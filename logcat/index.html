<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-CN lang=zh-cn><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.110.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Logcat &#183; Vee's space</title><meta name=description content><link type=text/css rel=stylesheet href=https://vee-zhang.github.iocss/print.css media=print><link type=text/css rel=stylesheet href=https://vee-zhang.github.iocss/poole.css><link type=text/css rel=stylesheet href=https://vee-zhang.github.iocss/syntax.css><link type=text/css rel=stylesheet href=https://vee-zhang.github.iocss/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><link href=https://vee-zhang.github.io/logcat/index.md rel=alternate type=text/plain title="Vee's space"></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://vee-zhang.github.io><h1>Vee's space</h1></a><p class=lead>关于 DoIt 主题</p></div><nav><ul class=sidebar-nav><li><a href=https://vee-zhang.github.io>Home</a></li><li><a href=/posts/>所有文章</a></li><li><a href=/tags/>标签</a></li><li><a href=/categories/>分类</a></li><li><a href=/series/>系列</a></li><li><a href=/about/>关于</a></li></ul></nav><p>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</p></div></aside><main class="content container"><div class=post><h1>Logcat</h1><time datetime=2022-07-06T22:55:20+0800 class=post-date>Wed, Jul 6, 2022</time><p>今天是我过得非常不爽的一天，因为今天说了『我不会』『我不懂』『我看不明白』，从哥2017年自学安卓到现在，从一点不会到基本不百度，我还没说过这些话。今天真是太刺激了，从上层转底层真的这么费劲吗，还是说年纪大了学不动了？都不是，是我一开始学系统底层还没找到要领，同时又事物缠身，分身无术。仔细想想还是先从常用工具入手，别他妈让我抓个log都这么费劲。</p><h2 id=logcat是什么>logcat是什么</h2><p>就是Android-sdk提供的抓取log的工具，位于<code>Android/sdk/platform-tools/adb</code>.</p><h2 id=logcat启动方式>logcat启动方式</h2><h3 id=adb方式>adb方式</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb logcat
</span></span></code></pre></td></tr></table></div></div><h3 id=shell方式>shell方式</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb shell
</span></span><span class=line><span class=cl>logcat
</span></span></code></pre></td></tr></table></div></div><h2 id=logcat帮助>logcat帮助</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb logcat --help
</span></span></code></pre></td></tr></table></div></div><h2 id=缓冲区>缓冲区</h2><table><thead><tr><th>buffer</th><th>description</th></tr></thead><tbody><tr><td>radio</td><td>无线装置/电话短信</td></tr><tr><td>events</td><td>二进制系统事件</td></tr><tr><td>main</td><td>主日志缓冲区，不包含系统和崩溃</td></tr><tr><td>system</td><td>系统</td></tr><tr><td>crash</td><td>崩溃</td></tr><tr><td>all</td><td>所有</td></tr><tr><td>default</td><td>默认，包含main、system、crash</td></tr></tbody></table><h2 id=命令格式>命令格式</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>logcat [options] [filterspecs]
</span></span></code></pre></td></tr></table></div></div><p>注意，这里的options可以有多个。</p><h2 id=选项>选项</h2><table><thead><tr><th>option</th><th>description</th></tr></thead><tbody><tr><td>-b</td><td>加载可供查看的日志缓冲区</td></tr><tr><td>-g</td><td>输出日志缓冲区信息</td></tr><tr><td>-c</td><td>清楚所选的缓冲区并退出，默认缓冲区集合为main、system、crash,清楚所有缓冲区则使用-b all -c</td></tr><tr><td>-e &lt;expr></td><td>抓取正则表达式匹配的行</td></tr><tr><td>-m &lt;count></td><td>输出&lt;count>行后退出，可与-e配合使用</td></tr><tr><td>-d</td><td>将缓冲区的log转存到屏幕后退出</td></tr><tr><td>-f &lt;filePath></td><td>将日志写入文件，默认文件名为stdout，像不像std::cout</td></tr><tr><td>-s</td><td>过滤，一会详细了解一下</td></tr><tr><td>-v &lt;format></td><td>设置日志的输出格式，默认为threadtime</td></tr><tr><td>-D</td><td>输出日志时给各个缓冲区之间加个分割线来区分，推荐使用</td></tr><tr><td>-t &lt;count></td><td>仅输出最新的行数，包含-d</td></tr><tr><td>-t &lt;time></td><td>输出指定时间锚点以来的最新行，包含-d，如：adb logcat -t &lsquo;01-26 20:52:41.820&rsquo;</td></tr><tr><td>-T</td><td>与-t一致，不包含-d</td></tr><tr><td>-L</td><td>在最后一次重启之前转存log</td></tr><tr><td>-B</td><td>以二进制文件输出日志</td></tr><tr><td>-S</td><td>输出统计信息</td></tr><tr><td>-G</td><td>设置日志缓冲区大小，单位是K或M</td></tr><tr><td>&ndash;pid=&lt;pid></td><td>仅输出指定pid的log</td></tr></tbody></table><h2 id=过滤>过滤</h2><h3 id=优先级与tag>优先级与TAG</h3><p>以下是log的优先级，与AS中对应：</p><table><thead><tr><th>priority</th><th>description</th></tr></thead><tbody><tr><td>V</td><td>详细</td></tr><tr><td>D</td><td>调试</td></tr><tr><td>I</td><td>信息</td></tr><tr><td>W</td><td>警告</td></tr><tr><td>E</td><td>错误</td></tr><tr><td>F</td><td>严重错误</td></tr><tr><td>S</td><td>静默，毛没有</td></tr></tbody></table><p>TAG不用解释了，我懂得。</p><p>格式：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&lt;priority&gt;/&lt;tag&gt;
</span></span></code></pre></td></tr></table></div></div><p>eg:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb logcat ActivityManager:I MyApp:D *:S
</span></span></code></pre></td></tr></table></div></div><p>显示tag为<code>ActivityManager</code>并且等级是<code>I</code>以上的日志；和tag为<code>MyApp</code>并且等级为<code>D</code>以上的日志；与此同时，通过<code>*:S</code>让其他日志静默。</p><blockquote><p>注意这里，实测用tag过滤后，并不能阻止其他日志的出现，所以后面必须加*:S才能单独显示tag标记后的日志。</p></blockquote><h2 id=格式控制>格式控制</h2><p>可以通过<code>-v</code>参数控制日志输出的格式。</p><table><thead><tr><th>format</th><th>description</th></tr></thead><tbody><tr><td>brief</td><td>priority+tag+PID</td></tr><tr><td>long</td><td>元数据字段，并使用空白行区分</td></tr><tr><td>process</td><td>PID</td></tr><tr><td>raw</td><td>不包含其他元数据的原始日志消息</td></tr><tr><td>tag</td><td>priority+tag</td></tr><tr><td>thread</td><td>priority+PID+TID</td></tr><tr><td>threadtime</td><td>默认，time+priority+tag+PID+TID</td></tr><tr><td>time</td><td>date+time+priority+tag+PID</td></tr></tbody></table><h2 id=logcat导出>logcat导出</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb logcat -d &gt;wzj.txt
</span></span></code></pre></td></tr></table></div></div></div></main></body></html>