[{"categories":[],"content":"ç»ƒä¹ javaæ–‡ä»¶ package com.vee.test; public class HelloJNI { static { System.loadLibrary(\"HelloJNI\"); } public native void sayHello(); public static void main(String[] args) { new HelloJNI().sayHello(); } } é€šè¿‡System.loadLibrary(\"[åº“åç§°]\")åŠ è½½åº“ã€‚ é€šè¿‡nativeå£°æ˜å‡½æ•°ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸ªæœ¬åœ°å‡½æ•°ï¼Œéœ€è¦é€šè¿‡jniæ¥è°ƒç”¨å…¶ä»–è¯­è¨€ä¸­çš„å‡½æ•°ã€‚ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:1:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"ç”Ÿæˆå¤´æ–‡ä»¶ java10ä»¥ä¸‹ï¼š javac HelloJNI javah HelloJNI java10åŠä»¥ä¸Šï¼š javac -h include HelloJNI.java ä»¥ä¸Šå‘½ä»¤ä¼šåœ¨ç›¸å¯¹åœ°å€includeç›®å½•ä¸‹ç”Ÿæˆcom_vee_test_HelloJNI.hå¤´æ–‡ä»¶ï¼š /* DO NOT EDIT THIS FILE - it is machine generated */ #include \u003cjni.h\u003e /* Header for class com_vee_test_HelloJNI */ #ifndef _Included_com_vee_test_HelloJNI #define _Included_com_vee_test_HelloJNI #ifdef __cplusplus extern \"C\" { #endif /* * Class: com_vee_test_HelloJNI * Method: sayHello * Signature: ()V */ JNIEXPORT void JNICALL Java_com_vee_test_HelloJNI_sayHello (JNIEnv *, jobject); #ifdef __cplusplus } #endif #endif å…¶ä¸­æœ€ä¸»è¦çš„å°±æ˜¯å‡½æ•°JNIEXPORT void JNICALL Java_HelloJNI_sayHello (JNIEnv *, jobject);ï¼Œå‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š JNIEnv*ï¼šJNIè¿è¡Œç¯å¢ƒçš„æŒ‡é’ˆ jobject: è°ƒç”¨å¯¹è±¡ï¼ŒæŒ‡ä»£javaä¸­çš„thiså¯¹è±¡ã€‚ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:2:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"ç¼–è¯‘å‡ºåº“ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:3:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"linux gcc -I$JAVA_HOME/include -I$JAVA_HOME/include/linux -fPIC -shared include/HelloJNI.c -o libs/libHelloJNI.so -I åŒ…å«ç¼–è¯‘JNIå¿…è¦çš„å¤´æ–‡ä»¶ -fPIC ç¼–è¯‘æˆä¸ä½ç½®æ— å…³çš„ç‹¬ç«‹ä»£ç  -shared ç¼–è¯‘æˆåŠ¨æ€åº“ -o æŒ‡å®šç¼–è¯‘ååŠ¨æ€åº“ç”Ÿæˆçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ˆä¸€èˆ¬ç”¨libXXX.soå‘½åï¼‰,è¿™é‡Œæˆ‘ä»¬æŠŠsoæ”¾åœ¨libsç›®å½•ä¸‹ã€‚ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:3:1","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"è¿è¡Œ java -Djava.library.path=./libs com/vee/test/HelloJNI.java -Djava.library.pathæ˜¯æŒ‡æ˜javaçš„åº“è·¯å¾„ï¼Œå¦‚æœä¸åŠ è¿™ä¸ªé€‰é¡¹ï¼Œåˆ™javaé»˜è®¤ä¼šå»ç³»ç»Ÿå±æ€§æŒ‡å®šçš„ç›®å½•ä¸‹æŸ¥æ‰¾åŠ¨æ€åº“æ–‡ä»¶ï¼Œæ‰¾ä¸åˆ°ä¼šæŠ¥é”™ï¼š java.lang.UnsatisfiedLinkError: no HelloJNI in java.library.path: /usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib å¯ä»¥çœ‹åˆ°ï¼Œjavaä¼šé»˜è®¤ä»è¿™ä¸¤ä¸ªç›®å½•ä¸­æ‰¾ï¼š /usr/lib /usr/lib64 ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:3:2","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"æ•°æ®ç±»å‹ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:4:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"åŸºæœ¬æ•°æ®ç±»å‹ java jni c/c++ description boolean jboolean unsigned char unsigned 8 bits byte jbyte signed char signed 8 bits char jchar unsigned short unsigned 16 bits short jshort signed short signed 16 bits int jint signed int signed 64 bits long jlong signed long signed 64 bits float jfloat float 32 bits double jdouble double 64bits æ³¨æ„ï¼šè¿™äº›æ•°æ®ç±»å‹æ˜¯å¯ä»¥åœ¨JNIä¸­ç›´æ¥æ—¶ä½¿ç”¨çš„ï¼Œä¸éœ€è½¬æ¢ã€‚ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:4:1","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"å¼•ç”¨æ•°æ®ç±»å‹ java jni java.lang.Object jobject java.lang.String jstring java.lang.Class jclass Object[] jobjectArray boolean[] jbooleanArray byte[] jbyteArray char[] jcharArray short[] jshortArray int[] jintArray long[] jlongArray float[] jfloatArray double[] jdoubleArray java.lang.Throwable jthrowable void void å¼•ç”¨ç±»å‹ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦ç»è¿‡JNIå‡½æ•°è½¬æ¢æ‰èƒ½ä½¿ç”¨ï¼š jclass intArrayClass = env-\u003eFindClass(\"[I\"); int len = 10; jobjectArray objectIntArray = env-\u003eNewObjectArray(len,intArrayClass,NULL); JNIä¸­æ‰€æœ‰çš„arrayç±»å‹ï¼Œéƒ½ç»§æ‰¿è‡ªjarrayç±»å‹ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:4:2","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"ç±»æè¿°ç¬¦ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:4:3","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"åŸŸæè¿°ç¬¦ ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:4:4","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"JNIENV JNIEnv,è‹±æ–‡å…¨ç§°æ˜¯Java Native Interface Environmentï¼Œç”¨å’‹ä¸­å›½è¯æ¥è¯´å°±æ˜¯Javaæœ¬åœ°æ¥å£ç¯å¢ƒã€‚ åœ¨JNIä¸­ï¼Œé€šè¿‡nativeæ–¹æ³•ç¼–è¯‘å‡ºçš„.hæ–‡ä»¶ä¸­å¯¹åº”çš„å‡½æ•°å£°æ˜ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯JNIEnvçš„æŒ‡é’ˆã€‚ JNIä¸­æä¾›äº†ä¸€ç³»åˆ—çš„æ–¹å¼ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š å‡½æ•° åŠŸèƒ½ FindClass åŠ è½½æœ¬åœ°å®šä¹‰çš„ç±»å‹ GetObjectClass è·å–å¯¹è±¡çš„ç±»å‹ NewGlobalRef åˆ›å»ºobjå‚æ•°æ‰€å¼•ç”¨å¯¹è±¡çš„æ–°å…¨å±€å¼•ç”¨ NewObject æ„é€ æ–°çš„javaå¯¹è±¡ NewString åˆ©ç”¨Unicodeå­—ç¬¦æ•°ç»„æ„é€ æ–°çš„java.lang.Stringå¯¹è±¡ NewArray åˆ›å»ºç±»å‹ä¸ºTypeçš„æ•°ç»„å¯¹è±¡ GetField è·å–ç±»å‹ä¸ºTypeçš„å­—æ®µ SetField è®¾ç½®ç±»å‹ä¸ºTypeçš„å­—æ®µ GetStaticField è·å–ç±»å‹ä¸ºTypeçš„staticçš„å­—æ®µçš„å€¼ SetStaticField è®¾ç½®ç±»å‹ä¸ºTypeçš„staticçš„å­—æ®µçš„å€¼ CallMethod è°ƒç”¨è¿”å›ç±»å‹ä¸ºTypeçš„æ–¹æ³• CallStaticMethod è°ƒç”¨è¿”å›å€¼ç±»å‹ä¸ºTypeçš„staticæ–¹æ³• ","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:5:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"å…ˆåˆ°è¿™é‡Œï¼Œå¾…ç»­ã€‚ã€‚ã€‚","date":"2023-01-15","objectID":"/jni%E5%AD%A6%E4%B9%A0/:6:0","series":[],"tags":[],"title":"JNIå­¦ä¹ ","uri":"/jni%E5%AD%A6%E4%B9%A0/"},{"categories":[],"content":"scanf()å‡½æ•° scanf()å‡½æ•°ç”¨äºæ ¼å¼åŒ–æ‰«æï¼Œä¸print()å‡½æ•°æ­£å¥½ç›¸å¯¹ã€‚ #include \u003cstdio.h\u003e int main() { int a = 0, b = 0, c = 0, d = 0; scanf(\"%d\", \u0026a); //è¾“å…¥æ•´æ•°å¹¶èµ‹å€¼ç»™å˜é‡a scanf(\"%d\", \u0026b); //è¾“å…¥æ•´æ•°å¹¶èµ‹å€¼ç»™å˜é‡b printf(\"a+b=%d\\n\", a+b); //è®¡ç®—a+bçš„å€¼å¹¶è¾“å‡º scanf(\"%d %d\", \u0026c, \u0026d); //è¾“å…¥ä¸¤ä¸ªæ•´æ•°å¹¶åˆ†åˆ«èµ‹å€¼ç»™cã€d printf(\"c*d=%d\\n\", c*d); //è®¡ç®—c*dçš„å€¼å¹¶è¾“å‡º return 0; } è¿è¡Œååœ¨æ§åˆ¶å°ä¸­è¾“å…¥ï¼š 12å›è½¦ 60å›è½¦ è¾“å‡ºï¼ša+b=72 å†è¾“å…¥ï¼š 10 23å›è½¦ è¾“å‡ºï¼šc*d=230 ","date":"2022-12-16","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E8%BE%93%E5%85%A5/:1:0","series":[],"tags":[],"title":"Cè¯­è¨€çš„è¾“å…¥","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E8%BE%93%E5%85%A5/"},{"categories":[],"content":"å­—ç¬¦ ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:1:0","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"ä¸“ç”¨æ‰“å°æ–¹å¼ char a = '1'; putchar(a); printf(\"%c\",a); putcharå‡½æ•°å•æ¬¡åªèƒ½è¾“å‡ºä¸€ä¸ªchar,ç›¸å¯¹æ¥è¯´printfå‡½æ•°è¦å¼ºå¤§çš„å¤šã€‚ ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:1:1","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"å­—ç¬¦ä¸æ•´æ•° è®¡ç®—æœºåœ¨å­˜å‚¨å­—ç¬¦æ—¶å¹¶ä¸æ˜¯çœŸçš„è¦å­˜å‚¨å­—ç¬¦çš„å®ä½“ï¼Œè€Œæ˜¯å­˜å‚¨è¯¥å­—ç¬¦åœ¨å­—ç¬¦é›†ä¸­çš„ç¼–å·ã€‚å¯¹äºcharç±»å‹æ¥è¯´ï¼Œä¸–çºªå­˜å‚¨çš„å°±æ˜¯å­—ç¬¦çš„ASCIIç ã€‚ æ— è®ºåœ¨å“ªä¸ªå­—ç¬¦é›†ä¸­ï¼Œå­—ç¬¦ç¼–å·éƒ½æ˜¯ä¸€ä¸ªæ•´æ•°ï¼›ä»è¿™ä¸ªè§’åº¦å»è€ƒè™‘ï¼Œå­—ç¬¦ç±»å‹æœ¬è´¨ä¸Šä¸æ•´æ•°ä¸€è‡´ã€‚ æˆ‘ä»¬å¯ä»¥ç»™å­—ç¬¦ç±»å‹èµ‹å€¼ä¸€ä¸ªæ•´æ•°ï¼Œæˆ–è€…ä»¥æ•´æ•°çš„å½¢å¼è¾“å‡ºå­—ç¬¦ç±»å‹ã€‚åè¿‡æ¥ï¼Œä¹Ÿå¯ä»¥ç»™æ•´æ•°ç±»å‹èµ‹å€¼ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ–è€…ä»¥å­—ç¬¦çš„å½¢å¼è¾“å‡ºæ•´æ•°ç±»å‹ã€‚ #include \u003cstdio.h\u003e int main() { char a = 'E'; char b = 70; int c = 71; int d = 'H'; printf(\"a: %c, %d\\n\", a, a); printf(\"b: %c, %d\\n\", b, b); printf(\"c: %c, %d\\n\", c, c); printf(\"d: %c, %d\\n\", d, d); return 0; } è¾“å‡ºï¼š a: E, 69 b: F, 70 c: G, 71 d: H, 72 ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:1:2","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"ä¸­æ–‡å­—ç¬¦ ç”±äºcharä½¿ç”¨ç”µè„‘ç³»ç»Ÿçš„é»˜è®¤ç¼–ç ï¼Œä¸€èˆ¬windowsä¸Šéƒ½æ˜¯ASCIIï¼Œåªèƒ½è¯†åˆ«åˆ°è‹±æ–‡å­—æ¯ï¼Œæ‰€ä»¥æ˜¯ä¸æ”¯æŒæ±‰å­—å•å­—ç¬¦çš„ã€‚æ‰€ä»¥è¦å­˜å‚¨æ±‰å­—å­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨å®½å­—ç¬¦wchar_tã€‚ å®½å­—ç¬¦wchar_tä½¿ç”¨UTF-16æˆ–UTF-32ç¼–ç ã€‚ ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:1:3","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"å­—ç¬¦çš„ç¼–ç  char ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:1:4","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"å­—ç¬¦ä¸² Cè¯­è¨€ä¸­å‹æ ¹å°±æ²¡æœ‰å­—ç¬¦ä¸²ï¼Œåªèƒ½ä½¿ç”¨æ•°ç»„å’ŒæŒ‡é’ˆæ¥æ¸æ¸çš„å‚¨å­˜å­—ç¬¦ä¸²ã€‚ //æ•°ç»„æ–¹å¼ char str1[] = \"http://c.biancheng.net\"; //è¿™é‡Œå¸®åŸä½œæ‰“ä¸ªå¹¿å‘Š //æŒ‡é’ˆæ–¹å¼ char *str2 = \"Cè¯­è¨€ä¸­æ–‡ç½‘\"; ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/:2:0","series":[],"tags":[],"title":"Cè¯­è¨€çš„Char","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"categories":[],"content":"TODO ","date":"2022-12-15","objectID":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E7%AC%A6%E5%8F%B7%E4%BD%8D/:0:0","series":[],"tags":[],"title":"Cè¯­è¨€çš„ç¬¦å·ä½","uri":"/c%E8%AF%AD%E8%A8%80%E7%9A%84%E7%AC%A6%E5%8F%B7%E4%BD%8D/"},{"categories":[],"content":"ä¸€ä¸ªæ•°å­—é»˜è®¤å°±æ˜¯åè¿›åˆ¶çš„ï¼Œè¡¨ç¤ºä¸€ä¸ªåè¿›åˆ¶æ•°å­—ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šçš„æ ¼å¼ã€‚ä½†æ˜¯è¡¨ç¤ºå…¶ä»–è¿›åˆ¶çš„æ•°ç»„å°±éœ€è¦åŠ ç‰¹å®šçš„å‰ç¼€ã€‚ ","date":"2022-12-15","objectID":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/:0:0","series":[],"tags":[],"title":"è¿›åˆ¶æ•°çš„è¡¨ç¤º","uri":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/"},{"categories":[],"content":"äºŒè¿›åˆ¶ å‰ç¼€ï¼š0bæˆ–è€…0Bã€‚ int a = 0b101; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 5 int b = -0b110010; //æ¢ç®—æˆåè¿›åˆ¶ä¸º -50 int c = 0B100001; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 33 ","date":"2022-12-15","objectID":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/:0:1","series":[],"tags":[],"title":"è¿›åˆ¶æ•°çš„è¡¨ç¤º","uri":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/"},{"categories":[],"content":"å…«è¿›åˆ¶ å‰ç¼€ï¼š0ã€‚ int a = 015; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 13 int b = -0101; //æ¢ç®—æˆåè¿›åˆ¶ä¸º -65 int c = 0177777; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 65535 æ ¼å¼åŒ–è¾“å‡ºï¼š%ho,%o,%lo ","date":"2022-12-15","objectID":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/:0:2","series":[],"tags":[],"title":"è¿›åˆ¶æ•°çš„è¡¨ç¤º","uri":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/"},{"categories":[],"content":"åå…­è¿›åˆ¶ åå…­è¿›åˆ¶ç”±æ•°å­—0~9ã€å­—æ¯A~Fï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ç»„æˆã€‚ å‰ç¼€ï¼š0xæˆ–0Xã€‚ int a = 0X2A; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 42 int b = -0XA0; //æ¢ç®—æˆåè¿›åˆ¶ä¸º -160 int c = 0xffff; //æ¢ç®—æˆåè¿›åˆ¶ä¸º 65535 ","date":"2022-12-15","objectID":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/:0:3","series":[],"tags":[],"title":"è¿›åˆ¶æ•°çš„è¡¨ç¤º","uri":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/"},{"categories":[],"content":"ç”¨è¿›åˆ¶è¿›è¡Œæ ¼å¼åŒ–è¾“å‡º int main() { short a = 0b1010110; //äºŒè¿›åˆ¶æ•°å­— int b = 02713; //å…«è¿›åˆ¶æ•°å­— long c = 0X1DAB83; //åå…­è¿›åˆ¶æ•°å­— printf(\"a=%ho, b=%o, c=%lo\\n\", a, b, c); //ä»¥å…«è¿›åˆ¶å½¢ä¼¼è¾“å‡º printf(\"a=%hd, b=%d, c=%ld\\n\", a, b, c); //ä»¥åè¿›åˆ¶å½¢å¼è¾“å‡º printf(\"a=%hx, b=%x, c=%lx\\n\", a, b, c); //ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼ˆå­—æ¯å°å†™ï¼‰ printf(\"a=%hX, b=%X, c=%lX\\n\", a, b, c); //ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼ˆå­—æ¯å¤§å†™ï¼‰ return 0; } è¾“å‡ºï¼š a=126, b=2713, c=7325603 a=86, b=1483, c=1944451 a=56, b=5cb, c=1dab83 a=56, b=5CB, c=1DAB83 å¦‚æœéœ€è¦è¾“å‡ºå‰ç¼€ï¼Œåˆ™åœ¨%åé¢åŠ ä¸Š#ï¼š int main() { short a = 0b1010110; //äºŒè¿›åˆ¶æ•°å­— int b = 02713; //å…«è¿›åˆ¶æ•°å­— long c = 0X1DAB83; //åå…­è¿›åˆ¶æ•°å­— printf(\"a=%#ho, b=%#o, c=%#lo\\n\", a, b, c); //ä»¥å…«è¿›åˆ¶å½¢ä¼¼è¾“å‡º printf(\"a=%hd, b=%d, c=%ld\\n\", a, b, c); //ä»¥åè¿›åˆ¶å½¢å¼è¾“å‡º printf(\"a=%#hx, b=%#x, c=%#lx\\n\", a, b, c); //ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼ˆå­—æ¯å°å†™ï¼‰ printf(\"a=%#hX, b=%#X, c=%#lX\\n\", a, b, c); //ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºï¼ˆå­—æ¯å¤§å†™ï¼‰ return 0; } å¯¹åº”è¾“å‡ºï¼š a=0126, b=02713, c=07325603 a=86, b=1483, c=1944451 a=0x56, b=0x5cb, c=0x1dab83 a=0X56, b=0X5CB, c=0X1DAB83 æ³¨æ„ï¼šä¸å¯ä»¥æ—¶ç”¨printfç›´æ¥è¾“å‡ºäºŒè¿›åˆ¶ã€‚ ","date":"2022-12-15","objectID":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/:0:4","series":[],"tags":[],"title":"è¿›åˆ¶æ•°çš„è¡¨ç¤º","uri":"/%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA/"},{"categories":[],"content":"é‡ç‚¹åŒºåˆ† ASCII,ç¾å›½å­—ç¬¦é›†ï¼Œåªæ”¯æŒè‹±æ–‡å­—ç¬¦ã€‚ GB2312,ç®€ä½“ä¸­æ–‡å­—ç¬¦é›†ï¼Œ1984å¹´å‘å¸ƒã€‚ GBKï¼Œä¸­æ–‡å­—ç¬¦é›†ï¼Œ1995å¹´å‘å¸ƒï¼Œåœ¨GB2312çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•ã€‚ GB18030ï¼Œä¸­æ–‡å­—ç¬¦é›†ï¼Œ2000å¹´å‘å¸ƒï¼Œåœ¨GBKä¸Šå†æ¬¡æ‰©å±•ã€‚ Big5ï¼Œä¸­æ–‡ç¹ä½“å­—ç¬¦é›† ","date":"2022-12-15","objectID":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/:0:0","series":[],"tags":[],"title":"1-1ç¼–ç¨‹åŸºç¡€-ASCIIä¸GBK","uri":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/"},{"categories":[],"content":"ä¸ASCIIçš„å…³ç³» ASCIIæ˜¯æœ€æ—©çš„å­—ç¬¦é›†ï¼Œå…¶ä»–çš„å­—ç¬¦é›†éƒ½æ˜¯åœ¨ASCIIçš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œæ‰€ä»¥å…¨éƒ½å…¼å®¹ASCIIã€‚ ","date":"2022-12-15","objectID":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/:1:0","series":[],"tags":[],"title":"1-1ç¼–ç¨‹åŸºç¡€-ASCIIä¸GBK","uri":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/"},{"categories":[],"content":"Unicode å…¨çƒåŒ–èŒƒç”¨çš„ç¼–ç ã€‚ ","date":"2022-12-15","objectID":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/:2:0","series":[],"tags":[],"title":"1-1ç¼–ç¨‹åŸºç¡€-ASCIIä¸GBK","uri":"/1_1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80_ascii%E4%B8%8Egbk/"},{"categories":[],"content":"æ¨¡å¼ å®½å®¹æ¨¡å¼-Permissive:åªæ‰“å°auditå¼‚å¸¸logï¼Œä¸ä¼šæ‹’ç»è¯·æ±‚ï¼› å¼ºåˆ¶æ¨¡å¼-Enforce:å³æ‰“å°auditå¼‚å¸¸logï¼Œä¹Ÿä¼šæ‹’ç»è¯·æ±‚ï¼› ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:1","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"ç­–ç•¥æ–‡ä»¶ ä½ç½® SELinuxç­–ç•¥æ–‡ä»¶ç”¨äºå®šä¹‰åŸŸå’Œæ ‡ç­¾ï¼Œä»¥*.teç»“å°¾ã€‚ Androidè‡ªå¸¦çš„ç­–ç•¥æ–‡ä»¶ä½äºAOSPä¸­çš„system/sepolicyä¸­ï¼Œæˆ‘ä»¬å°½é‡ä¸è¦å»ä¿®æ”¹è¿™é‡Œçš„ç­–ç•¥ï¼Œè€Œæ˜¯åº”ä¿®æ”¹ä½äºdevice/manufacturer/device-name/sepolicyç›®å½•ä¸‹ï¼ˆå…¶å®å°±æ˜¯croot/device/åˆ¶é€ å•†/è®¾å¤‡/sepolicy/ï¼‰çš„.teæ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿå°½é‡ä¸è¦å»æ–°å»º.teæ–‡ä»¶ï¼Œè€Œæ˜¯åº”è¯¥åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šä¿®æ”¹ã€‚ å…¶å®è¿™é‡Œè¯´çš„å°½é‡ä¸è¦ï¼Œä¸»è¦æ˜¯é’ˆå¯¹ä¼ä¸šï¼Œå› ä¸ºgoogleæœ‰å¯èƒ½ä¼šæ‰¾ä½ éº»çƒ¦ï¼Œè€Œä¸”åç»­æ›´æ–°ä¹Ÿä¼šé‡åˆ°é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœè‡ªå·±ç©çš„è¯ï¼Œæƒ³æ”¹å°±æ”¹ã€‚ä¸è¿‡è¿˜æ˜¯ä¸å»ºè®®æ”¹é»˜è®¤å®ç°ï¼Œå¦åˆ™å‡çº§ä¹‹ååˆå›é€€äº†ã€‚ æ ¼å¼ allow source target:class permissions; source:è§„åˆ™ä¸»é¢˜çš„ç±»å‹ï¼ˆæˆ–å±æ€§ï¼‰ï¼Œä»£è¡¨è°æ­£åœ¨ç”³è¯·è®¿é—®æƒé™ï¼› target:å¯¹è±¡ç±»å‹ï¼ˆæˆ–å±æ€§ï¼‰ï¼Œå¯¹å“ªäº›å†…å®¹æå‡ºäº†è®¿é—®æƒé™ï¼› class:è¦è®¿é—®çš„å¯¹è±¡ï¼ˆï¼‰çš„ç±»å‹; permissions:è¦æ‰§è¡Œçš„æ“ä½œã€‚ eg: allow untrusted_app app_data_file:file {read write}; å® å¦‚æœè¦æ·»åŠ çš„æƒé™å¾ˆå¤šï¼Œä¸ºäº†ç®€åŒ–è§„åˆ™å®šä¹‰ï¼ŒSEAndroidæä¾›äº†å®ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­å¯ä»¥è¿™æ ·å†™ï¼š eg: allow untrusted_app app_data_file:file rw_file_perms; ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:2","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"ä¸Šä¸‹æ–‡æè¿°æ–‡ä»¶ åœ¨device/manufacturer/device-name/sepolicyä¸­å­˜åœ¨å„ç§ä¸Šä¸‹æ–‡æè¿°æ–‡ä»¶ï¼Œä¸»è¦è´Ÿè´£ä¸ºtargetæ‰“æ ‡ç­¾ã€‚ åˆ—ä¸¾ file_contextsç”¨äºä¸ºæ–‡ä»¶åˆ†é…æ ‡ç­¾ï¼Œå¹¶ä¸”å¯ä¾›å¤šç§ç”¨æˆ·ç©ºé—´æ—¶ç”¨ã€‚ genfs_contextsç”¨äºä¸ºä¸æ”¯æŒæ‰©å±•å±æ€§çš„æ–‡ä»¶ç³»ç»Ÿåˆ†é…æ ‡ç­¾ã€‚ property_contextsç”¨äºä¸ºAndroidç³»ç»Ÿå±æ€§åˆ†é…æ ‡ç­¾ï¼Œä»¥ä¾¿æ§åˆ¶é‚£äº›è¿›ç¨‹å¯ä»¥ä¸ºè®¾ç½®è¿™äº›å±æ€§ã€‚å†å¯åŠ¨æœŸé—´ï¼Œinitè¿›ç¨‹ä¼šè¯»å–è¿™äº›é…ç½®ã€‚ service_contextsç”¨äºä¸ºAndroid BinderæœåŠ¡åˆ†é…æ ‡ç­¾ï¼Œä»¥ä¾¿æ§åˆ¶é‚£äº›è¿›ç¨‹å¯ä»¥ä¸ºç›¸åº”æœåŠ¡æ·»åŠ ï¼ˆæ³¨å†Œï¼‰å’ŒæŸ¥æ‰¾Binderå¼•ç”¨ã€‚åœ¨å¯åŠ¨æœŸé—´ï¼Œservicemanagerè¿›ç¨‹ä¼šè¯»å–æ­¤é…ç½®ã€‚ seapp_contextsç”¨äºä¸ºåº”ç”¨è¿›ç¨‹å’Œ/data/dataç›®å½•åˆ†é…æ ‡ç­¾ã€‚åœ¨æ¯æ¬¡åº”ç”¨å¯åŠ¨æ—¶ï¼Œzygoteè¿›ç¨‹éƒ½ä¼šè¯»å–æ­¤é…ç½®ï¼›åœ¨å¯åŠ¨æœŸé—´ï¼Œinstalldä¼šè¯»å–æ­¤é…ç½®ã€‚ mac_permissions.xmlç”¨äºæ ¹æ®åº”ç”¨ç­¾åå’Œåº”ç”¨è½¯ä»¶åŒ…åç§°ä¸ºåº”ç”¨åˆ†é…seinfoæ ‡è®°ã€‚åˆ†é…çš„seinfoæ ‡è®°å¯åœ¨seapp_contextsæ–‡ä»¶ä¸­ç”¨åšå¯†é’¥ï¼Œä»¥ä¾¿ä¸ºå¸¦æœ‰è¯¥seinfoæ ‡è®°çš„æ‰€æœ‰åº”ç”¨åˆ†é…ç‰¹å®šæ ‡ç­¾ã€‚åœ¨å¯åŠ¨æœŸé—´ï¼Œsestem_serverä¼šè¯»å–æ­¤é…ç½®ã€‚ æ ¼å¼ æˆ‘ä»¬æ‰“å¼€file_contextsæ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ ¼å¼ï¼š /mnt/vendor/crypto(/.*)? u:object_r:mnt_vendor_crypto_file:s0 /(vendor|system/vendor)/bin/delete7dayslog.sh u:object_r:delete_seven_day_log-sh_exec:s0 å°±æ˜¯ç›®å½•+æ ‡ç­¾çš„æ–¹å¼ï¼Œçœ‹èµ·æ¥å¾ˆåƒhostçš„å®šä¹‰ã€‚ è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼š ç›®å½•æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ uï¼Œobject_r,s0éƒ½æ˜¯å›ºå®šçš„ ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:3","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"BoardConfig.mk å½“ä¿®æ”¹æˆ–æ·»åŠ äº†ç­–ç•¥æ–‡ä»¶å’Œä¸Šä¸‹æ–‡æè¿°æ–‡ä»¶åï¼Œéœ€è¦æ›´æ–°/device/manufacturer/device-name/BoardConfig.mkæ¥å¼•ç”¨ç”Ÿæ•ˆã€‚ eg: BOARD_SEPOLICY_DIRS += \\ \u003croot\u003e/device/manufacturer/device-name/sepolicy BOARD_SEPOLICY_UNION += \\ genfs_contexts \\ file_contexts \\ sepolicy.te æœ€åéœ€è¦éœ€è¦é‡æ–°ç¼–è¯‘æ‰èƒ½ç”Ÿæ•ˆï¼ ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:4","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"å¯åŠ¨ç”¨SELinux åœ¨å†…æ ¸ä¸­å¯ç”¨ï¼ˆeg:åœ¨kernel/msm-5.4/kernel/configs/android-base.configï¼‰ä¸­é…ç½®ï¼šCONFIG_SECURITY_SELINUX=y; æ›´æ”¹Kernel_cmdlineå‚æ•°ï¼šBOARD_KERNEL_CMDLINE := androidboot.selinux=permissive,å‘ç‰ˆå‰åº”è¯¥ç§»é™¤æ­¤å‚æ•°ä»¥å˜æ›´ä¸ºå¼ºåˆ¶æ¨¡å¼ï¼› ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:5","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"æŸ¥çœ‹å¼€æœºæ—¶çš„æ‹’ç»äº‹ä»¶ adb root adb shell dmesg | grep audit | grep av è¿”å›ï¼š [ 1.979517] audit: type=1400 audit(1.969:4): avc: denied { relabelfrom } for pid=261 comm=\"init\" name=\"/\" dev=\"tmpfs\" ino=10968 scontext=u:r:vendor_init:s0 tcontext=u:object_r:tmpfs:s0 tclass=dir permissive=0 ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:6","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"æŸ¥çœ‹SContext æ ‡å‡†çš„SContextæ ¼å¼å¦‚ä¸‹ï¼š user:role:type[:range] User:ç”¨æˆ·ï¼Œè¿™é‡Œçš„ç”¨æˆ·å¹¶élinuxçš„UID; Roleï¼šè§’è‰²ï¼Œä¸åŒçš„Roleå…·æœ‰ä¸åŒçš„æƒé™ï¼› Type:Subjectæˆ–è€…Objectçš„ç±»å‹ï¼Œå¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œtypeå°±æ˜¯domainã€‚ Rangeï¼šMSLçº§åˆ«ã€‚MLSå°†ç³»ç»Ÿçš„è¿›ç¨‹å’Œæ–‡ä»¶è¿›è¡Œäº†åˆ†çº§ï¼Œä¸åŒçº§åˆ«çš„èµ„æºéœ€è¦å¯¹åº”çº§åˆ«çš„è¿›ç¨‹æ‰èƒ½è®¿é—®ã€‚ æ–‡ä»¶çš„SContext å‘½ä»¤ï¼šls -Z u:object_r:system_file:s0 system u:è¯¥æ–‡ä»¶çš„SELinuxç”¨æˆ·,åœ¨SEAndroidä¸­åªæœ‰ä¸€ä¸ªSELinuxç”¨æˆ·ï¼Œå°±æ˜¯uï¼› object_r:è§’è‰²ï¼Œè¿™é‡Œçš„object_rè¡¨ç¤ºå›ºå®šä¸å˜çš„ä¸œè¥¿ï¼Œå¦‚æ–‡ä»¶ï¼Œåœ¨SEAndroidä¸­åªå®šä¹‰äº†ä¸¤ä¸ªroleï¼Œé€‚ç”¨äºä¸»é¢˜çš„rå’Œé€‚ç”¨äºå¯¹è±¡çš„object_rï¼› system_file:ç±»å‹ï¼Œè¿™é‡Œè¡¨ç¤ºsystemç›®å½•çš„ç±»å‹ï¼› s0:MLSçš„æ•æ„Ÿåº¦ï¼Œé»˜è®¤å°±æ˜¯s0ã€‚ è¿›ç¨‹çš„SContext å‘½ä»¤ï¼šps -Z LABEL USER PID PPID VSZ RSS WCHAN ADDR S NAME u:r:su:s0 root 25497 8935 9320 3144 sigsuspend 0 S sh u:r:su:s0 root 27256 25497 11788 3128 0 0 R ps æœ€å·¦ä¾§LABELè¿™ä¸€åˆ—å°±æ˜¯è¿›ç¨‹çš„SContextï¼š u:å°±æ˜¯SELinuxç”¨æˆ·ï¼ˆuserï¼‰ï¼› r:ä¸ºè§’è‰²ï¼ˆroleï¼‰ï¼Œç›¸å½“äºç”¨æˆ·ç»„ï¼› su:ä»£è¡¨è¯¥è¿›ç¨‹æ‰€å±çš„åŸŸä¸ºSU; s0:MLSçº§åˆ«ã€‚ ==================================================to be continue======== ","date":"2022-12-12","objectID":"/selinux%E5%92%8Cseandroid/:0:7","series":[],"tags":[],"title":"SELinuxå’ŒSEAndroid","uri":"/selinux%E5%92%8Cseandroid/"},{"categories":[],"content":"ç¼–è¯‘æ–¹å¼ åŸºäºMakeçš„ndk-build CMake ç‹¬ç«‹å·¥å…·é“¾ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:1:0","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"ndk-buildæ–¹å¼ ndk-buildæ˜¯åŸºäºmakeçš„ç¼–è¯‘å·¥å…·ï¼Œéœ€è¦é€šè¿‡Android.mkå’ŒApplication.mkæ¥é…ç½®ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:2:0","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"å†…éƒ¨åŸç† è¿è¡Œndk-buildè„šæœ¬ç›¸å½“äºè¿è¡Œäº†ä»¥ä¸‹å‘½ä»¤ï¼š $GNUMAKE -f \u003cndk\u003e/build/core/build-local.mk \u003cparameters\u003e $GNUMAKE æŒ‡å‘ GNU Make 3.81 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œ åˆ™æŒ‡å‘ NDK å®‰è£…ç›®å½•ã€‚æ‚¨å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯ä»å…¶ä»– Shell è„šæœ¬ï¼ˆç”šè‡³æ˜¯æ‚¨è‡ªå·±çš„ Make æ–‡ä»¶ï¼‰ä¸­è°ƒç”¨ ndk-buildã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:2:1","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"ä½¿ç”¨ $ cd \u003cproject\u003e $ \u003cndkå®‰è£…ç›®å½•\u003e/ndk-build [option] option mean clean æ¸…é™¤ä¹‹å‰çš„äº§ç‰© V=1 å¯åŠ¨æ„å»º -B V=1 å¼ºè¡Œæ‰§è¡Œå®Œæ•´çš„æ„å»ºå¹¶æ˜¾ç¤º NDK_APPLICATION_MK= ä½¿ç”¨ NDK_APPLICATION_MK å˜é‡æŒ‡å‘çš„ç‰¹å®š Application.mk æ–‡ä»¶è¿›è¡Œæ„å»º -C æŒ‡å®šé¡¹ç›®è·¯å¾„ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:2:2","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"Android.mkè®²è§£ ä¹‹å‰å­¦ä¹ AOSPçš„æ—¶å€™ï¼Œgoogleè¯´è¿™è´§å·²ç»åºŸå¼ƒäº†ï¼Œåœ¨aospä¸­ç”¨Android.bpé€æ¸æ›¿ä»£ã€‚ä½†æ˜¯æˆ‘ä¸€ç›´æ‰¾ä¸åˆ°bpçš„ç›¸å…³æ–‡æ¡£ï¼Œç°åœ¨æ‰åªçŸ¥é“bpæ–‡ä»¶é‡Œé¢é‚£äº›shared_libraryè¿™äº›éƒ½æ˜¯ç›´æ¥ä»Android.mkä¸­ç»§æ‰¿æ¥çš„ï¼Œæˆ‘ä¸å­¦mkï¼Œå°±ä¸ä¼šå†™bpï¼ç°åœ¨å­¦ä¹ ndkæ—¶å‘ç°åœ¨ASåˆ›å»ºé¡¹ç›®æ—¶é»˜è®¤ä½¿ç”¨CMakeï¼Œè€ŒCMakeç”¨çš„æ˜¯CMakeLists.txtï¼Œæˆ‘å»ä½ XXçš„ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:3:0","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"ç”¨é€” é…ç½®é¡¹ç›®å’ŒæŒ‡å®šApplication.mkæ–‡ä»¶ã€‚ æ¨¡å—åŒ–ï¼ŒAndroid.mkçš„è¯­æ³•æ”¯æŒå°†æºæ–‡ä»¶åˆ†ç»„ä¸ºæ¨¡å—ï¼Œæ¨¡å—æ˜¯é™æ€åº“ã€åŠ¨æ€åº“æˆ–ç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ å› ä¸ºApplication.mkæ˜¯åœ¨Android.mkä¸­æŒ‡å®šçš„ï¼Œæ‰€ä»¥ndk-buildä¸­ä¸éœ€è¦æŒ‡å®šå‰è€…ï¼Œè€Œéœ€è¦æŒ‡å®šåè€…ï¼Œå†é€šè¿‡åè€…æ‰¾åˆ°å‰è€…ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:3:1","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"åŸºç¡€ æˆ‘ä»ndkç›®å½•ä¸­ç›´æ¥æ‰“å¼€äº†ä¸€ä¸ªAndroid.mkæ–‡ä»¶å¦‚ä¸‹ï¼š # å¿…é¡»å…ˆå®šä¹‰è¿™ä¸ªå˜é‡ï¼Œè¡¨ç¤ºæºæ–‡ä»¶åœ¨é¡¹ç›®æ ‘ä¸­çš„ä½ç½®ï¼Œmy-diræ˜¯ndkæä¾›çš„å®ï¼Œè¿”å›å½“å‰è·¯å¾„ LOCAL_PATH:= $(call my-dir) $(warning ndk_helper is no longer maintained in the NDK. This copy is left for \\ compatibility purposes only. For an up to date copy, see \\ https://github.com/googlesamples/android-ndk/tree/master/teapots/common/ndk_helper) # CLEAR_VARSæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªç‰¹æ®Šçš„GNU Makefileï¼Œå¯ä»¥æ¸…é™¤LOCAL_XXXå˜é‡ include $(CLEAR_VARS) # æŒ‡å®šæ¨¡å—çš„åç§°ï¼Œæ¯ä¸ªæ¨¡å—åç§°å”¯ä¸€ä¸”ä¸å«ç©ºæ ¼ï¼Œäº§ç‰©ä»¥è¿™ä¸ªå€¼æ¥å‘½å LOCAL_MODULE:= ndk_helperå˜é‡ # åˆ—ä¸¾æºæ–‡ä»¶ï¼Œä»¥ç©ºæ ¼åˆ†å‰² LOCAL_SRC_FILES:= JNIHelper.cpp interpolator.cpp tapCamera.cpp gestureDetector.cpp perfMonitor.cpp vecmath.cpp GLContext.cpp shader.cpp gl3stub.c # å˜é‡ LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH) # å˜é‡ LOCAL_EXPORT_LDLIBS := -llog -landroid -lEGL -lGLESv2 # å˜é‡ LOCAL_STATIC_LIBRARIES := cpufeatures android_native_app_glue # BUILD_STATIC_LIBRARYå˜é‡æŒ‡å‘ä¸€ä¸ªMakefileè„šæœ¬ï¼Œç”¨æ¥æ”¶é›†æœ€è¿‘includeä»¥æ¥åœ¨LOCAL_XXXå˜é‡ä¸­å®šä¹‰çš„ä¿¡æ¯ include $(BUILD_STATIC_LIBRARY) #$(call import-module,android/native_app_glue) #$(call import-module,android/cpufeatures) ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:3:2","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"å˜é‡ å˜é‡åˆ†ä¸ºï¼š ndkå†…ç½®å˜é‡ï¼šä»¥LOCAL_ã€PRIVATE_ã€NDK_ã€APP_å¼€å¤´çš„å’Œéƒ¨åˆ†å°å†™å­—æ¯å˜é‡ï¼› è‡ªå®šä¹‰å˜é‡ï¼Œæ¨èä»¥MY_å¼€å¤´ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:4:0","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"NDKå®šä¹‰çš„includeå˜é‡ CLEAR_VARS ç”¨æ¥å–æ¶ˆæ‰€æœ‰LOCAL_XXXå˜é‡ã€‚ æ¯”å¦‚ï¼šLOCAL_MODULEã€LOCAL_SRC_FILES å’Œ LOCAL_STATIC_LIBRARIESã€‚ include $(CLEAR_VARS) ä¸ä¼šå–æ¶ˆLOCAL_PATHã€‚ BUILD_EXECUTABLE ç”¨äºæ„å»ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ include $(BUILD_EXECUTABLE) éœ€è¦ï¼š LOCAL_MODULE LOCAL_SRC_FILES BUILD_SHARED_LIBRARY ç”¨äºæ„å»ºåŠ¨æ€åº“.soã€‚ include $(BUILD_SHARED_LIBRARY) éœ€è¦ï¼š LOCAL_MODULE LOCAL_SRC_FILES BUILD_STATIC_LIBRARY ç”¨äºç¼–è¯‘é™æ€åº“.aã€‚ include $(BUILD_STATIC_LIBRARY) PREBUILT_SHARED_LIBRARY ç”¨äºåœ¨ç¼–è¯‘åŠ¨æ€åº“ä¹‹å‰æäº‹æƒ…ã€‚ include $(PREBUILT_SHARED_LIBRARY) è¿™é‡Œçš„LOCAL_SRC_FILESä¸èƒ½æ˜¯æºæ–‡ä»¶ï¼Œè€Œæ˜¯é¢„æ„å»ºå…±äº«åº“çš„è·¯å¾„ï¼Œå¦‚ï¼šfoo/libfoo.soã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨LOCAL_PREBUILTSå˜é‡å¼•ç”¨å¦ä¸€ä¸ªæ¨¡å—ä¸­çš„é¢„æ„å»ºåº“ã€‚ PREBUILT_STATIC_LIBRARY åŒä¸Šï¼Œç”¨æ¥åœ¨ç¼–è¯‘é™æ€åº“ä¹‹å‰æäº‹æƒ…çš„ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:4:1","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"ç›®æ ‡ä¿¡æ¯å˜é‡ APP_ABI æˆ‘ä»¬å¯ä»¥åœ¨Android.mkä¸­å®šä¹‰ä¸€ä¸ªAPP_ABIå˜é‡æŒ‡å®šç¼–è¯‘çš„ABIï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰ï¼Œæ„å»ºç³»ç»Ÿä¼šæ ¹æ®è¿™è´§æ¥è§£æAndroid.mkï¼ŒæŒ‡å®šçš„ABIæœˆå¤š4åˆ™è§£ææ¬¡æ•°ä¹Ÿè¶Šå¤šã€‚ TARGET_ARCH å®šä¹‰æ”¯æŒçš„cpuæ¶æ„ï¼š arm arm64 x86 x86_64 TARGET_PLATFORM å®šä¹‰æ”¯æŒçš„Android APIçº§åˆ«å·: android-1 android-2 android-3 android-28 ifeq ($(TARGET_PLATFORM),android-22) # ... do something ... endif TARGET_ARCH_ABI ç”¨æ¥æŒ‡å®šABIï¼š CPUæ¶æ„ ABI ARMv7 armeabi-v7a ARMv8 AArch64 arm64-v8a i686 x86 x86-64 x86_64 ifeq ($(TARGET_ARCH_ABI),arm64-v8a) # ... do something ... endif TARGET_ABI ç”¨æ¥æŒ‡å®šç‰¹å®šè®¾å¤‡ï¼Œè¯´ç™½äº†å°±æ˜¯TARGET_PLATFORM-TARGET_ARCH_ABIçš„å½¢å¼ï¼š ifeq ($(TARGET_ABI),android-22-arm64-v8a) # ... do something ... endif ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:4:2","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"æ¨¡å—æè¿°å˜é‡ï¼ˆé‡ç‚¹ï¼‰ LOCAL_PATH ç”¨äºæŒ‡å®šå½“å‰æ–‡ä»¶çš„è·¯å¾„ï¼Œå¿…é¡»åœ¨Android.mkæ–‡ä»¶çš„å¼€å¤´å®šä¹‰æ­¤å˜é‡ã€‚ LOCAL_PATH := $(call my-dir) ä¸ä¼šè¢«CLEAR_VARSæŒ‡å‘çš„è„šæœ¬æ¸…æ‰ã€‚ LOCAL_MODULE æ¨¡å—åç§°ã€‚ LOCAL_MODULE := foo LOCAL_MODULE_FILENAME := libnewfoo äº§ç‰©é»˜è®¤ä½¿ç”¨æ¨¡å—åç§°æ¥å‘½åï¼Œå¦‚æœéœ€è¦å•ç‹¬å‘½åäº§ç‰©ï¼Œåˆ™å¯ä»¥ä½¿ç”¨LOCAL_MODULE_FILENAMEå˜é‡ã€‚ ä¸Šé¢ä»£ç ä¸­ç¼–è¯‘å‡ºæ¥çš„äº§ç‰©å°±æ˜¯libnewfoo.soã€‚ LOCAL_SRC_FILES ç”¨æ¥æŒ‡å®šæ„å»ºç¼–è¯‘çš„æºæ–‡ä»¶åˆ—è¡¨ï¼Œåªéœ€è¦åˆ—å‡ºæ„å»ºæ—¶ä¸–çºªä¼ é€’åˆ°ç¼–è¯‘å™¨çš„æ–‡ä»¶ï¼Œæ„å»ºç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥ä¸€èˆ¬ç»™è¿™ä¸ªå˜é‡æŒ‡å®šä¸€ä¸ªå…¥å£æ–‡ä»¶å°±å¤Ÿäº†ã€‚ æ¨èä½¿ç”¨ç›¸å¯¹è·¯å¾„ã€‚ LOCAL_CPP_EXTENSION å¯ä»¥ä½¿ç”¨æ­¤å¯é€‰å˜é‡ä¸º C++ æºæ–‡ä»¶æŒ‡å®š .cpp ä»¥å¤–çš„æ–‡ä»¶æ‰©å±•åã€‚ LOCAL_CPP_EXTENSION := .cxx æ²¡å•¥ç”¨ã€‚ LOCAL_CPP_FEATURES å¤ªå¤æ‚ï¼Œçœ‹ä¸æ˜ç™½ï¼Œåé¢éœ€è¦å†æ‹ä¸€ä¸‹æ–‡æ¡£ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:4:3","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"å® å®å°±æ˜¯NDKæä¾›çš„å†…ç½®å‡½æ•°ã€‚ å¯ä»¥ä½¿ç”¨$(call \u003cfunction\u003e)æ–¹å¼è°ƒç”¨å®ï¼Œè¿”å›å­—ç¬¦ä¸²ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:0","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"my-dir è¿™ä¸ªå®è¿”å›æœ€ååŒ…æ‹¬çš„ makefile çš„è·¯å¾„ï¼Œé€šå¸¸æ˜¯å½“å‰ Android.mk çš„ç›®å½•ã€‚ ä½†æ˜¯æœ‰æ—¶å€™é‡å¤è°ƒç”¨å°±ä¼šå‡ºé—®é¢˜ï¼Œæ¯”å¦‚: LOCAL_PATH := $(call my-dir) # ... declare one module # ä½ çœ‹è¿™é‡Œï¼Œæˆ‘includeäº†ä¸€ä¸ªä¹Ÿå¸¦æœ‰makefileçš„LOCAL_PATH include $(LOCAL_PATH)/foo/`Android.mk` # å†è°ƒç”¨my-dirçš„è¯ï¼Œè·¯å¾„å°±æˆäº†LOCALâ€”PATHçš„å€¼äº† LOCAL_PATH := $(call my-dir) # æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ­¤includeå›åŸæ¥çš„è·¯å¾„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ğŸ¦ include $(LOCAL_PATH)/foo/Android.mk # ... declare another module ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:1","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"all-subdir-makefiles è¿”å›ä½äºå½“å‰ my-dir è·¯å¾„æ‰€æœ‰å­ç›®å½•ä¸­çš„ Android.mk æ–‡ä»¶åˆ—è¡¨ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:2","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"this-makefile è¿”å›å½“å‰ makefileï¼ˆæ„å»ºç³»ç»Ÿä»ä¸­è°ƒç”¨å‡½æ•°ï¼‰çš„è·¯å¾„ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:3","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"parent-makefile è¿”å›åŒ…å«æ ‘ä¸­çˆ¶ makefile çš„è·¯å¾„ï¼ˆåŒ…å«å½“å‰ makefile çš„ makefile çš„è·¯å¾„ï¼‰ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:4","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"grand-parent-makefile è¿”å›åŒ…å«æ ‘ä¸­ç¥–çˆ¶ makefile çš„è·¯å¾„ï¼ˆåŒ…å«å½“å‰çˆ¶ makefile çš„ makefile çš„è·¯å¾„ï¼‰ã€‚ ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:5","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"import-module ç”¨æ¥å¯¼å…¥æ¨¡å—ï¼ˆä¼šè‡ªåŠ¨å¯¼å…¥ç›®æ ‡æ¨¡å—çš„Android.mkï¼‰ $(call import-module,\u003cname\u003e) ","date":"2022-10-28","objectID":"/ndk%E7%BC%96%E8%AF%91/:5:6","series":[],"tags":[],"title":"Android.mkä¸ndk-build","uri":"/ndk%E7%BC%96%E8%AF%91/"},{"categories":[],"content":"åŸºæœ¬è¯­æ³• // å¼•å…¥å¤´æ–‡ä»¶,è¿™ä¸ªæ˜¯æ‰€æœ‰Cè¯­è¨€ç¼–è¯‘å™¨çš„æ ‡å‡†éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›è¾“å…¥å’Œè¾“å‡ºçš„æ”¯æŒã€‚ // includeè¯­å¥æ˜¯Cçš„é¢„å¤„ç†å™¨æŒ‡ä»¤ï¼Œ#ç¬¦å·æ ‡æ³¨çš„ä¸æ˜¯cçš„è¯­å¥ï¼Œè€Œæ˜¯è¡¨ç¤ºåœ¨ç¼–è¯‘ä¹‹å‰ï¼Œç”±é¢„å¤„ç†å™¨æ¥å¤„ç†çš„è¯­å¥ã€‚ #include\u003cstdio.h\u003e //ä¸»å‡½æ•° //è¿”å›å€¼æ˜¯è¿”å›ç»™æ“ä½œç³»ç»Ÿçš„ int main(void){ int number; number = 2014; printf(\"Hello ! I am dotcpp.com\\n\"); print(\"This tear is %d\\n\",number); return 0; } å˜é‡ååŒºåˆ†å¤§å°å†™ï¼Œå…è®¸å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—ã€‚ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:1","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"æ•°æ®ç±»å‹ ç±»å‹ å…³é”®å­— å ç”¨å­—èŠ‚æ•° å­—ç¬¦ char 1 æ— ç¬¦å·å­—ç¬¦ unsignedchar 1 æ•´æ•° int 4 æ— ç¬¦å·æ•´æ•° unsigned int 4 çŸ­æ•´æ•° short 2 æ— ç¬¦å·çŸ­æ•´æ•° unsignved short 2 é•¿æ•´æ•° long 4 æ— ç¬¦å·é•¿æ•´æ•° unsigned long 4 å•ç²¾åº¦æµ®ç‚¹ float 4 åŒç²¾åº¦æµ®ç‚¹ double 8 é•¿åŒç²¾åº¦æµ®ç‚¹ long double 10 ç±»å‹è½¬æ¢ (type_name) expression eg: (float) a; //å°†å˜é‡ a è½¬æ¢ä¸º float ç±»å‹ (int)(x+y); //æŠŠè¡¨è¾¾å¼ x+y çš„ç»“æœè½¬æ¢ä¸º int æ•´å‹ (float) 100; //å°†æ•°å€¼ 100ï¼ˆé»˜è®¤ä¸ºintç±»å‹ï¼‰è½¬æ¢ä¸º float ç±»å‹ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:2","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"æ•°ç»„ ç±»å‹è¯´æ˜ç¬¦ æ•°ç»„å [å¸¸é‡è¡¨è¾¾å¼]; int a[1000]={1,2,3,4,5}; float b[10]; int a[3][4]={ {1,2,3}, {10,20,30}}; ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:3","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"è¾“å…¥ä¸è¾“å‡º printf putcharè¾“å‡ºå•å­—ç¬¦ã€‚ getcharæ¥æ”¶é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦åˆ°å˜é‡ã€‚ æ ¼å¼åŒ–æ‰“å° printf(\"æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²\",è¾“å‡ºè¡¨é¡¹); è¿”å›å¯æ‰“å°çš„å­—ç¬¦çš„æ•°é‡ï¼Œå¦‚æœè¾“å‡ºé”™è¯¯ï¼Œå°†è¿”å›-1ã€‚ å ä½ç¬¦ è§£é‡Š d,i ä»¥åè¿›åˆ¶å½¢å¼è¾“å‡ºæœ‰ç¬¦å·æ•´æ•° O ä»¥å…«è¿›åˆ¶å½¢å¼è¾“å‡ºæ— ç¬¦å·æ•´æ•°ï¼ˆä¸å«å‰ç¼€0ï¼‰ x ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºæ— ç¬¦å·æ•´æ•°ï¼ˆä¸å«å‰ç¼€0xï¼‰ U ä»¥åè¿›åˆ¶å½¢å¼è¾“å‡ºæ— ç¬¦å·æ•´æ•° f ä»¥å°é¼ å½¢å¼è¾“å‡ºå•ã€åŒç²¾åº¦å®æ•° e ä»¥æŒ‡æ•°å½¢å¼è¾“å‡ºå•ã€åŒç²¾åº¦å®æ•° g ä»¥%fæˆ–%eä¸­è¾ƒçŸ­è¾“å‡ºå®½åº¦çš„ä¸€ç§æ ¼å¼è¾“å‡ºå•ã€åŒç²¾åº¦å®æ•° C è¾“å‡ºå•å­—ç¬¦ S è¾“å‡ºå­—ç¬¦ä¸² puts #include \u003cstdio.h\u003e int main(void) { char str[100] = \"www.dotcpp.com\"; printf(\"%s\\n\", str); puts(str); return 0; } ``` | #### æ¥æ”¶å•å­—ç¬¦è¾“å…¥ ```c char c;//å®šä¹‰ä¸ªå­—ç¬¦å˜é‡c c=getchar();//å°†è¯»å–åˆ°çš„å­—ç¬¦èµ‹å€¼ç»™å­—ç¬¦å˜é‡c scanf scanf(\"æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²\",è¾“å…¥é¡¹åœ°å€åˆ—è¡¨); æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²çš„ä½œç”¨äºprintfå‡½æ•°ç›¸åŒï¼Œä½†ä¸èƒ½æ˜¾ç¤ºéæ ¼å¼å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½æ˜¾ç¤ºæç¤ºå­—ç¬¦ä¸²ï¼›åœ°å€è¡¨é¡¹ä¸­çš„åœ°å€è¦ç»™å‡ºå˜é‡çš„åœ°å€ï¼Œç”±\u0026åè·Ÿå˜é‡åç»„æˆã€‚ get # include \u003cstdio.h\u003e int main(void) { char str[100] = \"\\0\"; printf(\"è¯·è¾“å…¥å­—ç¬¦ä¸²ï¼š\\n\"); gets(str); printf(\"åˆšæ‰è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯ï¼š\\n\"); printf(\"%s\\n\", str); return 0; } getæ–¹å¼ä¸ä¼šå¯¹è¾“å…¥è¿›è¡Œæ£€æŸ¥å’ŒéªŒè¯ï¼Œæ‰€ä»¥è¾“å…¥å†…å®¹è¿‡é•¿å¯èƒ½ä¼šé€ æˆOOMï¼Œæ‰€ä»¥å¹¶ä¸å®‰å…¨ã€‚ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:4","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"sizeofè¿ç®—ç¬¦ è¿™ç©æ„ä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯cè¯­è¨€è‡ªå¸¦çš„32ä¸ªå…³é”®å­—ä¹‹ä¸€ï¼Œå«åšé•¿åº¦ï¼ˆæ±‚å­—èŠ‚ï¼‰è¿ç®—ç¬¦ï¼Œç”¨æ¥è®¡ç®—ç±»å‹æˆ–è€…å˜é‡å ç”¨å†…å­˜çš„å­—èŠ‚æ•°ã€‚ ç”±äºä¸æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥()å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚åé¢è·Ÿçš„æ˜¯å˜é‡å°±å¯ä»¥çœç•¥()ï¼Œè€Œå¦‚æœè·Ÿçš„æ˜¯ç±»å‹ï¼Œåˆ™å¿…é¡»()ã€‚ #include\u003cstdio.h\u003e int main() { int n=0; int intsize = sizeof(int); printf(\"int sizeof is %d bytes\\n\",intsize); return 0; } ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:5","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"ä¸‰ç›®è¿ç®—ç¬¦ 2\u003e1?10:20 ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:6","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"é€»è¾‘è¯­å¥ ifè¯­å¥ if(è¡¨è¾¾å¼) /*å¦‚æœè¡¨è¾¾å¼æˆç«‹ï¼Œæ‰§è¡Œè¯­å¥1å¦åˆ™ç»§ç»­åˆ¤æ–­è¡¨è¾¾å¼2*/ { //è¯­å¥1 } else if(è¡¨è¾¾å¼2) /*å¦‚æœè¡¨è¾¾å¼æˆç«‹ï¼Œæ‰§è¡Œè¯­å¥2å¦åˆ™ç»§ç»­åˆ¤æ–­è¡¨è¾¾å¼3*/ { //è¯­å¥2 } else /*å¦‚æœä»¥ä¸Šè¡¨è¾¾å¼éƒ½ä¸æˆç«‹ åˆ™æ‰§è¡Œè¯­å¥4*/ { //è¯­å¥4 } switchè¯­å¥ switch(è¡¨è¾¾å¼) /*é¦–å…ˆè®¡ç®—è¡¨è¾¾å¼çš„å€¼*/ { case å¸¸é‡è¡¨è¾¾å¼1:è¯­å¥1; break; case å¸¸é‡è¡¨è¾¾å¼2:è¯­å¥2; break; case å¸¸é‡è¡¨è¾¾å¼3:è¯­å¥3; break; // â€¦â€¦ case å¸¸é‡è¡¨è¾¾å¼n:è¯­å¥n; default:è¯­å¥n+1; } whileå¾ªç¯ while(è¡¨è¾¾å¼) { å¾ªç¯ä½“è¯­å¥ } dowhileå¾ªç¯ do { å¾ªç¯ä½“è¯­å¥ }while(è¡¨è¾¾å¼); forå¾ªç¯ for(åˆå§‹åŒ–è¡¨è¾¾å¼;åˆ¤æ–­è¡¨è¾¾å¼;æ›´æ–°è¡¨è¾¾å¼) { å¾ªç¯ä½“è¯­å¥ continue; } ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:7","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"å‡½æ•° è¿”å›å€¼ç±»å‹ å‡½æ•°å(å½¢å‚è¡¨è¯´æ˜) /*å‡½æ•°é¦–éƒ¨*/ { è¯´æ˜è¯­å¥ /*å‡½æ•°ä½“*/ æ‰§è¡Œè¯­å¥ } æ³¨æ„ï¼šå¯ä»¥ä¸æŒ‡æ˜è¿”å›å€¼ç±»å‹ï¼Œè¿™æ ·ç³»ç»Ÿé»˜è®¤è¿”å›æ•´å‹ã€‚ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:8","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"å˜é‡å‚¨å­˜ ä»æ—¶é—´è§’åº¦åˆ†ä¸ºé™æ€å‚¨å­˜å’ŒåŠ¨æ€å‚¨å­˜ä¸¤ç§ï¼š é™æ€å‚¨å­˜ï¼Œå˜é‡å‚¨å­˜åœ¨å†…å­˜çš„é™æ€å‚¨å­˜åŒºï¼Œåœ¨ç¼–è¯‘æ—¶å°±åˆ†é…äº†å‚¨å­˜ç©ºé—´ï¼Œåœ¨æ•´ä¸ªç¨‹åºçš„è¿è¡ŒæœŸé—´ï¼Œè¯¥å˜é‡å æœ‰å›ºå®šçš„å‚¨å­˜å•å…ƒï¼Œåœ¨ç¨‹åºç»“æŸåï¼Œè¿™éƒ¨åˆ†ç©ºé—´æ‰ä¼šé‡Šæ”¾ï¼Œå˜é‡çš„å€¼åœ¨æ•´ä¸ªç¨‹åºä¸­å§‹ç»ˆå­˜åœ¨ã€‚ åŠ¨æ€å‚¨å­˜ï¼Œå˜é‡åœ¨å‚¨å­˜åœ¨å†…å­˜çš„åŠ¨æ€å‚¨å­˜åŒºï¼Œåœ¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåªæœ‰å½“å˜é‡æ‰€ä»¥åœ¨çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘ç³»ç»Ÿæ‰ä¸´æ—¶ä¸ºè¯¥å˜é‡åˆ†é…ä¸€æ®µå†…å­˜å•å…ƒï¼Œå‡½æ•°è°ƒç”¨ç»“æŸï¼Œè¯¥å˜é‡ç©ºé—´é‡Šæ”¾ï¼Œå˜é‡çš„å€¼æ—¨åœ¨å‡½æ•°è°ƒç”¨æœŸå†…å­˜åœ¨ã€‚ å˜é‡çš„ä½œç”¨èŒƒå›´åˆåˆ†ä¸ºå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ï¼š å…¨å±€å˜é‡ å¤–éƒ¨å˜é‡å°±æ˜¯å…¨å±€å˜é‡ï¼Œæ˜¯åœ¨å‡½æ•°å¤–éƒ¨å®šä¹‰çš„ã€‚ä»–çš„ä½œç”¨äºä»å˜é‡å®šä¹‰å¤„å¼€å§‹ï¼Œåˆ°ç¨‹åºæ–‡ä»¶çš„æœ«å°¾ã€‚å¦‚æœåœ¨å®šä¹‰ç‚¹ä¹‹å‰çš„å‡½æ•°æƒ³é¥®ç”¨è¯¥å¤–éƒ¨å˜é‡ï¼Œåˆ™åº”è¯¥åœ¨å¼•ç”¨å¤„ç”¨å…³é”®å­—externå¯¹è¯¥å˜é‡è¿›è¡Œå£°æ˜ï¼Œå°±å¯ä»¥åˆæ³•çš„ä½¿ç”¨è¯¥å˜é‡äº†ã€‚ è‡ªåŠ¨å˜é‡ å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ã€å‡½æ•°ä¸­çš„å½¢å‚ï¼Œåœ¨è°ƒç”¨æ—¶å‡½æ•°æ—¶ç³»ç»Ÿä¼šç»™ä»–ä»¬åˆ†é…å‚¨å­˜ç©ºé—´ï¼Œåœ¨å‡½æ•°è°ƒç”¨åä¼šè‡ªåŠ¨é‡Šæ”¾è¿™äº›ç©ºé—´ï¼Œè¿™ç±»å˜é‡ç§°ä¸ºè‡ªåŠ¨å˜é‡ã€‚ int fun(int a) { auto int b,c=3;/*å®šä¹‰b,cä¸ºè‡ªåŠ¨å˜é‡*/ } é™æ€å˜é‡ #include\u003cstdio.h\u003e static a=5; int fun() { a=a*2; printf(\"a=%d\\n\",a); return 0; } int main() { int i=0; for(i=0;i\u003c10;i++) { fun(); } return 0; } å¯„å­˜å™¨å˜é‡ ä¸ºæé«˜æ•ˆç‡ï¼Œcè¯­è¨€å…è®¸å°†å±€éƒ¨å˜é‡çš„å€¼å­˜æ”¾åˆ°cpuçš„å¯„å­˜å™¨ä¸­ï¼Œå«åšå¯„å­˜å™¨å˜é‡ï¼Œç”¨å…³é”®å­—registerå£°æ˜ã€‚ æ³¨æ„ï¼š åªæœ‰å±€éƒ¨è‡ªåŠ¨å˜é‡å’Œå½¢å‚å¯ä»¥ä½œä¸ºå¯„å­˜å™¨å˜é‡ã€‚ ä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿä¸­çš„å¯„å­˜å™¨æ•°é‡æœ‰é™ï¼Œä¸èƒ½å®šä¹‰ä»»æ„å¤šä¸ªå¯„å­˜å™¨å˜é‡ã€‚ ä¸èƒ½ä½¿ç”¨åœ°å€è¿ç®—ç¬¦\u0026æ±‚å¯„å­˜å™¨å˜é‡çš„åœ°å€ã€‚ register int a=0;//å°†å˜é‡aå­˜å‚¨åœ¨å¯„å­˜å™¨ä¸Š ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:9","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"æŒ‡é’ˆ ç”¨\u0026ç¬¦å·è¡¨ç¤ºæŒ‡é’ˆæˆ–å¼•ç”¨åœ°å€ï¼Œç”¨*ç¬¦å·è·å–æŒ‡é’ˆå¯¹åº”çš„å€¼ã€‚ #include\u003cstdio.h\u003e int main() { int num=2014; int *p=\u0026num; printf(\"num Address = 0x%x,num=%d\\n\",\u0026num,num); printf(\"p = 0x%x,*p=%d\\n\",p,*p); printf(\"%d\\n\",*\u0026num); return 0; } ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:10","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"å­—ç¬¦ä¸²å¤„ç† å­—ç¬¦ä¸²åˆå§‹åŒ–ï¼š char *str = \"www.dotcpp.com\" ; å¯ä»¥ç”¨å­—ç¬¦ä¸²å¸¸é‡å¯¹æŒ‡é’ˆè¿›è¡Œåˆå§‹åŒ–ã€‚ å‡½æ•° ç”¨é€” strcpy å®ç°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‹·è´ strcat å®ç°ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‹¼æ¥ strcmp å¯¹æ¯”ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ strlen è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:11","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"ç»“æ„ä½“ å£°æ˜ï¼š struct ç»“æ„ç±»å‹å { æ•°æ®ç±»å‹ æˆå‘˜å 1; æ•°æ®ç±»å‹ æˆå‘˜å 2; ...... æ•°æ®ç±»å‹ æˆå‘˜å n; }; åˆå§‹åŒ–ï¼š struct ç»“æ„ç±»å‹å ç»“æ„å˜é‡ = { åˆå§‹åŒ–æ•°æ® 1, ...... åˆå§‹åŒ–æ•°æ® n }; ç¤ºä¾‹ï¼š #include\u003cstdio.h\u003e #include\u003cstring.h\u003e struct _INFO { int num; char str[256]; }; int main() { struct _INFO A; A.num = 2014; strcpy(A.str,\"Welcome to dotcpp.com\"); printf(\"This year is %d %s\\n\",A.num,A.str); return 0; } ç»“æ„ä½“æŒ‡é’ˆ ç»“æ„ä½“å˜é‡ç”¨.æ¥è®¿é—®æˆå‘˜ï¼Œè€Œç»“æ„ä½“æŒ‡é’ˆç”¨-\u003eæ¥è®¿é—®ã€‚ ç¤ºä¾‹ï¼š #include\u003cstdio.h\u003e struct address { char name[30]; /*å§“åï¼Œå­—ç¬¦æ•°ç»„ä½œä¸ºç»“æ„ä½“ä¸­çš„æˆå‘˜*/ char street[40]; /*è¡—é“*/ unsigned long tel; /*ç”µè¯ï¼Œæ— ç¬¦å·é•¿æ•´å‹ä½œä¸ºç»“æ„ä½“ä¸­çš„æˆå‘˜*/ unsigned long zip; /*é‚®æ”¿ç¼–ç */ }; int main() { struct address A[3]={\"Zhang\",\"Road NO.1\",111111,4444}, {\"Wang\",\" Road NO.2\",222222,5555}, {\"Li\",\" Road NO.3\",333333,6666}}; struct address *p; p=\u0026A[0]; printf(\"%s %s %u %u\\n\",p-\u003ename,p-\u003estreet,p-\u003etel,p-\u003ezip); return 0; } ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:12","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"å…±ç”¨ä½“ åœ¨Cè¯­è¨€ä¸­ï¼Œå…è®¸å‡ ç§ä¸åŒç±»å‹çš„å˜é‡å­˜æ”¾åˆ°åŒä¸€æ®µå†…å­˜å•å…ƒä¸­ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨è¦†ç›–æŠ€æœ¯ï¼Œå‡ ä¸ªå˜é‡äº’ç›¸è¦†ç›–ã€‚è¿™ç§å‡ ä¸ªä¸åŒçš„å˜é‡å…±åŒå ç”¨ä¸€æ®µå†…å­˜çš„ç»“æ„ï¼Œè¢«ç§°ä¸ºå…±ç”¨ä½“ç±»å‹ç»“æ„ï¼Œç®€ç§°å…±ç”¨ä½“ã€‚ä¸€èˆ¬å®šä¹‰å½¢å¼ä¸ºï¼š union å…±ç”¨ä½“å { æ•°æ®ç±»å‹ æˆå‘˜å 1; æ•°æ®ç±»å‹ æˆå‘˜å 2; ...... æ•°æ®ç±»å‹ æˆå‘˜å n; }å˜é‡åè¡¨åˆ—; []æš‚æ—¶ä¸çŸ¥é“æœ‰å•¥ç”¨ï¼Œå¾…å­¦å§ï½ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:13","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"typedef å¯ä»¥ç”¨æ¥å®šä¹‰æ–°çš„ç±»å‹,æˆ–è€…è¯´ç»™ç±»å‹èµ·ä¸ªåˆ«åï¼š typedef å·²å®šä¹‰çš„ç±»å‹ æ–°çš„ç±»å‹; ä¾‹å¦‚ï¼š typedef int INTEGER; /*æŒ‡å®šç”¨ INTEGER ä»£è¡¨ int ç±»å‹*/ typedef float REAL; /*æŒ‡å®šç”¨ REAL ä»£è¡¨ float ç±»å‹*/ ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:14","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"æšä¸¾ enumã€€æšä¸¾åã€€{æšä¸¾å…ƒç´ 1,æšä¸¾å…ƒç´ 2,â€¦â€¦}; å¦‚ï¼š #include\u003cstdio.h\u003e int main() { enum Week{MON, TUE, WED, THU, FRI, SAT, SUN};//å®šä¹‰ä¸€ä¸ªenum weekç±»å‹ï¼Œä¸ƒä¸ªå€¼ï¼ˆ0.1.2...6ï¼‰ enum Week A=WED; //ç¬¬ä¸‰ä¸ªå€¼èµ‹ç»™A printf(\"%d\\n\",A); return 0; } æšä¸¾ç±»å‹çš„ç‰¹ç‚¹é»˜è®¤æ˜¯ä»0å¼€å§‹é€’å¢ï¼Œè‹¥æƒ³æ›´æ”¹ï¼Œå¯ä»¥å°†å…¶ä¸­æŸä¸ªç±»å‹èµ‹å€¼ï¼Œåé¢çš„å€¼å°†åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šé€’å¢ï¼Œå¦‚ä»£ç ï¼š #include\u003cstdio.h\u003e int main() { enum Week{MON, TUE=5, WED, THU, FRI, SAT, SUN}; enum Week A=WED; printf(\"%d\\n\",A); return 0; } ","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:15","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":[],"content":"é¢„å¤„ç† å® åˆ†ä¸ºæœ‰å‚å®å’Œæ— å‚å®ï¼Œ define defineå…³é”®å­—ç”¨æ¥è‡ªå®šä¹‰å®ï¼š æ— å‚å®ï¼š #define æ ‡è¯†ç¬¦ å­—ç¬¦ä¸²orè¡¨è¾¾å¼; æœ‰å‚å®ï¼š #define å®å(å½¢å‚è¡¨) å­—ç¬¦ä¸²orè¡¨è¾¾å¼; å¦‚ï¼š #define M (y*y+3*y); è¿™ä¸ªå®å®šä¹‰çš„æ„æ€æ˜¯ï¼šä½¿ç”¨Mæ›¿ä»£åé¢çš„è¡¨è¾¾å¼ã€‚ ç¤ºä¾‹ï¼š #include \u003cstdio.h\u003e #define MAX(a,b) (a\u003eb)?a:b /*å¸¦å‚æ•°çš„å®å®šä¹‰*/ main() { int x,y,max; printf(\"input two numbers: \"); scanf(\"%d %d\",\u0026x,\u0026y); max=MAX(x,y); printf(\"max=%d\\n\",max); /*å®è°ƒç”¨*/ }\u003c/stdio.h\u003e include ç”¨æ¥æŠŠæŒ‡å®šçš„æ–‡ä»¶ä¸å½“å‰çš„æºç¨‹åºæ–‡ä»¶è¿æˆä¸€ä¸ªæºæ–‡ä»¶ã€‚ #include \"stdio.h\" #include \u003cstdio.h\u003e å°–æ‹¬å·è¡¨ç¤ºåœ¨åŒ…å«æ–‡ä»¶ç›®å½•ä¸­å»æŸ¥æ‰¾ã€‚ åŒå¼•å·è¡¨ç¤ºåœ¨å½“å‰çš„æºæ–‡ä»¶ç›®å½•ä¸­æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°åˆ™å»åŒ…å«æ–‡ä»¶ç›®å½•ä¸­å»æ‰¾ã€‚ æ¡ä»¶ç¼–è¯‘ #ifdef æ ‡è¯†ç¬¦ ç¨‹åºæ®µ 1 #else ç¨‹åºæ®µ 2 #endif å¦‚æœæ ‡è¯†ç¬¦å·²è¢«#difineå‘½ä»¤å®šä¹‰è¿‡ï¼Œåˆ™å¯¹ç¨‹åºæ®µ1è¿›è¡Œç¼–è¯‘ï¼›å¦åˆ™å¯¹ç¨‹åºæ®µ2è¿›è¡Œç¼–è¯‘ã€‚ #ifndef æ ‡è¯†ç¬¦ ç¨‹åºæ®µ 1 #else ç¨‹åºæ®µ 2 #endif å¦‚æœæ ‡è¯†ç¬¦æœªè¢«#defineå‘½ä»¤å®šä¹‰è¿‡åˆ™å¯¹ç¨‹åºæ®µ1è¿›è¡Œç¼–è¯‘ï¼Œåä¹‹ç¼–è¯‘ç¨‹åºæ®µ2. #if å¸¸é‡è¡¨è¾¾å¼ ç¨‹åºæ®µ 1 #else ç¨‹åºæ®µ 2 #endif å¦‚æœå¸¸é‡è¡¨è¾¾å¼çš„å€¼ä¸ºtrueï¼Œåˆ™å¯¹ç¨‹åºæ®µ1ç¼–è¯‘ï¼Œåä¹‹åˆ™ç¼–è¯‘ç¨‹åºæ®µ2ã€‚ error å¼ºåˆ¶åœæ­¢ç¼–è¯‘ï¼Œç”¨äºç¼–è¯‘æ—¶è°ƒè¯•ã€‚ line pragma","date":"2022-10-17","objectID":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/:0:16","series":[],"tags":[],"title":"Cè¯­è¨€ç®€æ˜æ•™ç¨‹","uri":"/c%E8%AF%AD%E8%A8%80%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"},{"categories":null,"content":"ä»Šå¤©é‡æ–°å®‰è£…äº†ubuntu20.04LTSï¼Œå®‰è£…äº†IDEAåå‘ç°ä¸èƒ½ç”¨adbè¿æ¥è½¦æœºï¼ŒæŠ¥é”™ï¼š no permissions (missing udev rules? user is in the plugdev group) åœ¨è¿™é‡Œæ‰¾åˆ°äº†è§£å†³åŠæ³•ï¼Œæ„Ÿè°¢åŸä½œè€…ï¼ æ–¹æ³•å¦‚ä¸‹ï¼š ","date":"2022-10-10","objectID":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/:0:0","series":null,"tags":null,"title":"ubuntu22.04ä¸Šä¸èƒ½ä½¿ç”¨adb","uri":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/"},{"categories":null,"content":"æŸ¥çœ‹æ‰€æœ‰USBè®¾å¤‡ä¿¡æ¯ adb start-server lsusb ç»“æœï¼š // åŸä½œè€…çš„ï¼š $adb start-server $lsusb Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub Bus 001 Device 003: ID 17ef:6099 Lenovo Bus 001 Device 002: ID 17ef:608d Lenovo Bus 001 Device 033: ID 18d1:4ee7 Google Inc. //android xxx Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub // æˆ‘çš„ï¼š Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub Bus 001 Device 003: ID 046d:c52b Logitech, Inc. Unifying Receiver Bus 001 Device 002: ID 25a7:2420 2.4G Wireless Device Bus 001 Device 008: ID 12d1:3a07 Huawei Technologies Co., Ltd. HUAWEI USB-C HEADSET Bus 001 Device 007: ID 05c6:901d Qualcomm, Inc. Bus 001 Device 004: ID 214b:7250 USB2.0 HUB Bus 001 Device 006: ID 12d1:107e Huawei Technologies Co., Ltd. EVR-AL00 Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub è¿™é‡Œå°±è¦æ ¹æ®å¦‚ä¸Šä¿¡æ¯æ‰¾åˆ°è‡ªå·±è®¾å¤‡çš„idï¼Œæ¯”å¦‚ä½œè€…çš„åº”è¯¥æ˜¯picxlæ‰‹æœºï¼Œæ‰€ä»¥æ˜¯ã€Google Incã€‘çš„é‚£ä¸€è¡Œï¼Œè€Œæˆ‘çš„æ˜¯è½¦æœºï¼Œåº”è¯¥æ˜¯é«˜é€šçš„é‚£ä¸€è¡Œã€Qualcomm, Incã€‘ã€‚ ","date":"2022-10-10","objectID":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/:0:1","series":null,"tags":null,"title":"ubuntu22.04ä¸Šä¸èƒ½ä½¿ç”¨adb","uri":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/"},{"categories":null,"content":"åˆ›å»ºé…ç½®æ–‡ä»¶ sudo vim /etc/udev/rules.d/90-android.rules è¿™ä¸ªæ–‡ä»¶åå¯ä»¥éšæ„å“ˆğŸ¦ å†…å®¹ï¼š ATTRS{idVendor}==\"è‡ªå·±è®¾å¤‡é‚£ä¸€è¡ŒIDçš„å·¦ä¾§æ•°å­— æˆ‘è¿™é‡Œæ˜¯18d1\" ATTRS{idProduct}==\"è‡ªå·±è®¾å¤‡é‚£ä¸€è¡ŒIDçš„å³ä¾§æ•°å­— æˆ‘è¿™é‡Œæ˜¯4ee7\" ","date":"2022-10-10","objectID":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/:0:2","series":null,"tags":null,"title":"ubuntu22.04ä¸Šä¸èƒ½ä½¿ç”¨adb","uri":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/"},{"categories":null,"content":"å¯ç”¨é…ç½®æ–‡ä»¶ sudo udevadm control --reload-rules sudo service udev restart sudo udevadm trigger adb kill-server adb devices ç„¶åå°±okäº†ï¼ ","date":"2022-10-10","objectID":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/:0:3","series":null,"tags":null,"title":"ubuntu22.04ä¸Šä¸èƒ½ä½¿ç”¨adb","uri":"/ubuntu22.04%E4%B8%8A%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8adb/"},{"categories":[],"content":"æœ€è¿‘å·¥ä½œè¦æ±‚ï¼Œæ¶‰åŠåˆ°äº†HALå±‚å¼€å‘ï¼Œè®©æˆ‘è¿™ä¸ªåˆšåˆšä»ä¸Šå±‚è½¬åº•å±‚çš„å°ç™½æ— æ‰€é€‚ä»ï¼Œæ ¹æœ¬ä¸çŸ¥é“æ€ä¹ˆå…¥æ‰‹ï¼Œä»ç½‘ä¸Šæœé›†äº†å¤§å †çš„æ–‡ç« ï¼Œç…§ç€åšæ²¡æœ‰ä¸€ä¸ªèƒ½æˆï¼Œå‰å‰ååä¸€ä¸ªæœˆäº†ï¼Œä»Šå¤©ç»ˆäºæˆåŠŸäº†ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°å…¶ä»–åƒæˆ‘ä¸€æ ·é«˜è½¬ä½çš„åŒè¡Œå§ã€‚ æœ¬æ–‡å¤§é‡å€Ÿé‰´è¿™ç¯‡æ–‡ç« ï¼Œéå¸¸æ„Ÿè°¢åŸä½œï¼ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:0:0","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç¯å¢ƒä»‹ç» aospç‰ˆæœ¬ï¼šandroid9 ç”µè„‘æ“ä½œç³»ç»Ÿï¼šubuntu20.04LTS æ‰‹æœºï¼šgoogle-pixcel-3xl-æ¬§ç‰ˆ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:1:0","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç¼–è¯‘è¿‡ç¨‹ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:0","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"å®šä¹‰è½¯ä»¶åŒ…æ–‡ä»¶ç»“æ„ æˆ‘ä»¬å®šä¹‰çš„ä¸€éƒ¨åˆ†ç›¸å…³åŠŸèƒ½çš„é›†åˆï¼Œå«åšè½¯ä»¶åŒ…ã€‚ è½¯ä»¶åŒ…åç§°å¯ä»¥å…·æœ‰å­é›†ï¼Œå¦‚package.subpackageï¼Œå…¶æ ¹ç›®å½•ä¸ºhardware/interfacesæˆ–vendor/vendorNameã€‚è½¯ä»¶åŒ…åç§°ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å½¢æˆä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•ã€‚ AOSPä¸­çš„è½¯ä»¶åŒ…åˆ†å¸ƒå¦‚ä¸‹ï¼š å‰ç¼€ ä½ç½® ç±»å‹ android.hardware.* hardware/interfaces/* HAL android.frameworks.* frameworks/hardware/interfaces/* frameworks/ ç›¸å…³ android.system.* system/hardware/interfaces/* system/ ç›¸å…³ android.hidl.* system/libhidl/transport/* æ ¸å¿ƒ ä»ä¸Šè¡¨çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„HALåº”è¯¥ä½äºhardware/interfaces/*ä¸­ï¼Œä½†ç”±äºAOSPæŸäº›åˆ†æ”¯æ˜¯é”å®šçš„ï¼Œä¸å…è®¸ä¿®æ”¹VNDKåº“åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹hardware/interfaces/*ä¸­çš„æ–‡ä»¶ï¼Œä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹å¼å°±æ˜¯åœ¨æˆ‘ä»¬çš„å‚å•†ç›®å½•vendorä¸­å»ºç«‹åŒæ ·çš„hardware/interfaces/*ï¼Œç„¶åæ˜ å°„åˆ°AOSPæ ¹ç›®å½•ä¸‹çš„ç›¸åŒä½ç½®ã€‚è¿™ç§ç±»å‹çš„HALå«åšå‚å•†æ‰©å±•ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±å®šä¹‰ä¸€ä¸ªè½¯ä»¶åŒ…çš„ç›®å½•ç»“æ„ï¼š mkdir -p vendor/sample/hardware/interfaces/helloworld/1.0 æˆ‘ä»¬åœ¨vendorä¸­åˆ›å»ºhalæ¨¡å—ï¼Œä»”ç»†ç ”ç©¶ç›®å½•ç»“æ„ï¼š sampleæ˜¯æˆ‘ä»¬çš„ç»„ç»‡åç§°ï¼› hardware/interfacesæ˜ å°„ç€ç€æ ¹ç›®å½•é‡Œé¢çš„hardware/interfacesï¼› interfacesåé¢å°†ä½œä¸ºæˆ‘ä»¬çš„rootç›®å½•ï¼› helloworldæ˜¯æ¨¡å—åç§°ï¼› 1.0æ˜¯ä¸€ä¸ªç‰ˆæœ¬ç›®å½•ï¼Œä»¥åå¯èƒ½è¿˜æœ‰2.0,3.0ã€‚ ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹çš„hardware/interfaceä¸­æ“ä½œï¼Œæˆ‘è¯•äº†å¾ˆå¤šæ¬¡éƒ½ç¼–è¯‘å¤±è´¥äº†ï¼Œéƒ½æ˜¯å…³äºVNDKçš„æŠ¥é”™ï¼ŒVNDKæ˜¯å•¥æˆ‘éƒ½ä¸çŸ¥é“ï¼Œä¹Ÿæ²¡åŠæ³•è§£å†³ã€‚åæ¥æ‰çŸ¥é“ï¼Œä¸è¦ç›´æ¥åœ¨Androidæºç ç›®å½•hardware/interfacesä¸‹é¢æ·»åŠ å’Œä¿®æ”¹æ¥å£,åœ¨APIé”å®šåˆ†æ”¯ä¸­ä¸å…è®¸æ›´æ”¹VNDKåº“åˆ—è¡¨ã€‚ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:1","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"åˆ›å»ºHIDLæ–‡ä»¶ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨1.0ç›®å½•ä¸­åˆ›å»ºä¸‰ä¸ª.halæ–‡ä»¶ï¼š IHelloWorld.hal package sample.hardware.helloworld@1.0; import IHelloWorldCallback; interface IHelloWorld { initial(); getInt() generates (int32_t i); setInt(int32_t val) generates (Result error); oneway setCallback(IHelloWorldCallback callback); }; å†™æ³•éå¸¸ç±»ä¼¼AIDLï¼Œäº‹å®ä¸Šï¼Œä»Android11å¼€å§‹ï¼Œgoogleå·²ç»ç”¨AIDLå»æ›¿ä»£HIDL,æ‰€ä»¥å¯¹äºHIDLå¤§æ¦‚ç†è§£å°±è¡Œï¼Œæ²¡å¿…è¦ä¸‹åŠŸå¤«å»å­¦ã€‚ å†…å®¹ä¸å¤šï¼Œæˆ‘ä»¬åœ¨æ­¤å£°æ˜äº†å››ä¸ªè™šæ–¹æ³•ï¼Œåé¢ä¼šä¸€ä¸€å®ç°ã€‚ IHelloWorldCallback.hal package sample.hardware.helloworld@1.0; interface IHelloWorldCallback { oneway onEvent(Event event); }; types.hal types.halæ–‡ä»¶å¹¶æ²¡æœ‰å®šä¹‰æ¥å£ï¼Œè€Œæ˜¯ç”¨æ¥å®šä¹‰è½¯ä»¶åŒ…ä¸­æ¯ä¸ªæ¥å£å¯ä»¥è®¿é—®çš„æ•°æ®ç±»å‹ã€‚æ ¹æ®Googleçš„è§„èŒƒï¼Œè¿™ä¸ªæ–‡ä»¶çš„åç§°å¿…é¡»æ˜¯types.halã€‚ package sample.hardware.helloworld@1.0; enum Result : int32_t { OK, UNKNOWN, INVALID_ARGUMENTS, }; struct Event { uint32_t type; uint32_t code; uint32_t value; }; æœ€åæ³¨æ„ä¸€ä¸‹packageåŒ…å£°æ˜ï¼Œæ˜¯ä¸ç›®å½•æœ‰ä¸€å®šè”ç³»çš„ï¼ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:2","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"æŒ‡å®šinterfacesä¸ºè½¯ä»¶åŒ…æ ¹ç›®å½• åœ¨interfacesä¸­åˆ›å»ºAndroid.bpæ–‡ä»¶ï¼š hidl_package_root { name: \"sample.hardware\", path: \"vendor/sample/hardware/interfaces\", } æˆ‘ä»¬çŸ¥é“.bpæ–‡ä»¶æ˜¯ç”¨æ¥æè¿°è½¯ä»¶åŒ…çš„ï¼Œè¿™é‡Œå°±æ˜¯æŠŠinterfacesæŒ‡å®šä¸ºâ€œsample.hardwareâ€è½¯ä»¶åŒ…çš„æ ¹ç›®å½•ã€‚ å¦‚æœæ²¡æœ‰æŒ‡å®šç›®å½•ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼šCannot find package root specification ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:3","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç”¨hidl-genå·¥å…·ç”Ÿæˆç›¸å…³æ–‡ä»¶ hidl-genæ˜¯googleæä¾›çš„ï¼Œç”¨æ¥ç”Ÿæˆhidlç›¸å…³æ–‡ä»¶çš„å·¥å…·ï¼Œä½†ä»–æœ¬èº«æ˜¯ä»¥æºç çš„å½¢å¼ï¼Œæ”¾åœ¨aospä»£ç ä¸­æä¾›çš„ï¼Œæ‰€ä»¥ä½¿ç”¨å‰éœ€è¦å…ˆç¼–è¯‘è¿™ç©æ„ï¼š cdåˆ°android9çš„æ ¹ç›®å½• source build/envsetup.sh lunch 20 make hidl-gen -j4 ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰å‡ ä¸ªç¯å¢ƒå˜é‡ï¼Œä¸€ä¼šè¦é‡å¤ä½¿ç”¨ï¼š // åŒ…å PACKAGE=sample.hardware // è½¯ä»¶å NAME=$PACKAGE.helloworld@1.0 // è½¯ä»¶åŒ…æ ¹ç›®å½• ROOT=vendor/sample/hardware/interfaces // hidlå®ç°æ–‡ä»¶å­˜æ”¾çš„ä½ç½® LOC=$ROOT/helloworld/1.0/default ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:4","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç”Ÿæˆç‰ˆæœ¬æ§åˆ¶æ–‡ä»¶ ç‰ˆæœ¬æ§åˆ¶æ–‡ä»¶æ˜¯ä½äºè½¯ä»¶åŒ…æ ¹ç›®å½•ä¸‹çš„current.txt,ç”¨æ¥åšOTAå‡çº§æ—¶ï¼Œç¡®è®¤è½¯ä»¶åŒ…ç‰ˆæœ¬ä¿¡æ¯çš„ã€‚ hidl-gen -Lhash -r$PACKAGE:$ROOT -randroid.hidl:system/libhidl/transport $NAME\u003e $ROOT/current.txt åœ¨$ROOTä¸‹ä¼šå‡ºç°ä¸€ä¸ªcurrent.txtæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯æ‰€æœ‰hidlçš„å“ˆå¸Œï¼Œç”¨æ¥æ ‡è®°ç‰ˆæœ¬ã€‚ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:5","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç”ŸæˆHIDLçš„å®ç° hidl-gen -o $LOC -Lc++-impl -r$PACKAGE:$ROOT -randroid.hidl:system/libhidl/transport $NAME åœ¨$LOCä¸‹ä¼šç”ŸæˆHIDLçš„c++å®ç°æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆè‡ªå·±çš„å®ç°ã€‚ HelloWorld.h #ifndef SAMPLE_HARDWARE_HELLOWORLD_V1_0_HELLOWORLD_H #define SAMPLE_HARDWARE_HELLOWORLD_V1_0_HELLOWORLD_H #include \u003csample/hardware/helloworld/1.0/IHelloWorld.h\u003e #include \u003chidl/MQDescriptor.h\u003e #include \u003chidl/Status.h\u003e namespace sample { namespace hardware { namespace helloworld { namespace V1_0 { namespace implementation { using ::android::hardware::hidl_array; using ::android::hardware::hidl_memory; using ::android::hardware::hidl_string; using ::android::hardware::hidl_vec; using ::android::hardware::Return; using ::android::hardware::Void; using ::android::sp; struct HelloWorld : public IHelloWorld { Return\u003cvoid\u003e initial() override; Return\u003cint32_t\u003e getInt() override; Return\u003c::sample::hardware::helloworld::V1_0::Result\u003e setInt(int32_t val) override; Return\u003cvoid\u003e setCallback(const sp\u003c::sample::hardware::helloworld::V1_0::IHelloWorldCallback\u003e \u0026callback) override; static void *pollThreadWrapper(void *me); void pollThreadEntry(); private: pthread_mutex_t mLock = PTHREAD_MUTEX_INITIALIZER; pthread_t mPollThread; bool mRunning; std::vector\u003csp\u003cIHelloWorldCallback\u003e\u003e mCallbacks; }; } // namespace implementation } // namespace V1_0 } // namespace helloworld } // namespace hardware } // namespace sample #endif // SAMPLE_HARDWARE_HELLOWORLD_V1_0_HELLOWORLD_H HeloWorld.cpp: #define LOG_TAG \"sample.hardware.helloworld@1.0-service\" #include \u003candroid-base/logging.h\u003e #include \u003clog/log.h\u003e #include \"HelloWorld.h\" namespace sample { namespace hardware { namespace helloworld { namespace V1_0 { namespace implementation { Return\u003cvoid\u003e HelloWorld::initial() { ALOGD(\"%s\", __FUNCTION__); if (mRunning) return Void(); mRunning = true; pthread_attr_t attr; pthread_attr_init(\u0026attr); pthread_attr_setdetachstate(\u0026attr, PTHREAD_CREATE_JOINABLE); pthread_create(\u0026mPollThread, \u0026attr, pollThreadWrapper, this); pthread_attr_destroy(\u0026attr); return Void(); } Return\u003cint32_t\u003e HelloWorld::getInt() { ALOGD(\"%s\", __FUNCTION__); return int32_t{666}; } Return\u003c::sample::hardware::helloworld::V1_0::Result\u003e HelloWorld::setInt(int32_t val) { ALOGD(\"%s %d\", __FUNCTION__, val); return ::sample::hardware::helloworld::V1_0::Result{}; } void *HelloWorld::pollThreadWrapper(void *me) { static_cast\u003cHelloWorld *\u003e(me)-\u003epollThreadEntry(); return NULL; } void HelloWorld::pollThreadEntry() { mRunning = true; ALOGD(\"%s enter\", __FUNCTION__); Event event; event.type = 0; event.code = 0; event.value = 0; while (mRunning) { event.code++; event.type++; event.value++; sleep(1); ALOGD(\"%s event %04x %04x %04x\\n\", __FUNCTION__, event.type, event.code, event.value); pthread_mutex_lock(\u0026mLock); if (!mCallbacks.empty()) { std::vector\u003csp\u003cIHelloWorldCallback\u003e\u003e::iterator it; for (it = mCallbacks.begin(); it != mCallbacks.end();) { sp\u003cIHelloWorldCallback\u003e callback = *it; Return\u003cvoid\u003e ret = callback-\u003eonEvent(event); if (!ret.isOk()) { ALOGE(\"error %s\", ret.description().c_str()); it = mCallbacks.erase(it); } else { it++; } } } pthread_mutex_unlock(\u0026mLock); } ALOGD(\"%s exit\", __FUNCTION__); } Return\u003cvoid\u003e HelloWorld::setCallback(const sp\u003c::sample::hardware::helloworld::V1_0::IHelloWorldCallback\u003e \u0026callback) { ALOGD(\"%s\", __FUNCTION__); pthread_mutex_lock(\u0026mLock); if (callback != nullptr) { mCallbacks.push_back(callback); } pthread_mutex_unlock(\u0026mLock); return Void(); } } // namespace implementation } // namespace V1_0 } // namespace helloworld } // namespace hardware } // namespace sample service.cpp ä»¥ä¸Šå…¨éƒ½æ˜¯c++ä»£ç ï¼Œc++éœ€è¦ä¸€ä¸ªmainå…¥å£å‡½æ•°æ‰èƒ½å¯åŠ¨ï¼Œæ¥ä¸‹æ¥å°±è¦å®ç°ä¸€ä¸ªserviceä½œä¸ºå…¥å£ï¼Œåˆ›å»º$LOC/service.cpp: #define LOG_TAG \"sample.hardware.helloworld@1.0-service\" #include \u003candroid-base/logging.h\u003e #include \u003chidl/HidlTransportSupport.h\u003e #include \"HelloWorld.h\" using android::OK; using android::sp; using android::status_t; using android::hardware::configureRpcThreadpool; using android::hardware::joinRpcThreadpool; using sample::hardware::helloworld::V1_0::IHelloWorld; using sample::hardware::hello","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:6","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç”ŸæˆAndroid.bp ç”Ÿæˆ$LOCä¸‹çš„Android.bp: hidl-gen -o $LOC -Landroidbp-impl -r$PACKAGE:$ROOT -randroid.hidl:system/libhidl/transport $NAME ç”Ÿæˆ$ROOT/helloworld/1.0ä¸­çš„Android.bpï¼š $ source $ANDROID_BUILD_TOP/system/tools/hidl/update-makefiles-helper.sh $ do_makefiles_update $PACKAGE:ROOT android.hardware:hardware/interfaces android.hidl:system/libhidl/transport ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:7","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"åœ¨ç¼–è¯‘ç±»å‹ä¸­æ³¨å†ŒHALæœåŠ¡ åœ¨devicesä¸­çš„å¯¹åº”å‚å•†çš„å¯¹åº”ç¼–è¯‘ç±»å‹ï¼ˆlunchæŒ‡ä»¤çš„ç¼–è¯‘ç›®æ ‡ï¼‰ç›®å½•ä¸‹ä¿®æ”¹manifest.xmlæ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘çš„aosp,å¯¹åº”è°ƒè¯•æ‰‹æœºä¸ºgoogle-pixel-3xl,æˆ‘åœ¨lunchæ—¶çš„ç›®æ ‡ç±»å‹æ˜¯aosp-crosshatch-userdebugï¼Œé‚£ä¹ˆå°±åº”è¯¥å»ä¿®æ”¹device/google/crosshatch/manifest.xmlæ–‡ä»¶ã€‚åœ¨æ–‡ä»¶ä¸­åŠ å…¥ï¼š \u003chal format=\"hidl\"\u003e \u003cname\u003esample.hardware.helloworld\u003c/name\u003e \u003ctransport\u003ehwbinder\u003c/transport\u003e \u003cversion\u003e1.0\u003c/version\u003e \u003cinterface\u003e \u003cname\u003eIHelloWorld\u003c/name\u003e \u003cinstance\u003edefault\u003c/instance\u003e \u003c/interface\u003e \u003c/hal\u003e ç„¶åæ•´ç¼–ä¸€ä¸‹ï¼Œæ›´æ–°manifest.xmlã€‚ è¿™é‡Œä¸æ›´æ–°manifest.xml,å¯èƒ½ä¼šæŠ¥é”™ï¼šW hwservicemanager: getTransport: Cannot find entry sample.hardware.helloworld@1.0::IHelloWorld/default in either framework or device manifest. åœ¨è¿™é‡Œæˆ‘é‡åˆ°äº†æŠ¥é”™ï¼š [ 25% 4/16] build out/target/product/crosshatch/gen/ETC/framework_compatibility_matrix.xml_intermediates/compatibility_matrix.xml FAILED: out/target/product/crosshatch/gen/ETC/framework_compatibility_matrix.xml_intermediates/compatibility_matrix.xml /bin/bash -c \"PRODUCT_ENFORCE_VINTF_MANIFEST=\\\"true\\\" VINTF_ENFORCE_NO_UNUSED_HALS=true out/host/linux-x86/bin/assemble_vintf -i out/target/product/crosshatch/system/etc/vintf/compatibility_matrix.legacy.xml:out/target/product/crosshatch/system/etc/vintf/compatibility_matrix.1.xml:out/target/product/crosshatch/system/etc/vintf/compatibility_matrix.2.xml:out/target/product/crosshatch/system/etc/vintf/compatibility_matrix.3.xml:out/target/product/crosshatch/system/etc/vintf/compatibility_matrix.device.xml -o out/target/product/crosshatch/gen/ETC/framework_compatibility_matrix.xml_intermediates/compatibility_matrix.xml -c \\\"out/target/product/crosshatch/obj/ETC/device_manifest.xml_intermediates/manifest.xml\\\"\" Error: The following instances are in the device manifest but not specified in framework compatibility matrix: sample.hardware.helloworld@1.0::IHelloWorld/default Suggested fix: 1. Check for any typos in device manifest or framework compatibility matrices with FCM version \u003e= 3. 2. Add them to any framework compatibility matrix with FCM version \u003e= 3 where applicable. 3. Add them to DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE. ninja: build stopped: subcommand failed. 10:01:12 ninja failed with: exit status 1 #### failed to build some targets (7 seconds) #### çŒœæƒ³åŸå› ï¼Œæ˜¯å› ä¸ºç”±äºé”å®šåˆ†æ”¯çš„å…³ç³»ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥åœ¨hardware/interfaces/*ä¸­å»ºç«‹æˆ‘ä»¬çš„hal,è€Œæ˜¯åœ¨å‚å•†ç›®å½•vendorä¸­ç©çš„ã€‚ æ³¨æ„çœ‹é”™è¯¯ä¿¡æ¯ï¼šError: The following instances are in the device manifest but not specified in framework compatibility matrix: sample.hardware.helloworld@1.0::IHelloWorld/defaultã€‚æ„æ€æ˜¯è¯´ï¼Œæˆ‘ä»¬è™½ç„¶åœ¨deviceçš„manifestä¸­æ·»åŠ äº†ä¸€ä¸ªå®ä¾‹ï¼Œä½†æ˜¯æ²¡æœ‰åœ¨framework compatibility matrixä¸­æŒ‡å®šã€‚ ç„¶åä¸‹é¢ç»™å‡ºäº†3æ¡å»ºè®®ï¼š 1. Check for any typos in device manifest or framework compatibility matrices with FCM version \u003e= 3. 2. Add them to any framework compatibility matrix with FCM version \u003e= 3 where applicable. 3. Add them to DEVICE_FRAMEWORK_COMPATIBILITY_MATRIX_FILE. ç„¶åæ ¹æ®å»ºè®®ï¼Œåœ¨hardware/interfaces/compatibility_matrices/compatibility_matrix.3.xmlä¸­æ·»åŠ ç›¸åŒçš„å†…å®¹ï¼š \u003chal format=\"hidl\"\u003e \u003cname\u003esample.hardware.helloworld\u003c/name\u003e \u003ctransport\u003ehwbinder\u003c/transport\u003e \u003cversion\u003e1.0\u003c/version\u003e \u003cinterface\u003e \u003cname\u003eIHelloWorld\u003c/name\u003e \u003cinstance\u003edefault\u003c/instance\u003e \u003c/interface\u003e \u003c/hal\u003e å†æ¬¡æ•´ç¼–æˆåŠŸï¼ åé¢éœ€è¦è¯¦ç»†äº†è§£ä¸€ä¸‹å…¼å®¹æ€§çŸ©é˜µã€‚ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:8","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"æ·»åŠ æœ¬åœ°c++æµ‹è¯• // åŒ…å PACKAGE=sample.hardware // è½¯ä»¶å NAME=$PACKAGE.helloworld@1.0 // è½¯ä»¶åŒ…æ ¹ç›®å½• ROOT=vendor/sample/hardware/interfaces // hidlå®ç°æ–‡ä»¶å­˜æ”¾çš„ä½ç½® LOC=$ROOT/helloworld/1.0/default åˆ›å»º$ROOT/1.0/test/Android.cppï¼š cc_binary { name: \"sample.hardware.helloworld_hidl_hal_test\", vendor: true, srcs: [\"test.cpp\"], shared_libs: [ \"libhidlbase\", \"libhidltransport\", \"liblog\", \"libutils\", \"libhardware\", \"sample.hardware.helloworld@1.0\", ], } åˆ›å»º$ROOT/1.0/test/test.cpp: #define LOG_TAG \"sample.hardware.helloworld_hidl_hal_test\" #include \u003candroid-base/logging.h\u003e #include \u003chidl/HidlTransportSupport.h\u003e #include \u003clog/log.h\u003e #include \u003csample/hardware/helloworld/1.0/IHelloWorld.h\u003e #include \u003csample/hardware/helloworld/1.0/types.h\u003e using ::android::sp; using ::android::hardware::Return; using ::android::hardware::Void; using ::sample::hardware::helloworld::V1_0::Event; using ::sample::hardware::helloworld::V1_0::IHelloWorld; using ::sample::hardware::helloworld::V1_0::IHelloWorldCallback; using ::sample::hardware::helloworld::V1_0::Result; class HelloWorldCallback : public IHelloWorldCallback { public: HelloWorldCallback() { printf(\"%s\\n\", __FUNCTION__); } ~HelloWorldCallback() { printf(\"%s\\n\", __FUNCTION__); } Return\u003cvoid\u003e onEvent(const Event \u0026event) { printf(\"%s %04x %04x %04x\\n\", __FUNCTION__, event.type, event.code, event.value); return Void(); } }; int main(int /* argc */, char ** /* argv */) { sp\u003cIHelloWorld\u003e service = IHelloWorld::getService(); if (service == nullptr) { printf(\"Failed to get service\\n\"); return -1; } printf(\"initial\\n\"); service-\u003einitial(); int ret = service-\u003egetInt(); printf(\"getInt %d\\n\", ret); Result result = service-\u003esetInt(888); printf(\"setInt result=%d\\n\", result); sp\u003cIHelloWorldCallback\u003e callback = new HelloWorldCallback(); printf(\"setCallback\\n\"); service-\u003esetCallback(callback); while (1) { sleep(1); } return 0; } ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:9","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç¼–è¯‘å‡ºè¿è¡Œåº“ å› ä¸ºæˆ‘æ˜¯å°ç™½ï¼Œè¿˜ä¸èƒ½å……åˆ†ç†è§£ï¼Œä¸‹é¢å®Œå…¨æ‘˜æŠ„åŸä½œã€‚ mmm vendor/sample/hardware/interfaces/helloworld/1.0/ ç¼–è¯‘halæ–‡ä»¶ç”Ÿæˆçš„ä¸­é—´ä»£ç ä½äºout/soong/.intermediates/vendor/sample/hardware/interfaces/helloworld/1.0/: default sample.hardware.helloworld@1.0 sample.hardware.helloworld@1.0-adapter sample.hardware.helloworld@1.0-adapter_genc++ sample.hardware.helloworld@1.0-adapter-helper sample.hardware.helloworld@1.0-adapter-helper_genc++ sample.hardware.helloworld@1.0-adapter-helper_genc++_headers sample.hardware.helloworld@1.0_genc++ sample.hardware.helloworld@1.0_genc++_headers sample.hardware.helloworld-V1.0-java sample.hardware.helloworld-V1.0-java_gen_java test â€œsample.hardware.helloworld@1.0_genc++â€œç›®å½•é‡Œé¢å¯ä»¥å‘ç°halæ–‡ä»¶è½¬æ¢æˆäº†C++æºç  ,é‡Œé¢å°±åŒ…å«Binder Bnç«¯,Binder Bpç«¯çš„ä»£ç .ä¸ç”¨åƒéProject Trebleé¡¹ç›®é‚£æ ·éœ€è¦è‡ªå·±å†™Binder Bnç«¯,Binder Bpç«¯çš„ä»£ç .ä½“ä¼šåˆ°äº†è°·æ­Œçš„è‰¯è‹¦ç”¨å¿ƒã€‚ ç¼–è¯‘æœ€ç»ˆä¼šåœ¨out/target/product/$TARGET_PRODUCT/ç›®å½•ä¸‹é¢ç”Ÿæˆäº†ä»¥ä¸‹æ–‡ä»¶: out/target/product/$TARGET_PRODUCT/system/lib/sample.hardware.helloworld@1.0.so out/target/product/$TARGET_PRODUCT/system/lib/sample.hardware.helloworld@1.0-adapter-helper.so out/target/product/$TARGET_PRODUCT/system/lib64/sample.hardware.helloworld@1.0.so out/target/product/$TARGET_PRODUCT/system/lib64/sample.hardware.helloworld@1.0-adapter-helper.so out/target/product/$TARGET_PRODUCT/system/framework/sample.hardware.helloworld-V1.0-java.jar out/target/product/$TARGET_PRODUCT/system/framework/oat/arm/sample.hardware.helloworld-V1.0-java.odex out/target/product/$TARGET_PRODUCT/system/framework/oat/arm/sample.hardware.helloworld-V1.0-java.vdex out/target/product/$TARGET_PRODUCT/system/framework/oat/arm64/sample.hardware.helloworld-V1.0-java.odex out/target/product/$TARGET_PRODUCT/system/framework/oat/arm64/sample.hardware.helloworld-V1.0-java.vdex out/target/product/$TARGET_PRODUCT/vendor/lib/sample.hardware.helloworld@1.0-impl.so out/target/product/$TARGET_PRODUCT/vendor/lib/sample.hardware.helloworld@1.0.so out/target/product/$TARGET_PRODUCT/vendor/lib/sample.hardware.helloworld@1.0-adapter-helper.so out/target/product/$TARGET_PRODUCT/vendor/lib64/sample.hardware.helloworld@1.0-impl.so out/target/product/$TARGET_PRODUCT/vendor/lib64/sample.hardware.helloworld@1.0.so out/target/product/$TARGET_PRODUCT/vendor/lib64/sample.hardware.helloworld@1.0-adapter-helper.so out/target/product/$TARGET_PRODUCT/vendor/bin/hw/sample.hardware.helloworld@1.0-service out/target/product/$TARGET_PRODUCT/vendor/bin/sample.hardware.helloworld_hidl_hal_test out/target/product/$TARGET_PRODUCT/vendor/etc/init/sample.hardware.helloworld@1.0-service.rc ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:2:10","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"æµ‹è¯• ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:3:0","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"æ¨é€åŒ…åˆ°è®¾å¤‡ å°†ç¼–è¯‘å¥½çš„åº“å’Œbinæ–‡ä»¶å¤åˆ¶åˆ°è®¾å¤‡ä¸­: $ adb root $ adb remount $ adb push out/target/product/$TARGET_PRODUCT/vendor/lib64/sample.hardware.helloworld@1.0-impl.so /vendor/lib64/sample.hardware.helloworld@1.0-impl.so $ adb push out/target/product/$TARGET_PRODUCT/vendor/lib64/sample.hardware.helloworld@1.0.so /vendor/lib64/sample.hardware.helloworld@1.0.so $ adb push out/target/product/$TARGET_PRODUCT/vendor/bin/hw/sample.hardware.helloworld@1.0-service /vendor/bin/hw/sample.hardware.helloworld@1.0-service $ adb push out/target/product/$TARGET_PRODUCT/vendor/bin/sample.hardware.helloworld_hidl_hal_test /vendor/bin/sample.hardware.helloworld_hidl_hal_test æˆ‘å°è¯•ç›´æ¥æ•´ç¼–ï¼Œç„¶ååˆ·æœºï¼Œåç»­æ“ä½œç›´æ¥å¤±è´¥ï¼Œè¯´æ˜¯æ‰¾ä¸åˆ°æœåŠ¡ï¼Œç„¶åè¿›æ‰‹æœºå¯¹åº”çš„ç›®å½•ï¼Œç¡®å®æ²¡æœ‰å‘ç°å¯¹åº”çš„åº“ï¼Œæš‚æ—¶ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆã€‚æ‰€ä»¥è¿˜æ˜¯éœ€è¦è‡ªå·±pushåˆ°è®¾å¤‡ä¸Šã€‚ æ•´ç¼–åˆ·æœºçš„é—®é¢˜ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:3:1","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"å¯åŠ¨æœåŠ¡ åœ¨adbä¸­å¯åŠ¨æœåŠ¡ï¼š # ./vendor/bin/hw/sample.hardware.helloworld@1.0-service\u0026 æ³¨æ„ï¼š æŒ‡ä»¤æœ€åçš„ã€Œ\u0026ã€ç¬¦å·è¡¨ç¤ºåå°è¿è¡Œã€‚ ä¸åŠ ã€Œ\u0026ã€ç¬¦å·ï¼Œè¾“å…¥æŒ‡ä»¤åï¼Œshellä¼šå¡ä½ä¸åŠ¨ï¼Œæ˜¯æ­£å¸¸çš„ã€‚ è¾“å…¥æŒ‡ä»¤åï¼Œä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºï¼Œæ˜¯æ­£å¸¸çš„ï¼Œæƒ³çœ‹è¾“å‡ºï¼Œéœ€è¦ä»logcatä¸­æŸ¥çœ‹ã€‚ ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:3:2","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"å¯åŠ¨æµ‹è¯• # sample.hardware.helloworld_hidl_hal_test è¿™é‡Œæˆ‘åˆé‡åˆ°é—®é¢˜ï¼šCannot find entry in either framework or device manifest è§£å†³æ–¹å¼ï¼šåœ¨è®¾å¤‡çš„system/etc/vintf/manifest.xmlå’Œvendor/etc/vintf/manifest.xmlè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ï¼š \u003chal format=\"hidl\"\u003e \u003cname\u003esample.hardware.helloworld\u003c/name\u003e \u003ctransport\u003ehwbinder\u003c/transport\u003e \u003cversion\u003e1.0\u003c/version\u003e \u003cinterface\u003e \u003cname\u003eIHelloWorld\u003c/name\u003e \u003cinstance\u003edefault\u003c/instance\u003e \u003c/interface\u003e \u003c/hal\u003e å†æ¬¡å°è¯•è°ƒç”¨å®¢æˆ·ç«¯æˆåŠŸï¼è¾“å‡ºå¦‚ä¸‹ï¼š initial getInt 666 setInt result=0 HelloWorldCallback setCallback onEvent 0001 0001 0001 onEvent 0002 0002 0002 onEvent 0003 0003 0003 ... ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:3:3","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"Javaå±‚Appè°ƒè¯• æ–°å»ºä¸€ä¸ªAndroidåº”ç”¨é¡¹ç›®ï¼Œç„¶åå°†out/soong/.intermediates/vendor/sample/hardware/interfaces/helloworld/1.0/sample.hardware.helloworld-V1.0-java/android_common/combined/sample.hardware.helloworld-V1.0-java.jarå¤åˆ¶åˆ°appçš„libsç›®å½•ä¸‹ï¼Œå³é”®é€‰æ‹©add as libraryï¼Œä¹‹åappçš„gradle: implementation files('libs\\\\sample.hardware.helloworld-V1.0-java.jar') MainActivity.kt: package site.leasa.haltest import android.os.Bundle import android.os.RemoteException import android.util.Log import android.view.View import androidx.appcompat.app.AppCompatActivity import sample.hardware.helloworld.V1_0.Event import sample.hardware.helloworld.V1_0.IHelloWorld import sample.hardware.helloworld.V1_0.IHelloWorldCallback class MainActivity : AppCompatActivity() { private lateinit var service: IHelloWorld private val TAG = \"HAL_SERVICE_ACTIVITY\" override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_main) } open fun click(v: View) { try { this.service = IHelloWorld.getService() service.initial() val ret: Int = service.getInt() Log.d(TAG, \"getInt=$ret\") service.setInt(888) service.setCallback(HelloWorldCallback()) } catch (e: RemoteException) { Log.e(TAG, \"halæœåŠ¡åˆå§‹åŒ–å¤±è´¥: \", e) } } } class HelloWorldCallback : IHelloWorldCallback.Stub() { private val TAG = \"HAL_SERVICE_Callback\" override fun onEvent(event: Event) { Log.d(TAG, \"onEvent type=\" + event.type + \", code=\" + event.code + \", value=\" + event.value); } } ç„¶åæ§åˆ¶å°è¿›adb shell,å¯åŠ¨æœåŠ¡ï¼š # ./vendor/bin/hw/sample.hardware.helloworld@1.0-service\u0026 å¯åŠ¨App,ç‚¹ä¸€ä¸‹æŒ‰é’®å‡ºå‘clickæ–¹æ³•åï¼Œä¼šæŠ¥é”™ï¼šNoSuchElementï¼Œå°±æ˜¯æ‰¾ä¸åˆ°æˆ‘ä»¬çš„halæœåŠ¡ï¼Œä¹‹æ‰€ä»¥å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰é…ç½®selinuxçš„æ ‡ç­¾ï¼Œè¿™ç©æ„å¤ªéº»çƒ¦äº†ï¼Œæ”¾åé¢å­¦ä¹ ï¼Œç°åœ¨å…ˆå…³æ‰selinuxï¼š adb shell setenforce 0 ç„¶åé‡å¯å¯åŠ¨app,ç‚¹å‡»æŒ‰é’®ï¼Œlogcatæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š initial getInt 666 setInt result=0 HelloWorldCallback setCallback onEvent 0001 0001 0001 onEvent 0002 0002 0002 onEvent 0003 0003 0003 ... ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:3:4","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"åè®° å¯¹äºhal,æˆ‘ç›®å‰åªæ˜¯æœ€ç²—æµ…çš„èƒ½å¤Ÿç¼–è¯‘å¹¶è¿è½¬ï¼Œé‡Œé¢å¾ˆå¤šæœºåˆ¶è¿˜ä¸äº†è§£ï¼Œåç»­ä¼šæ…¢æ…¢æ¢³ç†å¥½ï¼Œè¡¥å……é“æœ¬æ–‡ï¼Œè¿™é‡Œè¿˜æ˜¯ç‰¹åˆ«æ„Ÿè°¢è¿™ç¯‡æ–‡ç« ï¼Œå¯¹æˆ‘çš„å­¦ä¹ äº§ç”Ÿè«å¤§å¸®åŠ©ï¼ å®‰å“ç³»ç»Ÿæ˜¯ä¸ªå¾ˆå¤æ‚çš„ä¸œè¥¿ï¼Œå½“ç„¶HALå±‚å¯åˆ°æ‰¿ä¸Šå¯ä¸‹çš„æ¡¥æ¢ä½œç”¨ï¼Œå¯¹äºæˆ‘è¿™ä¸ªæ–°æ‰‹æ¥è¯´ä¸Šæ‰‹éš¾åº¦è¾ƒå¤§ï¼Œæœ¬æ–‡çš„ä¸œè¥¿ä¹Ÿæ˜¯æ–­æ–­ç»­ç»­ç”¨äº†å¾ˆé•¿æ—¶é—´ï¼Œç£•ç£•ç»Šç»Šè§£å†³äº†å¾ˆå¤šé—®é¢˜æ‰äº§ç”Ÿçš„ç»“æœï¼Œå¯ä»¥è¯´ä¸å®¹æ˜“ï¼Œå¾ˆåº†å¹¸ï¼ŒåŒæ—¶ä¹Ÿè§è¯†åˆ°äº†æ“ä½œç³»ç»Ÿå±‚é¢çš„å¤æ‚ç²¾æ·±ï¼Œå¯¹çŸ¥è¯†å¹¿åº¦æœ‰å¾ˆé«˜çš„è¦æ±‚ã€‚æ”»å…‹ä¸‹æ¥ï¼Œä¸€é©¬å¹³å·ï¼è¿˜æ˜¯é‚£å¥è¯ï¼šIf i want, i can do it! ","date":"2022-08-03","objectID":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/:4:0","series":[],"tags":[],"title":"æ‰‹æŠŠæ‰‹æ•™ä½ è‡ªå®šä¹‰HALå±‚","uri":"/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89hal%E5%B1%82/"},{"categories":[],"content":"ç¼–è¯‘æŒ‡ä»¤ m -j32,mæŒ‡ä»¤ç”¨äºæ•´ç¼–ï¼Œå°±æ˜¯å®Œæ•´ç¼–è¯‘æ‰€æœ‰çš„æ¨¡å—ï¼Œã€Œ-j32ã€å°±æ˜¯å¯åŠ¨32ä¸ªçº¿ç¨‹ä¸€èµ·ç¼–è¯‘ï¼Œé€šå¸¸åœ¨AOSPçš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼› mmï¼ŒåŒmæŒ‡ä»¤ç”¨äºåœ¨å•ä¸€æ¨¡å—çš„ç›®å½•ä¸‹ç¼–è¯‘æ­¤å•ä¸ªæ¨¡å—; mmmï¼Œç”¨äºåœ¨æ ¹ç›®å½•å¯¹å•ä¸€æ¨¡å—è¿›è¡Œå•ç¼–ï¼Œæ‰€ä»¥åé¢è¦è·Ÿæ¨¡å—çš„ç›®å½•ã€‚ ","date":"2022-07-25","objectID":"/%E7%BC%96%E8%AF%91%E6%8A%80%E5%B7%A7/:1:0","series":[],"tags":[],"title":"ç¼–è¯‘æŠ€å·§","uri":"/%E7%BC%96%E8%AF%91%E6%8A%80%E5%B7%A7/"},{"categories":[],"content":"æ¸…é™¤æŒ‡ä»¤ make clean,æ¸…é™¤æœ¬æ¬¡è®¾ç½®æ‰€ç”Ÿæˆçš„æ‰€æœ‰çš„outputä¸ä¸­é—´æ–‡ä»¶ï¼Œout/target/product/[product_name]ï¼› make clobber ä¼šåˆ é™¤æ‰€æœ‰è®¾ç½®æ‰€ç”Ÿæˆçš„æ‰€æœ‰çš„outputä¸ä¸­é—´æ–‡ä»¶outã€‚ ","date":"2022-07-25","objectID":"/%E7%BC%96%E8%AF%91%E6%8A%80%E5%B7%A7/:2:0","series":[],"tags":[],"title":"ç¼–è¯‘æŠ€å·§","uri":"/%E7%BC%96%E8%AF%91%E6%8A%80%E5%B7%A7/"},{"categories":[],"content":"HALçš„ä½œç”¨ è¿é€šç¡¬ä»¶é©±åŠ¨ï¼Œæä¾›ä¸€ä¸ªæ ‡å‡†æ¥å£ï¼ˆç¡¬ä»¶ä¾›åº”å•†è‡ªå·±æä¾›å®ç°ï¼‰ï¼Œè®©Androidå¯ä»¥å¿½ç•¥åº•å±‚é©±åŠ¨ç¨‹åºçš„å®ç°ã€‚ ","date":"2022-07-18","objectID":"/%E7%90%86%E8%A7%A3hal/:1:0","series":[],"tags":[],"title":"ç†è§£HAL","uri":"/%E7%90%86%E8%A7%A3hal/"},{"categories":[],"content":"HALç±»å‹ ç»‘å®šå¼ï¼šä»¥HALæ¥å£å®šä¹‰è¯­è¨€æˆ–è€…AIDLè¡¨ç¤ºçš„HALã€‚FrameWorkä¸HALé€šè¿‡Binderè¿›è¡ŒIPCé€šä¿¡ï¼Œè‡ªAndroid8.0ä¹‹åçš„ç‰ˆæœ¬éƒ½å¿…é¡»æ”¯æŒç»‘å®šå¼ã€‚ ç›´é€šå¼ï¼šä»¥HIDLå°è£…çš„ä¼ ç»ŸHALæˆ–è€…æ—§ç‰ˆHALã€‚ ","date":"2022-07-18","objectID":"/%E7%90%86%E8%A7%A3hal/:2:0","series":[],"tags":[],"title":"ç†è§£HAL","uri":"/%E7%90%86%E8%A7%A3hal/"},{"categories":[],"content":"HALæ¥å£å®šä¹‰è¯­è¨€HIDL ç±»ä¼¼AIDL,å®‰å“æä¾›äº†ä¸€ç§ç”¨äºHALå’Œå…¶ç”¨æˆ·ä¹‹é—´çš„æ¥å£çš„è¡¨è¿°è¯­è¨€â€”â€”HIDLã€‚ å½“ç„¶éå¸¸googleçš„æ˜¯ï¼ŒHIDLåœ¨10.0åºŸå¼ƒäº†ï¼Œç›´æ¥ç”¨AIDLæ›¿æ¢äº†ä»–ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨ç©9.0è½¦æœºçš„è¿˜æ˜¯è¦å­¦è¿™ç©æ„ï¼Œç„¶åå¾ˆå¿«å°±ç™½å­¦äº†ã€‚ HIDLä¹Ÿæ˜¯ç”¨äºæè¿°IPCçš„ï¼Œåº•å±‚ä»ç„¶é‡‡ç”¨Binderã€‚ä»–è¢«è®¾è®¡å‡ºæ¥çš„ç›®çš„å°±æ˜¯å¯ä»¥åœ¨æ— éœ€é‡æ–°æ„å»ºHALçš„æƒ…å†µä¸‹æ›¿æ¢æ¡†æ¶ï¼ˆç®€è¨€ä¹‹å°±æ˜¯ä¸€ç§ç”¨äºåŠ¨æ€åŒ–å®ç°çš„æè¿°ï¼‰ã€‚ HIDLæ˜¯ç”±ä¾›åº”å•†ï¼ˆæ¯”å¦‚æˆ‘ä»¬é•¿åŸï¼‰æˆ–è€…SOCä¾›åº”å•†ï¼ˆé«˜é€šï¼‰æ„å»ºå‡ºæ¥ï¼Œæ”¾åœ¨/verdoråˆ†åŒºï¼ˆä¾›åº”å•†åˆ†åŒºï¼‰å†…ã€‚ ","date":"2022-07-18","objectID":"/%E7%90%86%E8%A7%A3hal/:3:0","series":[],"tags":[],"title":"ç†è§£HAL","uri":"/%E7%90%86%E8%A7%A3hal/"},{"categories":[],"content":"é¸£è°¢ æœ¬æ–‡æ˜¯è¾¹å­¦å®˜æ–‡å’Œåšå®¢é™é»˜å®‰è£…9339çš„æ–‡ç« è¾¹åšçš„æ•´ç†ï¼Œæ„Ÿè°¢åŸä½œï¼ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:1:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"ä½œç”¨ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:2:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"c/c+è¯­è¨€å¯¹ç¼–è¯‘å™¨çš„é€‰æ‹© language build-tool c gcc,clang c++ g++,clang++ è¿™é‡Œæ¨èé€‰æ‹©clangç³»åˆ—ï¼Œclangç³»åˆ—çš„æ•ˆç‡æ›´é«˜ï¼Œç¼–è¯‘äº§ç‰©ä¹Ÿæ›´å°ã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:3:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"makeçš„æ¼”å˜è¿‡ç¨‹ ä¸Šé¢è¿™äº›ç¼–è¯‘å™¨éƒ½åªèƒ½ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è·‘é¡¹ç›®ï¼Œæœ‰å¤šä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±éœ€è¦åšä¸ªæ‰¹å¤„ç†ã€‚ æœ€æ—©å‡ºç°äº†makeå·¥å…·ï¼Œé€šè¿‡ç¼–å†™makefileä½œä¸ºæ–‡ä»¶é…ç½®ï¼Œå®ç°äº†æ‰¹å¤„ç†ã€‚ ä½†é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œæ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œmakefileç¼–å†™ä¹Ÿä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œæ‰€ä»¥èªæ˜çš„è€å¤–åˆå¼„å‡ºä¸€ä¸ªcmakeå·¥å…·ï¼Œpregrammerä»¬å¯ä»¥ç”¨ç®€åŒ–åçš„cmakefileï¼Œé€šè¿‡è¿™ä¸ªå·¥å…·è½¬åŒ–ä¸ºmakefileï¼Œå¹¶ä¸”cmakefileä¸­å¯ä»¥åŠ å…¥ä¸€äº›åˆ¤æ–­å’Œå¾ªç¯ç­‰é€»è¾‘ï¼Œå¸®æˆ‘ä»¬çœäº†ä¸å°‘å·¥ä½œé‡ï¼Œæœ€åcmakeè¿˜æ˜¯è·¨å¹³å°çš„ã€‚ ç„¶ågoogleçš„å¤§ä½¬åœ¨ç¼–è¯‘è¶Šæ¥è¶Šåºå¤§çš„æºç æ—¶ï¼Œæ…¢åˆ°ä¸èƒ½å¿ï¼Œä»–å°±æ€ªåˆ°äº†cmakeçš„å¤´ä¸Šï¼Œæ‰€ä»¥åšå‡ºä¸€ä¸ªNinjaæ¥æ›¿æ¢cmakeï¼Œç”¨.ninjaæ–‡ä»¶æ›¿æ¢cmakefileã€‚æ‰€ä»¥Ninjaä¸cmakeæ˜¯å¹³çº§çš„ã€‚ æœ€åï¼ŒNinjaå’Œcmakeè¿˜æ˜¯åŸºäºç›®å½•å’Œæ–‡ä»¶çš„æ€ç»´æ¥ç»„ç»‡é¡¹ç›®ï¼ˆå¾ˆæœ‰cçš„ä¼ ç»Ÿï¼‰ï¼Œgoogleåˆå¼„å‡ºäº†ä¸ªSoongæ¥ä»¥ã€Œæ¨¡å—moduleã€æ€ç»´ç»„ç»‡é¡¹ç›®ï¼ŒåŒæ—¶å¸¦æ¥äº†Android.bpæ–‡ä»¶ï¼Œå…¶å†…å®¹æè¿°çš„æ˜¯æ¨¡å—ç»“æ„ï¼Œç„¶åç¼–è¯‘æˆ.ninjaæ–‡ä»¶ï¼Œæœ€åå†ç”±Ninjaæ¥å®é™…ç¼–è¯‘ã€‚ è¯´ç™½äº†å°±æ˜¯å±‚å±‚å°è£…ï¼Œç”±äºåˆ°Android10.0çš„æºç ä¸­è¿˜å­˜åœ¨Android.mk,æ‰€ä»¥å¸¦ç»™æˆ‘ä»¬çš„å°±æ˜¯éœ€è¦æŠŠmakeã€ninjaå’Œsoongéƒ½å­¦ä¼šæ‰èƒ½è§£å†³å¤æ‚é—®é¢˜ï¼Œç„¶åsoongè¿˜æ˜¯goè¯­è¨€å†™çš„ï¼Œæ‰€ä»¥æˆ‘è¿˜å¾—å­¦ä¸ªgoï¼ŒçœŸgoogleï¼ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:4:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"æ–‡ä»¶æ ¼å¼ æˆ‘ç°åœ¨çš„ç†è§£ï¼Œæ–‡ä»¶åå¿…é¡»æ˜¯Android.bpã€‚ cc_binary { name: \"gzip\", srcs: [\"src/test/minigzip.c\"], shared_libs: [\"libz\"], stl: \"none\", } å†…å®¹å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„æ¨¡å—ï¼Œä¹Ÿæ²¡å•¥æ–‡ä»¶å£°æ˜ã€ç‰ˆæœ¬å·ä»€ä¹ˆçš„ï¼Œè¿™ç‚¹ç»™å¥½è¯„ã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:5:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"è¯­æ³• moduleType { name:value, srcs:[ \"src/test/minigzip.c\", \"src/test/minigzip.c\" ] } æ¯ä¸ªæ¨¡å—ç”±æ¨¡å—ç±»å‹å’Œæ¨¡å—çš„å±æ€§ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå¤§æ‹¬å·é‡Œé¢çš„å°±æ˜¯å±æ€§ã€‚ moduleTypeæ˜¯å›ºå®šçš„é‚£å‡ ä¸ªï¼Œä¸èƒ½ä¹±å†™ï¼Œå¯åœ¨æºç ä¸­android/build/soong/androidmk/cmd/androidmk/android.goä¸­æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥å‚è€ƒgoogleæ…¢æˆå±çš„ç½‘ç«™ nameæ˜¯æ¯ä¸ªæ¨¡å—çš„å¿…å¡«é¡¹ï¼Œå¹¶ä¸”æ–‡ä»¶å†…å”¯ä¸€ã€‚ srcsç”¨äºæŒ‡å®šæ„å»ºæ¨¡å—çš„æºæ–‡ä»¶ã€‚[todo] æ¨¡å—å¼•ç”¨è¯­æ³• ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:5:1","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"é»˜è®¤æ¨¡å— cc_defaultsç±»å‹çš„æ¨¡å—å¯ç”¨äºåœ¨å¤šä¸ªæ¨¡å—ä¸­å¤ç”¨å±æ€§ï¼Œå¦‚ï¼š cc_defaults { name: \"gzip_defaults\", shared_libs: [\"libz\"], stl: \"none\", } cc_binary { name: \"gzip\", defaults: [\"gzip_defaults\"], srcs: [\"src/test/minigzip.c\"], } ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:5:2","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"é¢„æ„å»ºæ¨¡å— [] å¾…å®Œå–„ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:5:3","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"å‘½åç©ºé—´ [] å¾…å®Œå–„ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:5:4","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"é€»è¾‘ç¼–ç¨‹ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:0","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"ç±»å‹ è¿™é‡Œçš„å˜é‡å’Œå±æ€§æ˜¯å¼ºç±»å‹çš„ï¼Œä»¥åˆå§‹åŒ–èµ‹å€¼æ—¶çš„ç±»å‹æ¥ç¡®å®šã€‚ å¸ƒå°” æ•´å‹ å­—ç¬¦ä¸² å­—ç¬¦ä¸²æ•°ç»„ æ˜ å°„è¡¨ï¼ˆç±»ä¼¼HashMapï¼‰ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:1","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"é€šé…ç¬¦ æ¥å—æ–‡ä»¶åˆ—è¡¨çš„å±æ€§ï¼ˆå¦‚srcsï¼‰å¯ä»¥é‡‡ç”¨globå†™æ³•ã€‚ è¿™ç§å†™æ³•å¯ä»¥åŒ…å«é€šé…ç¬¦*ï¼Œå¦‚*.javaã€‚ *åŒ¹é…ä»»æ„æ–‡ä»¶åï¼Œå¦‚*.javaï¼› **åŒ¹é…0ï½nä¸ªè·¯å¾„ï¼Œå¦‚java/**/*.javaåŒæ—¶åŒ¹é… java/Main.java å’Œ java/com/android/Main.javaã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:2","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"å˜é‡ æ”¯æŒé¡¶çº§å˜é‡å½¢å¼ï¼š gzip_srcs = [\"src/test/minigzip.c\"], cc_binary { name: \"gzip\", srcs: gzip_srcs, shared_libs: [\"libz\"], stl: \"none\", } å˜é‡åªåœ¨æ–‡ä»¶å†…ç”Ÿæ•ˆï¼Œä¸”æ— æ³•æ”¹å˜ã€‚å¯ä»¥é€šè¿‡+=å˜é‡çš„å½¢å¼ä¸ºå…¶ä»–å˜é‡èµ‹å€¼ã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:3","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"æ³¨é‡Š å•è¡Œ// å¤šè¡Œ/* */ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:4","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"è¿ç®—ç¬¦ å¯ä»¥ä½¿ç”¨ + è¿ç®—ç¬¦é™„åŠ å­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²åˆ—è¡¨å’Œæ˜ å°„ã€‚å¯ä»¥ä½¿ç”¨ + è¿ç®—ç¬¦å¯¹æ•´æ•°æ±‚å’Œã€‚é™„åŠ æ˜ å°„ä¼šç”Ÿæˆä¸¤ä¸ªæ˜ å°„ä¸­é”®çš„å¹¶é›†ï¼Œå¹¶é™„åŠ åœ¨ä¸¤ä¸ªæ˜ å°„ä¸­éƒ½å­˜åœ¨çš„æ‰€æœ‰é”®çš„å€¼ã€‚ ç®€è¨€ä¹‹å°±æ˜¯åªæœ‰ä¸€ä¸ª+å·èƒ½ç”¨ã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:5","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"æ¡ä»¶ Soongä¸æ”¯æŒæ¡ä»¶åˆ¤æ–­ï¼Œéœ€è¦é¢å¤–å†™ä¸ªgoæ–‡ä»¶å®ç°ã€‚ç„¶åæ¡ä»¶è¯­å¥ä¼šè½¬æ¢ä¸ºæ˜ å°„å±æ€§ï¼Œå†æŠŠæ˜ å°„å±æ€§èµ‹å€¼ç»™æ¨¡å—çš„å±æ€§ã€‚ æ¯”å¦‚,è¦åŒºåˆ«ä¸åŒçš„cpuæ¶æ„ï¼š cc_library { ... srcs: [\"generic.cpp\"], arch: { arm: { srcs: [\"arm.cpp\"], }, x86: { srcs: [\"x86.cpp\"], }, }, } è¿˜ä¸ä¼šGo,å…ˆæ è¿‡ã€‚ã€‚ã€‚ [] å­¦ä¹ Go,å†å›æ¥è¡¥å……è¿™é‡Œã€‚ ","date":"2022-07-15","objectID":"/%E7%90%86%E8%A7%A3android.bp/:6:6","series":[],"tags":[],"title":"ç†è§£Android","uri":"/%E7%90%86%E8%A7%A3android.bp/"},{"categories":[],"content":"ä»Šå¤©åˆå¼„äº†ä¸€ä¸‹fcitx5,å¹¶ä¸”é…ç½®äº†goç¯å¢ƒå˜é‡ï¼Œç„¶åé‡å¯äº†ä¸€ä¸‹ç”µè„‘ï¼Œåˆ°äº†ç™»å½•é¡µé¢ï¼Œè¾“å…¥å¯†ç ï¼Œç«Ÿç„¶åˆé€€åˆ°ç™»å½•é¡µé¢ï¼Œæ— è®ºå¦‚ä½•ä¹Ÿè¿›ä¸å»æ¡Œé¢ã€‚ ","date":"2022-07-13","objectID":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/:0:0","series":[],"tags":[],"title":"Ubuntuæ— æ³•è¿›å…¥æ¡Œé¢","uri":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/"},{"categories":[],"content":"è§£å†³æ­¥éª¤ æ’å…¥ubuntuå¯åŠ¨ç›˜ï¼Œä»usbå¼•å¯¼ï¼Œè¿›å…¥ubuntuå®‰è£…é¡µé¢ï¼Œé€‰æ‹©try ubuntu. è¯•ç”¨æ–¹å¼ä¼šä»¥uç›˜ä¸ºæ ¹ç›®å½•ï¼Œè¿›å…¥åˆ°ç³»ç»Ÿï¼Œæ­¤æ—¶å°±èƒ½è¿›å…¥æ¡Œé¢äº†ã€‚ ä¸è¦æ€¥ï¼Œæƒ³æƒ³æœ€è¿‘å¹²äº†ä»€ä¹ˆäº‹æƒ…ï¼Œå“ªäº›ä¸æ“ä½œç³»ç»Ÿé…ç½®ç›¸å…³ï¼Œæ¯”å¦‚æˆ‘å°±å¹²äº†å¦‚ä¸‹å±é™©æ“ä½œï¼š ç³»ç»Ÿè¯­è¨€ä»è‹±æ–‡åˆ‡æ¢åˆ°äº†ä¸­æ–‡ï¼Œæ ¹ç›®å½•ä¿ç•™äº†è‹±æ–‡åç§°ã€‚ï¼ˆä¸‰å¤©æ²¡å‡ºäº‹ï¼Œå¯ä»¥æ’é™¤ï¼‰ï¼› å®‰è£…äº†Fcitx5è¾“å…¥æ³•ï¼Œä¸¤å¤©æ²¡äº‹ï¼Œä½†æ˜¯ä»Šå¤©åœ¨é’‰é’‰ä¸Šä¸èƒ½åˆ‡æ¢ä¸­æ–‡ï¼Œé’‰é’‰çš„æŠ€æœ¯å¸®æˆ‘å¼€äº†ã€Œé»˜è®¤æ¿€æ´»ã€é€‰é¡¹ï¼ˆä¸¥é‡æ€€ç–‘ï¼‰; åœ¨æ ¼å¼åŒ–æœºæ¢°ç¡¬ç›˜æ—¶å¼ºåˆ¶é‡å¯äº†ç³»ç»Ÿï¼ˆç³»ç»Ÿè£…åœ¨ssdä¸Šï¼Œåº”è¯¥ä¸ä¼šå—å½±å“ï¼‰ï¼ˆè½»åº¦æ€€ç–‘ï¼‰ï¼› å®‰è£…äº†goç¯å¢ƒï¼Œé…ç½®äº†ç¯å¢ƒå˜é‡ï¼ˆæ€€ç–‘ä¸ç³»ç»Ÿè‡ªå¸¦çš„goå†²çªï¼Ÿï¼‰ã€‚ ç„¶åé€‰æ‹©å…¶ä»–ä½ç½®ï¼Œæ‰¾åˆ°åŸæ¥ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼› å…ˆä»æœ€ç†Ÿæ‚‰çš„ç¯å¢ƒå˜é‡å¼€å§‹æ£€æŸ¥ï¼Œå‘ç°åœ¨fcitxçš„é…ç½®ä¸Šï¼Œå¤šäº†ä¸ªã€Œlsã€ï¼Œä½†æ˜¯è¿™é¡¶å¤šå¯¼è‡´ä¸€äº›æŠ¥é”™ï¼Œä¸ä¼šå½±å“åˆ°ç³»ç»Ÿï¼Œé¡ºæ‰‹æ”¹äº† ç»§ç»­å»çœ‹goçš„é…ç½®ï¼Œå‘ç°$PATH=$GO_HOME/bin,æ€»æ„Ÿè§‰å°‘äº†ä»€ä¹ˆï¼Œæˆ‘æ“¦ï¼Œæ­£å¸¸çš„PATHåº”è¯¥å„ç›®å½•æ‹¼æ¥æˆçš„ï¼Œæˆ‘è¿™æ ·å†™å°±æˆäº†èµ‹å€¼ï¼Œä¼šæ¸…ç©ºPATHå˜é‡ï¼ï¼ ä¿®æ”¹æˆ$PATH=$GO_HOME/bin:$PATHä¹‹åé‡å¯ï¼Œå¯ä»¥æ­£å¸¸è¿›æ¡Œé¢äº†ã€‚ ","date":"2022-07-13","objectID":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/:1:0","series":[],"tags":[],"title":"Ubuntuæ— æ³•è¿›å…¥æ¡Œé¢","uri":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/"},{"categories":[],"content":"æ€»ç»“ ç¯å¢ƒå˜é‡æ˜¯ä¸ªä¸¥è°¨çš„ç©æ„ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦æ…é‡å¯¹å¾…ï¼› æˆ‘å–œæ¬¢åœ¨vscodeé‡Œé¢ä¿®æ”¹.profile,ä½†æ˜¯æ¯æ¬¡æ‰“å¼€æ–‡ä»¶åå°±ä¸ç®¡äº†ï¼Œå¯¼è‡´.profileä¸€ç›´å¤„äºå¯ç¼–è¾‘çŠ¶æ€ï¼Œè¿™æ ·ååˆ†å±é™©ï¼Œä»¥åæ”¹å®Œå°±å…³é—­ï¼› æˆ‘å–œæ¬¢å°†ç¯å¢ƒå˜é‡å†™åœ¨~/.profileæ–‡ä»¶ä¸­ï¼Œè¿™æ ·ä¸€æ—¦å‡ºé”™å°±ä¼šå½±å“è‡ªå·±çš„ç”¨æˆ·ç³»ç»Ÿã€‚ä»¥ååº”è¯¥æŠŠç¯å¢ƒå˜é‡å†™åœ¨~/.bash_profileä¸­ï¼Œè¿™æ ·åªä¼šå½±å“ç»ˆç«¯ï¼Œä¸è‡³äºå‡ºç°è¿æ¡Œé¢éƒ½è¿›ä¸å»çš„å±€é¢ã€‚ ","date":"2022-07-13","objectID":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/:2:0","series":[],"tags":[],"title":"Ubuntuæ— æ³•è¿›å…¥æ¡Œé¢","uri":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/"},{"categories":[],"content":"æ›´æ–° è§£å†³æ¡Œé¢è¿›ä¸å»çš„é—®é¢˜ä¹‹åï¼Œå‘ç°é’‰é’‰åˆä¸èƒ½è¾“å…¥ä¸­æ–‡äº†ï¼Œé€šè¿‡æŠŠfcitx5çš„é…ç½®è¿˜åŸå›.profileï¼Œå¹¶ä¸”é‡å¯ç”Ÿæ•ˆåï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ çœ‹æ¥ä¸æ˜¯ä»€ä¹ˆç¯å¢ƒå˜é‡éƒ½èƒ½å†™åˆ°.bash_profileçš„ï¼Œæ¯”å¦‚fcitx5è¾“å…¥æ³•çš„é…ç½®ï¼Œå°±åº”è¯¥æ˜¯ç”¨æˆ·ç³»ç»Ÿå…¨å±€ç”Ÿæ•ˆçš„ï¼Œè€Œä¸æ˜¯åªåœ¨bashé‡Œé¢ç”Ÿæ•ˆã€‚ ","date":"2022-07-13","objectID":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/:3:0","series":[],"tags":[],"title":"Ubuntuæ— æ³•è¿›å…¥æ¡Œé¢","uri":"/ubuntu%E6%97%A0%E6%B3%95%E8%BF%9B%E5%85%A5%E6%A1%8C%E9%9D%A2/"},{"categories":[],"content":"ä¸»è¦å‚è€ƒäº†è¿™ç¯‡æ–‡ç« ,æ„Ÿè°¢åŸä½œï¼ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:0:0","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£… ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:0","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£…flatpak sudo add-apt-repository ppa:flatpak/stable sudo apt update sudo apt install flatpak sudo apt install gnome-software-plugin-flatpak flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo sudo reboot ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:1","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£…flatubä»“åº“ # æ·»åŠ  flatub ä»“åº“, fcitx5-unstable ä¹Ÿä¼šä¾èµ–ä¸€äº›è¿™ä¸ªä»“åº“ä¸­çš„è¿è¡Œæ—¶è½¯ä»¶åŒ…ã€‚ flatpak remote-add --user --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo # å¯é€‰éƒ¨åˆ†: å¦‚æœä½ æƒ³è¦ä½¿ç”¨ä¸ç¨³å®šç‰ˆæœ¬çš„fcitx5ï¼Œä¹Ÿå¯ä»¥æ·»åŠ  fcitx5 éç¨³å®šä»“åº“ã€‚ # flatpak remote-add --user --if-not-exists fcitx5-unstable https://flatpak.fcitx-im.org/unstable-repo/fcitx5-unstable.flatpakrepo è¿™ä¸ªå®‰è£…å®Œä¹‹åï¼Œæ¡Œé¢ä¼šå‡ºç°ä¸€ä¸ªå¦ä¸€ä¸ªåº”ç”¨å¸‚åœºã€‚ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:2","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£…fcitx5 # å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯æ—§ç‰ˆflatpakï¼Œåœ¨å®‰è£…çš„æ—¶å€™ä¼šéœ€è¦æ˜¾ç¤ºçš„æŒ‡å®šè½¯ä»¶ä»“åº“åå­—: flatpak install flathub org.fcitx.Fcitx5 flatpak install org.fcitx.Fcitx5 # ä¸­æ–‡è¾“å…¥æ³•å¼•æ“ flatpak install org.fcitx.Fcitx5.Addon.ChineseAddons # æ—¥æ–‡è¾“å…¥æ³•ï¼ˆä¸ç”¨è£…ï¼‰ # flatpak install org.fcitx.Fcitx5.Addon.Mozc # å®‰è£…fcitx5æœåŠ¡ï¼Œå¥½åƒæ˜¯è¿™ä¹ˆä¸ªæ„æ€ sudo apt install fcitx5-frontend-gtk2 fcitx5-frontend-gtk3 fcitx5-frontend-qt5 è¿™é‡Œæ—¥æ–‡è¾“å…¥ä¸ç”¨å®‰è£…ã€‚ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:3","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"é…ç½®ç¯å¢ƒå˜é‡ ç¼–è¾‘~/.profileï¼ŒåŠ å…¥ï¼š export XMODIFIERS=@im=fcitx export GTK_IM_MODULE=fcitx export QT_IM_MODULE=fcitx ç„¶åé‡å¯ã€‚ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:4","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"é…ç½®å¼€æœºè‡ªå¯ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:5","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£…ä¸»é¢˜ æˆ‘ä½¿ç”¨è¿™ä¸ªä¸»é¢˜ï¼Œè›®æ¼‚äº®çš„ï¼ŒREADMEé‡Œé¢æœ‰è¯¦ç»†çš„å®‰è£…æ–¹æ³•ã€‚ git clone https://github.com/hosxy/Fcitx5-Material-Color.git ~/.local/share/fcitx5/themes/Material-Color cd ~/.local/share/fcitx5/themes/Material-Color ln -sf ./theme-teal.conf theme.conf ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:6","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å®‰è£…è¯åº“ èŒå¨˜ç™¾ç§‘è¯åº“ ç»´åŸºç™¾ç§‘è¯åº“ ä¸‹è½½*.dictæ–‡ä»¶, æ”¾ç½®åˆ° ~/.local/share/fcitx5/pinyin/dictionaries ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:1:7","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"FAQ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:2:0","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"é’‰é’‰ä¸èƒ½è¾“å…¥ä¸­æ–‡ æ‰¾äº†é’‰é’‰çš„æŠ€æœ¯å®¢æœï¼Œæ•™äº†æˆ‘ä¸€æ‹›ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œå¯¹fcitx5çš„é…ç½®ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œè¿˜ä¸ä¸€æ ·ã€‚ ç¼–è¾‘/opt/apps/com.alibabainc.dingtalk/files/Elevator.shæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å£°æ˜#ï¼/bin/bin/shä¸‹é¢åŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š export GTK_IM_MODULE DEFAULT=fcitx export QT_IM_MODULE DEFAULT=fcitx export XMODIFIERS DEFAULT=@im=fcitx export INPUT_METHOD DEFAULT=fcitx export SDL_IM_MODULE DEFAULT=fcitx export QT_QPA_PLATFORM=xcb ç„¶åé‡å¯é’‰é’‰å³å¯ã€‚ ä¹‹åç”µè„‘é‡å¯ï¼Œè€æ¯›ç—…åˆçŠ¯äº†ï¼Œç„¶åæˆ‘åˆå»æ’©äº†é˜¿é‡Œçš„å¤§ä½¬ï¼Œå¾—åˆ°äº†è§£å†³åŠæ³•ï¼Œæ‰“å¼€fcitx5çš„é…ç½®-\u003eå…¨å±€é€‰é¡¹-\u003eè¡Œä¸º-\u003eå‹¾é€‰â€œé»˜è®¤çŠ¶æ€ä¸ºæ¿€æ´»â€-\u003eå…±äº«è¾“å…¥çŠ¶æ€é€‰â€œæ‰€æœ‰â€,ä¸€å¥—ä¸‹æ¥æå®šï¼ï¼ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:2:1","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"å–·è„‘æµ†IntelliJç³»åˆ—IDEè¾“å…¥é—®é¢˜ æ­¤é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ IDE é™„å¸¦çš„ JBR ä¸æ­£ç¡®ï¼Œè¦å¤„ç†æ­¤é—®é¢˜ï¼Œéœ€è¦ï¼š å‰å¾€ è¿™é‡Œ ä¸‹è½½ jbr å¹¶è§£å‹åˆ°ä»»æ„è·¯å¾„ æ›´æ”¹ IDE çš„ JBR,å¯åŠ¨IDEåå¿«æ·é”®ctrl+shift+A , è¾“å…¥ Choose Boot Java Runtime for the IDEï¼Œé€‰æ‹©Add Custom Runtime optionï¼Œé€‰æ‹©è§£å‹å‡ºçš„æ–‡ä»¶å¤¹ã€‚ ","date":"2022-07-12","objectID":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/:2:2","series":[],"tags":[],"title":"Ubuntu20.04å®‰è£…fcitx5","uri":"/ubuntu20.04%E5%AE%89%E8%A3%85fcitx5/"},{"categories":[],"content":"æœ€è¿‘äº‹å¤šï¼Œæ•´å¤©çå¿™ï¼Œéƒ½æ˜¯æ²Ÿé€šã€å¼€ä¼šã€å¡«è¡¨æ ¼å’Œå¡«å‘ï¼Œä»Šå¤©æƒ³ä¼‘æ¯ä¼‘æ¯ï¼Œæ‰“ç®—æœ‰ç©ºå†å†™å†™åç«¯æœåŠ¡ï¼ŒæŠŠè‡ªå·±çš„ç½‘ç›˜å’Œå›¾åºŠå…ˆå¼„å¥½ã€‚æ€æ¥æƒ³å»ï¼Œè‡ªå·±ä¸€ä¸ªäººçš„é¡¹ç›®ï¼Œæ—¶é—´å°‘ï¼Œæ‰€ä»¥å°½é‡è¿˜æ˜¯è¦æ–¹ä¾¿ç»´æŠ¤ï¼Œé‚£ä¹ˆå°±ä¸è¦ç”¨JAVAäº†ï¼Œç½—é‡Œå§å—¦çš„ï¼Œå¯æƒœDartè¿™è¾¹æ²¡ä»€ä¹ˆå¥½çš„æ¡†æ¶ï¼Œè¦ä¸ç„¶ä¸€ä¸ªè¯­è¨€å…¨ç«™äº†ï¼Œæœ€ç»ˆè¿˜æ˜¯é€‰æ‹©äº†kotlinï¼Œä½†æ˜¯åˆä¸æƒ³ç”¨ideaï¼Œäºæ˜¯æˆ‘ç„å‘äº†vscodeâ€¦ ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:0:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"IDEå’ŒæŠ€æœ¯é€‰å‹ ç”±äºideaå¤ªè´µäº†ï¼Œä»Šå¹´åˆæ¶¨ä»·äº†ï¼Œå¹¶ä¸”ç ´è§£ç»å¸¸å¤±æ•ˆï¼Œæ€»æ˜¯çªç„¶æŠŠæˆ‘æçš„ç„¦å¤´çƒ‚é¢çš„ï¼Œæ‰€ä»¥å¾ˆåæ„Ÿè¿™ç±»æ”¶è´¹çš„IDEã€‚ åæ¥è½¬å›eclipseï¼Œå‘ç°è¿™è´§æ…¢ã€ä¸‘ã€ç¬¨ï¼Œäºæ˜¯åˆå¼€å§‹å°è¯•å®‡å®™ç¬¬ä¸€IDEçš„å°è€å¼Ÿâ€”â€”vscodeã€‚ ä¸€å¼€å§‹ï¼Œå°è¯•ç”¨vscodeå†™äº†å‡ ä¸ªjavaå¾®æœåŠ¡ï¼ŒçœŸå«é¦™å•Šï¼Œä»¿ä½›å°±æ˜¯å¤©ç”Ÿä¸ºSpringCloudè€Œç”Ÿçš„ã€‚ä½†æ˜¯Springæœ¬èº«ç”Ÿæ€æ··ä¹±ï¼Œåºå¤§ï¼Œç¬¨æ‹™ï¼Œæ¯”å¦‚æ³¨å†Œä¸­å¿ƒæˆ‘é‡‡ç”¨é˜¿é‡Œçš„nacosï¼Œé‰´æƒä¸­å¿ƒé‡‡ç”¨keycloakï¼Œè¿™ä¿©è´§æœ¬èº«æ˜¯è„±ç¦»SpringCloudè€Œç‹¬ç«‹å­˜åœ¨çš„ï¼Œå†åŠ ä¸Šç†”æ–­ã€ç½‘å…³ç­‰ç­‰ï¼Œæˆ‘çš„é¡¹ç›®å°±æ˜¯å®¶é‡Œå‡ ä¸ªäººç”¨ï¼Œæˆ‘ä½•å¿…è¿™ä¹ˆå·è‡ªå·±å‘¢ï¼Ÿå†µä¸”æˆ‘çš„å°æ ‘è“æ´¾ä¹Ÿä¸ä¸€å®šåƒçš„æ¶ˆã€‚ åæ¥é™†ç»­åˆå°è¯•äº†Dartçš„ä¸¤ä¸ªåç«¯æ¡†æ¶ï¼Œå®˜æ–¹ç»´æŠ¤çš„è·Ÿç‹—å±ä¸€æ ·ï¼Œåˆå°è¯•äº†çº¢å¸½çš„Quarkusï¼Œä¹Ÿæ˜¯å¤ªåºå¤§å¤æ‚äº†ã€‚ æœ€ååˆçœ‹äº†ä¸€ä¸‹Kotlinè¿™è¾¹å€’æ˜¯å‡ºç°äº†ä¸€ä¸ªæ–°æ¡†æ¶å«ktorï¼Œè®¾è®¡çš„æŒºæ¸…å¥‡çš„ï¼Œç”¨èµ·æ¥ä¹Ÿè¿˜ä¸é”™ï¼Œç”Ÿæ€åŸºæœ¬ä¹Ÿç®—å¥å…¨ã€‚ é‚£ä¹ˆç°åœ¨å”¯ä¸€çš„é—®é¢˜å°±æ˜¯IDEçš„é€‰æ‹©äº†ã€‚åœ¨ç½‘ä¸Šæœvscodeå¼€å‘kotlinï¼ŒåŸºæœ¬éƒ½æ˜¯åŸºäºcodeRunnerï¼Œè¿™ä¸ªä¸œè¥¿å®åœ¨å¤ªå¹¼ç¨šäº†â€¦äºæ˜¯ä¹ï¼Œä¸€å¹´è¿‡å»äº†æˆ‘çš„é¡¹ç›®è¿˜æ²¡è½åœ°ï¼Œè‰¹ï¼ æ—¶é—´æ¥åˆ°æœ€è¿‘ï¼Œæˆ‘çœ‹äº†å‡ ç¯‡åœ¨vscodeä¸Šæ­å»ºc++ç¯å¢ƒçš„æ–‡ç« ï¼Œæ ¹æœ¬ä¸éœ€è¦ä»€ä¹ˆcodeRunnerï¼Œä»Šå¤©é—²ä¸‹æ¥çªç„¶çµæœºä¸€åŠ¨ï¼Œæˆ‘ç…§çŒ«ç”»è™ï¼Œç»ˆäºæå®šäº†ï¼âœŒğŸ» ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:1:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"æ’ä»¶é€‰æ‹© éœ€è¦è¿™ä¸ªå’Œè¿™ä¸ª ç›®å‰æœ€å¥½ç”¨çš„kotlin-languageServerï¼Œè¿˜å¸¦ä»£ç è¡¥å…¨ï¼ˆèŠèƒœäºæ— ï¼‰å’Œlintè¿˜æœ‰debugã€‚ å¦ä¸€ä¸ªæ˜¯å·¨ç¡¬å®˜æ–¹çš„gradleæ’ä»¶ï¼Œç¨³å®šæ€§å¯é ã€‚ ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:2:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"gradleç¯å¢ƒå˜é‡ åœ¨è¿™é‡Œä¸‹è½½gradleï¼Œå°½é‡é€‰æ‹©æ­£å¼çš„é«˜ç‰ˆæœ¬çš„ï¼Œè§£å‹ï¼Œç„¶åè®¾ç½®ç¯å¢ƒå˜é‡ï¼š export GRADLE_HOME=/Users/vee/Library/gradle-7.4.2 export PATH=$PATH:$GRADLE_HOME/bin windowsæ€ä¹ˆè®¾ç½®è‡ªå·±å»æŸ¥ï¼Œæˆ‘ä¸ä¼šç”¨windowsã€‚ ç„¶åç»ˆç«¯source .profile æœ€åç»ˆç«¯æ‰§è¡Œå‘½ä»¤gradleçœ‹çœ‹æˆåŠŸæ²¡ã€‚ ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:3:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"gradleåˆ›å»ºkotliné¡¹ç›® gradle init --type kotlin-application è·Ÿç€æç¤ºä¸€ç›´èµ°ã€‚ ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:4:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"vscodeé…ç½® cdåˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œç„¶åç›´æ¥code .ï¼Œå°±å¯ä»¥åœ¨vscodeä¸­æ‰“å¼€é¡¹ç›®äº†ã€‚ ç„¶åvscodeçš„èœå•æ -\u003eç»ˆç«¯-\u003eé…ç½®é»˜è®¤ç”Ÿæˆä»»åŠ¡-ã€‹gradle:app:buildï¼Œä¸€é¡¿æ“ä½œçŒ›å¦‚ç‹—ï¼Œå°±ä¼šå‘ç°é¡¹ç›®æ ¹ç›®å½•å¤šäº†ä¸€ä¸ª.vscode/tasks.json,å¦‚æœæ˜¯å¤šmoudleå·¥ç¨‹ï¼Œå¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶çš„tasksæ•°ç»„é‡Œé¢ç…§çŒ«ç”»è™å†æ·»åŠ ä¸ªtaskå°±è¡Œäº†ã€‚ { \"version\": \"2.0.0\", \"tasks\": [ { \"type\": \"gradle\", \"id\": \"/Users/vee/Downloads/testapp:buildapp\", \"script\": \"app:build\", \"description\": \"Assembles and tests this project.\", \"group\": { \"kind\": \"build\", \"isDefault\": true }, \"project\": \"app\", \"buildFile\": \"/Users/vee/Downloads/test/app/build.gradle.kts\", \"rootProject\": \"test\", \"projectFolder\": \"/Users/vee/Downloads/test\", \"workspaceFolder\": \"/Users/vee/Downloads/test\", \"args\": \"\", \"javaDebug\": false, \"problemMatcher\": [ \"$gradle\" ], \"label\": \"gradle: app:build\" } ] } æ¥ä¸‹æ¥åœ¨ç›¸åŒç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªlaunch.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š { // ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ // æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚ // æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387 \"version\": \"0.2.0\", \"configurations\": [ { \"type\": \"kotlin\", \"request\": \"launch\", \"name\": \"Kotlin Launch\", \"projectRoot\": \"${workspaceFolder}/app\", \"mainClass\": \"MyKotlinTest.AppKt\", \"preLaunchTask\": \"gradle: app:build\" } ] } é¦–å…ˆæ·»åŠ preLaunchTaskå­—æ®µï¼Œå€¼å°±æ˜¯åˆšæ‰taskçš„labelï¼Œè¦åŸå°ä¸åŠ¨çš„å¤åˆ¶è¿‡æ¥ã€‚ ç„¶åä¿®æ”¹projectRootå­—æ®µï¼Œä»–é»˜è®¤æ˜¯\"${workspaceFolder}\"ï¼Œè¿™æ˜¯vscodeä¸­çš„ç¯å¢ƒå˜é‡ï¼Œè¡¨ç¤ºé¡¹ç›®çš„æ ¹ç›®å½•ã€‚ä½†æ˜¯gradleçš„æ–‡ä»¶ç»“æ„æ˜¯å¤šäº†ä¸€å±‚appç›®å½•çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨åé¢æ·»åŠ appè·¯å¾„ã€‚ æœ€åä¿®æ”¹mainClasså­—æ®µï¼Œè¿™ä¸ªå­—æ®µè¡¨ç¤ºç¨‹åºå…¥å£ç±»ï¼Œå€¼æ˜¯å…¥å£ç±»çš„å…¨åç§°ï¼ˆåŒ…å+æ–‡ä»¶åï¼‰ã€‚ç”±äºæ˜¯kotlinç±»å‹çš„æ–‡ä»¶ï¼Œåç¼€åéƒ½æ˜¯.ktï¼Œæ‰€ä»¥ç±»åè¦åŠ ä¸ŠKtåç¼€ï¼Œè¿™æ˜¯kotlinæ’ä»¶è¦æ±‚çš„ï¼ŒçœŸtmæ€è·¯æ¸…å¥‡ã€‚ æœ€åæ”¾å¿ƒç›´æ¥æŒ‰F5ï¼Œå½“ç„¶æˆ‘çš„touch barä¸Šç›´æ¥æ˜¾ç¤ºäº†playæŒ‰é’®ï¼Œç‚¹ä»–ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ç¨‹åºè‡ªåŠ¨buildï¼Œå¹¶ä¸”è¿è¡Œäº†âœŒğŸ» ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:5:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"åè®° 9ç‚¹å›æ¥ï¼Œå¼„å¥½ç¯å¢ƒï¼Œå»æ´—äº†ä¸ªé¦™é¦™ï¼Œç„¶åæ´—è¢œå­ï¼Œæ´—å†…è£¤ï¼Œæ‹–åœ°ï¼Œå›æ¥å†™blogï¼Œä¸€çœ‹è¡¨åˆ12ç‚¹åŠäº†ï¼Œç¡å§ï¼Œæ˜å¤©ç»§ç»­å»ç¼–è¯‘ç³»ç»Ÿäº†ã€‚ ","date":"2022-07-07","objectID":"/vscode%E7%BC%96%E5%86%99kotlin/:6:0","series":[],"tags":[],"title":"vscode+gradle+kotlin","uri":"/vscode%E7%BC%96%E5%86%99kotlin/"},{"categories":[],"content":"adbå®¢æˆ·ç«¯ç¯å¢ƒå˜é‡ # ANDROID_HOME export ANDROID_HOME=$ENV_HOME/Android # android-sdk export ANDROID_SDK_ROOT=${ANDROID_HOME}/sdk export PATH=$PATH:$ANDROID_SDK_ROOT/platform-tools:$ANDROID_SDK_ROOT/tools æŠŠsdkä¸­çš„platform-toolså’ŒtoolsåŠ å…¥PATHå³å¯ã€‚ ","date":"2022-07-07","objectID":"/adb/:1:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"adbçš„ç»„æˆ å®¢æˆ·ç«¯ï¼šä½äºç”µè„‘ï¼Œç”¨äºå‘é€å‘½ä»¤ï¼› æœåŠ¡å™¨ï¼šä½äºç”µè„‘ï¼Œç”¨äºç®¡ç†å®¢æˆ·ç«¯ä¸å®ˆæŠ¤è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼› adbdï¼šä½äºè®¾å¤‡ï¼Œå®ˆæŠ¤è¿›ç¨‹ï¼Œç”¨äºåœ¨è®¾å¤‡ä¸Šè¿è¡Œå‘½ä»¤ã€‚ æ‰§è¡Œè¿‡ç¨‹ï¼š æˆ‘åœ¨ç»ˆç«¯ä¸­ï¼Œé€šè¿‡adbå‘½ä»¤å‘å®¢æˆ·ç«¯è¾“å…¥å‘½ä»¤ï¼› å®¢æˆ·ç«¯æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œï¼Œæ²¡æœ‰åˆ™å¯åŠ¨æœåŠ¡å™¨è¿›ç¨‹ï¼› æœåŠ¡å™¨è¿›ç¨‹ä¸æœ¬åœ°TCPç«¯å£5037ç»‘å®šï¼Œå¹¶ç›‘å¬å®¢æˆ·ç«¯å‘å‡ºçš„å‘½ä»¤ï¼ŒåŒæ–¹åŸºäº5037é€šä¿¡ï¼› æœåŠ¡å™¨é€šè¿‡æ‰«æè®¾å¤‡çš„5555ï½5585ä¹‹é—´çš„å¥‡æ•°å·ç«¯å£æŸ¥æ‰¾æ¨¡æ‹Ÿå™¨ï¼Œå‘ç°adbdåå»ºç«‹è¿æ¥ï¼› æ­¤æ—¶å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡adbå‘½ä»¤æ§åˆ¶è®¾å¤‡ã€‚ ","date":"2022-07-07","objectID":"/adb/:2:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"wifi-adb ","date":"2022-07-07","objectID":"/adb/:3:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"Android11åŠä»¥ä¸Š è®¾å¤‡ä¸Šï¼Œå¼€å‘è€…æ¨¡å¼ï¼Œå¯åŠ¨æ— çº¿è°ƒè¯•ï¼Œé€‰æ‹©Pair device with pairing codeï¼›è®°ä¸‹è®¾å¤‡çš„IPã€ç«¯å£å·å’Œé…å¯¹ç ï¼› è¿è¡Œadb pair ipaddr:portï¼Œå‡ºç°æç¤ºæ—¶è¾“å…¥é…å¯¹ç ã€‚ ","date":"2022-07-07","objectID":"/adb/:3:1","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"Android11ä»¥ä¸‹ usbçº¿è¿è®¾ï¼› æ‰§è¡Œadb tcpip 5555æ¥ç›‘å¬è®¾å¤‡çš„5555ï¼› æ‹”çº¿ æ‰§è¡Œadb connect device_ip_addresss:5555ï¼Œå…¶å®å¾ˆå¤šæƒ…å†µä¸‹æˆ‘éƒ½ä¸åŠ ç«¯å£ï¼Œé»˜è®¤å°±æ˜¯5555ï¼› æ‰§è¡Œadb devicesç¡®è®¤è¿æ¥æˆåŠŸã€‚ ","date":"2022-07-07","objectID":"/adb/:3:2","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"å¸¸ç”¨adbå‘½ä»¤ adb kill-server æ€æ‰adbæœåŠ¡å™¨ã€‚ adb start-server å¯åŠ¨adbæœåŠ¡å™¨ï¼Œä¸€èˆ¬ä¸éœ€è¦ç”¨ã€‚ adb devices -l æŸ¥è¯¢è®¾å¤‡,-lå‚æ•°å¯æ‰“å°å‡ºæ›´å¤šçš„ä¿¡æ¯ã€‚ adb -s \u003cdevice serial\u003e å¤šä¸ªè®¾å¤‡ä¸­æŒ‡å®šä¸€ä¸ªè®¾å¤‡ã€‚ adb -e å¤šä¸ªè®¾å¤‡ä¸­åªæœ‰ä¸€ä¸ªæ¨¡æ‹Ÿå™¨ï¼Œåˆ™æŒ‡å®šæ¨¡æ‹Ÿå™¨ã€‚ adb -d å¤šä¸ªè®¾å¤‡ä¸­åªæœ‰ä¸€ä¸ªç¡¬ä»¶ï¼Œåˆ™æŒ‡å®šç¡¬ä»¶ã€‚ adb connect \u003cip:port\u003e è¿æ¥ä¸€ä¸ªè®¾å¤‡ã€‚ adb disconnect æ–­è¿æ‰€æœ‰è®¾å¤‡ã€‚ adb install apk_file_path æŠŠapkå®‰è£…åˆ°ç”¨æˆ·åˆ†åŒºdata/dataã€‚ adb uninstall \u003cpackage name\u003e é€šè¿‡åŒ…åå¸è½½Appã€‚ adb forward tcp:6100 tcp:7100 ç«¯å£è½¬å‘ã€‚ adb pull remote local æ‹‰å–è®¾å¤‡æ–‡ä»¶ã€‚ adb push local remote æ¨é€æœ¬åœ°æ–‡ä»¶åˆ°è®¾å¤‡ï¼Œä¼šè¦†ç›–è®¾å¤‡åŒåæ–‡ä»¶ã€‚ adb --help è°ƒå–å¸®åŠ©ä¿¡æ¯ã€‚ adb [-d|-e|-s] shell è¿›å…¥è®¾å¤‡çš„shellã€‚ adb [-d|-e|-s] shell \u003ccommand\u003e å‘è®¾å¤‡å‘é€shellæŒ‡ä»¤ã€‚ exit æˆ–è€…å¿«æ·é”®control+Dé€€å‡ºshellã€‚ adb root åŒ adb shell su å¯åŠ¨ç®¡ç†å‘˜æƒé™ã€‚ adb unroot å–æ¶ˆç®¡ç†å‘˜æƒé™ã€‚ adb remount é‡æ–°æŒ‚åœ¨systemåˆ†åŒºï¼Œsystemåˆ†åŒºé»˜è®¤åªè¯»ï¼Œremountä¹‹åå˜ä¸ºè¯»å†™æƒé™ã€‚ adb disable-verity -R å…³é—­åˆ†åŒºæ£€æµ‹ï¼Œéœ€è¦rootæƒé™ï¼Œé‡å¯ç”Ÿæ•ˆï¼Œ-Rè¡¨ç¤ºè‡ªåŠ¨é‡å¯ã€‚ adb reboot [bootloader|recovery|sideload|sideload-auto-reboot] è®¾å¤‡é‡å¯ã€‚ adb logcat æŠ“å–logã€‚ ","date":"2022-07-07","objectID":"/adb/:4:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"adb shell ","date":"2022-07-07","objectID":"/adb/:5:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"ActivityManager(am) å¯åŠ¨Activity start [options] intent option description -D å¯ç”¨è°ƒè¯• -W ç­‰å¾…å¯åŠ¨å®Œæˆ â€“start-profile \u003cfilePath\u003e å¯åŠ¨æ€§èƒ½å‰–æå™¨å¹¶å°†ç»“æœå‘é€è‡³file -P \u003cfile\u003e åŒä¸Šï¼Œä½†å½“åº”ç”¨ç©ºé—²æ—¶åœæ­¢ -R \u003ccount\u003e å¯åŠ¨Activity countæ¬¡ -S å¯åŠ¨Activityå‰å¼ºè¡Œåœæ­¢ç›®æ ‡åº”ç”¨ â€“opengl-trace å¯ç”¨OpenGLæ±‰ä¹¦è¿½è¸ª â€“user \u003cuserID\u003e|currnet æŒ‡å®šä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œã€‚é»˜è®¤current å¯åŠ¨Service startservice [options] intent option description â€“user \u003cuserID\u003e|currnet æŒ‡å®šä½œä¸ºå“ªä¸ªç”¨æˆ·è¿è¡Œã€‚é»˜è®¤current ç»ˆæ­¢è¿›ç¨‹ force-stop [package] // å¼ºåˆ¶åœæ­¢åŒ…åç›¸å…³çš„æ‰€æœ‰è¿›ç¨‹ kill [--user userID|all|current] [package] //å®‰å…¨ç»ˆæ­¢åŒ…åç›¸å…³è¿›ç¨‹ï¼Œå¯æŒ‡å®šç”¨æˆ·ï¼Œé»˜è®¤all kill-all //ç»ˆæ­¢æ‰€æœ‰åå°è¿›ç¨‹ å‘é€å¹¿æ’­ broadcast [--user userID|all|current] intent æ€§èƒ½ç›‘æ§ profile start [process] [file]//å¯åŠ¨è¿›ç¨‹çš„æ€§èƒ½å‰–æå™¨ï¼Œç»“æœå†™å…¥æ–‡ä»¶ profile stop [process]//åœæ­¢æ€§èƒ½å‰–æ ç³»ç»Ÿç›‘è§† monitor [--gdb] //å¼€å§‹ç›‘æ§å´©æºƒæˆ–ANR,---gdbå‚æ•°å¯åœ¨ç»™å®šçš„ç«¯å£ä¸Šå¯åŠ¨gdbserv è°ƒæ•´æ˜¾ç¤º screen-compat {on | off} package //æ§åˆ¶ package çš„å±å¹•å…¼å®¹æ€§æ¨¡å¼ã€‚ display-size [reset | widthxheight] //æ›¿æ¢è®¾å¤‡æ˜¾ç¤ºå°ºå¯¸ display-density dpi //æ›¿æ¢è®¾å¤‡æ˜¾ç¤ºå¯†åº¦ ä¸»è¦ç”¨äºåœ¨å¤§å±ä¸Šè°ƒè¯•å°å±åº”ç”¨ï¼Œæˆ–è€…åè¿‡æ¥ã€‚ æŸ¥çœ‹intentè§„èŒƒ to-uri intent to-intent-uri intent ","date":"2022-07-07","objectID":"/adb/:5:1","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"PackageManager(pm) åˆ—å‡ºè½¯ä»¶åŒ… list packages [options] [filter] option description -f æŸ¥çœ‹å…³è”æ–‡ä»¶ -d åªæ˜¾ç¤ºå·²åœç”¨çš„åŒ… -e åªæ˜¾ç¤ºå·²å¯ç”¨çš„åŒ… -s åªæ˜¾ç¤ºç³»ç»Ÿåº”ç”¨ -3 åªæ˜¾ç¤ºç¬¬ä¸‰æ–¹è½¯ä»¶ -i æŸ¥çœ‹è½¯ä»¶åŒ…å®‰è£…ç¨‹åº -u åŒ…å«å·²å¸è½½çš„è½¯ä»¶ â€“user userID æŸ¥è¯¢æŒ‡å®šç”¨æˆ·ç©ºé—´ æŸ¥çœ‹æƒé™ç»„ list permission-groups list permissions [options] group option description -g æŒ‰ç»„æ•´ç† -f è¾“å‡ºæ‰€æœ‰ä¿¡æ¯ -s è¾“å‡ºæ‘˜è¦ -d åˆ—å‡ºå±é™©æƒé™ -u åˆ—å‡ºç”¨æˆ·èƒ½çœ‹åˆ°çš„æƒé™ æŸ¥æ‰¾åº”ç”¨å®‰è£…è·¯å¾„ path [package] å®‰è£…è½¯ä»¶ install [options] [path] option description -r é‡è£…åº”ç”¨ä¿ç•™æ•°æ® -t å…è®¸å®‰è£…debugåŒ… -d å…è®¸é™çº§å®‰è£… -g æˆäºˆåº”ç”¨æ¸…å•ä¸­çš„æ‰€æœ‰æƒé™ â€“fastdeploy åªæ›´æ–°å·®å¼‚ å¸è½½è½¯ä»¶ uninstall [-k] [package] //-kè¡¨ç¤ºä¿ç•™æ•°æ® clear [package] // åˆ é™¤æ•°æ® ","date":"2022-07-07","objectID":"/adb/:5:2","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"æˆªå±/å½•å± screencap \u003cfilepath\u003e // æˆªå±åˆ°æ–‡ä»¶ screenrecord [options] \u003cfilepath\u003e // å½•å± å¯ä»¥é€šè¿‡control+Cåœæ­¢ï¼Œæˆ–è€…é€šè¿‡--time-limitè®¾ç½®æ—¶é—´ï¼Œé»˜è®¤3åˆ†é’Ÿã€‚ ","date":"2022-07-07","objectID":"/adb/:5:3","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"é™„å½•ï¼šhelpä¿¡æ¯ Android Debug Bridge version 1.0.41 Version 33.0.2-8557947 Installed as /home/vee/.env/Android/sdk/platform-tools/adb global options: -a listen on all network interfaces, not just localhost -d use USB device (error if multiple devices connected) -e use TCP/IP device (error if multiple TCP/IP devices available) -s SERIAL use device with given serial (overrides $ANDROID_SERIAL) -t ID use device with given transport id -H name of adb server host [default=localhost] -P port of adb server [default=5037] -L SOCKET listen on given socket for adb server [default=tcp:localhost:5037] --one-device SERIAL|USB only allowed with 'start-server' or 'server nodaemon', server will only connect to one USB device, specified by a serial number or USB device address. --exit-on-write-error exit if stdout is closed general commands: devices [-l] list connected devices (-l for long output) help show this help message version show version num networking: connect HOST[:PORT] connect to a device via TCP/IP [default port=5555] disconnect [HOST[:PORT]] disconnect from given TCP/IP device [default port=5555], or all pair HOST[:PORT] [PAIRING CODE] pair with a device for secure TCP/IP communication forward --list list all forward socket connections forward [--no-rebind] LOCAL REMOTE forward socket connection using: tcp:\u003cport\u003e (\u003clocal\u003e may be \"tcp:0\" to pick any open port) localabstract:\u003cunix domain socket name\u003e localreserved:\u003cunix domain socket name\u003e localfilesystem:\u003cunix domain socket name\u003e jdwp:\u003cprocess pid\u003e (remote only) vsock:\u003cCID\u003e:\u003cport\u003e (remote only) acceptfd:\u003cfd\u003e (listen only) forward --remove LOCAL remove specific forward socket connection forward --remove-all remove all forward socket connections ppp TTY [PARAMETER...] run PPP over USB reverse --list list all reverse socket connections from device reverse [--no-rebind] REMOTE LOCAL reverse socket connection using: tcp:\u003cport\u003e (\u003cremote\u003e may be \"tcp:0\" to pick any open port) localabstract:\u003cunix domain socket name\u003e localreserved:\u003cunix domain socket name\u003e localfilesystem:\u003cunix domain socket name\u003e reverse --remove REMOTE remove specific reverse socket connection reverse --remove-all remove all reverse socket connections from device mdns check check if mdns discovery is available mdns services list all discovered services file transfer: push [--sync] [-z ALGORITHM] [-Z] LOCAL... REMOTE copy local files/directories to device --sync: only push files that are newer on the host than the device -n: dry run: push files to device without storing to the filesystem -z: enable compression with a specified algorithm (any/none/brotli/lz4/zstd) -Z: disable compression pull [-a] [-z ALGORITHM] [-Z] REMOTE... LOCAL copy files/dirs from device -a: preserve file timestamp and mode -z: enable compression with a specified algorithm (any/none/brotli/lz4/zstd) -Z: disable compression sync [-l] [-z ALGORITHM] [-Z] [all|data|odm|oem|product|system|system_ext|vendor] sync a local build from $ANDROID_PRODUCT_OUT to the device (default all) -n: dry run: push files to device without storing to the filesystem -l: list files that would be copied, but don't copy them -z: enable compression with a specified algorithm (any/none/brotli/lz4/zstd) -Z: disable compression shell: shell [-e ESCAPE] [-n] [-Tt] [-x] [COMMAND...] run remote shell command (interactive shell if no command given) -e: choose escape character, or \"none\"; default '~' -n: don't read from stdin -T: disable pty allocation -t: allocate a pty if on a tty (-tt: force pty allocation) -x: disable remote exit codes and stdout/stderr separation emu COMMAND run emulator console command app installation (see also `adb shell cmd package help`): install [-lrtsdg] [--instant] PACKAGE push a single package to the device and install it install-multiple [-lrtsdpg] [--instant] PACKAGE... push multiple APKs to the device for a single package and install them install-multi-package [-lrtsdpg] [--instant] PACKAGE... push one or more packages to the device and install them atomicall","date":"2022-07-07","objectID":"/adb/:6:0","series":[],"tags":[],"title":"adb","uri":"/adb/"},{"categories":[],"content":"ä»Šå¤©æ˜¯æˆ‘è¿‡å¾—éå¸¸ä¸çˆ½çš„ä¸€å¤©ï¼Œå› ä¸ºä»Šå¤©è¯´äº†ã€æˆ‘ä¸ä¼šã€ã€æˆ‘ä¸æ‡‚ã€ã€æˆ‘çœ‹ä¸æ˜ç™½ã€ï¼Œä»å“¥2017å¹´è‡ªå­¦å®‰å“åˆ°ç°åœ¨ï¼Œä»ä¸€ç‚¹ä¸ä¼šåˆ°åŸºæœ¬ä¸ç™¾åº¦ï¼Œæˆ‘è¿˜æ²¡è¯´è¿‡è¿™äº›è¯ã€‚ä»Šå¤©çœŸæ˜¯å¤ªåˆºæ¿€äº†ï¼Œä»ä¸Šå±‚è½¬åº•å±‚çœŸçš„è¿™ä¹ˆè´¹åŠ²å—ï¼Œè¿˜æ˜¯è¯´å¹´çºªå¤§äº†å­¦ä¸åŠ¨äº†ï¼Ÿéƒ½ä¸æ˜¯ï¼Œæ˜¯æˆ‘ä¸€å¼€å§‹å­¦ç³»ç»Ÿåº•å±‚è¿˜æ²¡æ‰¾åˆ°è¦é¢†ï¼ŒåŒæ—¶åˆäº‹ç‰©ç¼ èº«ï¼Œåˆ†èº«æ— æœ¯ã€‚ä»”ç»†æƒ³æƒ³è¿˜æ˜¯å…ˆä»å¸¸ç”¨å·¥å…·å…¥æ‰‹ï¼Œåˆ«ä»–å¦ˆè®©æˆ‘æŠ“ä¸ªlogéƒ½è¿™ä¹ˆè´¹åŠ²ã€‚ ","date":"2022-07-06","objectID":"/logcat/:0:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"logcatæ˜¯ä»€ä¹ˆ å°±æ˜¯Android-sdkæä¾›çš„æŠ“å–logçš„å·¥å…·ï¼Œä½äºAndroid/sdk/platform-tools/adb. ","date":"2022-07-06","objectID":"/logcat/:1:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"logcatå¯åŠ¨æ–¹å¼ ","date":"2022-07-06","objectID":"/logcat/:2:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"adbæ–¹å¼ adb logcat ","date":"2022-07-06","objectID":"/logcat/:2:1","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"shellæ–¹å¼ adb shell logcat ","date":"2022-07-06","objectID":"/logcat/:2:2","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"logcatå¸®åŠ© adb logcat --help ","date":"2022-07-06","objectID":"/logcat/:3:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"ç¼“å†²åŒº buffer description radio æ— çº¿è£…ç½®/ç”µè¯çŸ­ä¿¡ events äºŒè¿›åˆ¶ç³»ç»Ÿäº‹ä»¶ main ä¸»æ—¥å¿—ç¼“å†²åŒºï¼Œä¸åŒ…å«ç³»ç»Ÿå’Œå´©æºƒ system ç³»ç»Ÿ crash å´©æºƒ all æ‰€æœ‰ default é»˜è®¤ï¼ŒåŒ…å«mainã€systemã€crash ","date":"2022-07-06","objectID":"/logcat/:4:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"å‘½ä»¤æ ¼å¼ logcat [options] [filterspecs] æ³¨æ„ï¼Œè¿™é‡Œçš„optionså¯ä»¥æœ‰å¤šä¸ªã€‚ ","date":"2022-07-06","objectID":"/logcat/:5:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"é€‰é¡¹ option description -b åŠ è½½å¯ä¾›æŸ¥çœ‹çš„æ—¥å¿—ç¼“å†²åŒº -g è¾“å‡ºæ—¥å¿—ç¼“å†²åŒºä¿¡æ¯ -c æ¸…æ¥šæ‰€é€‰çš„ç¼“å†²åŒºå¹¶é€€å‡ºï¼Œé»˜è®¤ç¼“å†²åŒºé›†åˆä¸ºmainã€systemã€crash,æ¸…æ¥šæ‰€æœ‰ç¼“å†²åŒºåˆ™ä½¿ç”¨-b all -c -e \u003cexpr\u003e æŠ“å–æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„è¡Œ -m \u003ccount\u003e è¾“å‡º\u003ccount\u003eè¡Œåé€€å‡ºï¼Œå¯ä¸-eé…åˆä½¿ç”¨ -d å°†ç¼“å†²åŒºçš„logè½¬å­˜åˆ°å±å¹•åé€€å‡º -f \u003cfilePath\u003e å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼Œé»˜è®¤æ–‡ä»¶åä¸ºstdoutï¼Œåƒä¸åƒstd::cout -s è¿‡æ»¤ï¼Œä¸€ä¼šè¯¦ç»†äº†è§£ä¸€ä¸‹ -v \u003cformat\u003e è®¾ç½®æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ï¼Œé»˜è®¤ä¸ºthreadtime -D è¾“å‡ºæ—¥å¿—æ—¶ç»™å„ä¸ªç¼“å†²åŒºä¹‹é—´åŠ ä¸ªåˆ†å‰²çº¿æ¥åŒºåˆ†ï¼Œæ¨èä½¿ç”¨ -t \u003ccount\u003e ä»…è¾“å‡ºæœ€æ–°çš„è¡Œæ•°ï¼ŒåŒ…å«-d -t \u003ctime\u003e è¾“å‡ºæŒ‡å®šæ—¶é—´é”šç‚¹ä»¥æ¥çš„æœ€æ–°è¡Œï¼ŒåŒ…å«-dï¼Œå¦‚ï¼šadb logcat -t â€˜01-26 20:52:41.820â€™ -T ä¸-tä¸€è‡´ï¼Œä¸åŒ…å«-d -L åœ¨æœ€åä¸€æ¬¡é‡å¯ä¹‹å‰è½¬å­˜log -B ä»¥äºŒè¿›åˆ¶æ–‡ä»¶è¾“å‡ºæ—¥å¿— -S è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ -G è®¾ç½®æ—¥å¿—ç¼“å†²åŒºå¤§å°ï¼Œå•ä½æ˜¯Kæˆ–M â€“pid=\u003cpid\u003e ä»…è¾“å‡ºæŒ‡å®špidçš„log ","date":"2022-07-06","objectID":"/logcat/:6:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"è¿‡æ»¤ ","date":"2022-07-06","objectID":"/logcat/:7:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"ä¼˜å…ˆçº§ä¸TAG ä»¥ä¸‹æ˜¯logçš„ä¼˜å…ˆçº§ï¼Œä¸ASä¸­å¯¹åº”ï¼š priority description V è¯¦ç»† D è°ƒè¯• I ä¿¡æ¯ W è­¦å‘Š E é”™è¯¯ F ä¸¥é‡é”™è¯¯ S é™é»˜ï¼Œæ¯›æ²¡æœ‰ TAGä¸ç”¨è§£é‡Šäº†ï¼Œæˆ‘æ‡‚å¾—ã€‚ æ ¼å¼ï¼š \u003cpriority\u003e/\u003ctag\u003e eg: adb logcat ActivityManager:I MyApp:D *:S æ˜¾ç¤ºtagä¸ºActivityManagerå¹¶ä¸”ç­‰çº§æ˜¯Iä»¥ä¸Šçš„æ—¥å¿—ï¼›å’Œtagä¸ºMyAppå¹¶ä¸”ç­‰çº§ä¸ºDä»¥ä¸Šçš„æ—¥å¿—ï¼›ä¸æ­¤åŒæ—¶ï¼Œé€šè¿‡*:Sè®©å…¶ä»–æ—¥å¿—é™é»˜ã€‚ æ³¨æ„è¿™é‡Œï¼Œå®æµ‹ç”¨tagè¿‡æ»¤åï¼Œå¹¶ä¸èƒ½é˜»æ­¢å…¶ä»–æ—¥å¿—çš„å‡ºç°ï¼Œæ‰€ä»¥åé¢å¿…é¡»åŠ *:Sæ‰èƒ½å•ç‹¬æ˜¾ç¤ºtagæ ‡è®°åçš„æ—¥å¿—ã€‚ ","date":"2022-07-06","objectID":"/logcat/:7:1","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"æ ¼å¼æ§åˆ¶ å¯ä»¥é€šè¿‡-vå‚æ•°æ§åˆ¶æ—¥å¿—è¾“å‡ºçš„æ ¼å¼ã€‚ format description brief priority+tag+PID long å…ƒæ•°æ®å­—æ®µï¼Œå¹¶ä½¿ç”¨ç©ºç™½è¡ŒåŒºåˆ† process PID raw ä¸åŒ…å«å…¶ä»–å…ƒæ•°æ®çš„åŸå§‹æ—¥å¿—æ¶ˆæ¯ tag priority+tag thread priority+PID+TID threadtime é»˜è®¤ï¼Œtime+priority+tag+PID+TID time date+time+priority+tag+PID ","date":"2022-07-06","objectID":"/logcat/:8:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"logcatå¯¼å‡º adb logcat -d \u003ewzj.txt ","date":"2022-07-06","objectID":"/logcat/:9:0","series":[],"tags":[],"title":"Logcat","uri":"/logcat/"},{"categories":[],"content":"å®‰è£…Repo ","date":"2022-06-29","objectID":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/:1:0","series":[],"tags":[],"title":"Ubuntu22.04å®‰è£…é…ç½®repo","uri":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/"},{"categories":[],"content":"aptå®‰è£…ï¼ˆä¸æ¨èï¼‰ sudo apt-get update sudo apt-get install repo å®æµ‹aptå®‰è£…éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”èƒ½è‡ªåŠ¨é…ç½®å¥½ç¯å¢ƒå˜é‡ã€‚ä½†æ˜¯ubuntu22.04LTSæºä¸Šçš„ç‰ˆæœ¬æ˜¯æ¯”è¾ƒæ—§ï¼Œå¯¹æˆ‘è¿™ç§æ–°æ½®å…šå¾ˆä¸å‹å¥½ã€‚ ","date":"2022-06-29","objectID":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/:1:1","series":[],"tags":[],"title":"Ubuntu22.04å®‰è£…é…ç½®repo","uri":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/"},{"categories":[],"content":"ä¸‹è½½å®‰è£… åœ¨ç”¨æˆ·æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªbinç›®å½•ï¼š mkdir ~/bin ä¸éœ€è¦ä¿®æ”¹ï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š export REPO=$(mktemp /tmp/repo.XXXXXXXXX) curl -o ${REPO} https://storage.googleapis.com/git-repo-downloads/repo gpg --recv-key 8BB9AD793E8E6153AF0F9A4416530D5E920F5C65 curl -s https://storage.googleapis.com/git-repo-downloads/repo.asc | gpg --verify - ${REPO} \u0026\u0026 install -m 755 ${REPO} ~/bin/repo è¿™äº›å‘½ä»¤ä¼šè®¾ç½®ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå°† Repo ä¸‹è½½åˆ°è¯¥æ–‡ä»¶ä¸­ï¼Œå¹¶éªŒè¯æä¾›çš„å¯†é’¥æ˜¯å¦ä¸æ‰€éœ€çš„å¯†é’¥åŒ¹é…ã€‚å¦‚æœè¿™äº›æ­¥éª¤æˆåŠŸå®Œæˆï¼Œå°±ä¼šç»§ç»­è¿›è¡Œå®‰è£…ã€‚ mktempå‘½ä»¤å¯æŸ¥çœ‹https://www.runoob.com/linux/linux-comm-mktemp.html è¿™ä¸€æ­¥æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œåœ¨binç›®å½•ä¸‹å°±ä¼šå‡ºç°ä¸€ä¸ªrepoæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸ªpythonå¯æ‰§è¡Œæ–‡ä»¶ã€‚ æˆ‘ä»¬ç”¨ä»»ä½•ç¼–è¾‘å™¨æ‰“å¼€å®ƒï¼Œæ¯”å¦‚æˆ‘å–œæ¬¢vscodeï¼š cd ~/bin code repo åœ¨æ–‡ä»¶é¡¶ç«¯ç¬¬ä¸€è¡Œæœ‰æ ¼å¼å£°æ˜ï¼Œæˆ‘ä¸‹è½½çš„repoç”¨çš„æ˜¯python2,ä½†æ˜¯æˆ‘çš„ubuntuåªå®‰è£…äº†python3,æ‰€ä»¥éœ€è¦æŠŠ2æ”¹æˆ3ï¼š #!/usr/bin/env python æ”¹ä¸ºï¼š #!/usr/bin/env python3 ä¹‹åï¼Œç”±äºrepoåœ¨åˆå§‹åŒ–æ—¶é»˜è®¤è®¿é—®googleåœ°å€ï¼Œé€Ÿåº¦éå¸¸æ…¢ï¼Œæ‰€ä»¥éœ€è¦æ”¹æˆæ¸…åçš„é•œåƒï¼Œåœ¨repoæ–‡ä»¶å†…æŠŠhttps://gerrit.googlesource.com/git-repoæ›¿æ¢æˆhttps://mirrors.tuna.tsinghua.edu.cn/git/git-repoï¼Œå¹¶ä¿å­˜ã€‚ REPO_URL = os.environ.get('REPO_URL', None) if not REPO_URL: # REPO_URL = 'https://gerrit.googlesource.com/git-repo' REPO_URL = 'https://mirrors.tuna.tsinghua.edu.cn/git/git-repo' REPO_REV = os.environ.get('REPO_REV') if not REPO_REV: REPO_REV = 'stable' # URL to file bug reports for repo tool issues. BUG_URL = 'https://bugs.chromium.org/p/gerrit/issues/entry?template=Repo+tool+issue' Pythonæ˜¯ä¸€ç§å¼ºæ ¼å¼è¯­è¨€ï¼Œæ‰€ä»¥æ›¿æ¢çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ç¼©è¿›çš„ä½æ•°ä¸ä¹‹å‰ä¸€è‡´ã€‚ æœ€åæŸ¥çœ‹ä¸€ä¸‹repoç‰ˆæœ¬å·ï¼ŒéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š repo version ","date":"2022-06-29","objectID":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/:1:2","series":[],"tags":[],"title":"Ubuntu22.04å®‰è£…é…ç½®repo","uri":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/"},{"categories":[],"content":"ä¸‹è½½å®‰å“æºç  ","date":"2022-06-29","objectID":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/:2:0","series":[],"tags":[],"title":"Ubuntu22.04å®‰è£…é…ç½®repo","uri":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/"},{"categories":[],"content":"åˆå§‹åŒ–Repo åˆ›å»ºä¸€ä¸ªç©ºç›®å½•æ¥å­˜æ”¾æ‚¨çš„å·¥ä½œæ–‡ä»¶ã€‚ä¸ºå…¶æŒ‡å®šä¸€ä¸ªæ‚¨å–œæ¬¢çš„ä»»æ„åç§°ï¼š mkdir WORKING_DIRECTORY cd WORKING_DIRECTORY gitéœ€è¦é…ç½®å…¨å±€åç§°å’Œé‚®ç®±ï¼š git config --global user.name Your Name git config --global user.email you@example.com è¿è¡Œrepo initæ›´æ–°repo,å¹¶ä¸ºrepoæŒ‡å®šä¸€ä¸ªç½‘å€ï¼š repo init -u https://android.googlesource.com/platform/manifest æ®è¯´ä»googleä»“åº“ä¸‹è½½ä¼šéå¸¸æ…¢ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¤±è´¥ï¼Œå¹¸å¥½å…¬å¸è¿™è¾¹å·²ç»æœ‰äº†ğŸ˜€ï¼š repo init -u \"git://10.53.131.102/platform/manifest\" -b android-9.0.0_r46 æœ€ååŒæ­¥Androidæºç ï¼š repo sync æ›´å¿«çš„æ–¹å¼ï¼ŒåŠ ä¸Šå‚æ•°: -c è¡¨ç¤ºä»å½“å‰åˆ†æ”¯åŒæ­¥ -j8 è¡¨ç¤ºå¯åŠ¨8ä¸ªçº¿ç¨‹å¹¶å‘åŒæ­¥ repo sync -c -j8 æ‰§è¡Œä¹‹åï¼Œå‘ç°å¥½æ…¢ï¼ŒæŠ½çƒŸå»äº†ã€‚ ","date":"2022-06-29","objectID":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/:2:1","series":[],"tags":[],"title":"Ubuntu22.04å®‰è£…é…ç½®repo","uri":"/ubuntu22.04%E5%AE%89%E8%A3%85repo/"},{"categories":[],"content":"åˆ†åŒºæ¦‚å¿µ ç°åœ¨äº†è§£åˆ°å®‰å“ç³»ç»Ÿå¤§æ¦‚åˆ†ä¸‰ä¸ªåˆ†åŒºï¼š system/priv-app:ç³»ç»Ÿé¢„ç½®åˆ†åŒº vendor/appï¼šå‚å•†é¢„ç½®åˆ†åŒº data:ç”¨æˆ·è½¯ä»¶åˆ†åŒº å¹³æ—¶æˆ‘ä»¬é adbå®‰è£…çš„apkï¼Œéƒ½ä¼šè£…åˆ°dataä¸­ï¼Œä¼šè¦†ç›–æ‰å¦å¤–ä¸¤ä¸ªåˆ†å™¨çš„é¢„ç½®apkã€‚ å½“å¸è½½æ—¶ï¼Œä¹Ÿåªä¼šå¸è½½æ‰ç”¨æˆ·åˆ†åŒºçš„apkï¼Œä¸ä¼šå½±å“å¦å¤–ä¸¤ä¸ªåˆ†åŒºã€‚å½“å¸è½½æ‰ç”¨æˆ·åˆ†åŒºçš„apkåï¼Œé¢„ç½®çš„åŒåŒ…åapkå°±ä¼šæš´éœ²å‡ºæ¥ï¼Œè®©äººæœ‰ç§åƒåœ¾è½¯ä»¶å¸è½½ä¸æ‰çš„æ„Ÿè§‰ã€‚ ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:1:0","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"è°ƒè¯•æ—¶çš„å®‰è£…å¸è½½æ–¹å¼ ä»¥ä¸‹ä¸¤ç§æ–¹å¼éƒ½åªèƒ½å¸è½½ç”¨æˆ·åˆ†åŒºçš„apkï¼Œåªæœ‰ç¬¬ä¸‰ç§å®æµ‹å¯åˆ é™¤systemå’Œvendorä¸­çš„apkã€‚ ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:0","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"adbæ–¹å¼ å®‰å“è°ƒè¯•æ¡¥ï¼š adb install [package name] adb uninstall [package name] ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:1","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"pmæ–¹å¼ PackageManageråŒ…ç®¡ç†å™¨ï¼š adb shell pm install [package name] pm uninstall [package name] ### shellæ–¹å¼ ```shell adb shell cd xxxx rm xxx.xx ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:2","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"è·å–rootæƒé™ adb root ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:3","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"é‡æ–°æŒ‚è½½systemåˆ†åŒº å› ä¸ºandroidç³»ç»Ÿçš„systemåˆ†åŒºåœ¨å¯åŠ¨ä¹‹åæ˜¯åªè¯»åˆ†åŒºï¼Œä½†åœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦å¯¹systemåˆ†åŒºè¿›è¡Œä¿®æ”¹ï¼Œåˆ™éœ€é‡æ–°æŒ‚è½½æˆè¯»å†™æ¨¡å¼ã€‚ æ¯”å¦‚Android9.0å¯åŠ¨äº†ç³»ç»ŸéªŒè¯ï¼Œå› æ­¤åœ¨æ›¿æ¢vendorç›®å½•å†…å®¹æ—¶éœ€è¦å…ˆç¦æ­¢ç³»ç»ŸéªŒè¯ï¼Œå¹¶é‡æ–°æŒ‚è½½systemåˆ†åŒºï¼š adb root adb remount adb disable-verity adb reboot adb root adb remount ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:4","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"æ–‡ä»¶ä¼ è¾“ è¿™é‡Œé€šå¸¸ç”¨æ¥ä¼ è¾“apkæ–‡ä»¶ã€‚ adb pull [ç›®æ ‡è®¾å¤‡æ–‡ä»¶] [æœ¬åœ°è·¯å¾„] adb push [æœ¬åœ°æ–‡ä»¶] [ç›®æ ‡è®¾å¤‡è·¯å¾„] ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:5","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"md5éªŒè¯apk ç”±äºæ›¿æ¢system/vendorï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ›¿æ¢æˆåŠŸæ²¡æœ‰ï¼Œè¿™æ—¶å°±éœ€è¦å¯¹æ¯”æ“ä½œå‰åçš„apkçš„md5: md5sum æ–‡ä»¶ å¦‚æœæ–‡ä»¶æœ‰æ”¹åŠ¨ï¼Œå…¶md5å¿…å®šä¸æœ€ä¹‹å‰çš„ä¸åŒï¼Œè¯´æ˜æ›¿æ¢æˆåŠŸã€‚ ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:6","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"æŠ“log ç”±äºç°åœ¨å¾ˆå¤šä¸œè¥¿éƒ½è£…åœ¨vendorï¼Œå®‰è£…å°šä¸”å›°éš¾ï¼Œæ›´åˆ«ææŒ‚ç«¯ç‚¹è°ƒè¯•äº†ï¼Œä¹Ÿä¸ä¼šçœ‹åˆ°ä»»ä½•logï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¸»åŠ¨æŠ“å–logï¼š ","date":"2022-06-17","objectID":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/:2:7","series":[],"tags":[],"title":"Android9åˆ·å†™vendorä¸­çš„apk","uri":"/android9%E5%88%B7%E5%86%99vendor%E4%B8%AD%E7%9A%84apk/"},{"categories":[],"content":"yumlç±»å›¾åŸºæœ¬æ ¼å¼ // {type:class} // {direction:topDown} // {generate:true} [note: You can stick notes on diagrams too!{bg:cornsilk}] [Customer]\u003c\u003e1-orders 0..*\u003e[Order] [Order]++*-*\u003e[LineItem] [Order]-1\u003e[DeliveryMethod] [Order]*-*\u003e[Product|EAN_Code|promo_price()] [Category]-.-\u003e[Product] [DeliveryMethod]^[National] [DeliveryMethod]^[International] ä¸Šé¢æ˜¯ä¸ªåˆ—å­ã€‚ Item Example Class [Customer] Directional(å•å‘å…³è”) [Customer]-\u003e[Order] Bidirectional(åŒå‘å…³è”) [Customer]\u003c-\u003e[Order] Aggregation(èšåˆ) [Customer]+-[Order] or [Customer]\u003c\u003e-[Order] Composition(ç»„åˆ) [Customer]++-[Order] Inheritance(æ³›åŒ–) [Customer]^[Cool Customer] Dependencies(ä¾èµ–) [Customer]uses-.-\u003e[PaymentStrategy] Cardinality [Customer]\u003c1-1..2\u003e[Address] Labels [Person]customer-billingAddress[Address] Notes [Address]-[note: Value Object] Full Class `[Customer Color splash [Customer{bg:orange}]\u003c\u003e1-\u003e*[Order{bg:green}] ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:1:0","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"è®¿é—®ä¿®é¥°ç¬¦ ä¿®é¥°ç¬¦ æè¿° + public - private # protected æ—  package ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:2:0","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"å…³ç³» ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:3:0","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"ä¾èµ–å…³ç³» è¡¨ç¤ºä¸€ç§ä¸´æ—¶æ€§çš„ï¼Œå€ŸåŠ©å¤–éƒ¨äº‹ç‰©çš„ã€ä½¿ç”¨ã€‘å…³ç³»ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æ‰“ç”µè¯ï¼Œæ­¤æ—¶éœ€è¦ä¸€å°æ‰‹æœºï¼Œé‚£ä¹ˆå°±æ˜¯personä¾èµ–mobilePhoneï¼Œä½†æ˜¯äººçš„èº«ä½“é‡Œå¹¶æ²¡æœ‰æ‰‹æœºï¼Œæ‰‹æœºæ˜¯å¤–éƒ¨çš„ã€‚ä¸€èˆ¬åœ¨ä»£ç ä¸­çš„ä½“ç°å°±æ˜¯ï¼ŒæŸä¸ªç±»é€šè¿‡è°ƒç”¨å…¶ä»–ç±»çš„æŸäº›æ–¹æ³•å®Œæˆä»»åŠ¡ï¼Œå«åšâ€æŸä¸ªç±»â€œä¾èµ–â€å…¶ä»–ç±»â€ã€‚ // {type:class} [Customer]uses-.-\u003e[PaymentStrategy] ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:3:1","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"æ³›åŒ–å…³ç³» æ³›åŒ–å…³ç³»å¼å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¤§çš„å…³ç³»ï¼Œè¡¨ç¤ºä¸€ç§æ‰©å±•ï¼ˆç»§æ‰¿ï¼‰å…³ç³»ï¼Œæ˜¯ç¬¦åˆis-açš„å…³ç³»ã€‚ è¡¨ç¤ºä¸ºç©ºå¿ƒç®­å¤´ï¼š // {type:class} [Student]^[Person] ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:3:2","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"å®ç°å…³ç³» æ¥å£ä¸å®ç°ç±»çš„å…³ç³»ã€‚ è¡¨ç¤ºä¸ºè™šçº¿+ç©ºå¿ƒç®­å¤´ã€‚ // {type:class} [Student]^[Person] ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:3:3","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"å…³è”å…³ç³» æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´çš„è”ç³»ã€‚JAVAä¸­ä¸€èˆ¬æŒ‡ç±»å†…éƒ¨åŒ…å«çš„å±æ€§ï¼Œè€Œè¿™ä¸ªå±æ€§ä¸€èˆ¬æ˜¯å…¶ä»–ç±»å‹ã€‚ å•å‘\u0026åŒå‘å…³è” åœ¨ä»£ç ä¸­é€šå¸¸å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ¥å®ç°å…³è”å…³ç³»ã€‚ [Customer]\u003c-\u003e[Order] è¡¨ç¤ºä¸ºå®çº¿+å®å¿ƒç®­å¤´æŒ‡å‘è¢«å…³è”çš„ç±»ã€‚ èšåˆ èšåˆï¼ˆAggregationï¼‰å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºå…³è”å…³ç³»ï¼Œæ˜¯æ•´ä½“å’Œéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ has-a çš„å…³ç³»ã€‚ èšåˆå…³ç³»ä¹Ÿæ˜¯é€šè¿‡æˆå‘˜å¯¹è±¡æ¥å®ç°çš„ï¼Œå…¶ä¸­æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡è€Œç‹¬ç«‹å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå­¦æ ¡ä¸è€å¸ˆçš„å…³ç³»ï¼Œå­¦æ ¡åŒ…å«è€å¸ˆï¼Œä½†å¦‚æœå­¦æ ¡åœåŠäº†ï¼Œè€å¸ˆä¾ç„¶å­˜åœ¨ã€‚ è¡¨ç¤ºä¸ºå®çº¿+ç©ºå¿ƒè±å½¢ï¼ˆæŒ‡å‘æ•´ä½“ï¼‰ã€‚ [Teacher]+-[University] ç»„åˆ è¡¨ç¤ºç±»ä¹‹é—´çš„â€œæ•´ä½“â€ä¸â€œéƒ¨åˆ†â€çš„å…³ç³»ã€‚æ˜¯contains-aå…³ç³»ã€‚ åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥æ§åˆ¶éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å¯¹åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¸èƒ½è„±ç¦»æ•´ä½“å¯¹è±¡è€Œå­˜åœ¨ã€‚ è¡¨ç¤ºä¸ºå®çº¿+å®å¿ƒè±å½¢æŒ‡å‘æ•´ä½“ã€‚ ","date":"2022-06-08","objectID":"/%E7%B1%BB%E5%9B%BE/:3:4","series":[],"tags":[],"title":"ç±»å›¾","uri":"/%E7%B1%BB%E5%9B%BE/"},{"categories":[],"content":"å‰æ®µæ—¶é—´é¢è¯•æ»´æ»´çš„æ—¶å€™ï¼Œè·Ÿé¢è¯•å®˜èŠäº†ä¸€ä¸‹å±æ€§åŠ¨ç”»ï¼Œä¸Šæ¥å°±é—®ï¼šä½ çœ‹è¿‡æºç å—ï¼Ÿæˆ‘è¯´æ²¡çœ‹è¿‡ï¼Œç„¶åä»–è¡¨ç¤ºå±æ€§åŠ¨ç”»å¹¶ä¸æ˜¯çœŸæ­£çš„æ”¹å˜viewçš„å±æ€§ï¼ŒåŸå› æ˜¯ä¸€ä¸ªä¾‹å­ï¼šåœ¨constraintlayoutä¸­ï¼Œé€šè¿‡ç›¸äº’çº¦æŸå®šä¹‰çºµå‘çš„ä¸€åˆ—viewï¼Œç„¶åé€šè¿‡å±æ€§åŠ¨ç”»ï¼Œè®©ç¬¬ä¸€ä¸ªviewå¹³ç§»ï¼Œä½ è®¤ä¸ºä¸‹é¢çš„viewæ˜¯å¦ä¼šè·Ÿç€åŠ¨ï¼Ÿä»–çš„ç»“è®ºæ˜¯ä»ç³»ç»Ÿè®¾è®¡ä¸Šï¼Œè°·æ­Œå°±ä¸å¯èƒ½å…è®¸è·Ÿç€åŠ¨çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šåŠ¨ç”»çš„ç›®æ ‡å°±æ˜¯ç¬¬ä¸€ä¸ªviewï¼Œæ‰€ä»¥å¹³ç§»æ“ä½œä¹Ÿåº”è¯¥å±€é™åœ¨ç¬¬ä¸€ä¸ªviewä¸­ï¼Œè€Œä¸åº”è¯¥å½±å“å…¶ä»–çš„viewã€‚æˆ‘å½“æ—¶è§‰å¾—ä»–å¤ªç‰›é€¼äº†ï¼Œèƒ½ä»æºç æƒ³åˆ°è®¾è®¡æ€æƒ³ï¼Œåé¢æˆ‘è¿˜é ä»–è¿™ä¸ªç»“è®ºå»å¿½æ‚ è¿‡å…¶ä»–äººï¼Œè€Œå…¶ä»–äººä¹Ÿè§‰å¾—æˆ‘å¾ˆç‰›é€¼ï¼Œå“ˆå“ˆå“ˆã€‚ä»Šå¤©å¿ƒè¡€æ¥æ½®ï¼Œè‡ªå·±å†™ä¸ªdemoæµ‹ä¸€ä¸‹ï¼Œé€šè¿‡å±æ€§åŠ¨ç”»å»æ”¹viewçš„xä½ç½®ï¼Œç»“æœä¸‹é¢çš„viewçœŸçš„æ²¡æœ‰è·Ÿç€åŠ¨ï¼Œå¯æ˜¯æ¥ä¸‹æ¥çš„è¡¨ç°å´è®©æˆ‘ç ç›®ç»“èˆŒã€‚ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:0:0","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"ä½¿ç”¨æ–¹å¼ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:1:0","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"ObjectAnimator \u0026 ValueAnimator class MainActivity : AppCompatActivity() { private lateinit var target: Button private lateinit var objectAni: ObjectAnimator private lateinit var valueAni: ValueAnimator private var type = 0 override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_main) target = findViewById(R.id.btn_target) objectAni = ObjectAnimator.ofFloat(target, \"alpha\", 1f, 0f) valueAni = ValueAnimator.ofFloat(1f, 0f).apply { duration = 500 startDelay = 1000 repeatCount = 2 repeatMode = ValueAnimator.REVERSE addUpdateListener { val currentValue = it.animatedValue as Float target.alpha = currentValue target.invalidate() } setTarget(target) } } fun objectStart(v: View) { objectAni.start() type = 1 } fun valueStart(v: View) { valueAni.start() type = 2 } /** * åè½¬ */ fun reset(v: View) { when (type) { 1 -\u003e objectAni.reverse() 2 -\u003e valueAni.reverse() } } } ä»¥ä¸Šå°±æ˜¯å±æ€§åŠ¨ç”»çš„ç”¨æ³•ï¼ŒæœŸä¸­çš„ObjectAnimatoræ˜¯ValueAnimatorçš„çˆ¶ç±»ï¼Œè€Œç”±äºåè€…æ›´åŠ çµæ´»ï¼Œå¯å¤ç”¨ç¨‹åº¦æ›´é«˜ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬å¸¸ç”¨ValueAnimatorã€‚è€ŒObjectAnimatorå‘¢ï¼Œéœ€è¦åœ¨åˆ›å»ºæ—¶é€šè¿‡å‚æ•°ä¼ é€’å±æ€§çš„åç§°ï¼Œé‚£ä¸ç”¨çŒœä¹ŸçŸ¥é“ä»–ç”¨äº†è¿è¡Œæ—¶åå°„ï¼Œè€Œåå°„ä¼šå¸¦æ¥æ›´å¤šçš„èµ„æºæ¶ˆè€—ï¼Œæ‰€ä»¥æ‹‰å€’å§ï¼ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:1:1","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"ç»„åˆåŠ¨ç”»AnimatorSet after(Animator anim) ï¼šåœ¨å‚æ•°åŠ¨ç”»æ‰§è¡Œå®Œä¹‹åå†æ‰§è¡Œ after(long delay) ï¼šå‚æ•°åŠ¨ç”»æ‰§è¡Œå®Œä¹‹åå»¶è¿Ÿæ‰§è¡Œ before(Animator anim)ï¼š æ’å…¥åˆ°å‚æ•°åŠ¨ç”»ä¹‹å‰æ‰§è¡Œ with(Animator anim) ï¼šä¸å‚æ•°åŠ¨ç”»åŒæ—¶æ‰§è¡Œ AnimatorSet aniset = new AnimatorSet(); aniset.play(ani2).with(ani3).before(ani1).after(ani0); ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:1:2","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"æ’å€¼å™¨ä¸ä¼°å€¼å™¨ æ’å€¼å™¨å’Œä¼°å€¼å™¨ç”¨æ¥å®šä¹‰åŠ¨ç”»æ‰§è¡Œæ—¶çš„çŸ¢é‡åŠ¨æ€ï¼Œå¦‚åŠ é€Ÿåº¦ã€é‡åŠ›ã€é˜»åŠ›ã€é˜»å°¼ç­‰ã€‚ eg: ObjectAnimator anim = ObjectAnimator.ofFloat(mButton, \"rotation\", 0.0f, 360.0f); anim.setDuration(5000); anim.setInterpolator(new DecelerateAccelerateInterpolator()); anim.start(); æ’å€¼å™¨ï¼šæ—¶é—´çŸ¢é‡ æ’å€¼å™¨ï¼ˆInterpolatorï¼‰ç”¨äºå®šä¹‰åŠ¨ç”»éšæ—¶é—´æµé€çš„å˜åŒ–è§„å¾‹ã€‚ é»˜è®¤æ’å€¼å™¨ æ’å€¼å™¨ è¡¨ç° AccelerateDecelerateInterpolator å…ˆåŠ é€Ÿï¼Œåå‡é€Ÿ LinearInterpolator çº¿æ€§æ’å€¼å™¨ï¼ŒåŠ¨ç”»åŒ€é€Ÿè¿è¡Œ AccelerateInterpolator åŠ é€Ÿæ’å€¼å™¨ï¼ŒåŠ¨ç”»åŠ é€Ÿè¿è¡Œè‡³ç»“æŸ DecelerateInterpolator å‡é€Ÿæ’å€¼å™¨ï¼ŒåŠ¨ç”»å‡é€Ÿè¿è¡Œè‡³ç»“æŸ OvershootInterpolator å¼¹ç°§æ’å€¼å™¨ï¼Œå¿«é€Ÿå®ŒæˆåŠ¨ç”»ï¼Œè¶…å‡ºç»ˆç‚¹ä¸€å°éƒ¨åˆ†åå†å›åˆ°ç»ˆç‚¹ AnticipateInterpolator å‘æ¡æ’å€¼å™¨ï¼Œå…ˆåé€€ä¸€å°æ­¥å†åŠ é€Ÿå‰è¿›è‡³ç»“æŸ AnticipateOvershootInterpolator æ¿ç°§æ’å€¼å™¨ï¼Œå…ˆåé€€ä¸€å°æ­¥å†åŠ é€Ÿå‰è¿›ï¼Œè¶…å‡ºç»ˆç‚¹ä¸€å°éƒ¨åˆ†åå†å›åˆ°ç»ˆç‚¹ BounceInterpolator å¼¹æ€§æ’å€¼å™¨ï¼Œåœ¨åŠ¨ç”»ç»“æŸä¹‹å‰ä¼šæœ‰ä¸€ä¸ªå¼¹æ€§åŠ¨ç”»çš„æ•ˆæœ CycleInterpolator å‘¨æœŸè¿åŠ¨ è‡ªå®šä¹‰æ’å€¼å™¨ éœ€è¦å®ç°æ¥å£ï¼š public interface TimeInterpolator { /** * å›è°ƒå‚æ•°æ˜¯åŠ¨ç”»æ‰§è¡Œæ—¶é—´çš„ç™¾åˆ†æ¯” */ float getInterpolation(float input); } ä¼°å€¼å™¨ï¼šèµ·å§‹çŸ¢é‡ ä¼°å€¼å™¨ï¼ˆTypeEvaluatorï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ä»åˆå§‹å€¼è¿‡æ¸¡åˆ°ç»“æŸå€¼çš„è®¡ç®—è§„åˆ™ã€‚ è‡ªå®šä¹‰ä¼°å€¼å™¨ éœ€è¦å®ç°æ¥å£ï¼š public interface TypeEvaluator\u003cT\u003e { public T evaluate(float fraction, T startValue, T endValue); } å‚æ•°fractionè¡¨ç¤ºåŠ¨ç”»çš„å®Œæˆåº¦ï¼Œå®é™…ä¸Šå°±æ˜¯æ’å€¼å™¨ä¸­getInterpolation()æ–¹æ³•çš„è¿”å›å€¼ã€‚æœ€åçš„è¿”å›å€¼æ˜¯åœ¨ã€å½“å‰å®Œæˆåº¦ã€è¿™ä¸ªæ¡ä»¶ä¹‹ä¸‹çš„è®¡ç®—ç»“æœå€¼ã€‚ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:1:3","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"XMLæ–¹å¼ ä¸Šé¢æåˆ°ObjectAnimatoræ˜¯é åå°„çš„æ–¹å¼è·å–åˆ°Viewçš„å±æ€§ï¼Œé‚£ä¹ˆè‡ªç„¶å¯ä»¥æƒ³åˆ°é€šè¿‡xmlæ–‡ä»¶å£°æ˜ï¼Œç„¶ååŒæ ·é åå°„è·å–åˆ°Viewçš„å±æ€§å†èµ‹å€¼ï¼Œäºæ˜¯æœ‰äº†é€šè¿‡å®šä¹‰xmlæ–‡ä»¶çš„æ–¹å¼æ¥ç©åŠ¨ç”»çš„æ–¹æ¡ˆï¼š åœ¨resèµ„æºç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªxmlæ–‡ä»¶ï¼š \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cset xmlns:android=\"http://schemas.android.com/apk/res/android\"\u003e \u003canimator android:duration=\"100\" android:repeatMode=\"reverse\"/\u003e \u003c/set\u003e ç„¶åå°±å¯ä»¥å¡«å……åŠ¨ç”»äº†ï¼š val animator = AnimatorInflater.loadAnimator(this,R.animator.my_ani) ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:1:4","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"æºç è§£è¯» ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:2:0","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"ValueAnimator ä»ofFloatæ–¹æ³•å…¥æ‰‹ // æ³¨æ„è¿™ä¸ª PropertyValuesHolder[] mValues; // åˆ›å»ºå¯¹è±¡å¹¶èµ‹å€¼ã€‚ public static ValueAnimator ofFloat(float... values) { ValueAnimator anim = new ValueAnimator(); anim.setFloatValues(values); return anim; } // èµ‹å€¼æ“ä½œ public void setFloatValues(float... values) { if (values == null || values.length == 0) { return; } if (mValues == null || mValues.length == 0) { setValues(PropertyValuesHolder.ofFloat(\"\", values)); } else { PropertyValuesHolder valuesHolder = mValues[0]; valuesHolder.setFloatValues(values); } // New property/values/target should cause re-initialization prior to starting mInitialized = false; } é€šè¿‡å†…å­˜å‚¨å­˜mValuesè¿™ä¸ªæ•°ç»„çš„ç±»å‹ï¼Œå’Œä»£ç ä¸­èµ‹å€¼çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä»–ç”¨äº†ä¸€ä¸ªç±»ä¼¼RecyclerViewçš„holderçš„æ–¹å¼åšç¼“å­˜å’Œå¤ç”¨ã€‚ è¿™é‡Œæ„Ÿè§‰è¦å»å¤ä¹ ä¸€ä¸‹Viewçš„ç›¸å…³çŸ¥è¯†æ‰èƒ½ç»§ç»­å†™ä¸‹å»äº†ï¼ŒåŒ…æ‹¬å¯¹Viewçš„ä¸€äº›æ–°çš„ç†è§£ï¼Œè¿˜æœ‰å®‰å“æ•´ä½“çš„å¸ƒå±€ä½“ç³»ã€‚ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:2:1","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"æ‘˜è¦çš„ç»“è®º æˆ‘é€šè¿‡å±æ€§åŠ¨ç”»ï¼Œå»æ”¹å˜view.translateXï¼Œä¸è®ºæ˜¯è°ƒç”¨invalidate()è¿˜æ˜¯requestLayout(),éƒ½åªæœ‰targetViewè‡ªå·±äº§ç”Ÿäº†å¹³ç§»ï¼› è€Œå½“æˆ‘æ”¹ä¸ºä¿®æ”¹LayoutParamsçš„marginStartåå†requestLayout(),ä¸‹é¢çš„æ‰€æœ‰Viewéƒ½è·Ÿç€å¹³ç§»äº†ã€‚ çœ‹ç€è¿™ä¸ªç»“æœï¼Œæˆ‘æ˜¯æç„¶å¤§æ‚Ÿï¼Œè‰¹ï¼Œä»¥å‰å¤ªæŠŠå¤§å‚çš„äººå½“ç¥çœ‹äº†ï¼Œå†åŠ ä¸Šé¢è¯•æ—¶ç´§å¼ ï¼Œå°±æ²¡è€ƒè™‘é‚£ä¹ˆå¤šã€‚ç°åœ¨çœ‹çœ‹ï¼Œè¿™æ ¹æœ¬å°±æ˜¯ä¸ªä¼ªå‘½é¢˜å•Šï¼Œé¦–å…ˆconstraintlayoutæ‰€å»ºç«‹çš„å¸ƒå±€ä½“ç³»æ˜¯LayoutParamsç›¸å…³çš„ï¼Œè€ŒViewçš„ä½ç½®å±æ€§(x/y)ä¹Ÿåœ¨measureå’Œlayoutè¿‡ç¨‹ä¸­æ ¹æ®lpæ¥ç¡®å®šçš„ã€‚æ‰€ä»¥å½“æˆ‘é€šè¿‡å±æ€§åŠ¨ç”»æ”¹å˜translateXæ—¶ï¼Œå¹¶ä¸ä¼šå½±å“lpï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šæ”¹å˜çº¦æŸï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»–Viewäº†ã€‚ ç»“è®ºï¼šä¸è¦æ„Ÿè§‰å¤§å‚çš„äººå¾ˆæƒå¨ï¼Œå…¶ä¸­æœ‰å¾ˆå¤šäººå¯èƒ½å°±æ“…é•¿è£…ä¸ªé€¼è€Œå·²ï¼Œä½ è¯´ä½ è‡ªå·±éƒ½æ²¡å¼„æ‡‚ï¼Œå°±æ•¢æ‹¿æ¥é¢è¯•åˆ«äººï¼Œè¿˜è¯¯å¯¼äººå®¶ï¼Œå¥½æ„æ€å—ï¼Ÿç°åœ¨éå¸¸åº†å¹¸ï¼Œè™½ç„¶å½“åˆé¢è¯•è¿‡äº†ï¼Œä½†æ˜¯å¹¸å¥½å› ä¸ºè–ªèµ„é—®é¢˜æ²¡æœ‰å»ï¼Œè¦ä¸ç„¶è·Ÿè¿™ç§äººå…±äº‹å¤©å¤©çœ‹ä»–è£…é€¼ï¼Œæˆ‘å¿ƒé‡Œä¹Ÿä¸èˆ’æœã€‚ ","date":"2022-05-22","objectID":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/:3:0","series":[],"tags":[],"title":"å±æ€§åŠ¨ç”»","uri":"/%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB/"},{"categories":[],"content":"æœ€è¿‘æ‰“ç®—è‡ªå·±å¼€å‘ç‹¬ç«‹Appï¼Œé‚£ä¹ˆé¦–å…ˆè€ƒè™‘çš„å°±æ˜¯è´¦å·å¯†ç çš„ç½‘ç»œä¼ è¾“å®‰å…¨ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ç™»å½•å®‰å…¨ã€‚ HTTPSé€šä¿¡æ¡†æ¶ä¸‹ï¼› åŠ å›ºåçš„.soæ–‡ä»¶ï¼Œé€šè¿‡éªŒè¯Appç­¾åï¼Œè¿”å›RSAå…¬é’¥ï¼› é€šè¿‡RSAå…¬é’¥åŠ å¯†ç”¨æˆ·åå¯†ç ï¼Œä¸ŠæŠ¥æœåŠ¡å™¨ï¼› æœåŠ¡å™¨é€šè¿‡ç§é’¥è§£å¯†å–å¾—ç”¨æˆ·åå¯†ç ï¼ŒéªŒè¯ç”¨æˆ·åå¯†ç åˆæ³•æ€§ï¼Œè¿”å›jwtçš„tokenï¼› â€”â€”â€”â€”â€”-7æœˆ7æ—¥æ›´æ–°â€”â€”â€”â€”â€”â€”â€”â€”- æœ€è¿‘æ­£å¥½è´Ÿè´£äº†PKIï¼Œäº†è§£äº†åŒå‘è®¤è¯æœºåˆ¶ï¼Œé‚£ä¹ˆè‡ªå·±çš„å®‰å…¨å¯ä»¥å®Œå…¨ä½¿ç”¨åŒå‘è®¤è¯æ¥ç©äº†ï¼š æ‰¾ä¸ªå…è´¹çš„tslè¯ä¹¦ï¼Œé…ç½®å¥½httpsåŒå‘è®¤è¯ã€‚ åœ¨å»ºç«‹è¿æ¥æ¡æ‰‹æ—¶é‡‡ç”¨éå¯¹ç§°åŠ å¯†ï¼Œä¼ è¾“ä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œå·²ç»éå¸¸å®‰å…¨äº†ï¼Œä½†æ˜¯æ¡æ‰‹è¿‡ç¨‹é€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰€ä»¥éœ€è¦é…åˆé“¾æ¥ä¿æ´»ã€‚ é‡è¦ä¿¡æ¯ä½¿ç”¨åŒå‘è®¤è¯ï¼Œéé‡è¦ä¿¡æ¯å¯ä»¥é‡‡ç”¨å•å‘è®¤è¯ã€‚å¦‚æœå…¨é‡‡ç”¨åŒå‘ï¼Œåˆ™ä»»æ„æµè§ˆå™¨ä¸å…·å¤‡è‡ªé¢å‘è¯ä¹¦ï¼Œå°±å¾ˆéº»çƒ¦äº†ã€‚ å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨androidçš„å¯†é’¥åº“ã€‚ ","date":"2022-05-17","objectID":"/%E7%99%BB%E5%BD%95%E5%AE%89%E5%85%A8/:0:0","series":[],"tags":[],"title":"ç™»å½•å®‰å…¨","uri":"/%E7%99%BB%E5%BD%95%E5%AE%89%E5%85%A8/"},{"categories":[],"content":" ä½¿ç”¨httpsé˜²æ‹¦æˆªï¼› é‡‡ç”¨åŠ¨æ€å¯†é’¥ï¼Œé¦–æ¬¡ç™»å½•å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨æœ¬åœ°å¯†é’¥ï¼Œç„¶åå¯ä»æœåŠ¡å™¨åŠ¨æ€å‰©ä¸‹å…¬ç§é’¥ï¼Œå…¬é’¥ä¸‹è½½è‡³å®¢æˆ·ç«¯ï¼Œå‚¨å­˜åœ¨.soæ–‡ä»¶ä¸­ã€‚ ä».soè¯»å–å…¬é’¥ï¼Œ.soéœ€è¦è®¤è¯è¯ä¹¦ç­¾åï¼Œæ‹¿åˆ°å…¬é’¥åä»¥å…¬é’¥åŠ å¯†æ•°æ®å†å‘é€ã€‚ tokenå¯é€šè¿‡æ—¶é—´æˆ³å®ç°æœ‰æ•ˆæ€§éªŒè¯ã€‚ ","date":"2022-05-17","objectID":"/%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1/:0:0","series":[],"tags":[],"title":"å®¢æˆ·ç«¯ç½‘ç»œå®‰å…¨è®¾è®¡","uri":"/%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1/"},{"categories":[],"content":"å¸¸è§æ·˜æ±°ç­–ç•¥ FIFOï¼ˆFirst Inï¼ŒFirst Outï¼‰å…ˆè¿›å…ˆå‡ºï¼› FILO å…ˆè¿›åå‡ºï¼› LFUï¼ˆLeast Frequently Usedï¼‰æœ€å°‘ä½¿ç”¨ï¼› LRUï¼ˆLeast Recently Usedï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚ ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:1","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"é“¾è¡¨çš„ç‰¹æ€§ ä¸éœ€è¦è¿ç»­çš„å‚¨å­˜ç©ºé—´ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡é’ˆè®²ä¸€å †é›¶æ•£çš„å†…å­˜å¿«ä¸²è”èµ·æ¥ã€‚ï¼› ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:2","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"å•é“¾è¡¨ åç»§æŒ‡é’ˆï¼šç”±äºæ•°æ®å­˜å‚¨ä¸è¿ç»­ï¼Œæ‰€ä»¥é“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦è®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ï¼Œå«åšåç»§æŒ‡é’ˆï¼› å¤´èŠ‚ç‚¹ï¼Œè®°å½•äº†é“¾è¡¨çš„åŸºåœ°å€ï¼› å°¾èŠ‚ç‚¹ï¼Œåç»§æŒ‡é’ˆæŒ‡å‘ç©ºåœ°å€nullã€‚ ç”±äºæ•°ç»„éœ€è¦è¿ç»­çš„å‚¨å­˜ç©ºé—´ï¼Œæ‰€ä»¥åœ¨å¢åˆ æ“ä½œæ—¶éœ€è¦ç§»ä½è¡¥æ¼ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œè€Œé“¾è¡¨å› ä¸ºç©ºé—´æœ¬èº«ä¸æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦ç§»ä½ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯O(1)ã€‚ ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:3","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"å¾ªç¯é“¾è¡¨ ä¸€ç§ç‰¹æ®Šçš„å•é¡¹é“¾ï¼Œå°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆæŒ‡å‘å¤´èŠ‚ç‚¹ã€‚ ä»é“¾å°¾å¯ä»¥è½»æ¾è¿”å›é“¾å¤´ã€‚ å½“æ•°æ®å…·å¤‡ç¯å½¢ç‰¹ç‚¹æ—¶é€‚åˆä½¿ç”¨å¾ªç¯é“¾è¡¨ã€‚ ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:4","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"åŒå‘é“¾è¡¨ èŠ‚ç‚¹ä¸­åŒæ—¶å…·å¤‡å‰é©±å’Œ**åç»§åŒæŒ‡é’ˆ ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:5","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"LRUç®—æ³• åœ¨ä¸€ä¸ªå›ºå®šé•¿åº¦å¹¶ä¸”æœ‰åºçš„é“¾è¡¨ç»“æ„ä¸­å­˜å…¥æ•°æ®ï¼Œç”±äºæœ‰åºï¼Œæ‰€ä»¥æœ€å…ˆæ’å…¥çš„å°±ä¼šæ’åœ¨é“¾å°¾ã€‚ å½“è®¿é—®æ•°æ®æ—¶ï¼Œä»é“¾å¤´å¼€å§‹éå†æŸ¥è¯¢åˆ°å¯¹åº”èŠ‚ç‚¹ï¼Œå¹¶å°†å®ƒç§»åˆ°é“¾å¤´ï¼› å¦‚æœæ²¡æœ‰æŸ¥è¯¢åˆ°ï¼Œåˆ™å°†æ–°æ•°æ®æ’å…¥é“¾å¤´ã€‚ å¦‚æœæ’å…¥åå‘ç°é“¾è¡¨å·²è¶…å‡ºå›ºå®šé•¿åº¦ï¼Œåˆ™åˆ é™¤é“¾å°¾ã€‚ ","date":"2022-05-14","objectID":"/%E9%93%BE%E8%A1%A8/:0:6","series":[],"tags":[],"title":"é“¾è¡¨","uri":"/%E9%93%BE%E8%A1%A8/"},{"categories":[],"content":"æ•°ç»„çš„ç‰¹æ€§ çº¿æ€§è¡¨ç»“æ„ï¼› éœ€è¦å†…å­˜ä¸­æœ‰è¶³å¤Ÿçš„è¿ç»­å‚¨å­˜ç©ºé—´ï¼Œå¦åˆ™å‰©ä½™ç©ºé—´å†å¤§ä¹Ÿä¼šåˆ›å»ºå¤±è´¥ï¼› å¯é€šè¿‡ä¸‹æ ‡éšæœºè®¿é—®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)å¸¸é‡é˜¶ï¼› å¦‚æœä¸é€šè¿‡ä¸‹æ ‡è®¿é—®ï¼Œè€Œæ˜¯é€šè¿‡ç®—æ³•æŸ¥æ‰¾(æ¯”å¦‚äºŒåˆ†æ³•)ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)å¯¹æ•°é˜¶ã€‚ æ’å…¥åˆ é™¤æ“ä½œä½æ•ˆï¼Œåœ¨æ’å…¥/åˆ é™¤æ“ä½œæ—¶ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚ ","date":"2022-05-14","objectID":"/%E6%95%B0%E7%BB%84/:0:1","series":[],"tags":[],"title":"æ•°ç»„","uri":"/%E6%95%B0%E7%BB%84/"},{"categories":[],"content":"ArrayListèƒ½å¦å®Œå…¨æ›¿ä»£æ•°ç»„ ArrayListåªæ”¯æŒåŒ…è£…ç±»å‹ï¼Œå¦‚Intengerï¼ŒLongç­‰ï¼Œå´ä¸æ”¯æŒç»“æ„ä½“ï¼Œåœ¨å­˜å…¥ç»“æ„ä½“æ—¶ä¼šè‡ªåŠ¨è£…ç®±ï¼Œè€Œè£…ç®±æ“ä½œä¼šæœ‰ä¸€å®šçš„æ€§èƒ½æ¶ˆè€—ã€‚ åœ¨åšä¸€äº›åº•å±‚å¼€å‘æ—¶ï¼Œå»ºè®®ä½¿ç”¨æ•°ç»„ã€‚ ","date":"2022-05-14","objectID":"/%E6%95%B0%E7%BB%84/:0:2","series":[],"tags":[],"title":"æ•°ç»„","uri":"/%E6%95%B0%E7%BB%84/"},{"categories":[],"content":"ä¸ºä½•ä¸‹æ ‡ä»0å¼€å§‹ ä¸‹æ ‡å¯ä»¥ç†è§£ä¸ºã€Œåç§»é‡ã€ï¼Œä»0å¼€å§‹å°±æ„å‘³ç€ä¸éœ€è¦åç§»ï¼Œæ‰æ˜¯æ­£ç¡®çš„ç†è§£ã€‚å½“æˆ‘ä»¬é€šè¿‡ä¸‹æ ‡æŸ¥æ‰¾å…ƒç´ æ—¶ï¼Œcpuä¼šé€šè¿‡è®¡ç®—åç§»é‡æ¥æŸ¥æ‰¾ï¼Œè€Œå¦‚æœä»¥1å¼€å§‹ï¼Œcpuè®¡ç®—å®Œåç§»é‡ä¹‹åè¿˜è¦è¿½åŠ ä¸€æ¬¡å‡1æ“ä½œã€‚ ","date":"2022-05-14","objectID":"/%E6%95%B0%E7%BB%84/:0:3","series":[],"tags":[],"title":"æ•°ç»„","uri":"/%E6%95%B0%E7%BB%84/"},{"categories":[],"content":"åŒæ ·åŸºäºäº¤æ¢çš„æ€æƒ³ï¼Œé€‰æ‹©æ’åºæ³•çš„æ•ˆç‡è¦æ¯”å†’æ³¡æ’åºé«˜å¾ˆå¤šã€‚ ","date":"2022-05-13","objectID":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/:0:0","series":[],"tags":[],"title":"é€‰æ‹©æ’åºæ³•","uri":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/"},{"categories":[],"content":"æ ¸å¿ƒæ€æƒ³ å°†æ•°æ®åˆ†æˆä¸¤ç»„ï¼Œé€šè¿‡éå†æ‰¾åˆ°æå€¼ï¼Œå¹¶å­˜æ”¾åˆ°å¦ä¸€ç»„æœ«å°¾ã€‚ ","date":"2022-05-13","objectID":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/:0:1","series":[],"tags":[],"title":"é€‰æ‹©æ’åºæ³•","uri":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/"},{"categories":[],"content":"é€‰æ‹©æŸ¥æ‰¾æå€¼ ","date":"2022-05-13","objectID":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/:0:2","series":[],"tags":[],"title":"é€‰æ‹©æ’åºæ³•","uri":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/"},{"categories":[],"content":"é€‰æ‹©æ³•æŸ¥æ‰¾æå€¼ private static int max(int[] original) { int[] arr = Arrays.copyOf(original, original.length); int i = 0; int pos = i + 1; for (; i \u003c arr.length; i++) { if (arr[i] \u003e arr[pos]) { pos = i; } } return arr[pos]; } ","date":"2022-05-13","objectID":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/:0:3","series":[],"tags":[],"title":"é€‰æ‹©æ’åºæ³•","uri":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/"},{"categories":[],"content":"é€‰æ‹©æ³•æ’åº private static int[] sort(int[] original) { // copyä¸€ä»½æ•°æ®å‡ºæ¥ï¼Œä¸è®©åŸæ•°æ®å—å½±å“ int[] aar = Arrays.copyOf(original, original.length); int num; // åªéå†n-1æ¬¡å°±å¤Ÿäº†ï¼Œæœ€åä¸€ä¸ªæ•°ä¸ç”¨ç®¡ for (int i = 0; i \u003c aar.length - 1; i++) { // è®°å½•æå€¼çš„ä½ç½® int minPos = i; // è®©å‡ºå·²å¤„ç†è¿‡çš„æ•°æ®ï¼Œåªéœ€éå†å‰©ä¸‹çš„æ•°æ® for (int j = i + 1; j \u003c aar.length; j++) { // æ¯”è¾ƒå¹¶æ›´æ–°ä½ç½® if (aar[j] \u003c aar[minPos]) { minPos = j; } } // ä¸€è½®éå†ä¹‹åå¼€å§‹äº¤æ¢ if (i != minPos) { num = aar[i]; aar[i] = aar[minPos]; aar[minPos] = num; } } return aar; } é¦–å…ˆä»å·¦å¾€å³é€‰æ‹©ä¸€ä¸ªå…ƒç´ iï¼Œç„¶åå®šä¹‰ä¸€ä¸ªæŒ‡é’ˆminPosï¼Œä¹‹åéå†iåé¢çš„å…ƒç´ æŸ¥æ‰¾æœ€å°å€¼çš„ä½ç½®è®°å½•åˆ°æŒ‡é’ˆï¼Œæœ€åç”¨åˆå§‹é€‰å®šçš„å…ƒç´ iå»ä¸minPosäº¤æ¢ã€‚ å¤–å±‚å¾ªç¯éå†n-1æ¬¡ï¼Œå‰©ä¸‹æœ€åä¸€ä¸ªå€¼ä¸éœ€è¦ç®¡ï¼› ä¸€ä»½æ•°æ®åˆ†æˆä¸¤ç»„æ•´ç†ï¼Œæ‰€ä»¥éå†æ¬¡æ•°ä¼šä¾æ¬¡å‡å°‘ï¼Œæé«˜æ•ˆç‡ï¼› å…ƒç´ æ¯æ¬¡ä¸åªç§»åŠ¨ä¸€ä½ï¼› é€šè¿‡è®°å½•ä¸‹æ ‡ï¼Œå†…å±‚å¾ªç¯ä¸€è½®ä¹‹åå…ƒç´ æ‰ä¼šç§»åŠ¨ï¼› æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²) ","date":"2022-05-13","objectID":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/:0:4","series":[],"tags":[],"title":"é€‰æ‹©æ’åºæ³•","uri":"/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E6%B3%95/"},{"categories":[],"content":"å†’æ³¡æ³•å¯ä»¥ç”¨æ¥æ‰¾é˜Ÿåˆ—ä¸­çš„æœ€å¤§å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤šæ¬¡å†’æ³¡å¯¹é›†åˆè¿›è¡Œæ’åºã€‚ ","date":"2022-05-13","objectID":"/%E5%86%92%E6%B3%A1%E6%B3%95/:0:0","series":[],"tags":[],"title":"å†’æ³¡æ³•","uri":"/%E5%86%92%E6%B3%A1%E6%B3%95/"},{"categories":[],"content":"æ ¸å¿ƒæ€æƒ³ éå†æ•°ç»„æˆ–é›†åˆä¸­ï¼Œç”¨å½“å‰ä½ç½®çš„å€¼ä¸åé¢ä¸€ä¸ªå€¼ç›¸æ¯”è¾ƒå¹¶ä¸”äº¤æ¢ï¼Œä½¿æå€¼æ°¸è¿œå¤„äºæ•°ç»„æˆ–é›†åˆçš„æœ€æœ«ã€‚ ","date":"2022-05-13","objectID":"/%E5%86%92%E6%B3%A1%E6%B3%95/:1:0","series":[],"tags":[],"title":"å†’æ³¡æ³•","uri":"/%E5%86%92%E6%B3%A1%E6%B3%95/"},{"categories":[],"content":"å†’æ³¡æ‰¾æœ€å¤§å€¼ é€ä¸ªæ¯”å¯¹ï¼Œé€šè¿‡äº¤æ¢ä½¿æå€¼æ‹åˆ°æœ«å°¾ï¼Œä½†å¹¶ä¸ä¿è¯å‰é¢çš„é¡ºåºã€‚ private static int max(int[] original) { // copyæ•°ç»„ï¼Œä¸ä¼šå½±å“åŸæ•°ç»„ int[] newArray = Arrays.copyOf(original, original.length); int num1, num2; // æ³¨æ„è¿™é‡Œå‡1ä»¥æé«˜æ•ˆç‡ for (int i = 0; i \u003c newArray.length - 1; i++) { num1 = newArray[i]; num2 = newArray[i + 1]; if (num1 \u003e num2) { newArray[i] = num2; newArray[i + 1] = num1; } } // è¿”å›æœ«ç«¯ return newArray[newArray.length - 1]; } ä¸ºä½•å¾ªç¯ä¸­å‡1å‘¢ï¼Ÿå› ä¸ºä¸æ–­çš„éå†å’Œæ¯”è¾ƒï¼Œå½“éå†åˆ°å€’æ•°ç¬¬äºŒä¸ªå€¼çš„æ—¶å€™ï¼Œä¼šä¸å€’æ•°ç¬¬ä¸€å»æ¯”è¾ƒï¼Œä¸è®ºç»“æœå¦‚ä½•ï¼Œæœ€å¤§å€¼å·²ç»åˆ°è¾¾æœ«å°¾äº†ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¿…è¦å†å»éå†åˆ°æœ€åä¸€ä¸ªå€¼äº†ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(n) ","date":"2022-05-13","objectID":"/%E5%86%92%E6%B3%A1%E6%B3%95/:1:1","series":[],"tags":[],"title":"å†’æ³¡æ³•","uri":"/%E5%86%92%E6%B3%A1%E6%B3%95/"},{"categories":[],"content":"å†’æ³¡æ’åº åœ¨å†’æ³¡æ‰¾æå€¼çš„åŸºç¡€ä¸ŠåŠ å…¥å¾ªç¯ï¼Œä½¿æ•°ç»„æˆ–é›†åˆä»åå¾€å‰æ•°ä¾æ¬¡æ˜¯ï¼šæå€¼ã€æ¬¡æå€¼ã€æ¬¡æ¬¡æå€¼â€¦ private static int[] sort(int[] original, int k) { int[] newArray = Arrays.copyOf(original, original.length); int num1, num2; int i = 0; // å¤–å±‚å¾ªç¯æ§åˆ¶å†’æ³¡çš„è½®æ•° for (; i \u003c k - 1; i++) { //è®°å½•å†…å±‚æ˜¯å¦å‘ç”Ÿè¿‡äº¤æ¢ boolean flag = false; //å†…å±‚å¾ªç¯æ§åˆ¶å†’æ³¡çš„æ¬¡æ•° for (int j = 0; j \u003c newArray.length - 1 - i; j++) { num1 = newArray[j]; num2 = newArray[j + 1]; if (num1 \u003c num2) { newArray[j] = num2; newArray[j + 1] = num1; flag = false; } } // å¦‚æœå†…å±‚ä¸€è½®éå†ä¸‹æ¥ç¾èª‰å‘ç”Ÿè¿‡äº¤æ¢ï¼Œè¯´æ˜å·²ç»æ’åºå¥½äº†ï¼Œç›´æ¥è·³å‡ºå¤–å±‚å¾ªç¯ if (flag) { break; } } return newArray; } å¤–å±‚å¾ªç¯æ¯éå†ä¸€æ¬¡ï¼Œå†…å±‚å°±ä¼šæ‰¾å‡ºæå€¼æ”¾åˆ°æœ«å°¾ã€‚é‚£ä¹ˆå½“åªå‰©ä¸‹æœ€åä¸€ä¸ªå€¼æ—¶ï¼Œä»–è‡ªå·±å°±æ˜¯åæå€¼äº†ï¼Œæ²¡å¿…è¦å†è®©å†…å±‚å»éå†ä¸€è½®äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™å¤–å±‚å¾ªç¯æ¬¡æ•°å‡1. ä¸æŸ¥è¯¢æå€¼ç±»ä¼¼ï¼Œå†…å±‚å¾ªç¯ä¸ºäº†æé«˜æ•ˆç‡ä¹Ÿåº”è¯¥å‡1ã€‚ æ¯å½“å¤–å±‚å¾ªç¯ä¸€è½®ï¼Œéƒ½ä¼šæ‰¾å‡ºæå€¼æ”¾åˆ°æœ«å°¾ï¼Œé‚£ä¹ˆå†…å±‚åœ¨å†’æ³¡æ—¶ï¼Œå¯¹äºå·²ç»æ‰¾åˆ°çš„æå€¼å¹¶ä¸éœ€è¦å…³æ³¨äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡åº”è¯¥å†å‡å»å¤–å±‚å¾ªç¯çš„æ¬¡æ•°ã€‚ æœ€åæ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)ï¼› æœ€å¥½æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼› å†’æ³¡æ’åºç”±äºæ¯”è¾ƒå’Œäº¤æ¢ç›¸é‚»å…ƒç´ ï¼Œå…ƒç´ æ¯æ¬¡åªç§»åŠ¨ä¸€ä½ï¼Œæ‰€ä»¥éœ€è¦å¤šæ¬¡çš„å¾ªç¯éå†å’Œåˆ¤æ–­ï¼Œæ•ˆç‡éå¸¸ä½ã€‚ ","date":"2022-05-13","objectID":"/%E5%86%92%E6%B3%A1%E6%B3%95/:1:2","series":[],"tags":[],"title":"å†’æ³¡æ³•","uri":"/%E5%86%92%E6%B3%A1%E6%B3%95/"},{"categories":[],"content":"æ—¶é—´å¤æ‚åº¦åˆ†ææ³• ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:0","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"æ ¸å¿ƒæ€æƒ³ å¿½ç•¥æ‰å…¬å¼ä¸­çš„å¸¸é‡ã€ä½é˜¶ã€ç³»æ•°ï¼Œåªéœ€è¦è®°å½•ä¸€ä¸ªæœ€å¤§é˜¶çš„é‡çº§å°±å¯ä»¥äº†ã€‚ int cal(int n) { int sum = 0; int i = 1; for (; i \u003c= n; ++i) { sum = sum + i; } return sum; } 2ã€3è¡Œæ˜¯å¸¸é‡ï¼Œå¯ä»¥ç›´æ¥æ’é™¤ï¼Œæˆ‘ä»¬åªçœ‹å…¶ä¸­çš„forå¾ªç¯å°±å¯ä»¥äº†ã€‚ä¸Šé¢ä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯ï¼šO(n)ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:1","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"åµŒå¥—å¾ªç¯çš„åˆ†ææ³• int cal(int n) { int ret = 0; int i = 1; for (; i \u003c n; ++i) { ret = ret + f(i); } } int f(int n) { int sum = 0; int i = 1; for (; i \u003c n; ++i) { sum = sum + i; } return sum; } ä¸Šé¢çš„ä»£ç ï¼Œåœ¨cal()æ–¹æ³•é‡Œé¢å¾ªç¯è°ƒç”¨äº†f(),å¦‚æœæŠŠå‰è€…å¾ªç¯é‡Œé¢çš„éƒ¨åˆ†å½“ä½œå¸¸é‡ï¼Œé‚£ä¹ˆå‰è€…çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œè€Œåè€…çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œé‚£ä¹ˆæ€»å…±å°±æ˜¯O(n x n)ï¼Œä¹Ÿå°±æ˜¯O(nÂ²)ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:2","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"å¸¸è§çš„æ—¶é—´å¤æ‚åº¦ï¼ˆæ•°é‡çº§é€’å¢ï¼‰ å¤šé¡¹å¼é‡çº§ O(1)-å¸¸é‡é˜¶ O(n)-çº¿æ€§é˜¶ O(logâ¿)-å¯¹æ•°é˜¶ O(nlogâ¿)-çº¿æ€§å¯¹æ•°é˜¶ O(nÂ²)-å¹³æ–¹é˜¶ã€ç«‹æ–¹é˜¶â€¦kæ¬¡æ–¹é˜¶ éå¤šé¡¹å¼é‡çº§ O(2â¿)-æŒ‡æ•°é˜¶ O(n!)-é˜¶ä¹˜é˜¶ å½“æ•°æ®è§„æ¨¡nè¶Šæ¥è¶Šå¤§æ—¶ï¼Œéå¤šé¡¹å¼é‡çº§çš„æ‰§è¡Œæ—¶é—´ä¼šæ€¥å‰§å¢åŠ ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:3","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"å¯¹æ•°é˜¶ i = 1; while (i \u003c= n) { i = i * 2; } å˜é‡içš„å€¼ä»1å¼€å§‹ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šx2ï¼Œå®é™…ä¸Šå°±å½¢æˆäº†ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼š 2â° 2Â¹ 2Â² ... 2Ë£ = n è¿™ç§å½¢å¼å°±æ˜¯å¯¹æ•°é˜¶ï¼Œå› ä¸ºä»¥2ä¸ºåº•ï¼Œè®¡ä½œO(logâ‚‚n)ã€‚åˆç”±äºåº•å¯ä»¥å¿½ç•¥ï¼Œæ‰€ä»¥è®°ä¸ºO(logn)ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:4","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"å¤šæ•°é‡çº§ int cal(int m, int n) { int sum_1 = 0; int i = 1; for (; i \u003c m; ++i) { sum_1 = sum_1 + i; } int sum_2 = 0; int j = 1; for (; j \u003c n; ++j) { sum_2 = sum_2 + j; } return sum_1 + sum_2; } è¿™æ®µä»£ç å³æœ‰måˆæœ‰nï¼Œè¡¨ç¤ºä¸¤ä¸ªä¸åŒçš„æ•°æ®é‡çº§ï¼Œæˆ‘ä»¬æ— æ³•è¯„ä¼°è°çš„æ•°é‡çº§æ›´å¤§ï¼Œæ‰€ä»¥ä¸¤ä¸ªéƒ½è¦è€ƒè™‘åœ¨å†…ï¼Œè®°ä½œO(m + n)ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:1:5","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"ç©ºé—´å¤æ‚åº¦ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:2:0","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"æ ¸å¿ƒæ€æƒ³ æ’é™¤å¸¸é‡ã€ç³»æ•°å’Œè¿ç®—ï¼Œåªè®°å½•æœ€å¤§ç©ºé—´å ç”¨ã€‚ void print(int n) { int i = 0; int[] a = new int[n]; for (i; i \u003cn; ++i) { a[i] = i * i; } for (i = n-1; i \u003e= 0; --i) { print out a[i] } } ç¬¬äºŒè¡Œä»£ç ç”³è¯·äº†ä¸€ä¸ªç©ºé—´ç”¨æ¥å‚¨å­˜å˜é‡iï¼Œä½†ç”±äºæ˜¯å¸¸é‡é˜¶ï¼Œå¯ä»¥å¿½ç•¥ã€‚ ç¬¬ä¸‰è¡Œä»£ç ç”³è¯·äº†nä¸ªç©ºé—´ã€‚ åç»­ä»£ç æ²¡æœ‰å†ç»§ç»­ç”³è¯·ç©ºé—´ã€‚ æ‰€ä»¥ç©ºé—´å¤æ‚åº¦å°±æ˜¯O(n)ã€‚ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:2:1","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"å¸¸è§ç©ºé—´å¤æ‚åº¦ O(1)-å¸¸é‡é˜¶ O(n)-çº¿æ€§é˜¶ O(nÂ²)-å¹³æ–¹é˜¶ ","date":"2022-05-12","objectID":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/:2:2","series":[],"tags":[],"title":"æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦","uri":"/%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/"},{"categories":[],"content":"ä¸€ä¸ªæ— é™å¤§çš„æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å‡½å¤§é‡çš„æ•°æ®ï¼Œéœ€æ±‚æ˜¯ä»ä¸­å–å‡ºtop50ã€‚ ","date":"2022-05-12","objectID":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/:0:0","series":[],"tags":[],"title":"å¤§æ•°æ®é‡å–top","uri":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/"},{"categories":[],"content":"å…ˆè¯´ç‚¹åºŸè¯å§ è¿™æ˜¯ç°åœ¨é¢è¯•é—®çš„TMçš„æœ€å¤šçš„é—®é¢˜ï¼Œè§£ç­”æ—¶å¾€å¾€è¿˜ä¸è®©ç”¨ideã€‚æˆ‘å°±åœ¨æƒ³ç°åœ¨éƒ½å·æˆä»€ä¹ˆæ ·äº†ï¼Œè¿™ç§é‡çº§çš„æ•°æ®æ€ä¹ˆèƒ½æ‹¿åˆ°ç§»åŠ¨ç«¯æ¥åšå‘¢ï¼Œè€…é¢è¯•é¢˜æ˜æ˜¾æ˜¯ä»æœåŠ¡ç«¯æŠ„è¿‡æ¥çš„ï¼Œç”¨æ¥è€ƒæ ¸ç§»åŠ¨ç«¯çš„èƒ½åŠ›æœ‰ä»€ä¹ˆç”¨ï¼Ÿé—®è¿™ç§é—®é¢˜çš„é¢è¯•å®˜ç”¨æ„ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå…¶ç›®çš„æ ¹æœ¬ä¸åœ¨äºè€ƒå¯Ÿé¢è¯•è€…çš„å®é™…ä¸šåŠ¡æ°´å¹³ï¼Œè€Œæ˜¯ä»…ä»…ä¸ºäº†çœ‹ä½ æœ‰æ²¡æœ‰åˆ·è¿‡é¢˜ï¼Œæ¯”å¦‚ç©è¿‡leetCodeï¼Œæ‰€ä»¥ä»–ä»¬æœ€åæ‹›åˆ°çš„æœ€å¤šä¹Ÿå°±æ˜¯ç†è®ºå®¶ï¼Œè¿™ç§äººæˆ‘éƒ½ä¸ä¿¡ä»–æœ‰ä»€ä¹ˆè§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚ ","date":"2022-05-12","objectID":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/:1:0","series":[],"tags":[],"title":"å¤§æ•°æ®é‡å–top","uri":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/"},{"categories":[],"content":"è§£ç­”æ–¹æ¡ˆ ","date":"2022-05-12","objectID":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/:2:0","series":[],"tags":[],"title":"å¤§æ•°æ®é‡å–top","uri":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/"},{"categories":[],"content":"æ–¹æ¡ˆä¸€ï¼šå…¨æ’åº å¦‚æœä¸è€ƒè™‘å†…å­˜çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨å¿«é€Ÿæ’åºæ³•å¯¹æ•´ä¸ªæ–‡ä»¶åšå…¨æ’åºï¼Œç„¶åå–top50ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ","date":"2022-05-12","objectID":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/:2:1","series":[],"tags":[],"title":"å¤§æ•°æ®é‡å–top","uri":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/"},{"categories":[],"content":"æ–¹æ¡ˆäºŒï¼š","date":"2022-05-12","objectID":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/:2:2","series":[],"tags":[],"title":"å¤§æ•°æ®é‡å–top","uri":"/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%8F%96top/"},{"categories":[],"content":"å¼‚å¸¸çš„æ•è· å¯ä»¥ä½¿ç”¨try-catchæ•è·åŒæ­¥å¼‚å¸¸ï¼Œä½¿ç”¨catchERRORæ•è·å¼‚æ­¥ä»£ç çš„å¼‚å¸¸ã€‚ ","date":"2022-04-20","objectID":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/:1:0","series":[],"tags":[],"title":"Flutterå¼‚å¸¸ç›‘æ§","uri":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"æœªæ•è·å¼‚å¸¸ å¯ä»¥åœ¨mainå‡½æ•°ä¸­é‡å†™FlutterError.onErrorå‡½æ•°è®¾ç½®é»˜è®¤çš„æœªæ•è·å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚ void main(){ Flutter.Error.onError = (detail){ // å¼‚å¸¸å¤„ç† }; runApp(MyApp()); } ","date":"2022-04-20","objectID":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/:2:0","series":[],"tags":[],"title":"Flutterå¼‚å¸¸ç›‘æ§","uri":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"æ•è·Futureçš„å¼‚å¸¸ å¯ä»¥ä½¿ç”¨zone,zoneè¡¨ç¤ºä¸€ä¸ªä»£ç æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œç»™å¼‚æ­¥ä»£ç æä¾›äº†ä¸€ä¸ªç¨³å®šçš„è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ²™ç›’ï¼š void main(){ runZone((){ runApp(MyApp()); },onError(error,stackTrace){ // å¼‚å¸¸å¤„ç† }); } ","date":"2022-04-20","objectID":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/:3:0","series":[],"tags":[],"title":"Flutterå¼‚å¸¸ç›‘æ§","uri":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"çº¢ç™½å±æ•è· å¯ä»¥åœ¨mainå‡½æ•°ä¸­é‡å†™ErrorWidgetBuilderï¼š void performRebuild() { ... try { ... } catch (e, stack) { // ErrorWidget.builderå›è°ƒæ–¹æ³•æ›¿æ¢é”™è¯¯é¡µé¢ built = ErrorWidget.builder( _debugReportException( ErrorDescription('building $this'), e, stack, informationCollector: () sync* { yield DiagnosticsDebugCreator(DebugCreator(this)); }, ), ); } ... } //é»˜è®¤çš„å¤„ç†æ–¹å¼,æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨mainä¸­è¦†ç›–å¤„ç† static ErrorWidgetBuilder builder = _defaultErrorWidgetBuilder; ","date":"2022-04-20","objectID":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/:4:0","series":[],"tags":[],"title":"Flutterå¼‚å¸¸ç›‘æ§","uri":"/flutter%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"ç”µé‡ä¼˜åŒ– ä¼˜åŒ–ä»£ç ï¼Œå‡å°‘ä¸å¿…è¦çš„æ“ä½œï¼Œæˆ–è€…åˆå¹¶æ“ä½œï¼Œå‡å°‘è®¾å¤‡æ´»è·ƒæ—¶é—´ï¼Œæ¯”å¦‚ä¸€æ¬¡æ€§çš„è¯·æ±‚ç½‘ç»œæ•°æ®ï¼Œä¸€æ¬¡æ€§çš„IOã€‚ å»¶è¿Ÿæ“ä½œï¼Œé€šè¿‡ç›‘å¬ç³»ç»Ÿå¹¿æ’­ã€WorkManagerç­‰æ–¹å¼ç›‘å¬è®¾å¤‡å……æ»¡ç”µä¹‹åå†æäº‹æƒ…ã€‚ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:1:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"ç½‘ç»œä¼˜åŒ– ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œé¿å…æ¼«é•¿çš„DNSè§£æè¿‡ç¨‹ è¿æ¥å¤ç”¨ï¼Œé¿å…å¤šæ¬¡å»ºç«‹è¿æ¥ï¼ˆokHttpè‡ªå¸¦çš„keep-aliveå’Œå¤šè·¯å¤ç”¨ï¼‰ å¯¹æ•°æ®å‹ç¼©å¤„ç†ï¼ˆgzipï¼‰ é‡‡ç”¨jsonï¼Œprotobufï¼Œç”šè‡³graphQLå‡å°‘æ•°æ®ä½“ç§¯å’Œä¼ è¾“é¢‘æ¬¡ æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œé¿å…é¢‘ç¹è¯·æ±‚æ¥å£ è¯†åˆ«è®¾å¤‡ç½‘ç»œçŠ¶æ€ï¼Œåœ¨2/3/4Gæµé‡çŠ¶æ€ä¸‹ä¼ è¾“ä½æ¸…å›¾ç‰‡ ä½¿ç”¨webPæ ¼å¼å›¾ç‰‡ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:2:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"UIå¡é¡¿ä¼˜åŒ– ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:3:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"layoutåŠ è½½é—®é¢˜ æ­£å¸¸çš„æµç¨‹æ˜¯åœ¨ä¸»çº¿ç¨‹å…ˆIOè¯»å–å¹¶é€’å½’è§£æä¸€ä¸ªxmlæ–‡ä»¶ï¼Œå†é€šè¿‡åå°„åˆ›å»ºViewå¯¹è±¡ï¼Œæ•ˆç‡å¾ˆä½ï¼Œé‡åˆ°å¤æ‚çš„layoutï¼Œç”šè‡³å¯èƒ½å¼•å‘ANRã€‚ ä½¿ç”¨çº¦æŸå¸ƒå±€ï¼Œå‡å°‘å¸ƒå±€åµŒå¥—ï¼Œå‡å°‘é€’å½’ï¼› ä½¿ç”¨AsyncLayoutInflaterå¼‚æ­¥åŠ è½½ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼› ä½¿ç”¨æ³¨è§£å¤„ç†å™¨+javaPoetåœ¨ç¼–è¯‘æ—¶ç”ŸæˆViewæ–‡ä»¶ã€‚ï¼ˆæŒé˜…x2cåŸç†ï¼‰ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:3:1","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"é‡å¤ç»˜åˆ¶é—®é¢˜ ä½¿ç”¨çº¦æŸå¸ƒå±€ï¼Œå‡å°‘å¸ƒå±€åµŒå¥— å»é™¤çœ‹ä¸è§çš„èƒŒæ™¯å›¾ç‰‡ å‡å°‘alphaçš„ä½¿ç”¨ï¼Œä½¿ç”¨alphaä¼šå¯¼è‡´Viewç»˜åˆ¶ä¸¤æ¬¡ï¼Œå¯ä½¿ç”¨ARGBè‰²å€¼æ›¿ä»£ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:3:2","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"å¡é¡¿é—®é¢˜ è‡ªå®šä¹‰Viewçš„onDrawä¼˜åŒ– å†…å­˜æŠ–åŠ¨é¢‘ç¹GC ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:3:3","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"æ’æŸ¥å·¥å…· Systrace profile adb ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:3:4","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"apkä½“ç§¯ä¼˜åŒ– lintæ£€æŸ¥æ— æ•ˆèµ„æº æ··æ·†minifyEnabled èµ„æºæ’é™¤ å›¾ç‰‡å‹ç¼©ï¼ŒwebPï¼ŒVectorDrawable ä½¿ç”¨tintå‰å°æ”¹è‰²å¤ç”¨å›¾ç‰‡ æŒ‡å®šæœ¬åœ°åŒ–è¯­è¨€ æŒ‡å®šNDK æœ¬åœ°åº“å‹ç¼©ï¼Œåœ¨manifastæ–‡ä»¶ä¸­ä¸ºapplicationæŒ‡å®šandroid:extractNativeLibs = true ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:4:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"å†…å­˜ä¼˜åŒ– ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:5:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"æ•°æ®ç»“æ„ä¼˜åŒ– ArrayList åˆå§‹åŒ–é•¿åº¦å®šä½0ï¼Œé¿å…ç¬¬ä¸€æ¬¡addæ—¶æ‰©å®¹ï¼Œç©ºé—´æ¢æ—¶é—´ å¢åˆ æ—¶ä½¿ç”¨LinkedListï¼ŒæŸ¥è¯¢æ—¶è½¬æ¢æˆArrayList é¿å…åœ¨ä¸­é—´æ’å…¥å’Œç§»é™¤ï¼Œè¿™æ ·ä¼šéå†æ”¹å˜ä¸‹æ ‡ï¼Œéå¸¸è€—æ—¶ï¼Œå¯ä»¥ä»æœ«å°¾æ“ä½œ ä½¿ç”¨HashMapæ›¿ä»£ï¼ŒHashMapå¢åˆ å¿«ï¼ŒæŸ¥è¯¢å¿« HashMap é¢„ä¼°é•¿åº¦é¿å…æ‰©å®¹ é•¿åº¦ä¸º2çš„æ•´æ•°å€ï¼Œé¿å…å“ˆå¸Œå†²çª ä½¿ç”¨SpaceArrayæ›¿ä»£ï¼Œå…¶æ ¸å¿ƒæ˜¯äºŒç»´æ•°ç»„ï¼Œå¹¶é‡‡ç”¨äºŒåˆ†æ³•æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:5:1","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"å´©æºƒç›‘æ§ Thread.setDefaultUnCauthExceptionHandler linuxé”™è¯¯ä¿¡å· ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:6:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"ANRç›‘æ§ é€šè¿‡ç›‘å¬linuxé”™è¯¯ä¿¡å·ï¼Œç»åˆ¤æ–­æ‰¾å‡ºANRé”™è¯¯ï¼Œç„¶åä¸ŠæŠ¥ã€‚ ","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:7:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"å®‰å…¨æ€§ç›¸å…³ä¼˜åŒ–","date":"2022-04-19","objectID":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/:8:0","series":[],"tags":[],"title":"æ€§èƒ½ä¼˜åŒ–æ€»è§ˆ","uri":"/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%80%BB%E8%A7%88/"},{"categories":[],"content":"å‘é€å¹¿æ’­ ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:1:0","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"æ™®é€šå¹¿æ’­ï¼ˆæ— åºï¼‰ å®Œå…¨å¼‚æ­¥æ‰§è¡Œï¼Œæ— åºã€‚å‘å‡ºä¹‹åï¼Œæ‰€æœ‰å¹¿æ’­æ¥æ”¶å™¨éƒ½å¯æ¥æ”¶åˆ°ï¼Œæ— æ³•è¢«æ‹¦æˆªã€‚ //intentä¸­çš„å‚æ•°ä¸ºaction Intent intent = new Intent(\"com.example.dimple.BROADCAST_TEST\"); sendBroadcast(intent); ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:1:1","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"æœ‰åºå¹¿æ’­ åŒæ­¥æ‰§è¡Œï¼Œæœ‰åºã€‚å‘å‡ºä¹‹åï¼Œå¹¿æ’­æ¥æ”¶å™¨æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºæ¥æ”¶ï¼Œå¹¶å¯æ‹¦æˆªæ‰å¹¿æ’­ï¼Œç±»ä¼¼Viewäº‹ä»¶åˆ†å‘æœºåˆ¶ã€‚ //intentä¸­çš„å‚æ•°ä¸ºaction Intent intent = new Intent(\"com.example.dimple.BROADCAST_TEST\"); sendOrderBroadcast(intentï¼Œnull);//ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸æƒé™ç›¸å…³çš„å­—ç¬¦ä¸²ã€‚ è®¾ç½®å¹¿æ’­æ¥æ”¶å™¨çš„ä¼˜å…ˆçº§ï¼š \u003creceiver android:name=\".MyReceiver\" android:enabled=\"true\" android:exported=\"true\"\u003e \u003c!--æ³¨æ„æ­¤æ—¶æœ‰ä¸€ä¸ªPriorityå±æ€§--\u003e \u003cintent-filter android:priority=\"100\"\u003e \u003caction android:name=\"android.intent.action.BROADCAST_TEST\"\u003e\u003c/action\u003e \u003c/intent-filter\u003e \u003c/receiver\u003e ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:1:2","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"å¹¿æ’­æ¥æ”¶å™¨ ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:2:0","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"åŠ¨æ€æ³¨å†Œ è‡ªå®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿BroadcastReceiverã€‚ MyBroadcastReceiver myBroadcastReceiver = new MyBroadcastReceiver(); IntentFilter intentFilter = new IntentFilter(); intentFilter.addAction(\"com.example.dimple.MY_BROADCAST\"); registerReceiver(myBroadcastReceiver,intentFilter); Activityå…³é—­æ—¶è¦å–æ¶ˆæ³¨å†Œï¼š @Override protected void onDestroy() { super.onDestroy(); unregisterReceiver(myBroadcastReceiver); } å¦‚æœéœ€è¦æ¥æ”¶ç³»ç»Ÿçš„å¹¿æ’­ï¼ˆæ¯”å¦‚ç”µé‡å˜åŒ–ï¼Œç½‘ç»œå˜åŒ–ç­‰ç­‰ï¼‰ï¼Œåˆ«å¿˜è®°åœ¨AndroidManifesté…ç½®æ–‡ä»¶ä¸­åŠ ä¸Šæƒé™ã€‚ ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:2:1","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"é™æ€æ³¨å†Œ ä¹Ÿæ˜¯è‡ªå®šä¹‰ä¸€ä¸ª ç„¶åä¸éœ€è¦åœ¨ä»£ç ä¸­æ³¨å†Œï¼Œç›´æ¥åœ¨ä¸­æ³¨å†Œå³å¯ï¼š \u003creceiver android:name=\".MyReceiver\" android:enabled=\"true\" android:exported=\"true\"\u003e \u003c!--æ·»åŠ action--\u003e \u003cintent-filter\u003e \u003caction android:name=\"android.intent.action.BOOT_COMPLETED\" /\u003e \u003c/intent-filter\u003e \u003c/receiver\u003e ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:2:2","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"ä¸¤ç§æ–¹å¼çš„åŒºåˆ« åŠ¨æ€æ³¨å†Œï¼Œä¸Activityç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œæ‰€ä»¥åªèƒ½åœ¨Activityå¯åŠ¨åæ‰èƒ½æ¥æ”¶å¹¿æ’­ï¼Œå¹¶ä¸”éœ€è¦æ‰‹åŠ¨å–æ¶ˆæ³¨å†Œã€‚ é™æ€æ³¨å†Œçš„å¹¿æ’­ä¸å—ç¨‹åºæ˜¯å¦å¯åŠ¨çš„çº¦æŸï¼Œå½“åº”ç”¨ç¨‹åºå…³é—­ä¹‹åï¼Œè¿˜æ˜¯å¯ä»¥æ¥æ”¶åˆ°å¹¿æ’­ï¼Œé€‚åˆç›‘å¬ç³»ç»Ÿå¹¿æ’­ï¼Œç”šè‡³å¯ä»¥åœ¨æ”¶åˆ°å¹¿æ’­åæ‹‰èµ·åº”ç”¨ï¼ˆåœ¨åç»­ç‰ˆæœ¬ä¸­å–æ¶ˆäº†ï¼‰ã€‚ ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:2:3","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"æœ¬åœ°å¹¿æ’­ ä¸€èˆ¬æˆ‘ä»¬å‘é€çš„å¹¿æ’­éƒ½æ˜¯åŸºäºintentçš„actionè¿‡æ»¤å®ç°çš„ï¼Œåœ¨ç³»ç»Ÿä¸­æ˜¯å…¨å±€çš„ï¼Œä¼šå¼•å‘å®‰å…¨æ€§é—®é¢˜ï¼Œå®‰å“è¿˜æä¾›äº†ä¸€å¥—æœ¬åœ°å¹¿æ’­çš„æœºåˆ¶ï¼Œå°±æ˜¯ä¾é LocalBroadcastManagerã€‚ class MainActivity : AppCompatActivity() { private val localBroadcastReceiver = MyReceiver() private lateinit var lcalBroadcastManager: LocalBroadcastManager private val action = \"com.vee.intentservicetest.local_broadcast_receiver\" override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_main) // åˆå§‹åŒ–LocalBroadcastManager lcalBroadcastManager = LocalBroadcastManager.getInstance(this) // æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨ lcalBroadcastManager.registerReceiver(localBroadcastReceiver, IntentFilter(action)) // å‘é€å¹¿æ’­ lcalBroadcastManager.sendBroadcast(Intent(action)) } override fun onDestroy() { super.onDestroy() //åˆ«å¿˜äº†å–æ¶ˆæ³¨å†Œ lcalBroadcastManager.unregisterReceiver(localBroadcastReceiver) } } /** * è‡ªå®šä¹‰çš„å¹¿æ’­æ¥æ”¶å™¨ */ class MyReceiver : BroadcastReceiver() { override fun onReceive(context: Context?, intent: Intent?) { TODO(\"Not yet implemented\") } } ","date":"2022-03-28","objectID":"/%E5%B9%BF%E6%92%AD/:3:0","series":[],"tags":[],"title":"å¹¿æ’­","uri":"/%E5%B9%BF%E6%92%AD/"},{"categories":[],"content":"é¢è¯•é¢˜ï¼šåœºæ™¯éœ€è¦åœ¨å­çº¿ç¨‹ä¸­ä¾æ¬¡æ‰§è¡Œå¤šä¸ªå­ä»»åŠ¡ï¼Œè¦ä¿è¯ä»»åŠ¡æ—¶åºï¼Œæ‰€æœ‰å­ä»»åŠ¡æ‰§è¡Œå®Œæ¯•è¯¥çº¿ç¨‹è‡ªåŠ¨é€€å‡ºï¼Œæ€ä¹ˆå®ç°ï¼Ÿ IntentServiceæ‰©å±•è‡ªServiceï¼Œæ˜¯Serviceå’ŒHandlerThreadçš„ç»“åˆä½“ï¼Œå¤©ç”Ÿå°±åœ¨è‡ªçº¿ç¨‹ä¸­ï¼Œä¸”å®Œæˆä»»åŠ¡åè‡ªåŠ¨åœæ­¢ï¼Œé€‚åˆå¤„ç†è‡ªçº¿ç¨‹è€—æ—¶ä»»åŠ¡ã€‚å¦‚æœå¤šæ¬¡å¯åŠ¨IntentServiceï¼Œåˆ™æ¯ä¸€ä¸ªä»»åŠ¡ä¼šä»¥é˜Ÿåˆ—çš„æ–¹å¼åœ¨onHandlerIntentæ–¹æ³•ä¸­ä¾æ¬¡æ‰§è¡Œã€‚ ","date":"2022-03-28","objectID":"/intentservice/:0:0","series":[],"tags":[],"title":"IntentService","uri":"/intentservice/"},{"categories":[],"content":"åŸç† public abstract class IntentService extends Service { private volatile Looper mServiceLooper; @UnsupportedAppUsage private volatile ServiceHandler mServiceHandler; private String mName; // å­çº¿ç¨‹Handler private final class ServiceHandler extends Handler { public ServiceHandler(Looper looper) { super(looper); } @Override public void handleMessage(Message msg) { //æ”¶åˆ°æ¶ˆæ¯åè°ƒç”¨onHandleIntentæ–¹æ³• onHandleIntent((Intent)msg.obj); //ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åå…³é—­è‡ªå·±ï¼Œæ³¨æ„è¿™é‡Œçš„å‚æ•° stopSelf(msg.arg1); } } /** * æ„é€ æ–¹æ³•éœ€è¦ä¼ é€’çº¿ç¨‹åç§° */ public IntentService(String name) { super(); mName = name; } @Override public void onCreate() { // åˆå§‹åŒ–ä¸€ä¸ªHandlerThread HandlerThread thread = new HandlerThread(\"IntentService[\" + mName + \"]\"); thread.start(); mServiceLooper = thread.getLooper(); // ç”¨å­çº¿ç¨‹çš„Looperåˆå§‹åŒ–äº†å­çº¿ç¨‹çš„Handler mServiceHandler = new ServiceHandler(mServiceLooper); } /** * ç›´æ¥è°ƒç”¨onStartæ–¹æ³• */ @Override public int onStartCommand(@Nullable Intent intent, int flags, int startId) { onStart(intent, startId); return mRedelivery ? START_REDELIVER_INTENT : START_NOT_STICKY; } /** * ä¸»è¦æ˜¯æŠŠä»»åŠ¡å°è£…æˆæ¶ˆæ¯ï¼Œå‘é€ç»™å­çº¿ç¨‹å¤„ç† */ @Override public void onStart(@Nullable Intent intent, int startId) { Message msg = mServiceHandler.obtainMessage(); msg.arg1 = startId; msg.obj = intent; mServiceHandler.sendMessage(msg); } /** * é€€å‡ºæ—¶å…³é—­å­çº¿ç¨‹Looperï¼Œä½¿çº¿ç¨‹ç»ˆæ­¢ */ @Override public void onDestroy() { mServiceLooper.quit(); } /** * ä¸€èˆ¬ä¸éœ€è¦ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é‡å†™å®ç° */ @Override @Nullable public IBinder onBind(Intent intent) { return null; } /** * æˆ‘ä»¬éœ€è¦é‡å†™è¿™ä¸ªæ–¹æ³•å»å®ç°ä¸šåŠ¡é€»è¾‘ */ @WorkerThread protected abstract void onHandleIntent(@Nullable Intent intent); } åŸç†å¾ˆç®€å•ï¼š åœ¨åˆ›å»ºserviceæ—¶ï¼ŒonCreateæ–¹æ³•æ˜¯å¿…é¡»åªè°ƒç”¨ä¸€æ¬¡çš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œåˆå§‹åŒ–äº†ä¸€ä¸ªHandlerThreadå’Œå½’å±äºä»–çš„Handlerã€‚ å½“æˆ‘ä»¬åœ¨activityä¸­æ¯æ¬¡è°ƒç”¨startService()ï¼Œä¼šå›è°ƒserviceçš„onStartCommand()æ–¹æ³•ï¼Œåœ¨å…¶ä¸­è°ƒç”¨äº†onStart()ï¼ŒæŠŠintentå°è£…æˆæ¶ˆæ¯å‘é€ç»™å­çº¿ç¨‹ã€‚ç”±äºæ¶ˆæ¯æ²¡æœ‰whenå‚æ•°é™åˆ¶å»¶è¿Ÿæ—¶é—´ï¼Œæ‰€ä»¥æ¶ˆæ¯åœ¨MessageQueueä¸­æ˜¯æŒ‰ç…§FIFO(å…ˆè¿›åå‡º)çš„é¡ºåºæ’åˆ—çš„ã€‚ å½“æ¶ˆæ¯ç»è¿‡Looperä¼ é€’åˆ°Handlerçš„HandlerMessage()æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨onHandleIntent()æ–¹æ³•ç”±æˆ‘ä»¬è‡ªå·±å»å¤„ç†ã€‚å¤„ç†å®Œä¹‹åä¼šå°è¯•é”€æ¯serviceã€‚ åœ¨é”€æ¯serviceæ—¶ä¼ é€’äº†startIDï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šæ£€æŸ¥serviceä¸­æ˜¯å¦è¿˜æœ‰å…¶ä»–çš„startIDï¼Œå¦‚æœæœ‰çš„è¯å°±ä¸ä¼šé€€å‡ºï¼Œå¥½è®©å‰©ä½™çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¼šé”€æ¯Service. ","date":"2022-03-28","objectID":"/intentservice/:1:0","series":[],"tags":[],"title":"IntentService","uri":"/intentservice/"},{"categories":[],"content":"startServiceçš„ç”Ÿå‘½å‘¨æœŸ onCreate onStartCommant onDestroy fun start(v: View) { Intent(this, MyService::class.java).run { startService(this) } } fun stop(v: View) { Intent(this, MyService::class.java).run { stopService(this) } // or åœ¨serviceä¸­è°ƒç”¨stopSelf() } è¿™ç§æ–¹å¼åˆ›å»ºServiceï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨startServiceï¼Œå¹¶ä¸”onStartCommantæ–¹æ³•ä¹Ÿä¼šéšä¹‹å›è°ƒï¼Œä½†æ˜¯onCreateåªä¼šå›è°ƒä¸€æ¬¡ã€‚ å¯ä»¥é€šè¿‡Intentå‘serviceä¼ é€’ä¿¡æ¯ã€‚ å½“ä¸éœ€è¦serviceä¸éœ€è¦ç»§ç»­è¿è¡Œæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å…³é—­ã€‚ ","date":"2022-03-28","objectID":"/service%E7%9A%84%E4%BD%BF%E7%94%A8/:1:0","series":[],"tags":[],"title":"Serviceçš„ä½¿ç”¨","uri":"/service%E7%9A%84%E4%BD%BF%E7%94%A8/"},{"categories":[],"content":"bindServiceçš„ç”Ÿå‘½å‘¨æœŸ onCreate onBind onDestroy Activityä»£ç ï¼š private lateinit var service: MyService /** * è‡ªå®šä¹‰ä¸€ä¸ªè¿æ¥ï¼Œç”¨æ¥è·å–serviceå¯¹è±¡ */ private val conn = object : ServiceConnection { override fun onServiceConnected(name: ComponentName?, binder: IBinder) { // è·å–service val myBinder = (binder as MyService.MyBinder) //è°ƒç”¨ä¸šåŠ¡æ–¹æ³• myBinder.startDownload.invoke() } override fun onServiceDisconnected(name: ComponentName?) { // å½“Serviceæœªæ­£å¸¸é€€å‡ºï¼Œè€Œæ˜¯å› ä¸ºå…¶ä»–åŸå› é€€å‡ºæ—¶å›è°ƒ } } fun bind(v: View) { Intent(this, MyService::class.java).run { bindService(this, conn, BIND_AUTO_CREATE) } } fun unbind(v: View) { Intent(this, MyService::class.java).run { unbindService(conn) } } Serviceä»£ç ï¼š class MyService : Service() { /** * é¢„ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„binder **/ private val mBinder = MyBinder { startDownload() } override fun onCreate() { Log.d(TAG, \"onCreate: \") super.onCreate() } override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int { Log.d(TAG, \"onStartCommand: \") return super.onStartCommand(intent, flags, startId) } override fun onBind(intent: Intent): IBinder { // è¿”å›è‡ªå®šä¹‰çš„binder return mBinder } override fun onDestroy() { Log.d(TAG, \"onDestroy: \") super.onDestroy() } /** * Activityå¯ä»¥ç›´æ¥é€šè¿‡serviceå¯¹è±¡è°ƒç”¨ä¸šåŠ¡æ–¹æ³• */ private fun startDownload() { //å¤„ç†ä¸‹è½½ä»»åŠ¡ï¼Œå®Œæˆåé€šçŸ¥Activityåˆ·æ–°UI mBinder.callback?.refreshUI() } /** * è‡ªå®šä¹‰ä¸€ä¸ªBinderå†…éƒ¨ç±» * é€šè¿‡ä¼ é€’å‡½æ•°å‚æ•°ï¼Œå®ç°Activityç›´æ¥é€šè¿‡binderè°ƒç”¨serviceçš„å†…éƒ¨æ–¹æ³• */ inner class MyBinder(val startDownload: () -\u003e Unit) : Binder() { var callback: MyBinderCallback? = null } } interface MyBinderCallback { fun refreshUI() } é€šè¿‡bindServiceæ–¹æ³•ç»‘å®šserviceï¼Œå¯ä»¥ä½¿ç”¨BIND_AUTO_CREATEè¿™ä¸ªflagè‡ªåŠ¨åˆ›å»ºserviceï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç»‘å®šåˆ°startServiceæ–¹æ³•åˆ›å»ºçš„serviceä¹‹ä¸Šã€‚ å½“ä¸å†éœ€è¦serviceç»§ç»­æ‰§è¡Œæ—¶ï¼ˆä¾‹å¦‚Activityé€€å‡ºå‰ï¼‰ï¼Œå¿…é¡»è°ƒç”¨unbindServiceè¿›è¡Œè§£ç»‘ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ å½“å¤šä¸ªé¡µé¢éƒ½ç»‘å®šåˆ°åŒä¸€ä¸ªserviceï¼Œå•ä¸ªé¡µé¢çš„è§£ç»‘ä¸ä¼šå½±å“serviceã€‚ å½“æ²¡æœ‰é¡µé¢ç»§ç»­ç»‘å®šæ—¶ï¼Œserviceä¼šè‡ªåŠ¨é”€æ¯ã€‚ å½“é€šè¿‡startServiceåˆ›å»ºäº†serviceï¼Œå¹¶ä¸”æœ‰å…¶ä»–activityåˆé€šè¿‡bindServiceç»‘å®šåˆ°äº†serviceï¼Œé‚£ä¹ˆåªæœ‰unbindServiceå’ŒstopServiceéƒ½è°ƒç”¨ä¹‹åï¼Œæ‰ä¼šé”€æ¯serviceã€‚ ","date":"2022-03-28","objectID":"/service%E7%9A%84%E4%BD%BF%E7%94%A8/:2:0","series":[],"tags":[],"title":"Serviceçš„ä½¿ç”¨","uri":"/service%E7%9A%84%E4%BD%BF%E7%94%A8/"},{"categories":["è¶£å‘³é¢˜"],"content":"å‡è®¾æœ‰ä¸ªå•å‘é“¾ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“é•¿åº¦ï¼Œè¦æ±‚æ‰¾åˆ°å€’æ•°çš„ç¬¬Nä¸ªèŠ‚ç‚¹ã€‚ ","date":"2022-03-24","objectID":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/:0:0","series":[],"tags":[],"title":"å•å‘é“¾æ‰¾å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹","uri":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/"},{"categories":["è¶£å‘³é¢˜"],"content":"è§£é¢˜æ€è·¯ ç”¨å¸¸è§„çš„æ•°å­¦æ€è·¯å»è§£æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨é€»è¾‘æ€è·¯å»è§£ã€‚ é¦–å…ˆï¼Œæ—¢ç„¶æ˜¯å•å‘é“¾ï¼Œè‚¯å®šæœ‰å¤´æœ‰å°¾ï¼Œå°±åƒä¸€ä¸ªè½¨é“ä¸€æ ·æœ‰èµ·æœ‰ç»ˆã€‚é‚£ä¹ˆå‡è®¾æˆ‘ä»¬æœ‰ä¸€åˆ—ç«è½¦çš„é•¿åº¦å°±æ˜¯Nï¼Œå½“ç«è½¦é©¶åˆ°ç»ˆç‚¹æ—¶ï¼Œè½¦ä½çš„ä½ç½®ä¸å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä½ç½®å—ï¼Ÿ ","date":"2022-03-24","objectID":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/:1:0","series":[],"tags":[],"title":"å•å‘é“¾æ‰¾å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹","uri":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/"},{"categories":["è¶£å‘³é¢˜"],"content":"ä»£ç å®æ“ /** * æœ‰ä¸ªä¸çŸ¥é“é•¿åº¦çš„å•å‘é“¾nodeï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°å…¶å€’æ•°ç¬¬numä¸ªèŠ‚ç‚¹è¿”å› * @param num * @return */ private static Node findNode(int num) { //å®šä¹‰å¤´å°¾æŒ‡é’ˆ Node nodeHead = node; Node nodeTail = node; //è®©å¤´å…ˆèµ°numæ­¥ for (int i = 0; i \u003c num - 1; i++) { nodeHead = nodeHead.next; } //å¤´å°¾ä¸€èµ·ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œç›´åˆ°å¤´è§¦åº• while (nodeHead.next != null) { nodeTail = nodeTail.next; nodeHead = nodeHead.next; } //è¿”å›å°¾ï¼Œæ­¤æ—¶å°¾æŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„numèŠ‚ç‚¹ return nodeTail; } ","date":"2022-03-24","objectID":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/:2:0","series":[],"tags":[],"title":"å•å‘é“¾æ‰¾å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹","uri":"/%E5%8D%95%E5%90%91%E9%93%BE%E6%89%BE%E5%80%92%E6%95%B0%E7%AC%ACn%E4%B8%AA%E8%8A%82%E7%82%B9/"},{"categories":[],"content":"ä¼ªèŒƒå‹å’ŒèŒƒå‹æ“¦é™¤ åœ¨ç¼–è¯‘æœŸé—´ï¼Œæ‰€æœ‰çš„èŒƒå‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦é™¤æ‰ã€‚ Javaä¸­çš„èŒƒå‹æ˜¯åœ¨ç¼–è¯‘å™¨è¿™ä¸ªå±‚æ¬¡æ¥å®ç°çš„ï¼Œåœ¨ç”ŸæˆJavaå­—èŠ‚ç ä¸­æ˜¯ä¸åŒ…å«èŒƒå‹ä¸­çš„ç±»å‹ä¿¡æ¯çš„ï¼Œä½¿ç”¨èŒƒå‹çš„æ—¶å€™åŠ ä¸Šçš„ç±»å‹å‚æ•°ï¼Œä¼šåœ¨ç¼–è¯‘æœŸé—´å»æ‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«èŒƒå‹æ“¦é™¤ã€‚ éªŒè¯ï¼šå£°æ˜ä¸¤ä¸ªä¸åŒèŒƒå‹çš„Listï¼Œç„¶åæ¯”è¾ƒä¸¤ä¸ªlistçš„ç±»å‹ã€‚ ArrayList\u003cString\u003e list1 = new ArrayList(); ArrayList\u003cInteger\u003e list2 = new ArrayList(); System.out.print(list1.getClass() == list2.getClass()); // è¾“å‡º true ","date":"2022-03-19","objectID":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/:1:0","series":[],"tags":[],"title":"Javaä¸­çš„èŒƒå‹","uri":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/"},{"categories":[],"content":"èŒƒå‹é€šé…ç¬¦ \u003c? extends T\u003e å­ç±»é™å®šé€šé…ç¬¦ï¼Œ \u003c? super T\u003e è¶…ç±»é™å®šé€šé…ç¬¦ï¼Œ \u003c?\u003e æ— é™å®šé€šé…ç¬¦ï¼Œ ","date":"2022-03-19","objectID":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/:2:0","series":[],"tags":[],"title":"Javaä¸­çš„èŒƒå‹","uri":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/"},{"categories":[],"content":"èŒƒå‹çš„é™åˆ¶ èŒƒå‹ä¸èƒ½ç”¨æ¥å®ä¾‹åŒ–å˜é‡ï¼› é™æ€åŸŸæˆ–æ–¹æ³•ä¸èƒ½ä½¿ç”¨è‡ªå·±ç±»å‹çš„èŒƒå‹ï¼ˆå› ä¸ºåªæœ‰åœ¨åˆ›å»ºå¯¹è±¡åæ‰çŸ¥é“èŒƒå‹çš„å…·ä½“ç±»å‹ï¼‰ï¼› èŒƒå‹ä¸æ”¯æŒä½¿ç”¨ç»“æ„ä½“ï¼Œå¯ä»¥ä½¿ç”¨å¼•ç”¨çš„åŒ…è£…ç±»å‹æ›¿ä»£ï¼Œå¦‚Double,Integer,Longç­‰ï¼› èŒƒå‹ä¸å…è®¸ä½¿ç”¨instanceofå…³é”®å­—åˆ¤æ–­ç±»å‹ï¼› ç±»å‹æ“¦é™¤ï¼› èŒƒå‹ç±»ä¸èƒ½ç»§æ‰¿/æ‰©å±•ï¼ˆä½¿ç”¨extendså…³é”®å­—ï¼‰Expectionã€Throwableï¼› ä¸èƒ½try-catchæ•è·èŒƒå‹å¯¹è±¡ï¼› ","date":"2022-03-19","objectID":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/:3:0","series":[],"tags":[],"title":"Javaä¸­çš„èŒƒå‹","uri":"/java%E4%B8%AD%E7%9A%84%E8%8C%83%E5%9E%8B%E6%93%A6%E9%99%A4/"},{"categories":[],"content":"ä¼ é€’æµç¨‹ Activityçš„disPatchTouchEventæ–¹æ³•æ¥å—åˆ°äº‹ä»¶ï¼Œç„¶åä¼ é€’åˆ°PhoneWindowçš„disPatchTouchEventï¼Œå†ä»PhoneWindowä¼ é€’åˆ°DecorViewçš„disPatchTouchEventã€‚ ç„¶åäº‹ä»¶ä¼šåˆ°è¾¾æ ¹ViewGroupçš„disPatchTouchEventï¼Œåœ¨è¿™é‡Œä¼šé¦–å…ˆè°ƒç”¨onInterceptTouchEventåˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªã€‚å¦‚æœæ‹¦æˆªï¼Œåˆ™è°ƒç”¨è‡ªå·±çš„onTouchEventå¤„ç†ï¼›ä¸æ‹¦æˆªåˆ™ä¼šéå†å­Viewè¿›è¡Œå¤„ç†ã€‚ äº‹ä»¶åˆ°è¾¾å­Viewï¼Œä¼šç»disPatchTouchEventåˆ°è¾¾onTouchEventï¼Œå¦‚æœè¿›è¡Œäº†å¤„ç†ï¼Œå°±è¿”å›trueï¼Œè¡¨ç¤ºäº‹ä»¶å·²ç»æ¶ˆè´¹æ‰ï¼Œä¸ä¼šç»§ç»­ä¼ é€’ã€‚ å¦‚æœå­Viewä¸å¤„ç†å¹¶è¿”å›äº†falseï¼Œäº‹ä»¶ä¼šè¿”å›åˆ°çˆ¶çº§ViewGroupçš„disPatchTouchEventï¼Œç„¶åç›´æ¥åˆ°è¾¾ViewGroupçš„onTouchEventã€‚ å¦‚æœå†ä¸å¤„ç†ï¼Œå°±ä¼šç»§ç»­å‘ä¸Šå†’æ³¡ï¼Œç›´åˆ°Activityçš„onTouchEventã€‚ ","date":"2022-03-11","objectID":"/android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/:1:0","series":[],"tags":[],"title":"Androidäº‹ä»¶åˆ†å‘æœºåˆ¶","uri":"/android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/"},{"categories":[],"content":"éœ€è¦æ³¨æ„ åªæœ‰ViewGroupæœ‰#ï¼› åªæœ‰Viewçš„onTouchEventæ˜¯é»˜è®¤æ‹¦æˆªçš„ï¼› é‡å†™onTouchEventä¼šå‡ºç°è­¦æŠ¥ï¼Œè¡¨ç¤ºå¯èƒ½ä¼šå¼•èµ·clickäº‹ä»¶å¤±æ•ˆï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨è°ƒç”¨performClickæ–¹æ³•ï¼ŒæŒ‡å®šclickäº‹ä»¶çš„è§¦å‘æ—¶æœºã€‚ ","date":"2022-03-11","objectID":"/android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/:2:0","series":[],"tags":[],"title":"Androidäº‹ä»¶åˆ†å‘æœºåˆ¶","uri":"/android%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/"},{"categories":[],"content":"TODO ","date":"2022-03-10","objectID":"/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:0","series":[],"tags":[],"title":"å¯åŠ¨æµç¨‹","uri":"/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":" æŒ‰ä¸‹ç”µæºé”®ï¼Œé¦–å…ˆä»åŠ è½½å¹¶è¿è¡ŒBootLoaderï¼› BootLoaderæ‹‰èµ·linuxå†…æ ¸ï¼› linuxå†…æ ¸å¯åŠ¨åä¼šåŠ è½½init.rcæ–‡ä»¶ï¼Œå¹¶å¯åŠ¨initè¿›ç¨‹ã€‚ initè¿›ç¨‹ä¼šå¯åŠ¨å±æ€§æœåŠ¡ï¼ˆç±»ä¼¼æ³¨å†Œè¡¨ï¼‰ï¼Œå¹¶å¯åŠ¨Zygoteè¿›ç¨‹ã€‚ Zygoteè¿›ç¨‹ä¼šåˆ›å»ºJVMå¹¶æ³¨å†ŒJNIï¼Œåˆ›å»ºæœåŠ¡ç«¯Socket(ç”¨æ¥æ¥å—AMSä¿¡å·),å¯åŠ¨SystemServerè¿›ç¨‹ã€‚ SystemServerä¼šå¯åŠ¨Binderçº¿ç¨‹æ± å’ŒSystemServiceManageråŠå„ç§ç³»ç»ŸæœåŠ¡ï¼ˆå¦‚AMS,PMSç­‰ï¼‰ã€‚ é€šè¿‡åå°„è°ƒç”¨SystemServerä¸­çš„mainæ–¹æ³•ï¼Œå¹¶ä¸”newäº†ä¸€ä¸ªSystemServerå¹¶è°ƒç”¨å…¶runæ–¹æ³•ã€‚ å¯åŠ¨Launcherã€‚ ","date":"2022-03-09","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:0","series":[],"tags":[],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"æ‡’æ±‰å¼ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰ /** * æ‡’æ±‰å¼å•ä¾‹ * ç‰¹ç‚¹ï¼šç”¨æ—¶åŠ è½½ */ public class Singleton implements Serializable { /** * æ ¸å¿ƒä¸ºé™æ€å˜é‡ */ private static Singleton instance; /** * ç§æœ‰æ„é€ æ–¹æ³• */ private Singleton() { } /** * å·¥å‚æ–¹æ³• * @return */ private static Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } æ¯”è¾ƒå®¹æ˜“å¿½ç•¥çš„å°±æ˜¯æ„é€ æ–¹æ³•ç§æœ‰ã€‚ ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:1","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ /** * çº¿ç¨‹å®‰å…¨æ‡’æ±‰å¼å•ä¾‹ * ç‰¹ç‚¹ï¼šç”¨æ—¶åŠ è½½ï¼Œçº¿ç¨‹å®‰å…¨ */ public class Singleton implements Serializable { /** * æ ¸å¿ƒä¸ºé™æ€å˜é‡ * åŠ volatileç¡®ä¿å¼‚æ­¥å¯è§æ€§ */ private static volatile Singleton instance; /** * ç§æœ‰æ„é€ æ–¹æ³• */ private Singleton() { } /** * å·¥å‚æ–¹æ³• * åŠ é”ç¡®ä¿çº¿ç¨‹å®‰å…¨ * @return */ private static synchronized Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } è¿™ç§æ–¹å¼æŠŠsynchornizedåŠ åœ¨å·¥å‚æ–¹æ³•ä¸Šï¼Œå¯¼è‡´æ¯æ¬¡è°ƒç”¨å·¥å‚æ–¹æ³•éƒ½ä¼šé˜»å¡ï¼Œä»è€Œæ•ˆç‡ä½ä¸‹ã€‚ ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:2","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"åŒé‡é”ï¼ˆDLCï¼‰ï¼Œçº¿ç¨‹å®‰å…¨ /** * åŒé‡é”å•ä¾‹ * çº¿ç¨‹å®‰å…¨ */ public class DlcSingleton { private static volatile DlcSingleton instance; private DlcSingleton() { } public static DlcSingleton getInstance() { if (instance == null) {// é¿å…é˜»å¡ï¼Œæé«˜æ•ˆç‡ synchronized (DlcSingleton.class) { if (instance == null) {//é˜²æ­¢äºŒæ¬¡åˆ›å»º instance = new DlcSingleton(); } } } return instance; } } åŒé‡é”çš„ç‰¹ç‚¹å°±æ˜¯åœ¨å·¥å‚æ–¹æ³•ä¸­åŠ å…¥äº†åŒæ­¥ä»£ç å—å’ŒåŒé‡ifåˆ¤æ–­ï¼Œä½¿å¾—çº¿ç¨‹å®‰å…¨ã€‚å®¹æ˜“å¿˜æ‰çš„æ˜¯é™æ€å˜é‡æ·»åŠ çš„volatileå…³é”®å­—ã€‚ è€ƒç‚¹ï¼š synchronizedç±»é”ï¼Œæä¾›äº†åŸå­æ€§ï¼Œæ˜¯ä¸ºäº†çº¿ç¨‹å®‰å…¨å¼•å…¥ï¼Œé¿å…å¤šä¸ªçº¿ç¨‹è°ƒç”¨å·¥å‚æ–¹æ³•æ—¶ï¼Œç”±äºä¿¡æ¯ä¸åŒæ­¥å¯¼è‡´é‡å¤åˆ›å»ºã€‚ volatileå…³é”®å­—ï¼Œæä¾›äº†å¯è§æ€§ï¼Œç”±äºåŠ é”åªèƒ½ä¿è¯åŸå­æ€§ï¼Œå¹¶ä¸ä¿è¯å¯è§æ€§ï¼Œæ‰€ä»¥åœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹åˆ›å»ºäº†å®ä¾‹ï¼Œä½†æ˜¯å¯¹å¦ä¸€ä¸ªçº¿ç¨‹ä¸å¯è§ï¼Œå¯¼è‡´å¦ä¸€ä¸ªçº¿ç¨‹å¾—åˆ°nullï¼Œæ‰€ä»¥åŠ volatileè¯»å†™å±éšœä»¥ä¿è¯çº¿ç¨‹å¯è§æ€§ã€‚ åŒæ­¥å—é‡Œé¢çš„ifåˆ¤ç©ºï¼Œç”¨æ„ä¸æ™®é€šçš„å•ä¾‹ä¸­çš„ifåˆ¤æ–­æ˜¯ä¸€è‡´çš„ï¼Œæ˜¯ä¸ºäº†é¿å…äºŒæ¬¡åˆ›å»ºã€‚ åŒæ­¥å—å¤–é¢çš„ifåˆ¤ç©ºï¼Œåœ¨å‰é¢è¯´è¿‡ï¼Œçº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼çš„å¼Šç—…å°±æ˜¯æ¯æ¬¡è°ƒç”¨å·¥å‚æ–¹æ³•éƒ½ä¼šåŒæ­¥é˜»å¡ï¼Œé™ä½äº†æ•ˆç‡ã€‚åœ¨è¿™é‡ŒåŠ å…¥ifåˆ¤ç©ºï¼Œå°±æ˜¯ä¸ºäº†å¦‚æœå®ä¾‹å·²ç»åˆ›å»ºï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¿›å…¥åŒæ­¥ä»£ç å—ï¼Œä»è€Œæé«˜äº†æ•ˆç‡ã€‚ ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:3","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"é™æ€å†…éƒ¨ç±»æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ /** * é™æ€å†…éƒ¨ç±»æ‡’æ±‰å¼ */ public class InnerSingleton { /** * ç§æœ‰æ„é€ æ–¹æ³• */ private InnerSingleton(){} /** * é™æ€å†…éƒ¨ç±» */ private static class InnerSingletonHolder{ private static final InnerSingleton INSTANCE = new InnerSingleton(); } public static final InnerSingleton getInstance(){ return InnerSingletonHolder.INSTANCE; } } ä¸»è¦æ˜¯é é™æ€å†…éƒ¨ç±»æŒæœ‰é™æ€å®ä¾‹ã€‚ åˆçœ‹ä¸Šå»å†™æ³•å¾ˆé¥¿æ±‰å¼å¾ˆåƒï¼Œä½†æ˜¯åœ¨ä½¿ç”¨æ—¶ï¼ŒåŠ è½½InnerSingletonç±»å‹æ—¶ï¼Œå¹¶ä¸ä¼šåŒæ—¶åŠ è½½å…¶é™æ€å†…éƒ¨ç±»ï¼Œåªæœ‰è°ƒç”¨å·¥å‚æ–¹æ³•æ—¶ï¼Œæ‰ä¼šåŠ è½½å…¶é™æ€å†…éƒ¨ç±»ï¼Œå¹¶åŒæ—¶åˆå§‹åŒ–instanceï¼Œæ‰€ä»¥è¿™ä¸ªä¹Ÿç®—æ˜¯æ‡’æ±‰å¼ã€‚ classLoaderåŠ è½½å†…éƒ¨é™æ€ç±»æ—¶ï¼Œä¼šç›´æ¥åˆå§‹åŒ–instanceï¼Œæ‰€ä»¥ä¹Ÿä¿è¯äº†çº¿ç¨‹å®‰å…¨ã€‚ é™æ€å†…éƒ¨ç±»ï¼Œä¸æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œå®ƒå…¶å®å®Œå…¨å°±æ˜¯å¦ä¸€ä¸ªç‹¬ç«‹çš„ç±»ã€‚ ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:4","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ /** * é¥¿æ±‰å¼å•ä¾‹ * ç‰¹ç‚¹ï¼šç”¨å‰åŠ è½½ï¼Œå¤©ç”Ÿçº¿ç¨‹å®‰å…¨ï¼Œä¸å¦‚æ‡’æ±‰å¼çµæ´» */ public class Singleton implements Serializable { /** * æ ¸å¿ƒä¸ºé™æ€å˜é‡ * åŠ volatileç¡®ä¿å¼‚æ­¥å¯è§æ€§ */ private static final Singleton instance = new Singleton(); /** * ç§æœ‰æ„é€ æ–¹æ³• */ private Singleton() { } /** * å·¥å‚æ–¹æ³• * * @return */ private static Singleton getInstance() { return instance; } } ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:5","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"æšä¸¾é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ public enum SingletonEnum { INSTANCE; } åœ¨javaä¸­ï¼Œæšä¸¾å°±æ˜¯ä¸€ç§ç‰¹åˆ«çš„ç±»ï¼Œå®ƒå…·å¤‡classçš„ä¸€åˆ‡ç‰¹æ€§ï¼Œå¹¶ä¸”ç”±äºè·Ÿé¥¿æ±‰å·®ä¸å¤šï¼Œæ‰€ä»¥å¤©ç„¶çš„çº¿ç¨‹å®‰å…¨ã€‚ ","date":"2022-02-24","objectID":"/%E5%8D%95%E4%BE%8B/:0:6","series":["è®¾è®¡æ¨¡å¼"],"tags":[],"title":"å•ä¾‹","uri":"/%E5%8D%95%E4%BE%8B/"},{"categories":[],"content":"ç”¨äº†Hugoè¿™ä¸€æ®µæ—¶é—´ï¼Œä¸€ç›´æä¸æ˜ç™½å›¾ç‰‡æ€ä¹ˆå­˜æ”¾æ¯”è¾ƒå¥½ï¼Œä¹Ÿä¸€ç›´å¼„ä¸æ¸…æ¥šLeaf Bundleå’ŒBranch Bundleæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä»Šå¤©æœ‰ç‚¹æ—¶é—´ï¼Œç»ˆäºææ¸…æ¥šäº†ï¼Œå¹¶ä¸”å›¾ç‰‡ä¹ŸæˆåŠŸåœ¨Github-pagesä¸Šæ˜¾ç¤ºå‡ºæ¥äº†ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹å§ï¼ ","date":"2022-01-17","objectID":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/:0:0","series":[],"tags":[],"title":"Hugoçš„å›¾ç‰‡å¤„ç†","uri":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/"},{"categories":[],"content":"Hugoçš„å›¾ç‰‡å­˜æ”¾æ–¹å¼ Hugoçš„å›¾ç‰‡ä¸€èˆ¬æœ‰ä¸¤ç§å­˜æ”¾æ–¹å¼ï¼š æ”¾åœ¨staticç›®å½•ä¸­æˆä¸ºé™æ€èµ„æºï¼Œåœ¨å¼•ç”¨æ—¶å¯ä»¥ä»¥å½“å‰ç›®å½•åœ°å€ç›´æ¥å¼•ç”¨ã€‚æ¯”å¦‚æˆ‘åœ¨staticä¸­åˆ›å»ºäº†ä¸€ä¸ªimagesç›®å½•ï¼ŒæŠŠæ‰€æœ‰çš„å›¾ç‰‡éƒ½æ”¾åœ¨é‡Œé¢ï¼Œç„¶åå¯ä»¥è¿™æ ·å¼•ç”¨ï¼š ![å›¾ç‰‡](/images/xxx.png) è¿™ç§æ–¹å¼çš„é—®é¢˜å¾ˆå¤§ï¼š å›¾ç‰‡æ²¡æœ‰åˆ†é—¨åˆ«ç±»ï¼Œå…¨éƒ½æ”¾åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾ç»´æŠ¤ï¼› ç”±äºç”¨çš„æ˜¯ç¼–è¯‘åçš„ç›¸å¯¹ä½ç½®ï¼Œæ‰€ä»¥åœ¨ç¼–å†™æ–‡ç« æ—¶æ— æ³•å®æ—¶é¢„è§ˆï¼Œå¾ˆå®¹æ˜“å¯¼è‡´è¯­æ³•é”™è¯¯è€Œéš¾ä»¥æ’æŸ¥ã€‚ åˆ©ç”¨Leaf Bundleå­˜æ”¾ã€‚ å¥½å¤„æ˜¯å›¾ç‰‡ä¸æ–‡ç« åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œç»“æ„æ¸…æ™°åˆ©äºç»´æŠ¤ï¼Œå¹¶ä¸”åœ¨ç¼–è¾‘æ—¶æ‰€è§å³æ‰€å¾—ã€‚ ","date":"2022-01-17","objectID":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/:0:1","series":[],"tags":[],"title":"Hugoçš„å›¾ç‰‡å¤„ç†","uri":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/"},{"categories":[],"content":"Page Bundle Hugoçš„PageBundleåªæœ‰ä¸¤ç§ï¼š å¶å­èŠ‚ç‚¹ï¼Œå…¶æ‰€åœ¨ç›®å½•ä¸­åªèƒ½æœ‰ä¸€ä¸ªindex.mdæ–‡ä»¶ï¼Œç”¨æ¥å†™æ–‡ç« å†…å®¹ï¼Œå…¶ä½™æ–‡ä»¶éƒ½è¢«è®¤ä¸ºæ˜¯é™æ€èµ„æºï¼› ææ¡èŠ‚ç‚¹ï¼Œå…¶æ‰€åœ¨ç›®å½•ä¸­åªèƒ½æœ‰ä¸€ä¸ª_index.mdæ–‡ä»¶ï¼Œç”¨ä»¥å‘Šè¯‰Hugoè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸ªç›®å½•ï¼Œæ‰€åœ¨æ–‡ä»¶å¤¹å†…å¯åŒ…å‡½å…¶ä»–å¶å­èŠ‚ç‚¹æˆ–å¸¸è§„æ–‡ç« ã€‚ ","date":"2022-01-17","objectID":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/:0:2","series":[],"tags":[],"title":"Hugoçš„å›¾ç‰‡å¤„ç†","uri":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/"},{"categories":[],"content":"åˆ©ç”¨Leaf Bundleç»´æŠ¤å›¾ç‰‡ æ¯”å¦‚æˆ‘çš„ç›®å½•ç»“æ„ï¼š â”œâ”€ content â”‚ â”œâ”€ about.md â”‚ â””â”€ posts â”‚ â”œâ”€ Technology â”‚ â”‚ â”œâ”€ Android â”‚ â”‚ â”‚ â”œâ”€ Androidåº”ç”¨å¯åŠ¨æµç¨‹ â”‚ â”‚ â”‚ â”‚ â”œâ”€ index.md â”‚ â”‚ â”‚ â”‚ â””â”€ å¯åŠ¨æµç¨‹.png â”‚ â”‚ â”‚ â”œâ”€ _index.md â”‚ â”‚ â”œâ”€ _index.md å…¶ä¸­Technologyç›®å½•ä¸­æœ‰_index.mdï¼Œæ‰€ä»¥æ˜¯ææ¡èŠ‚ç‚¹ï¼Œé‡Œé¢åˆæœ‰ææ¡èŠ‚ç‚¹Androidï¼Œå†å…¶ä¸­ï¼ŒAndroidåº”ç”¨å¯åŠ¨æµç¨‹åªæœ‰ä¸€ä¸ªindex.mdå’Œä¸€å¼ å›¾ï¼Œæ˜¯å¶å­èŠ‚ç‚¹ã€‚æˆ‘ä»¬å°±åœ¨è¿™ä¸ªindex.mdä¸­å†™å†…å®¹ï¼Œç›´æ¥å¼•ç”¨å›¾ç‰‡å¯åŠ¨æµç¨‹.pngçš„ç›¸å¯¹åœ°å€å°±å¯ä»¥äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š ## æµç¨‹ ![](å¯åŠ¨æµç¨‹.png) è¿™æ ·å°±å¯ä»¥ä½¿å›¾ç‰‡æ‰€è§å³æ‰€å¾—çš„ç¼–å†™åšå®¢æ–‡ç« äº†ã€‚ ","date":"2022-01-17","objectID":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/:0:3","series":[],"tags":[],"title":"Hugoçš„å›¾ç‰‡å¤„ç†","uri":"/hugo%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%84%E7%90%86/"},{"categories":[],"content":"è¿‡å¹´è¿™å‡ å¤©é¼“æ£ä¸€ä¸‹æ ‘è“æ´¾ï¼Œç»“æœå„ç§éº»çƒ¦ï¼Œå°¤å…¶æ˜¯å®‰è£…docker-composeï¼Œæ˜æ˜dockerå®‰è£…å¾ˆé¡ºç•…ï¼Œä¸ºå•¥è¿™è´§å°±è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ ç»“æœåå¤å°è¯•ï¼Œç»ˆäºæ‰¾å‡ºäº†é—®é¢˜çš„å…³é”®ã€‚docker-composeçš„å®˜ç½‘æ˜¯é€šè¿‡ä»githubä¸‹è½½å®‰è£…çš„ï¼Œå…·ä½“æŒ‡ä»¤æ˜¯ï¼š sudo curl -L \"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose å°±æ˜¯è¿™ä¸ªæŒ‡ä»¤å‘äº†æˆ‘å¾ˆä¹…ã€‚ åæ¥æŸ¥åˆ°äº†ç”¨pipæ¥å®‰è£…çš„æ–¹æ³•ï¼Œå•å¥½ä¸å®¹æ˜“æŠŠpipå®‰è£…ä¸Šä¹‹åï¼Œè¿˜æ˜¯ä¸è¡Œã€‚ æœ€åçœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼Œæ„Ÿè°¢åŸä½œè€…ï¼ æˆ‘æ‰å‘ç°ï¼ŒåŸæ¥æ˜¯æˆ‘çš„urlæœ‰é—®é¢˜ï¼Œé¦–å…ˆæ ‘è“æ´¾ä¸Šçš„ubuntu-serveråº”è¯¥å®‰è£…aarch64ç±»å‹çš„docker-composeï¼Œæ­£ç¡®çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š sudo curl -L \"https://github.com/docker/compose/releases/download/v2.2.3/docker-compose-linux-aarch64\" -o /usr/local/bin/docker-compose çœ‹çœ‹ï¼Œå¯¹æ¯”ä¸‹æ¥å‘ç°å®˜ç½‘çš„urlé‡Œé¢çš„${uname}åªä¸è¿‡æ˜¯ä¸ªå ä½ç¬¦è€Œå·²ã€‚ æœ€åæ›´æ¢äº†urlåœ°å€ä¹‹åå®Œç¾è§£å†³ã€‚ ","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85docker-compose/:0:0","series":[],"tags":[],"title":"æ ‘è“æ´¾å®‰è£…docker-compose","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85docker-compose/"},{"categories":[],"content":"è¿‡å¹´è¿™å‡ å¤©é¼“æ£ä¸€ä¸‹æ ‘è“æ´¾ï¼Œç»“æœå„ç§éº»çƒ¦ã€‚ã€‚ã€‚å°¤å…¶æ˜¯åœ¨æŒ‚è½½exFatæ ¼å¼çš„ç§»åŠ¨ç¡¬ç›˜çš„æ—¶å€™ï¼Œæ˜æ˜ä¸´æ—¶æŒ‚è½½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ä¸€æ—¦åšäº†å¼€æœºè‡ªåŠ¨æŒ‚è½½çš„è¯ï¼Œå°±è¿ç³»ç»Ÿéƒ½å¯åŠ¨ä¸äº†äº†ã€‚ç»è¿‡ä¸æ‡ˆçš„ç™¾åº¦ï¼Œç»ˆäºè§£å†³äº†é—®é¢˜ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚ ","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/:0:0","series":[],"tags":[],"title":"æ ‘è“æ´¾æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/"},{"categories":[],"content":"åˆ›å»ºæŒ‚è½½ç‚¹ é¦–å…ˆè¦åˆ›å»ºæŒ‚è½½ç‚¹ï¼Œå…¶å®å°±æ˜¯åˆ›å»ºä¸ªæ–‡ä»¶å¤¹ï¼Œç§»åŠ¨ç¡¬ç›˜ä¼šæŒ‚è½½åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ª/mnt/servicediskã€‚ sudo mkdir /mnt/servicedisk ç„¶åå†æˆæƒï¼š sudo chmod 777 /mnt/servicedisk ç›®å‰äº†è§£åˆ°linuxæœ‰ä¸¤ä¸ªç›®å½•æ¯”è¾ƒé€‚åˆæŒ‚è½½ç§»åŠ¨ç¡¬ç›˜ï¼Œä¸€ä¸ªæ˜¯ã€Œmediaã€ï¼Œé€‚åˆæŒ‚è½½å¤–éƒ¨å¤šåª’ä½“é©±åŠ¨ï¼Œä¸€ä¸ªæ˜¯ã€Œmntã€ï¼Œé€‚åˆæŒ‚è½½å¤–éƒ¨å‚¨å­˜è®¾å¤‡ã€‚ ","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/:0:1","series":[],"tags":[],"title":"æ ‘è“æ´¾æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/"},{"categories":[],"content":"ä¸´æ—¶æŒ‚è½½ç¡¬ç›˜ ä¸ºäº†æµ‹è¯•ç¡¬ç›˜æ˜¯å¦å¯ç”¨ï¼Œéœ€è¦å…ˆä¸´æ—¶æŒ‚è½½ä¸€ä¸‹ã€‚ æŸ¥è¯¢ç¡¬ç›˜ä¿¡æ¯ é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥è¯¢å½“å‰çš„æ‰€æœ‰ç¡¬ç›˜ä¿¡æ¯ï¼š sudo fdisk -l è¿”å›ä¿¡æ¯å¦‚ä¸‹ï¼š pi@raspberrypi:~ $ sudo fdisk -l Disk /dev/ram0: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram1: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram2: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram3: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram4: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram5: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram6: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram7: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram8: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram9: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram10: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram11: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram12: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram13: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram14: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/ram15: 4 MiB, 4194304 bytes, 8192 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 4096 bytes I/O size (minimum/optimal): 4096 bytes / 4096 bytes Disk /dev/mmcblk0: 119.3 GiB, 128094044160 bytes, 250183680 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: dos Disk identifier: 0x9dddeedf Device Boot Start End Sectors Size Id Type /dev/mmcblk0p1 8192 532479 524288 256M c W95 FAT32 (LBA) /dev/mmcblk0p2 532480 250183679 249651200 119G 83 Linux Disk /dev/sda: 465.76 GiB, 500107862016 bytes, 976773168 sectors Disk model: HDD Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disklabel type: gpt Disk identifier: 2C9DFE05-186E-4911-B369-1CED62B9A27D Device Start End Sectors Size Type /","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/:0:2","series":[],"tags":[],"title":"æ ‘è“æ´¾æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/"},{"categories":[],"content":"å¼€æœºè‡ªåŠ¨æŒ‚è½½ æŸ¥è¯¢ç¡¬ç›˜èº«ä»½ä¿¡æ¯ $ sudo blkid /dev/sda2 /dev/sda2: LABEL=\"servicedisk\" UUID=\"6201-451A\" BLOCK_SIZE=\"512\" TYPE=\"exfat\" PARTUUID=\"ae27284a-b254-4bde-8a55-7457c694a22a\" ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶ sudo nano /etc/fstab æ‰“å¼€åæ˜¯è¿™æ ·å­ï¼š PARTUUID=9dddeedf-01 /boot vfat defaults 0 2 PARTUUID=9dddeedf-02 / ext4 defaults,noatime 0 1 # åœ¨æœ€åæ·»åŠ è‡ªå·±çš„ç§»åŠ¨ç¡¬ç›˜ä¿¡æ¯ PARTUUID=ae27284a-b254-4bde-8a55-7457c694a22a /mnt/servicedisk auto umask=0000 0 0 # a swapfile is not a swap partition, no line here # use dphys-swapfile swap[on|off] for that ç„¶åcontrol Oä¿å­˜,control xé€€å‡ºã€‚ å‘å°±åœ¨è¿™é‡Œäº†ï¼Œç½‘ä¸Šå¾ˆå¤šå¸–å­æ˜¯ç”¨UUIDæˆ–è€…ç”¨LEBALï¼Œç„¶ååé¢çš„æ ¼å¼ç”¨exfatæˆ–è€…vfatï¼Œæˆ‘å®æµ‹ä¸‹æ¥éƒ½å¤±è´¥äº†ï¼Œé‡å¯ä¹‹åsshéƒ½è¿ä¸ä¸Šäº†ã€‚æ‰€ä»¥**è¿™é‡Œä¸€å®šè¦ç”¨PARTUUIDå’Œautoï¼Œåé¢è¿˜è¦è·Ÿumask=0000ï¼Œå››ä¸ªğŸ¥šè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·éƒ½æœ‰è¯»å†™è¿è¡Œæƒé™ã€‚ æµ‹è¯•ä¸€ä¸‹ æœ€åè¿˜è¦æµ‹è¯•ä¸€ä¸‹ï¼Œä»¥å…é‡å¯ä¹‹åsshè¿ä¸ä¸Šå°±æ‚²å‰§äº†ï¼Œåªèƒ½å†é‡æ–°çƒ§å½•ç³»ç»Ÿäº†ã€‚ï¼ˆğŸ¤¦â€â™‚ï¸æˆ‘å°±å› ä¸ºä¸Šä¸€æ­¥æ²¡é…ç½®å¯¹å¯¼è‡´çƒ§å½•äº†Néç³»ç»Ÿï¼‰ sudo mount -a é‡å¯ è¿™ä¸ªå°±ä¸ç”¨è¯´äº†ã€‚ ","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/:0:3","series":[],"tags":[],"title":"æ ‘è“æ´¾æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/"},{"categories":[],"content":"æŒ‚è½½åˆ°æ™®é€šç”¨æˆ· åœ¨linuxä¸Šï¼Œç§»åŠ¨ç¡¬ç›˜ä¼šé»˜è®¤æŒ‚è½½åˆ°rootï¼Œè€Œä¸”é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯å½’å±åˆ°rootçš„ï¼Œä¸æ”¯æŒä¿®æ”¹ã€‚ è¿™å°±éº»çƒ¦äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ—¥å¸¸æ“ä½œéƒ½æ˜¯ä»¥æ™®é€šç”¨æˆ·èº«ä»½è¿›è¡Œçš„ï¼Œç”šè‡³æœ‰äº›ç¬¬ä¸‰æ–¹è½¯ä»¶ç¦æ­¢ä»¥rootèº«ä»½è¿è¡Œï¼Œæ¯”å¦‚æˆ‘æœ€è¿‘åœ¨æçš„Giteaã€‚ æŸ¥è¯¢å½“å‰æŒ‚è½½åˆ°çš„ç”¨æˆ· $ ls -l -rwxr-xr-x 1 root root 808 Feb 8 15:48 docker-compose.yml drwxr-xr-x 5 root root 131072 Feb 8 13:53 gitea drwxr-xr-x 2 root root 131072 Feb 8 15:48 mysql drwxr-xr-x 2 root root 131072 Feb 8 15:28 test æŸ¥çœ‹å½“å‰æ™®é€šç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ $id uid=1000(pi) gid=1000(pi) groups=1000(pi),4(adm),20(dialout),24(cdrom),27(sudo),29(audio),44(video),46(plugdev),60(games),100(users),105(input),107(render),109(netdev),995(docker),997(gpio),998(i2c),999(spi) å¯ä»¥çœ‹åˆ°ï¼š å½“å‰ç”¨æˆ·çš„uidæ˜¯1000 å½“å‰ç”¨æˆ·çš„gid(ç”¨æˆ·ç»„id)æ˜¯1000 dockerçš„ç”¨æˆ·ç»„idæ˜¯995 ä¸´æ—¶æŒ‚è½½ é¦–å…ˆå¸è½½ç¡¬ç›˜ sudo umount /dev/sda2 å†é‡æ–°æŒ‚è½½ sudo mount /dev/sda2 service -o uid=$id gid=995 ç„¶åå†æ¬¡ls -læŸ¥è¯¢æŒ‚è½½ç‚¹ï¼Œå°±å‘ç°å·²ç»æŒ‚è½½åˆ°æ™®é€šç”¨æˆ·äº†ã€‚ å¼€æœºè‡ªåŠ¨æŒ‚è½½åˆ°ç›®æ ‡ç”¨æˆ· åŒç†ï¼Œå¼€æœºè‡ªåŠ¨æŒ‚è½½å°±æ˜¯åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šæ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼š PARTUUID=ae27284a-b254-4bde-8a55-7457c694a22a /mnt/servicedisk auto umask=0000,uid=1000,gid=995 0 0 é…ç½®å®Œå¯ä»¥é‡å¯è¯•ä¸€ä¸‹ï¼Œåœ¨æ ‘è“æ´¾64ä½ç³»ç»Ÿä¸Šå®æµ‹æ˜¯æˆåŠŸçš„ã€‚ ","date":"2022-01-17","objectID":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/:0:4","series":[],"tags":[],"title":"æ ‘è“æ´¾æŒ‚è½½ç§»åŠ¨ç¡¬ç›˜","uri":"/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82%E8%BD%BD%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98/"},{"categories":[],"content":"WebViewä¸åŸç”Ÿå¯¹æ¯”å·®åœ¨å“ªé‡Œï¼Ÿ è¿™é‡Œå¼•ç”¨ç™¾åº¦APPå›¾ç‰‡æ¥è¯´æ˜ã€‚ ç™¾åº¦çš„å¼€å‘äººå‘˜å°†è¿™ä¸€æ•´ä¸ªè¿‡ç¨‹åˆ’åˆ†ä¸ºäº†å››ä¸ªé˜¶æ®µï¼Œå¹¶ç»Ÿè®¡å‡ºäº†å„ä¸ªé˜¶æ®µçš„å¹³å‡è€—æ—¶ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆå§‹åŒ–ç»„ä»¶é˜¶æ®µå°±èŠ±è´¹äº† 260 msï¼Œé¦–æ¬¡åˆ›å»ºè€—æ—¶å‡å€¼ä¸º 500 msï¼Œæ¯«æ— ç–‘é—®è¿™æ˜¯æˆ‘ä»¬è¦ä¼˜åŒ–çš„ç¬¬ä¸€ç‚¹ã€‚è€Œæœ€è€—æ—¶çš„å½“å±æ­£æ–‡åŠ è½½\u0026æ¸²æŸ“å’Œå›¾ç‰‡åŠ è½½ä¸¤ä¸ªé˜¶æ®µã€‚ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆè€—æ—¶å‘¢ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªé˜¶æ®µéœ€è¦è¿›è¡Œå¤šæ¬¡ç½‘ç»œè¯·æ±‚ã€JS è°ƒç”¨ã€IO è¯»å†™ã€‚æ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„åœ°æ–¹ã€‚ å¯ä»¥å¾—å‡ºä¼˜åŒ–æ–¹å‘ï¼š WebViewé¢„åˆ›å»ºå’Œå¤ç”¨ æ¸²æŸ“ä¼˜åŒ–ï¼ˆJSã€CSSã€å›¾ç‰‡ï¼‰ æ¨¡æ¿ä¼˜åŒ–ï¼ˆæ‹†åˆ†ã€é¢„çƒ­ã€å¤ç”¨ï¼‰ ","date":"2022-01-06","objectID":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/:0:1","series":[],"tags":[],"title":"WebViewæ€§èƒ½ä¼˜åŒ–","uri":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"WebViewé¢„åˆ›å»ºå’Œå¤ç”¨ WebView çš„åˆ›å»ºæ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œé¦–æ¬¡åˆ›å»ºè€—æ—¶å‡ ç™¾æ¯«ç§’ï¼Œå› æ­¤é¢„åˆ›å»ºå’Œå¤ç”¨å°¤ä¸ºé‡è¦ã€‚ å¤§è‡´é€»è¾‘æ˜¯å…ˆåˆ›å»ºWebViewå¹¶ç¼“å­˜èµ·æ¥ï¼Œç­‰åˆ°éœ€è¦çš„æ—¶å€™ç›´æ¥å–å‡ºæ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š class WebViewManager private constructor() { // ä¸ºäº†é˜…è¯»ä½“éªŒï¼Œçœç•¥éƒ¨åˆ†ä»£ç  private val webViewCache: MutableList\u003cWebView\u003e = ArrayList(1) private fun create(context: Context): WebView { val webView = WebView(context) // ...... return webView } fun prepare(context: Context) { if (webViewCache.isEmpty()) { Looper.myQueue().addIdleHandler { webViewCache.add(create(MutableContextWrapper(context))) false } } } fun obtain(context: Context): WebView { if (webViewCache.isEmpty()) { webViewCache.add(create(MutableContextWrapper(context))) } val webView = webViewCache.removeFirst() val contextWrapper = webView.context as MutableContextWrapper contextWrapper.baseContext = context webView.clearHistory() webView.resumeTimers() return webView } fun recycle(webView: WebView) { try { webView.stopLoading() webView.loadDataWithBaseURL(null, \"\", \"text/html\", \"utf-8\", null) webView.clearHistory() webView.pauseTimers() webView.webChromeClient = null webView.webViewClient = null val parent = webView.parent if (parent != null) { (parent as ViewGroup).removeView(webView) } } catch (e: Exception) { e.printStackTrace() } finally { if (!webViewCache.contains(webView)) { webViewCache.add(webView) } } } fun destroy() { try { webViewCache.forEach { it.removeAllViews() it.destroy() webViewCache.remove(it) } } catch (e: Exception) { e.printStackTrace() } } } è¿™é‡Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š é¢„åŠ è½½æ—¶æœºçš„é€‰æ‹© WebView çš„åˆ›å»ºæ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œä¸ºäº†ä½¿é¢„åŠ è½½ä¸ä¼šå½±å“åˆ°å½“å‰ä¸»çº¿ç¨‹ä»»åŠ¡ï¼Œæˆ‘ä»¬é€‰æ‹© IdleHandler æ¥æ‰§è¡Œé¢„åˆ›å»ºï¼Œä»¥ä¿è¯ä¸ä¼šå½±å“åˆ°å½“å‰ä¸»çº¿ç¨‹ä»»åŠ¡ã€‚è¯¦ç»†è¯·çœ‹ prepare(context: Context) æ–¹æ³•ã€‚ Contextçš„é€‰æ‹© æ¯ä¸ª WebView éœ€è¦å’Œå¯¹åº”çš„ Activity Context å®ä¾‹è¿›è¡Œç»‘å®šï¼Œä¸ºäº†ä¿è¯é¢„åŠ è½½çš„ WebView Context å’Œæœ€ç»ˆçš„ Context ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬é€šè¿‡ MutableContextWrapper æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚MutableContextWrapper å…è®¸å¤–éƒ¨æ›¿æ¢å®ƒçš„ baseContext ï¼Œå› æ­¤ prepare(context: Context)æ–¹æ³•å¯ä»¥ä¼  applicationContext è¿›è¡Œé¢„åˆ›å»ºï¼Œç­‰åˆ°å®é™…è°ƒç”¨æ—¶å†è¿›è¡Œæ›¿æ¢ï¼Œè¯¦ç»†è¯·çœ‹ obtain(context: Context) æ–¹æ³•ã€‚ å¤ç”¨å’Œé”€æ¯ åœ¨é¡µé¢å…³é—­å‰è°ƒç”¨ recycle(webView: WebView) è¿›è¡Œå›æ”¶ï¼Œåœ¨åº”ç”¨é€€å‡ºå‰è°ƒç”¨ destroy() è¿›è¡Œé”€æ¯ã€‚ å¤ç”¨WebViewè¿”å›ç©ºç™½ åœ¨è°ƒç”¨ recycle(webView: WebView) è¿›è¡Œå›æ”¶æ—¶ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ loadDataWithBaseURL(null, â€œâ€, â€œtext/htmlâ€, â€œutf-8â€, null) æ¸…é™¤é¡µé¢å†…å®¹ï¼Œå¯¼è‡´å¤ç”¨æ—¶çš„åŠ è½½æ ˆåº•å°±æ˜¯è¿™ä¸ªç©ºç™½é¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è¿”å›æ—¶å¯¹æ ˆåº•è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœä¸ºç©ºåˆ™ç›´æ¥è¿”å›ï¼Œä»£ç å¦‚ä¸‹ï¼š fun canGoBack(): Boolean { val canBack = webView.canGoBack() if (canBack) webView.goBack() val backForwardList = webView.copyBackForwardList() val currentIndex = backForwardList.currentIndex if (currentIndex == 0) { val currentUrl = backForwardList.currentItem.url val currentHost = Uri.parse(currentUrl).host //æ ˆåº•ä¸æ˜¯é“¾æ¥åˆ™ç›´æ¥è¿”å› if (currentHost.isNullOrBlank()) return false } return canBack } ### æ¸²æŸ“ä¼˜åŒ–ï¼ˆJSã€CSSã€å›¾ç‰‡ï¼‰ WebView åœ¨åŠ è½½å†…å®¹çš„æ—¶å€™ä¼šè¿›è¡Œå¤šæ¬¡ç½‘ç»œè¯·æ±‚ã€JS è°ƒç”¨ã€IO è¯»å†™ã€‚æˆ‘ä»¬å¯ä»¥å€Ÿç”±å†…æ ¸çš„ shouldInterceptRequest å›è°ƒï¼Œæ‹¦æˆªèµ„æºè¯·æ±‚ç”±å®¢æˆ·ç«¯è¿›è¡Œä¸‹è½½ï¼Œå¹¶ä»¥ç®¡é“æ–¹å¼å¡«å……åˆ°å†…æ ¸çš„ WebResourceResponseä¸­ï¼Œè¿™é‡Œå¼•ç”¨ç™¾åº¦APPå›¾ç‰‡æ¥è¯´æ˜ã€‚ ![WebViewæ¸²æŸ“è¿‡ç¨‹](WebViewæ¸²æŸ“è¿‡ç¨‹.awebp) é¢„ç½®ç¦»çº¿åŒ… ç²¾ç®€å¹¶æŠ½å–å…¬å…±çš„ JS å’Œ CSS æ–‡ä»¶ä½œä¸ºé€šç”¨èµ„æºï¼Œå°†æŠ½å–çš„èµ„æºå­˜æ”¾åœ¨ assets ä¸‹ï¼Œå†é€šè¿‡çº¦å®šçš„è§„åˆ™å»åŒ¹é…ï¼Œä»£ç å¦‚ä¸‹ï¼š ```kotlin webView.webViewClient = object : WebViewClient() { // ä¸ºäº†é˜…è¯»ä½“éªŒï¼Œçœç•¥éƒ¨åˆ†ä»£ç  override fun shouldInterceptRequest( view: WebView?, request: WebResourceRequest? ): WebResourceResponse? { if (view != null \u0026\u0026 request != null) { if(canAssetsResource(request)){ return assetsResourceRequest(view.context, request) } } return super.shouldInterceptRequest(view, request) } } private fun assetsResourceRequest( context: Context, webRequest: WebResourceRequest ): WebResourceResponse? { ... try { val url = webRequest.url.toString() val filenameIndex = url.lastIndexOf(\"/\") + 1 val filename = url.substring(filenameIndex) val suffixIndex = url.lastIndexOf(\".\") val suffix = url.substring(suffixIndex + 1) val webResourceResponse = WebResourceResponse() webResourceResponse.mimeType = getMimeTypeFromUrl(url) webResourceResponse.encoding = \"UTF-8\" webResourceResponse.data = context.assets.open(\"$suffix/$filename\") return webResourceResponse } catch (e: Exception) { e.printStackTrace() } return null } ","date":"2022-01-06","objectID":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/:0:2","series":[],"tags":[],"title":"WebViewæ€§èƒ½ä¼˜åŒ–","uri":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"æ¥å£æ›´æ–°ç¼“å­˜èµ„æº é™¤äº†é¢„ç½®ç¦»çº¿åŒ…å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æ¥å£è¯·æ±‚ï¼Œè·å–æœ€æ–°çš„ç¼“å­˜èµ„æºï¼Œä»¥åŠé€šè¿‡è¯·æ±‚èµ„æºçš„ç±»å‹è‡ªè¡Œç¼“å­˜ï¼Œä»£ç å¦‚ä¸‹ï¼š webView.webViewClient = object : WebViewClient() { ... override fun shouldInterceptRequest( view: WebView?, request: WebResourceRequest? ): WebResourceResponse? { if (view != null \u0026\u0026 request != null) { if(canCacheResource(request)){ return cacheResourceRequest(view.context, request) } } return super.shouldInterceptRequest(view, request) } } private fun canCacheResource(webRequest: WebResourceRequest): Boolean { // ä¸ºäº†é˜…è¯»ä½“éªŒï¼Œçœç•¥éƒ¨åˆ†ä»£ç  val url = webRequest.url.toString() val extension = getExtensionFromUrl(url) return extension == \"ico\" || extension == \"bmp\" || extension == \"gif\" || extension == \"jpeg\" || extension == \"jpg\" || extension == \"png\" || extension == \"svg\" || extension == \"webp\" || extension == \"css\" || extension == \"js\" || extension == \"json\" || extension == \"eot\" || extension == \"otf\" || extension == \"ttf\" || extension == \"woff\" } private fun cacheResourceRequest( context: Context, webRequest: WebResourceRequest ): WebResourceResponse? { ... try { val url = webRequest.url.toString() val cachePath = CacheUtils.getCacheDirPath(context, \"web_cache\") val filePathName = cachePath + File.separator + url.encodeUtf8().md5().hex() val file = File(filePathName) if (!file.exists() || !file.isFile) { runBlocking { // å¼€å¯ç½‘ç»œè¯·æ±‚ä¸‹è½½èµ„æº download(HttpRequest(url).apply { webRequest.requestHeaders.forEach { putHeader(it.key, it.value) } }, filePathName) } } if (file.exists() \u0026\u0026 file.isFile) { val webResourceResponse = WebResourceResponse() webResourceResponse.mimeType = getMimeTypeFromUrl(url) webResourceResponse.encoding = \"UTF-8\" webResourceResponse.data = file.inputStream() webResourceResponse.responseHeaders = mapOf(\"access-control-allow-origin\" to \"*\") return webResourceResponse } } catch (e: Exception) { e.printStackTrace() } return null } æˆ‘ä»¬é€šè¿‡canCacheResource(webRequest: WebResourceRequest)æ¥åˆ¤æ–­æ˜¯å¦æ˜¯éœ€è¦ç¼“å­˜çš„èµ„æºã€‚ å†æ ¹æ®URLå»è·å–ç¼“å­˜ä¸­æ–‡ä»¶ï¼Œå¦åˆ™å¼€å¯ç½‘ç»œè¯·æ±‚ä¸‹è½½èµ„æºï¼Œè¯¦ç»†è¯·çœ‹ cacheResourceRequest(context: Context, webRequest: WebResourceRequest) ã€‚ è¿™è¾¹ä»…å¯¹å›¾ç‰‡ã€å­—ä½“ã€CSSã€JSã€JSONè¿›è¡Œç¼“å­˜ï¼Œå¯æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µç¼“å­˜æ›´å¤šç±»å‹èµ„æºã€‚ ","date":"2022-01-06","objectID":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/:0:3","series":[],"tags":[],"title":"WebViewæ€§èƒ½ä¼˜åŒ–","uri":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"æ¨¡æ¿ä¼˜åŒ–ï¼ˆæ‹†åˆ†ã€é¢„çƒ­ã€å¤ç”¨ï¼‰ å…³äºæ¨¡æ¿ï¼Œä»£ç å¦‚ä¸‹ï¼š \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e \u003ctitle\u003etitle\u003c/title\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"xxx.css\"\u003e \u003cscript\u003e function changeContent(data){ document.getElementById('content').innerHTML=data; } \u003c/script\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv id=\"content\"\u003e\u003c/div\u003e \u003c/body\u003e \u003c/html\u003e å®¢æˆ·ç«¯åŠ è½½æ¨¡æ¿ä»£ç ï¼ˆæ¸©é¦¨æç¤ºï¼šä¸Šé¢åªæ˜¯ä¾‹å­ï¼Œå®é™…æ¨¡æ¿æ ¹æ®æƒ…å†µæ‹†åˆ†ï¼‰ï¼ŒåŠ è½½å®Œæˆåå†è°ƒç”¨ JS æ–¹æ³•æ³¨å…¥æ•°æ®ã€‚ æ•°æ®å“ªé‡Œæ¥å‘¢ï¼Ÿè¿™é‡Œä»¥åˆ—è¡¨é¡µè·³è½¬è¯¦æƒ…é¡µä¸¾ä¸ªä¾‹å­ï¼Œä»…ä¾›å‚è€ƒï¼š åˆ—è¡¨é¡µæ¥å£è¿”å›åˆ—è¡¨æ•°æ®çš„æ—¶å€™å¸¦ä¸Šè¯¦æƒ…å†…å®¹ï¼Œè·³è½¬è¯¦æƒ…é¡µçš„æ—¶å€™å¸¦ä¸Šå†…å®¹æ•°æ®ã€‚ä¼˜ç‚¹ç®€å•ç²—æš´ï¼Œç¼ºç‚¹è€—è´¹æµé‡ã€‚ å½“ç„¶è¿˜æœ‰å…¶ä»–æ–¹æ³•è¿™é‡Œä¸å†å¤šè¯´ï¼Œå¯æ ¹æ®è‡ªå·±çš„å®é™…éœ€æ±‚è¿›è¡Œé€‰æ‹©ã€‚ ","date":"2022-01-06","objectID":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/:0:4","series":[],"tags":[],"title":"WebViewæ€§èƒ½ä¼˜åŒ–","uri":"/webview%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚ åœ¨OkhttpClientå¯¹è±¡ä¸­æŒæœ‰ä¸€ä¸ªé“¾æ¥æ± ConnectionPool connectionPoolï¼Œä»Šå¤©æˆ‘å°±ç ”ç©¶ä¸€ä¸‹okçš„é“¾æ¥å¤ç”¨æœºåˆ¶ã€‚ ","date":"2021-10-29","objectID":"/okhttp%E7%9A%84%E9%93%BE%E6%8E%A5%E6%B1%A0/:0:0","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"Okhttpçš„é“¾æ¥æ± ","uri":"/okhttp%E7%9A%84%E9%93%BE%E6%8E%A5%E6%B1%A0/"},{"categories":[],"content":"ConnectionPoolç±» ä¸»è¦ç”¨äºç®¡ç†å’Œå¤ç”¨è¿æ¥ã€‚ public final class ConnectionPool { // å½“ç„¶ç¦»ä¸å¼€çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°ä¸º0ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ— é™å¤§ï¼ŒåŒ…æ´»æ—¶é—´ä¸º60ç§’ï¼ŒåŒæ­¥é˜Ÿåˆ—ï¼Œæœ€åæ˜¯è®¾ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ private static final Executor executor = new ThreadPoolExecutor(0 /* corePoolSize */, Integer.MAX_VALUE /* maximumPoolSize */, 60L /* keepAliveTime */, TimeUnit.SECONDS, new SynchronousQueue\u003cRunnable\u003e(), Util.threadFactory(\"OkHttp ConnectionPool\", true)); // æœ€å¤§é—²ç½®è¿æ¥æ•° private final int maxIdleConnections; // ä¿æ´»æ—¶é—´ private final long keepAliveDurationNs; private final Runnable cleanupRunnable = new Runnable() { @Override public void run() { while (true) { long waitNanos = cleanup(System.nanoTime()); if (waitNanos == -1) return; if (waitNanos \u003e 0) { long waitMillis = waitNanos / 1000000L; waitNanos -= (waitMillis * 1000000L); synchronized (ConnectionPool.this) { try { ConnectionPool.this.wait(waitMillis, (int) waitNanos); } catch (InterruptedException ignored) { } } } } } }; private final Deque\u003cRealConnection\u003e connections = new ArrayDeque\u003c\u003e(); final RouteDatabase routeDatabase = new RouteDatabase(); boolean cleanupRunning; /** * Create a new connection pool with tuning parameters appropriate for a single-user application. * The tuning parameters in this pool are subject to change in future OkHttp releases. Currently * this pool holds up to 5 idle connections which will be evicted after 5 minutes of inactivity. */ public ConnectionPool() { this(5, 5, TimeUnit.MINUTES); } public ConnectionPool(int maxIdleConnections, long keepAliveDuration, TimeUnit timeUnit) { this.maxIdleConnections = maxIdleConnections; this.keepAliveDurationNs = timeUnit.toNanos(keepAliveDuration); // Put a floor on the keep alive duration, otherwise cleanup will spin loop. if (keepAliveDuration \u003c= 0) { throw new IllegalArgumentException(\"keepAliveDuration \u003c= 0: \" + keepAliveDuration); } } // è¿”å›é—²ç½®çº¿ç¨‹æ•° public synchronized int idleConnectionCount() { int total = 0; for (RealConnection connection : connections) { if (connection.allocations.isEmpty()) total++; } return total; } public synchronized int connectionCount() { return connections.size(); } /** * Returns a recycled connection to {@code address}, or null if no such connection exists. The * route is null if the address has not yet been routed. */ @Nullable RealConnection get(Address address, StreamAllocation streamAllocation, Route route) { assert (Thread.holdsLock(this)); for (RealConnection connection : connections) { if (connection.isEligible(address, route)) { streamAllocation.acquire(connection, true); return connection; } } return null; } /** * Replaces the connection held by {@code streamAllocation} with a shared connection if possible. * This recovers when multiple multiplexed connections are created concurrently. */ @Nullable Socket deduplicate(Address address, StreamAllocation streamAllocation) { assert (Thread.holdsLock(this)); for (RealConnection connection : connections) { if (connection.isEligible(address, null) \u0026\u0026 connection.isMultiplexed() \u0026\u0026 connection != streamAllocation.connection()) { return streamAllocation.releaseAndAcquire(connection); } } return null; } void put(RealConnection connection) { assert (Thread.holdsLock(this)); if (!cleanupRunning) { cleanupRunning = true; executor.execute(cleanupRunnable); } connections.add(connection); } /** * Notify this pool that {@code connection} has become idle. Returns true if the connection has * been removed from the pool and should be closed. */ boolean connectionBecameIdle(RealConnection connection) { assert (Thread.holdsLock(this)); if (connection.noNewStreams || maxIdleConnections == 0) { connections.remove(connection); return true; } else { notifyAll(); // Awake the cleanup thread: we may have exceeded the idle connection limit. return false; } } /** Close and remove all idle connections in the pool. */ public void evictAll() { List\u003cRealConnection\u003e evictedConnections = new ArrayList\u003c\u003e(); synchronized (this) { for (Iterator\u003cRealConnection\u003e i = connections.iterator(); i.hasNext(); ) { RealConnection connection = i.next(); if (con","date":"2021-10-29","objectID":"/okhttp%E7%9A%84%E9%93%BE%E6%8E%A5%E6%B1%A0/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"Okhttpçš„é“¾æ¥æ± ","uri":"/okhttp%E7%9A%84%E9%93%BE%E6%8E%A5%E6%B1%A0/"},{"categories":[],"content":"TODO ","date":"2021-09-18","objectID":"/okhttp%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/:0:0","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttpçš„ç¼“å­˜æœºåˆ¶","uri":"/okhttp%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/"},{"categories":[],"content":"ä¹‹å‰å·²ç»äº†è§£è¿‡ï¼ŒOkHttpé»˜è®¤æ·»åŠ CacheInterceptoræ¥å¤„ç†ç¼“å­˜ï¼Œè€Œåè€…æ˜¯ä¾é DiskLruCacheæ¥å®ç°ç¡¬ç›˜ç¼“å­˜è¯»å†™ï¼Œæ‰€ä»¥æˆ‘å…ˆå»çœ‹äº†ä¸€ä¸‹Androidå†…ç½®çš„LruCacheåŸç†ï¼Œæ˜¯ä¾é javaçš„LinkedHashMapçš„LRUæ’åºç®—æ³•å®ç°çš„ï¼Œæœ€åæˆ‘å‡†å¤‡è¯¦ç»†çœ‹çœ‹DiskLruCacheæ˜¯æ€ä¹ˆåŸºäºç¡¬ç›˜ç¼“å­˜å®ç°LRUçš„ã€‚ ","date":"2021-09-16","objectID":"/disklrucache/:0:0","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"å†™åœ¨å‰é¢ æ®è¯´æœ€æ—©DiskLruCacheå¹¶ä¸æ˜¯Androidå®ç°çš„ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸­å¹¶æ²¡æœ‰å†…ç½®è¿™ä¸ªç±»ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨å‰å…ˆä»githubä¸Šä¸‹è½½ï¼Œè€ŒOkHttpä¸­æ›´å¹²è„†ï¼Œç›´æ¥è‡ªå·±å®ç°(mo gai)äº†ä¸€ä¸ªï¼Œæ‰€ä»¥æœ¬æ–‡çš„DiskLruCacheæ˜¯ä½äºokhttp3.internal.cacheåŒ…ä¸‹çš„ã€‚ä¸è¿‡å®ç°åŸç†ä¹Ÿéƒ½å·®ä¸å¤šã€‚ ","date":"2021-09-16","objectID":"/disklrucache/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"é™æ€åˆ›å»ºæ–¹æ³• public static DiskLruCache create(FileSystem fileSystem, File directory, int appVersion, int valueCount, long maxSize) { // Use a single background thread to evict entries. // åˆ›å»ºäº†ä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ±  Executor executor = new ThreadPoolExecutor(0, 1, 60L, TimeUnit.SECONDS, new LinkedBlockingQueue\u003cRunnable\u003e(), Util.threadFactory(\"OkHttp DiskLruCache\", true)); return new DiskLruCache(fileSystem, directory, appVersion, valueCount, maxSize, executor); } é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°ä¸º0ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º1ï¼Œæ´»è·ƒæ—¶é—´ä¸º1åˆ†é’Ÿï¼Œåˆ›å»ºçš„çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚ ç„¶ååˆ›å»ºä¸€ä¸ªDiskLruCacheï¼Œå¹¶ä¼ é€’äº†çº¿ç¨‹æ± ã€‚ ","date":"2021-09-16","objectID":"/disklrucache/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"æ„é€ æ–¹æ³• DiskLruCache(FileSystem fileSystem, File directory, int appVersion, int valueCount, long maxSize, Executor executor) { this.fileSystem = fileSystem; this.directory = directory; this.appVersion = appVersion; this.journalFile = new File(directory, JOURNAL_FILE); this.journalFileTmp = new File(directory, JOURNAL_FILE_TEMP); this.journalFileBackup = new File(directory, JOURNAL_FILE_BACKUP); this.valueCount = valueCount; this.maxSize = maxSize; this.executor = executor; } è¿™é‡Œåˆ›å»ºäº†3ä¸ªæ–‡ä»¶ï¼š journalFileï¼šæ ‡å‡†çš„journalæ–‡ä»¶ journalFileTmp journalFileBackup ","date":"2021-09-16","objectID":"/disklrucache/:0:3","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"editæ–¹æ³• å¯¹åº”çš„æ˜¯mapçš„putæ–¹æ³•ã€‚ // çœ‹çœ‹ï¼Œè¿˜æ˜¯åŸºäºè¿™ç©æ„çš„ã€Œæ’å…¥æ’åºã€å®ç°çš„ final LinkedHashMap\u003cString, Entry\u003e lruEntries = new LinkedHashMap\u003c\u003e(0, 0.75f, true); // editæ–¹æ³• synchronized Editor edit(String key, long expectedSequenceNumber) throws IOException { // é¦–å…ˆåˆå§‹åŒ– initialize(); // å½“å‰DiskLruCacheçš„å…³é—­æ£€æŸ¥ï¼Œå¿…é¡»å…³é—­ä¹‹åæ‰èƒ½editã€‚ checkNotClosed(); // keyçš„å®‰å…¨æ£€æŸ¥ validateKey(key); // æŸ¥è¯¢åˆ°å¯¹åº”çš„entry Entry entry = lruEntries.get(key); if (expectedSequenceNumber != ANY_SEQUENCE_NUMBER \u0026\u0026 (entry == null || entry.sequenceNumber != expectedSequenceNumber)) { return null; // Snapshot is stale. } if (entry != null \u0026\u0026 entry.currentEditor != null) { return null; // Another edit is in progress. } if (mostRecentTrimFailed || mostRecentRebuildFailed) { // The OS has become our enemy! If the trim job failed, it means we are storing more data than // requested by the user. Do not allow edits so we do not go over that limit any further. If // the journal rebuild failed, the journal writer will not be active, meaning we will not be // able to record the edit, causing file leaks. In both cases, we want to retry the clean up // so we can get out of this state! //å¼‚æ­¥æ‰§è¡Œ executor.execute(cleanupRunnable); return null; } // Flush the journal before creating files to prevent file leaks. journalWriter.writeUtf8(DIRTY).writeByte(' ').writeUtf8(key).writeByte('\\n'); journalWriter.flush(); if (hasJournalErrors) { return null; // Don't edit; the journal can't be written. } if (entry == null) { entry = new Entry(key); lruEntries.put(key, entry); } Editor editor = new Editor(entry); entry.currentEditor = editor; return editor; } å…ˆè°ƒç”¨äº†åˆå§‹åŒ–æ–¹æ³•initializeï¼Œä¸»è¦å¹²äº†ä¸¤ä»¶äº‹æƒ…ï¼š ä»å¤‡ä»½ä¸­æ¢å¤ï¼› é€šè¿‡okioï¼Œä»æ–‡ä»¶ä¸­è¯»å–é”®å€¼å¯¹åˆ°LinkedHashMapã€‚ public synchronized void initialize() throws IOException { assert Thread.holdsLock(this); if (initialized) { return; // Already initialized. } // ä»å¤‡ä»½ä¸­æ¢å¤ if (fileSystem.exists(journalFileBackup)) { // If journal file also exists just delete backup file. if (fileSystem.exists(journalFile)) { fileSystem.delete(journalFileBackup); } else { fileSystem.rename(journalFileBackup, journalFile); } } // Prefer to pick up where we left off. if (fileSystem.exists(journalFile)) { try { // è¯»å–æ‚å¿—æ–‡ä»¶ readJournal(); processJournal(); initialized = true; return; } catch (IOException journalIsCorrupt) { Platform.get().log(WARN, \"DiskLruCache \" + directory + \" is corrupt: \" + journalIsCorrupt.getMessage() + \", removing\", journalIsCorrupt); } try { delete(); } finally { closed = false; } } rebuildJournal(); initialized = true; } ","date":"2021-09-16","objectID":"/disklrucache/:0:4","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"æ‡’å¾—çœ‹äº† æ‰¾åˆ°ä¸€ç¯‡æ–‡ç« è®²çš„ä¸é”™ï¼š æ„Ÿè°¢åŸä½œè€… æ¥ä¸‹æ¥æƒ³å…ˆå»çœ‹çœ‹okioã€‚ ","date":"2021-09-16","objectID":"/disklrucache/:0:5","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"DiskLruCache","uri":"/disklrucache/"},{"categories":[],"content":"LRUè¿™ä¸ªç®—æ³•å°±æ˜¯æŠŠæœ€è¿‘ä¸€æ¬¡ä½¿ç”¨æ—¶é—´ç¦»ç°åœ¨æ—¶é—´æœ€è¿œçš„æ•°æ®åˆ é™¤æ‰ï¼Œè€Œå®ç°LruCacheå°†ä¼šé¢‘ç¹çš„æ‰§è¡Œæ’å…¥ã€åˆ é™¤ç­‰æ“ä½œï¼Œæˆ‘ä»¬å°±ä¼šæƒ³åˆ°ä½¿ç”¨LinkedListï¼Œä½†æ˜¯æˆ‘ä»¬åˆè¦åŸºäºKey-Valueæ¥ä¿å­˜æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ä¼šæƒ³èµ·HashMapï¼Œä½†æ˜¯HashMapä¸èƒ½åƒlinkedListé‚£æ ·ä¿ç•™æ•°æ®çš„æ’å…¥é¡ºåºï¼Œå¦‚æœè¦ä½¿ç”¨HashMapçš„è¯å¯ä»¥ä½¿ç”¨å®ƒçš„ä¸€ä¸ªå­ç±»LinkedHashMapã€‚ ","date":"2021-09-15","objectID":"/lrucache/:0:0","series":[],"tags":[],"title":"LruCache","uri":"/lrucache/"},{"categories":[],"content":"LinkedHashMap å¯ç†è§£ä¸ºæœ‰åºçš„HashMapã€‚ æ„é€ æ–¹æ³• // é˜Ÿé¦– private transient LinkedHashMapEntry\u003cK,V\u003e header; // æ’åºæ¨¡å¼ private final boolean accessOrder; public class LinkedHashMap\u003cK,V\u003e extends HashMap\u003cK,V\u003e implements Map\u003cK,V\u003e { ... } è¿™è´§æ˜¯ç»§æ‰¿è‡ªHashMapçš„ï¼Œé‚£ä¹ˆä»–å°±æœ‰HashMapçš„æ‰€æœ‰ç‰¹æ€§ï¼ŒåŒ…æ‹¬çº¿ç¨‹ä¸å®‰å…¨å’Œç¿»å€æ‰©å®¹ã€‚ ç„¶åæ¥çœ‹ä¸€ä¸‹ä»–å†…éƒ¨çš„entryï¼š å…¥å£Entry /** * ç»§æ‰¿è‡ªHashMapçš„Entry */ private static class LinkedHashMapEntry\u003cK,V\u003e extends HashMapEntry\u003cK,V\u003e { // å†…éƒ¨å®ç°äº†è‡ªå·±çš„beforeå’Œafterï¼Œæˆäº†ä¸€ä¸ªåŒå‘é“¾è¡¨ LinkedHashMapEntry\u003cK,V\u003e before, after; ... } å¯ä»¥çœ‹åˆ°ï¼Œä»–å†…éƒ¨çš„EntryåŒæ—¶å…·å¤‡åŒå‘é“¾å’Œå•å‘é“¾(ç»§æ‰¿äº†HashMapçš„entryå†…éƒ¨çš„nextå­—æ®µ)ç»“æ„ã€‚ nextæ˜¯ç”¨äºç»´æŠ¤HashMapæŒ‡å®štableä½ç½®ä¸Šè¿æ¥çš„Entryçš„é¡ºåºçš„ï¼› beforeã€Afteræ˜¯ç”¨äºç»´æŠ¤Entryæ’å…¥çš„å…ˆåé¡ºåºçš„ã€‚ æ ¸å¿ƒæ„é€ æ–¹æ³• // æ’åºæ¨¡å¼ true-è®¿é—®æ’åº false-æ’å…¥æ’åº private final boolean accessOrder; public LinkedHashMap(int initialCapacity,float loadFactor,boolean accessOrder) { super(initialCapacity, loadFactor); this.accessOrder = accessOrder; } ä¸HashMapçš„ä¸»è¦åŒºåˆ«å°±æ˜¯å¤šäº†accessOrderå±æ€§ï¼Œå®ƒçš„ä½œç”¨æ˜¯é€‰æ‹©æ’åºæ¨¡å¼ï¼š true è®¿é—®æ’åº false æ’å…¥æ’åº è¿™é‡Œæœ‰ä¸ªå‘è¦æ³¨æ„çš„æ˜¯ï¼Œè°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼š public HashMap(int initialCapacity, float loadFactor) { if (initialCapacity \u003e MAXIMUM_CAPACITY) { initialCapacity = MAXIMUM_CAPACITY; } else if (initialCapacity \u003c DEFAULT_INITIAL_CAPACITY) { initialCapacity = DEFAULT_INITIAL_CAPACITY; } threshold = initialCapacity; // è¿™ä¸ªinitæ–¹æ³•å¥½å‘å•Š init(); } void init() {} å…¶ä¸­è°ƒç”¨äº†initæ–¹æ³•ï¼Œè€ŒHashMapä¸­å¹¶æ²¡æœ‰å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œè¯´æ˜æ˜¯ä¸“é—¨ç”¨æ¥ç»™å­ç±»åˆå§‹åŒ–çš„ï¼Œäºæ˜¯æˆ‘å»çœ‹LinkedHashMapä¸­çš„é‡å†™å®ç°ï¼š @Override void init() { header = new LinkedHashMapEntry\u003c\u003e(-1, null, null, null); header.before = header.after = header; } åˆå§‹åŒ–äº†é˜Ÿé¦–çš„entryï¼Œå¹¶ä¸”å®ƒçš„beforeå’Œafteréƒ½æ˜¯å®ƒè‡ªèº«ã€‚ putæ–¹æ³• LinkedHashMapå¹¶æ²¡æœ‰é‡å†™putæ–¹æ³•ï¼Œæ‰€ä»¥ä»–æ˜¯ç›´æ¥æ²¿ç”¨äº†HashMapçš„putæ–¹æ³•ã€‚ æ¥å›é¡¾ä¸€ä¸‹HashMapçš„putæ–¹æ³•ï¼š public V put(K key, V value) { if (table == EMPTY_TABLE) { inflateTable(threshold); } if (key == null) return putForNullKey(value); // è®¡ç®—Keyçš„Hashå€¼ int hash = sun.misc.Hashing.singleWordWangJenkinsHash(key); //æ‰¾åˆ°keyçš„ä¸‹æ ‡ä½ç½® int i = indexFor(hash, table.length); //éå†å•å‘é“¾ï¼Œæ’å…¥åˆ°å¯¹åº”çš„hashä½ç½® for (HashMapEntry\u003cK,V\u003e e = table[i]; e != null; e = e.next) { Object k; if (e.hash == hash \u0026\u0026 ((k = e.key) == key || key.equals(k))) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } //æ²¡æœ‰å¯¹åº”åˆ™æ’åˆ°æœ«å°¾ modCount++; addEntry(hash, key, value, i); return null; } è¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼ŒLinkedHashMapå¤§é‡è¿ç”¨äº†å¤šæ€ï¼Œæ‰€ä»¥åœ¨æ·»åŠ çš„æ—¶å€™è°ƒç”¨çš„addEntryæ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯LinkedHashMapå·²ç»é‡å†™è¿‡çš„ï¼š void addEntry(int hash, K key, V value, int bucketIndex) { LinkedHashMapEntry\u003cK,V\u003e eldest = header.after; // å¦‚æœafterä¸æ˜¯è‡ªå·± if (eldest != header) { boolean removeEldest; size++; try { removeEldest = removeEldestEntry(eldest); } finally { size--; } if (removeEldest) { removeEntryForKey(eldest.key); } } super.addEntry(hash, key, value, bucketIndex); } ç„¶ååˆè°ƒç”¨çˆ¶ç±»çš„addEntryæ–¹æ³•ï¼Œè€Œåœ¨å…¶ä¸­å†æ¬¡è°ƒç”¨è‡ªå·±çš„å¤šæ€æ–¹æ³•createEntryï¼š void createEntry(int hash, K key, V value, int bucketIndex) { HashMapEntry\u003cK,V\u003e old = table[bucketIndex]; LinkedHashMapEntry\u003cK,V\u003e e = new LinkedHashMapEntry\u003c\u003e(hash, key, value, old); table[bucketIndex] = e; // åŒæ—¶æŒ‡å®šäº†afterå’Œbefore e.addBefore(header); size++; } // LRUç®—æ³•ï¼ŒæŠŠå½“å‰entryæ’å…¥åˆ°headeré˜Ÿé¦–ä¹‹å‰ï¼Œæˆä¸ºæ–°çš„é˜Ÿé¦– private void addBefore(LinkedHashMapEntry\u003cK,V\u003e existingEntry) { // æ’å…¥åˆ°headerä¹‹å‰ after = existingEntry; before = existingEntry.before; before.after = this; after.before = this; } åˆ›å»ºäº†ä¸€ä¸ªentryï¼Œæ’å…¥åˆ°headerä¸oldä¹‹é—´ï¼Œå†æŠŠsize+1ï¼Œè¿™æ ·å°±å½¢æˆäº†æ’å…¥é¡ºåºã€‚ getæ–¹æ³• public V get(Object key) { // å…ˆé€šè¿‡keyæ‹¿åˆ°entry LinkedHashMapEntry\u003cK,V\u003e e = (LinkedHashMapEntry\u003cK,V\u003e)getEntry(key); // åˆ¤ç©º if (e == null) return null; e.recordAccess(this); return e.value; } // è®°å½•ä¸‹è®¿é—®æ“ä½œ void recordAccess(HashMap\u003cK,V\u003e m) { LinkedHashMap\u003cK,V\u003e lm = (LinkedHashMap\u003cK,V\u003e)m; // å¦‚æœæ˜¯è®¿é—®æ’åºï¼Œå°±æŠŠæŸ¥åˆ°çš„entryæ’åˆ°é¦–ä½ if (lm.accessOrder) { lm.modCount++; // å…ˆç§»é™¤ç›®æ ‡entryè‡ªèº« before.after = after; after.before = before; //æ’å…¥åˆ°headerä¹‹å‰ addBefore(lm.header); } } // LRUç®—æ³•ï¼ŒæŠŠå½“å‰entryæ’å…¥åˆ°headeré˜Ÿé¦–ä¹‹å‰ï¼Œæˆä¸ºæ–°çš„é˜Ÿé¦– private void addBefore(LinkedHashMapEntry\u003cK,V\u003e existingEntry) { after = existingEntry; before = existingEntry.before; before.after = this; after.before = this; } é¦–å…ˆè°ƒç”¨HashMapçš„getEntryæ–¹æ³•ï¼Œæ ¹æ®keyæŸ¥åˆ°entryï¼Œç„¶åé€šè¿‡recordAccessæ–¹æ³•æŠŠæŸ¥åˆ°çš„entryè°ƒæ•´åˆ°é˜Ÿé¦–ä½ç½®ï¼Œè®©ä»–æœ€é å‰ï¼ï¼ï¼ LinkedHashMapçš„æ€»ç»“ åŸç†ï¼šä»¥HashMapæ¥ç»´æŠ¤æ•°æ®ç»“æ„ï¼Œä»¥LinkedListæ¥è®°å½•æ’å…¥é¡ºåºï¼› æ’å…¥å’ŒæŸ¥è¯¢å¤„ç†ï¼šä»¥å†…éƒ¨entryçš„addBeforeæ–¹æ³•æä¾›lruç®—æ³•ï¼ŒæŠŠå½“å‰çš„ç›®æ ‡entryæ’åˆ°é˜Ÿé¦–ï¼Œå®ç°ã€Œentryè¶Šé•¿æ—¶é—´ä¸æ“ä½œï¼Œæ’å…¥é¡ºåºå°±è¶Šé åã€ï¼› æ ¸å¿ƒå®¹å™¨ï¼šçˆ¶ç±»HashMapä¸­çš„tableä¸‰åˆ—è¡¨ï¼Œå’Œè‡ªå·±ç»´æŠ¤çš„headeråŒå‘é“¾ã€‚ ","date":"2021-09-15","objectID":"/lrucache/:0:1","series":[],"tags":[],"title":"LruCache","uri":"/lrucache/"},{"categories":[],"content":"LruCacheçš„å®ç° æ„é€ æ–¹æ³• private final LinkedHashMap\u003cK, V\u003e map; public LruCache(int maxSize) { if (maxSize \u003c= 0) { throw new IllegalArgumentException(\"maxSize \u003c= 0\"); } this.maxSize = maxSize; this.map = new LinkedHashMap\u003cK, V\u003e(0, 0.75f, true); } è®¾ç½®äº†æœ€å¤§å®¹é‡ï¼Œå¹¶ä¸”åˆå§‹åŒ–äº†ä¸€ä¸ªLinkedHashMapã€‚ putä¸getæ–¹æ³•(åŸºæœ¬å¯ä¸çœ‹) putæ–¹æ³•ï¼š public final V put(K key, V value) { V previous; synchronized (this) { putCount++; size += safeSizeOf(key, value); //å®é™…ä¸Šå°±æ˜¯è°ƒç”¨LinkedHashMapçš„put previous = map.put(key, value); if (previous != null) { size -= safeSizeOf(key, previous); } } if (previous != null) { entryRemoved(false, key, previous, value); } // å›æ”¶æœºåˆ¶åœ¨æ¬¡ trimToSize(maxSize); return previous; } getæ–¹æ³•ï¼š public final V get(K key) { V mapValue; synchronized (this) { mapValue = map.get(key); if (mapValue != null) { hitCount++; return mapValue; } missCount++; } V createdValue = create(key); if (createdValue == null) { return null; } synchronized (this) { createCount++; mapValue = map.put(key, createdValue); if (mapValue != null) { // There was a conflict so undo that last put map.put(key, mapValue); } else { size += safeSizeOf(key, createdValue); } } if (mapValue != null) { entryRemoved(false, key, createdValue, mapValue); return mapValue; } else { // å›æ”¶æœºåˆ¶åœ¨æ¬¡ trimToSize(maxSize); return createdValue; } } ç”¨æ¥å›æ”¶çš„trimToSizeæ–¹æ³• public void trimToSize(int maxSize) { // æ°¸åŠ¨æœº while (true) { K key; V value; synchronized (this) { if (size \u003c= maxSize) { break; } // æ‹¿åˆ°æœ€è€çš„entry Map.Entry\u003cK, V\u003e toEvict = map.eldest(); if (toEvict == null) { break; } key = toEvict.getKey(); value = toEvict.getValue(); // ç§»é™¤æœ€è€çš„å®¶ä¼™ map.remove(key); size -= safeSizeOf(key, value); evictionCount++; } // å•çº¯çš„å›è°ƒ entryRemoved(true, key, value, null); } } ä»linkedHashMapä¸­ï¼Œå¾ªç¯ç§»é™¤æœ€è€çš„entryï¼Œç›´åˆ°å½“å‰sizeå°äºmaxSizeã€‚ ","date":"2021-09-15","objectID":"/lrucache/:0:2","series":[],"tags":[],"title":"LruCache","uri":"/lrucache/"},{"categories":[],"content":"æ€»ç»“LruCacheçš„åŸç† å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªLinkedHashMapï¼Œå¯ä»¥è®¾ç½®æœ€å¤§å®¹é‡ï¼Œæ¯æ¬¡putå’Œgetæ—¶ï¼Œéƒ½ä¼šå¾ªç¯ç§»é™¤linkedHashMapçš„é˜Ÿå°¾ï¼Œç›´åˆ°å°äºmaxSizeã€‚ ","date":"2021-09-15","objectID":"/lrucache/:0:3","series":[],"tags":[],"title":"LruCache","uri":"/lrucache/"},{"categories":[],"content":"RealCallä¸­çš„ä¼ å€¼ ... interceptors.add(new BridgeInterceptor(client.cookieJar())); ... RealCallåœ¨åˆ›å»ºè¿™ä¸ªæ‹¦æˆªå™¨çš„æ—¶å€™åªä¼ é€’äº†ä¸€ä¸ªcookieJarã€‚ ","date":"2021-09-07","objectID":"/bridgeinterceptor/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"BridgeInterceptor","uri":"/bridgeinterceptor/"},{"categories":[],"content":"ä½œç”¨ è¿™ä¸ªç±»çš„æ³¨é‡Šå¦‚ä¸‹ï¼š Bridges from application code to network code. First it builds a network request from a user request. Then it proceeds to call the network. Finally it builds a user response from the network response. æ„æ€æ˜¯ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„codeä¸ç½‘ç»œè¿æ¥çš„codeä¹‹é—´æ¡¥æ¥ã€‚å…ˆé€šè¿‡ç”¨æˆ·çš„requeståˆ›å»ºä¸€ä¸ªç½‘ç»œrequestã€‚ç„¶åæ‰§è¡Œç½‘ç»œä»»åŠ¡ã€‚æœ€åä»ç½‘ç»œçš„responseåˆ›å»ºä¸€ä¸ªç”¨æˆ·çš„å“åº”responseã€‚ ç¿»è¯‘å®Œäº†ç±»æ³¨é‡Šï¼Œå†æ¥çœ‹ä»£ç å°±å¾ˆå¥½ç†è§£äº†ã€‚ ","date":"2021-09-07","objectID":"/bridgeinterceptor/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"BridgeInterceptor","uri":"/bridgeinterceptor/"},{"categories":[],"content":"BridgeInterceptorçš„å¤„ç†è¿‡ç¨‹ public final class BridgeInterceptor implements Interceptor { private final CookieJar cookieJar; public BridgeInterceptor(CookieJar cookieJar) { this.cookieJar = cookieJar; } @Override public Response intercept(Chain chain) throws IOException { //------------------requestå¤„ç† // ä»ã€Œæ‹¦æˆªå™¨ç®¡ç†å™¨ã€ä¸­æ‹¿åˆ°æ‰€è°“çš„ç”¨æˆ·request Request userRequest = chain.request(); Request.Builder requestBuilder = userRequest.newBuilder(); RequestBody body = userRequest.body(); // å„ç§æ¡¥æ¥è½¬æ¢ if (body != null) { MediaType contentType = body.contentType(); if (contentType != null) { requestBuilder.header(\"Content-Type\", contentType.toString()); } long contentLength = body.contentLength(); if (contentLength != -1) { requestBuilder.header(\"Content-Length\", Long.toString(contentLength)); requestBuilder.removeHeader(\"Transfer-Encoding\"); } else { requestBuilder.header(\"Transfer-Encoding\", \"chunked\"); requestBuilder.removeHeader(\"Content-Length\"); } } if (userRequest.header(\"Host\") == null) { requestBuilder.header(\"Host\", hostHeader(userRequest.url(), false)); } if (userRequest.header(\"Connection\") == null) { requestBuilder.header(\"Connection\", \"Keep-Alive\"); } // If we add an \"Accept-Encoding: gzip\" header field we're responsible for also decompressing // the transfer stream. boolean transparentGzip = false; if (userRequest.header(\"Accept-Encoding\") == null \u0026\u0026 userRequest.header(\"Range\") == null) { transparentGzip = true; requestBuilder.header(\"Accept-Encoding\", \"gzip\"); } List\u003cCookie\u003e cookies = cookieJar.loadForRequest(userRequest.url()); // é™„åŠ cookie if (!cookies.isEmpty()) { requestBuilder.header(\"Cookie\", cookieHeader(cookies)); } // é™„åŠ OkHttpè‡ªå·±çš„UA if (userRequest.header(\"User-Agent\") == null) { requestBuilder.header(\"User-Agent\", Version.userAgent()); } //------------------responseå¤„ç† Response networkResponse = chain.proceed(requestBuilder.build()); HttpHeaders.receiveHeaders(cookieJar, userRequest.url(), networkResponse.headers()); Response.Builder responseBuilder = networkResponse.newBuilder() .request(userRequest); if (transparentGzip \u0026\u0026 \"gzip\".equalsIgnoreCase(networkResponse.header(\"Content-Encoding\")) \u0026\u0026 HttpHeaders.hasBody(networkResponse)) { GzipSource responseBody = new GzipSource(networkResponse.body().source()); Headers strippedHeaders = networkResponse.headers().newBuilder() .removeAll(\"Content-Encoding\") .removeAll(\"Content-Length\") .build(); responseBuilder.headers(strippedHeaders); String contentType = networkResponse.header(\"Content-Type\"); responseBuilder.body(new RealResponseBody(contentType, -1L, Okio.buffer(responseBody))); } return responseBuilder.build(); } /** Returns a 'Cookie' HTTP request header with all cookies, like {@code a=b; c=d}. */ private String cookieHeader(List\u003cCookie\u003e cookies) { StringBuilder cookieHeader = new StringBuilder(); for (int i = 0, size = cookies.size(); i \u003c size; i++) { if (i \u003e 0) { cookieHeader.append(\"; \"); } Cookie cookie = cookies.get(i); cookieHeader.append(cookie.name()).append('=').append(cookie.value()); } return cookieHeader.toString(); } } ","date":"2021-09-07","objectID":"/bridgeinterceptor/:0:3","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"BridgeInterceptor","uri":"/bridgeinterceptor/"},{"categories":[],"content":"æ€»ç»“ çœ‹å®Œä¹‹åï¼Œæˆ‘çš„æ„Ÿæƒ³å°±æ˜¯ä¸€å®šä¸è¦ç›¸ä¿¡ç±»æ³¨é‡Šã€‚ è¿™ä¸ªæ‹¦æˆªå™¨ç¡®å®æ˜¯ç±»æ³¨é‡Šæè¿°çš„é‚£æ ·ï¼ŒæŠŠç”¨æˆ·çš„è¯·æ±‚è½¬ä¸ºç½‘ç»œè¯·æ±‚ï¼ŒæŠŠç½‘ç»œå“åº”è½¬ä¸ºç”¨æˆ·å“åº”ï¼Œä½†æ˜¯ï¼š å¤„ç†requestè¿‡ç¨‹ä¸­ï¼Œé™„åŠ äº†cookieå’Œè‡ªå·±çš„UAï¼› å¤„ç†responseè¿‡ç¨‹ä¸­ï¼Œä¸ºresponseé™„åŠ äº†è¯·æ±‚ä¸­çš„urlï¼Œä»¥ä¾¿äºè¾¨è®¤ã€‚ ","date":"2021-09-07","objectID":"/bridgeinterceptor/:0:4","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"BridgeInterceptor","uri":"/bridgeinterceptor/"},{"categories":[],"content":"RealCallä¸­çš„ä¼ å€¼ ... interceptors.add(new CacheInterceptor(client.internalCache())); ... RealCallåœ¨åˆ›å»ºè¿™ä¸ªæ‹¦æˆªå™¨çš„æ—¶å€™åªä¼ é€’äº†ä¸€ä¸ªcookieJarã€‚ ","date":"2021-09-07","objectID":"/cacheinterceptor/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"CacheInterceptor","uri":"/cacheinterceptor/"},{"categories":[],"content":"ä½œç”¨ è¿™ä¸ªç±»çš„æ³¨é‡Šå¦‚ä¸‹ï¼š Serves requests from the cache and writes responses to the cache. å°±æ˜¯ä»ç¼“å­˜ä¸­è¯·æ±‚ï¼Œå¹¶æŠŠå“åº”å†™å…¥ç¼“å­˜ã€‚ ç¿»è¯‘å®Œäº†ç±»æ³¨é‡Šï¼Œå†æ¥çœ‹ä»£ç å°±å¾ˆå¥½ç†è§£äº†ã€‚ ","date":"2021-09-07","objectID":"/cacheinterceptor/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"CacheInterceptor","uri":"/cacheinterceptor/"},{"categories":[],"content":"BridgeInterceptorçš„å¤„ç†è¿‡ç¨‹ public final class CacheInterceptor implements Interceptor { final InternalCache cache; public CacheInterceptor(InternalCache cache) { this.cache = cache; } @Override public Response intercept(Chain chain) throws IOException { Response cacheCandidate = cache != null ? cache.get(chain.request()) : null; long now = System.currentTimeMillis(); CacheStrategy strategy = new CacheStrategy.Factory(now, chain.request(), cacheCandidate).get(); Request networkRequest = strategy.networkRequest; Response cacheResponse = strategy.cacheResponse; if (cache != null) { cache.trackResponse(strategy); } if (cacheCandidate != null \u0026\u0026 cacheResponse == null) { closeQuietly(cacheCandidate.body()); // The cache candidate wasn't applicable. Close it. } // å¦‚æœæ²¡æœ‰æƒé™ï¼Œå¹¶ä¸”ç¼“å­˜ä¸è¶³ï¼Œç›´æ¥è¿”å›504 if (networkRequest == null \u0026\u0026 cacheResponse == null) { return new Response.Builder() .request(chain.request()) .protocol(Protocol.HTTP_1_1) .code(504) .message(\"Unsatisfiable Request (only-if-cached)\") .body(Util.EMPTY_RESPONSE) .sentRequestAtMillis(-1L) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); } // å¦‚æœä¸éœ€è¦ç½‘ç»œï¼Œå¹¶ä¸”å·²ç»ç¼“å­˜è¿‡è¯·æ±‚ï¼Œåˆ™ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å“åº”å¹¶è¿”å› if (networkRequest == null) { return cacheResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .build(); } //-------------response å¤„ç†è¿‡ç¨‹ Response networkResponse = null; try { networkResponse = chain.proceed(networkRequest); } finally { if (networkResponse == null \u0026\u0026 cacheCandidate != null) { closeQuietly(cacheCandidate.body()); } } // If we have a cache response too, then we're doing a conditional get. if (cacheResponse != null) { if (networkResponse.code() == HTTP_NOT_MODIFIED) { Response response = cacheResponse.newBuilder() .headers(combine(cacheResponse.headers(), networkResponse.headers())) .sentRequestAtMillis(networkResponse.sentRequestAtMillis()) .receivedResponseAtMillis(networkResponse.receivedResponseAtMillis()) .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); networkResponse.body().close(); // Update the cache after combining headers but before stripping the // Content-Encoding header (as performed by initContentStream()). cache.trackConditionalCacheHit(); cache.update(cacheResponse, response); return response; } else { closeQuietly(cacheResponse.body()); } } Response response = networkResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); if (cache != null) { if (HttpHeaders.hasBody(response) \u0026\u0026 CacheStrategy.isCacheable(response, networkRequest)) { // Offer this request to the cache. CacheRequest cacheRequest = cache.put(response); return cacheWritingResponse(cacheRequest, response); } if (HttpMethod.invalidatesCache(networkRequest.method())) { try { cache.remove(networkRequest); } catch (IOException ignored) { // The cache cannot be written. } } } return response; } private static Response stripBody(Response response) { return response != null \u0026\u0026 response.body() != null ? response.newBuilder().body(null).build() : response; } /** * Returns a new source that writes bytes to {@code cacheRequest} as they are read by the source * consumer. This is careful to discard bytes left over when the stream is closed; otherwise we * may never exhaust the source stream and therefore not complete the cached response. */ private Response cacheWritingResponse(final CacheRequest cacheRequest, Response response) throws IOException { // Some apps return a null body; for compatibility we treat that like a null cache request. if (cacheRequest == null) return response; Sink cacheBodyUnbuffered = cacheRequest.body(); if (cacheBodyUnbuffered == null) return response; final BufferedSource source = response.body().source(); final BufferedSink cacheBody = Okio.buffer(cacheBodyUnbuffered); Source cacheWritingSource = new Source() { boolean cacheRequestClosed; @Override public long read(Buffer sink, long byteCount) throws IOException { long bytesRead; try { bytesRead = source.read(sink, byteCount); } cat","date":"2021-09-07","objectID":"/cacheinterceptor/:0:3","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"CacheInterceptor","uri":"/cacheinterceptor/"},{"categories":[],"content":"ç¼“å­˜DiskLruCache public final class Cache implements Closeable, Flushable { final InternalCache internalCache = new InternalCache() { @Override public Response get(Request request) throws IOException { return Cache.this.get(request); } @Override public CacheRequest put(Response response) throws IOException { return Cache.this.put(response); } @Override public void remove(Request request) throws IOException { Cache.this.remove(request); } @Override public void update(Response cached, Response network) { Cache.this.update(cached, network); } @Override public void trackConditionalCacheHit() { Cache.this.trackConditionalCacheHit(); } @Override public void trackResponse(CacheStrategy cacheStrategy) { Cache.this.trackResponse(cacheStrategy); } }; /// æ‰¾åˆ°äº†ï¼Œå°±æ˜¯é çš„è¿™ç©æ„ final DiskLruCache cache; DiskLruCacheæ˜¯ç¡¬ç›˜ç¼“å­˜ï¼Œå¯¹åº”çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªLruCacheæ˜¯å†…å­˜ç¼“å­˜ç¼“å­˜ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å»å­¦ä¹ è¿™ä¸¤ä¸ªç¼“å­˜äº†ã€‚ ","date":"2021-09-07","objectID":"/cacheinterceptor/:0:4","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"CacheInterceptor","uri":"/cacheinterceptor/"},{"categories":[],"content":"CallServerInterceptor è´Ÿè´£å®é™…ä¸serveräº¤äº’ï¼ˆå†™è¯»ï¼‰ï¼Œå¹¶ä¸”å®Œæˆäº†æŠ¥æ–‡çš„å°è£…ä¸è§£æã€‚ @Override public Response intercept(Chain chain) throws IOException { RealInterceptorChain realChain = (RealInterceptorChain) chain; // ç”¨æ¥ç¼–ç httpè¯·æ±‚å’Œè§£ç httpå“åº” HttpCodec httpCodec = realChain.httpStream(); // æ­¤æ—¶åº”è¯¥ä¸ºnull StreamAllocation streamAllocation = realChain.streamAllocation(); // æ­¤æ—¶åº”è¯¥ä¸ºnull RealConnection connection = (RealConnection) realChain.connection(); // æ‹¿åˆ°request Request request = realChain.request(); long sentRequestMillis = System.currentTimeMillis(); // è°ƒç”¨çŠ¶æ€ç›‘å¬å™¨ï¼Œå¹¶ä¸”ä¼ é€’AsyncCallå¯¹è±¡ realChain.eventListener().requestHeadersStart(realChain.call()); // æ‰§è¡Œå†™å…¥ httpCodec.writeRequestHeaders(request); // é€šçŸ¥çŠ¶æ€ realChain.eventListener().requestHeadersEnd(realChain.call(), request); Response.Builder responseBuilder = null; // å¦‚æœä¸æ˜¯GETæˆ–HEADè¯·æ±‚ï¼Œå¹¶ä¸”å¸¦æœ‰è¯·æ±‚ä½“ if (HttpMethod.permitsRequestBody(request.method()) \u0026\u0026 request.body() != null) { // If there's a \"Expect: 100-continue\" header on the request, wait for a \"HTTP/1.1 100 // Continue\" response before transmitting the request body. If we don't get that, return // what we did get (such as a 4xx response) without ever transmitting the request body. if (\"100-continue\".equalsIgnoreCase(request.header(\"Expect\"))) { // å†™å…¥requestå®Œæˆ httpCodec.flushRequest(); realChain.eventListener().responseHeadersStart(realChain.call()); // å¼€å§‹è¯»å–response responseBuilder = httpCodec.readResponseHeaders(true); } if (responseBuilder == null) { // Write the request body if the \"Expect: 100-continue\" expectation was met. realChain.eventListener().requestBodyStart(realChain.call()); long contentLength = request.body().contentLength(); CountingSink requestBodyOut = new CountingSink(httpCodec.createRequestBody(request, contentLength)); BufferedSink bufferedRequestBody = Okio.buffer(requestBodyOut); request.body().writeTo(bufferedRequestBody); bufferedRequestBody.close(); realChain.eventListener() .requestBodyEnd(realChain.call(), requestBodyOut.successfulCount); } else if (!connection.isMultiplexed()) { // If the \"Expect: 100-continue\" expectation wasn't met, prevent the HTTP/1 connection // from being reused. Otherwise we're still obligated to transmit the request body to // leave the connection in a consistent state. streamAllocation.noNewStreams(); } } httpCodec.finishRequest(); if (responseBuilder == null) { realChain.eventListener().responseHeadersStart(realChain.call()); responseBuilder = httpCodec.readResponseHeaders(false); } // æ„å»ºresponse Response response = responseBuilder .request(request) .handshake(streamAllocation.connection().handshake()) .sentRequestAtMillis(sentRequestMillis) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); int code = response.code(); if (code == 100) { // server sent a 100-continue even though we did not request one. // try again to read the actual response // 100çŠ¶æ€ç ï¼Œç”¨æ¥è¡¨ç¤ºè¯·æ±‚è¢«æ­£å¸¸æ¥å—ï¼Œéœ€è¿›ä¸€æ­¥å¤„ç†ï¼Œéœ€è¦å®¢æˆ·ç«¯ç»§ç»­è¯·æ±‚ responseBuilder = httpCodec.readResponseHeaders(false); response = responseBuilder .request(request) .handshake(streamAllocation.connection().handshake()) .sentRequestAtMillis(sentRequestMillis) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); code = response.code(); } realChain.eventListener() .responseHeadersEnd(realChain.call(), response); if (forWebSocket \u0026\u0026 code == 101) { // Connection is upgrading, but we need to ensure interceptors see a non-null response body. // 101çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨å·²æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯éœ€è¦å®¢æˆ·ç«¯åˆ‡æ¢åè®®æ¥è¿›ä¸€æ­¥å¤„ç† response = response.newBuilder() .body(Util.EMPTY_RESPONSE) .build(); } else { response = response.newBuilder() .body(httpCodec.openResponseBody(response)) .build(); } if (\"close\".equalsIgnoreCase(response.request().header(\"Connection\")) || \"close\".equalsIgnoreCase(response.header(\"Connection\"))) { streamAllocation.noNewStreams(); } // 204/205çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸå¤„ç†è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¿”å›å“åº”ä½“ã€‚ if ((code == 204 || code == 205) \u0026\u0026 response.body().contentLength() \u003e 0) { throw new ProtocolException( \"HTTP \" + code + \" had non-zero Content-Length: \" + response.body().contentLength()); } return response; } ","date":"2021-09-07","objectID":"/callserverinterceptor/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"CallServerInterceptor","uri":"/callserverinterceptor/"},{"categories":[],"content":"ConnectInterceptor è¿æ¥æ‹¦æˆªå™¨ ä½œä¸ºç¬¬äºŒä¸ªå®é™…ç”Ÿæ•ˆçš„æ‹¦æˆªå™¨ï¼ŒConnectInterceptor çš„ä»£ç éå¸¸ç®€å•ã€‚ public final class ConnectInterceptor implements Interceptor { public final OkHttpClient client; public ConnectInterceptor(OkHttpClient client) { this.client = client; } @Override public Response intercept(Chain chain) throws IOException { RealInterceptorChain realChain = (RealInterceptorChain) chain; Request request = realChain.request(); StreamAllocation streamAllocation = realChain.streamAllocation(); // requestçš„å¥åº·æ£€æŸ¥ï¼Œå…¶å®å°±æ˜¯ä¸å…è®¸GETè¯·æ±‚ï¼Œçœ‹åˆ°è¿™æˆ‘æŒºçº³é—· boolean doExtensiveHealthChecks = !request.method().equals(\"GET\"); // å¤ç”¨/åˆ›å»ºä¸€ä¸ªæµ HttpCodec httpCodec = streamAllocation.newStream(client, chain, doExtensiveHealthChecks); // å»ºç«‹è¿æ¥ RealConnection connection = streamAllocation.connection(); // è°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ return realChain.proceed(request, streamAllocation, httpCodec, connection); } } ConnectInterceptorçš„ä½œç”¨æ­£å¦‚å¥¹çš„å‘½åï¼Œæ˜¯é€‰æ‹©å¹¶å¯åŠ¨è¿æ¥çš„ã€‚ ","date":"2021-09-07","objectID":"/connectinterceptor/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"ConnectInterceptorä¸StreamAllocation","uri":"/connectinterceptor/"},{"categories":[],"content":"StreamAllocation æ•°æ®æµåˆ†é…å™¨ è¿™ç©æ„æºç ä¸å¤æ‚ï¼Œæ˜¯è¶…çº§å¤æ‚ğŸ˜­ã€‚ åˆå§‹åŒ–è°ƒç”¨ public final class RetryAndFollowUpInterceptor implements Interceptor { ... @Override public Response intercept(Chain chain) throws IOException { ... // åˆå§‹åŒ–æ•°æ®æµåˆ†é…å™¨ StreamAllocation streamAllocation = new StreamAllocation(client.connectionPool(),createAddress(request.url()), call, eventListener, callStackTrace); StreamAllocationæ˜¯åœ¨RetryAndFollowUpInterceptoræ‹¦æˆªæ—¶è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œä¼ é€’äº†clientçš„è¿æ¥æ± ï¼Œurlï¼Œcallï¼Œå’ŒeventListenerã€‚ æºç  public final class StreamAllocation { // åœ°å€ public final Address address; private RouteSelector.Selection routeSelection; private Route route; private final ConnectionPool connectionPool; public final Call call; public final EventListener eventListener; private final Object callStackTrace; // State guarded by connectionPool. private final RouteSelector routeSelector; private int refusedStreamCount; private RealConnection connection; private boolean reportedAcquired; private boolean released; private boolean canceled; private HttpCodec codec; // åœ¨RetryAndFollowUpInterceptorä¸­è°ƒç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ– public StreamAllocation(ConnectionPool connectionPool, Address address, Call call, EventListener eventListener, Object callStackTrace) { this.connectionPool = connectionPool; this.address = address; this.call = call; this.eventListener = eventListener; this.routeSelector = new RouteSelector(address, routeDatabase(), call, eventListener); this.callStackTrace = callStackTrace; } /** * åœ¨ConnectInterceptorä¸­è°ƒç”¨ * åˆ›å»ºæ–°çš„æµï¼Œè¿”å›HttpCodec * æ³¨æ„âš ï¸ï¼šdoExtensiveHealthChecks å¦‚æœä¸æ˜¯GETè¯·æ±‚å°±æ˜¯true */ public HttpCodec newStream( OkHttpClient client, Interceptor.Chain chain, boolean doExtensiveHealthChecks) { int connectTimeout = chain.connectTimeoutMillis(); int readTimeout = chain.readTimeoutMillis(); int writeTimeout = chain.writeTimeoutMillis(); int pingIntervalMillis = client.pingIntervalMillis(); boolean connectionRetryEnabled = client.retryOnConnectionFailure(); try { // æ‰¾åˆ°ä¸€ä¸ªå¥åº·çš„è¿æ¥ RealConnection resultConnection = findHealthyConnection(connectTimeout, readTimeout, writeTimeout, pingIntervalMillis, connectionRetryEnabled, doExtensiveHealthChecks); // åˆå§‹åŒ– HttpCodec HttpCodec resultCodec = resultConnection.newCodec(client, chain, this); synchronized (connectionPool) { codec = resultCodec; return resultCodec; } } catch (IOException e) { throw new RouteException(e); } } /** * æ‰¾åˆ°ä¸€ä¸ªå¥åº·çš„è¿æ¥ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸ªå¥åº·çš„ */ private RealConnection findHealthyConnection(int connectTimeout, int readTimeout, int writeTimeout, int pingIntervalMillis, boolean connectionRetryEnabled, boolean doExtensiveHealthChecks) throws IOException { // æ³¨æ„è¿™ä¸ªæ°¸åŠ¨æœº while (true) { // ä»è¿æ¥æ± ä¸­æ‹¿å‡ºä¸€ä¸ªè¿æ¥ RealConnection candidate = findConnection(connectTimeout, readTimeout, writeTimeout, pingIntervalMillis, connectionRetryEnabled); // æ‰€è°“ã€Œå¥åº·ã€çš„è¿æ¥ï¼Œå°±æ˜¯successCountä¸º0 synchronized (connectionPool) { if (candidate.successCount == 0) { return candidate; } } // å¦‚æœæ²¡æœ‰å¥åº·çš„è¿æ¥ï¼Œå°±ç»§ç»­å¾ªç¯å»ç­‰ if (!candidate.isHealthy(doExtensiveHealthChecks)) { noNewStreams(); continue; } return candidate; } } // è¿”å›ä¸€ä¸ªè¿æ¥ï¼Œä¼˜å…ˆè¿”å›è¿æ¥æ± ä¸­å·²ç»å­˜åœ¨çš„ï¼Œæ²¡æœ‰åˆ™åˆ›å»º private RealConnection findConnection(int connectTimeout, int readTimeout, int writeTimeout, int pingIntervalMillis, boolean connectionRetryEnabled) throws IOException { boolean foundPooledConnection = false; RealConnection result = null; Route selectedRoute = null; Connection releasedConnection; Socket toClose; //é”åŠ åˆ°äº†è¿æ¥æ± ä¸Š synchronized (connectionPool) { if (released) throw new IllegalStateException(\"released\"); if (codec != null) throw new IllegalStateException(\"codec != null\"); if (canceled) throw new IOException(\"Canceled\"); // å°è¯•ä½¿ç”¨å·²åˆ†é…çš„è¿æ¥ã€‚æˆ‘ä»¬éœ€è¦å°å¿ƒï¼Œå› ä¸ºæˆ‘ä»¬çš„ã€Œå·²åˆ†é…ã€è¿æ¥å¯èƒ½å·²è¢«é™åˆ¶åˆ›å»ºæ–°æµã€‚ releasedConnection = this.connection; // å…³é—­è¿æ¥ï¼Œå›æ”¶socket toClose = releaseIfNoNewStreams(); // å¤ç”¨this.connection if (this.connection != null) { result = this.connection; releasedConnection = null; } if (!reportedAcquired) { // If the connection was never reported acquired, don't report it as released! releasedConnection = null; } if (result == null) { // ä»è¿æ¥æ± ä¸­æ‹¿å‡ºä¸€ä¸ªè¿æ¥ï¼Œè¿™å—æœ‰ç‚¹éº»çƒ¦ï¼Œæˆ‘è®°å¾—Internal.instanceæ˜¯åœ¨clientä¸­åˆå§‹åŒ–äº†ä¸€ä¸ªåŒ¿åç±»ï¼Œå›å¤´å†çœ‹ä¸€ä¸‹å» Inter","date":"2021-09-07","objectID":"/connectinterceptor/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"ConnectInterceptorä¸StreamAllocation","uri":"/connectinterceptor/"},{"categories":[],"content":"quarkuså¯ä»¥ä».propertiesæ–‡ä»¶ä¸­è¯»å–é…ç½®ã€‚ ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:0:0","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"å®šä¹‰é…ç½® åœ¨.propertiesæ–‡ä»¶ä¸­å®šä¹‰é…ç½®ï¼š greeting.message = hello greeting.name = quarkus ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:1:0","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"é…ç½®æº (400) System properties (300) Environment variables (295) å½“å‰å·¥ä½œç›®å½•ä¸­çš„.envæ–‡ä»¶ (260) Quarkus Application configuration file in $PWD/config/application.properties (250) Quarkus Application configuration file application.properties in classpath (100) MicroProfile Config configuration file META-INF/microprofile-config.properties in classpath æœ€ç»ˆçš„é…ç½®æ˜¯ä¸Šé¢è¿™äº›æºä¸­é…ç½®çš„èšåˆï¼Œquarkusæ˜¯ä»ä½åºå·åˆ°é«˜åºå·è¿›è¡Œmergeï¼Œåºå·è¶Šé«˜å°±è¶Šé ååŠ è½½ï¼ŒåŒ…è¯äº†ç³»ç»Ÿå±æ€§çš„å®‰å…¨æ€§ï¼Œä¹Ÿæ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨é«˜åºå·æºä¸­å®šä¹‰ç›¸åŒçš„é…ç½®æ¥è¦†ç›–ä½åºå·æºä¸­çš„é…ç½®ã€‚ System properties ç³»ç»Ÿå±æ€§å¯ä»¥åœ¨å¯åŠ¨æœŸé—´å°†é…ç½®ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚ï¼š ./mvnw quarkus:dev -Dquarkus.datasource.password=youshallnotpass or java -Dquarkus.datasource.password=youshallnotpass -jar target/quarkus-app/quarkus-run.jar Environment variables å°±æ˜¯ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ã€‚æ¯”å¦‚ï¼š export QUARKUS_DATASOURCE_PASSWORD=youshallnotpass ; java -jar target/quarkus-app/quarkus-run.jar .envæ–‡ä»¶ QUARKUS_DATASOURCE_PASSWORD=youshallnotpass ä¸€èˆ¬ä½äºæ ¹ç›®å½•ä¸­ï¼Œå¹¶ä¸”ä¸æ¨èåŠ å…¥VersionControlä¸­ã€‚ ApplicationConfigurationæ–‡ä»¶ æ–‡ä»¶ä½ç½® ä¸€èˆ¬ä½äºsrc/main/resources/application.propertiesä¸­ åœ¨æµ‹è¯•ç³»ç»Ÿä¸­ä¹Ÿå¯ä»¥æœ‰å•ç‹¬çš„é…ç½®æ–‡ä»¶src/test/resources/application.properties ä¹Ÿå¯ä»¥åŠ è½½jarä¸­çš„é…ç½® æ–‡ä»¶å†…å®¹ï¼š // ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰é…ç½® greeting.message=hello // ç³»ç»Ÿæ‰©å±•ä¹Ÿä»è¿™é‡ŒåŠ è½½é…ç½® quarkus.http.port=9090 å¤šç¯å¢ƒé…ç½® quarkusé»˜è®¤æœ‰ä¸‰ä¸ªç¯å¢ƒé…ç½®ï¼š dev å¼€å‘æ—¶æ¿€æ´»ï¼ˆquarkus:devï¼‰ test æµ‹è¯•æ—¶æ¿€æ´» prod é»˜è®¤é…ç½® æ ¼å¼ï¼š%{profile-name}.config.name eg: quarkus.http.port=9090 %dev.quarkus.http.port=8181 ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç«¯å£å·æ˜¯9090ï¼Œä½†æ˜¯å½“å¤„äºdevç¯å¢ƒæ—¶åˆ™æ˜¯8181ã€‚å¦‚æœdevç¯å¢ƒæ²¡æœ‰è®¾ç½®å€¼ï¼Œåˆ™å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚ è‡ªå®šä¹‰ç¯å¢ƒé…ç½® quarkus.http.port=9090 %custom.quarkus.http.port=9999 çˆ¶é…ç½® å¯ä»¥é€šè¿‡quarkus.config.profile.parentè®¾ç½®ä¸€ä¸ªçˆ¶é…ç½®ï¼Œå¦‚æœåœ¨å½“å‰æ´»è·ƒçš„é…ç½®ä¸­æ‰¾ä¸åˆ°æŸä¸ªå±æ€§ï¼Œå°±ä¼šå»æŸ¥æ‰¾çˆ¶é…ç½®ï¼š quarkus.profile=dev quarkus.config.profile.parent=common %common.quarkus.http.port=9090 %dev.quarkus.http.ssl-port=9443 quarkus.http.port=8080 quarkus.http.ssl-port=8443 è§£é‡Šï¼šå½“å‰é‡‡ç”¨devç¯å¢ƒï¼Œçˆ¶é…ç½®æ˜¯commonï¼Œquarkus.http.portä¼šå…ˆæŸ¥æ‰¾devç¯å¢ƒï¼Œå‘ç°devæ²¡æœ‰è®¾ç½®è¿™ä¸€é¡¹ï¼Œå†å»æŸ¥æ‰¾çˆ¶é…ç½®ï¼Œæ‰€ä»¥æœ€åå®é™…ä¸Šä¼šé‡‡ç”¨çˆ¶é…ç½®çš„å€¼9090;quarkus.http.ssl-portå…ˆå»æŸ¥æ‰¾devç¯å¢ƒï¼Œæ‰¾åˆ°äº†å€¼9443ï¼Œå°±ä¸ä¼šå†å»æŸ¥æ‰¾çˆ¶é…ç½®ï¼Œæ‰€ä»¥æœ€ç»ˆå€¼æ˜¯9443ã€‚ å±æ€§è¡¨è¾¾å¼ è¯­æ³•ï¼š ${ â€¦â€‹ } ä¸€èˆ¬ä½¿ç”¨ ${expression:value} é»˜è®¤å€¼æ–¹å¼ ${my.prop${compose}} ç»„åˆè¡¨è¾¾å¼ ${my.prop}${my.prop} å¤šè¡¨è¾¾å¼ ${quarkus.uuid} ç”ŸæˆUUID eg: remote.host=quarkus.io // å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šé¢å®šä¹‰å¥½çš„å±æ€§ callable.url=https://${remote.host}/ ç´¢å¼•å±æ€§ my.collection=dog,cat,turtle my.indexed.collection[0]=dog my.indexed.collection[1]=cat my.indexed.collection[2]=turtle ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:1:1","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"è‡ªå¸¦é…ç½® Quarkusè‡ªå¸¦çš„é…ç½®å±æ€§ï¼Œå…¶ä¸­å¸¦é”çš„æ˜¯æ„å»ºæ—¶é…ç½®ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶ä¿®æ”¹ã€‚ ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:1:2","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"è¯»å–é…ç½®ä¿¡æ¯ ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:2:0","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"æ³¨å…¥æ–¹å¼ å¯ä»¥åœ¨resourceä¸­æ³¨å…¥é…ç½®ä¿¡æ¯ï¼š @Path(\"/greeting\") public class GreetingResource { @ConfigProperty(name = \"greeting.message\") String message; /** * é»˜è®¤å€¼ */ @ConfigProperty(name = \"greeting.suffix\", defaultValue = \"!\") String suffix; /** * å¯é€‰æ–¹å¼ï¼Œå¯ä»¥é¿å…ç©ºæŒ‡é’ˆ */ @ConfigProperty(name = \"greeting.name\") Optional\u003cString\u003e name; @GET @Produces(MediaType.TEXT_PLAIN) public String hello() { return message + \" \" + name.orElse(\"world\") + suffix; } } ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:2:1","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"è·å–æ–¹å¼ @GET @Produces(MediaType.TEXT_PLAIN) public String hello() { String message = ConfigProvider.getConfig().getValue(\"greeting.message\", String.class); Optional\u003cString\u003e name = ConfigProvider.getConfig().getOptionalValue(\"greeting.name\", String.class); return message + \" \" + name.get(); } ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:2:2","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"è£…ç®±æ–¹å¼ å‡è®¾æœ‰é…ç½®ï¼š greeting.message = hello greeting.name = quarkus æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@ConfigMappingæŠŠæ‰€æœ‰åŒä¸€å‰ç¼€çš„å±æ€§è£…ç®±æˆä¸€ä¸ªæ¥å£ï¼š // æ”¯æŒé€—å·åˆ†éš”å¤šä¸ª @ConfigMapping(prefix = \"greeting\") public interface Greeting { // å‘½åå¿…é¡»ä¸å±æ€§ä¸€è‡´ String name(); String message(); } ç„¶ååœ¨è°ƒç”¨æ—¶å°±å¯ä»¥ç›´æ¥æ³¨å…¥å®ç°ç±»ï¼š @Path(\"/greeting\") public class GreetingResource { @Inject Greeting greeting; @GET @Produces(MediaType.TEXT_PLAIN) public String hello() { return greeting.message() + greeting.name(); } } åµŒå¥—æ–¹å¼ @ConfigMapping(prefix = \"server\") public interface Server { String host(); int port(); Log log(); interface Log { boolean enabled(); String suffix(); boolean rotate(); } } è¦†ç›–å±æ€§å @WithName å½“æˆ‘ä»¬çš„æ–¹æ³•å‘½åä¸é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§åç§°ä¸ä¸€è‡´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨@WithNameæ³¨è§£æ ‡æ˜ï¼š é…ç½®ï¼š server.name=localhost server.port=8080 æ˜ å°„ï¼š @ConfigMapping(prefix = \"server\") interface Server { @WithName(\"name\") String host(); int port(); } @WithParent ç»„åˆæ–¹å¼ã€‚ server.host=localhost server.port=8080 server.name=konoha interface Server { @WithParentName ServerHostAndPort hostAndPort(); @WithParentName ServerInfo info(); } interface ServerHostAndPort { String host(); int port(); } interface ServerInfo { String name(); } é©¼å³°å‘½åç­–ç•¥ server.the-host=localhost server.the-port=8080 ç”¨-æ¥åˆ†éš”å•è¯ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨é©¼å³°æ–¹å¼å‘½åçš„æ–¹æ³•æ¥æ˜ å°„ï¼š @ConfigMapping(prefix = \"server\") interface Server { String theHost(); int thePort(); } æ˜ å°„æ–¹æ³• é…ç½®ï¼š foo=foo æ˜ å°„ï¼š @ConfigMapping public interface Converters { @WithConverter(FooBarConverter.class) String foo(); } public static class FooBarConverter implements Converter\u003cString\u003e { @Override public String convert(final String value) { return \"bar\"; } } å½“æˆ‘ä»¬ä½¿ç”¨ foo()æ–¹æ³•æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šè¾“å‡ºfooï¼Œè€Œæ˜¯è¾“å‡ºbarã€‚ æ˜ å°„é›†åˆ é…ç½®ï¼š server.environments[0].name=dev server.environments[0].apps[0].name=rest server.environments[0].apps[0].services=bookstore,registration server.environments[0].apps[0].databases=pg,h2 server.environments[0].apps[1].name=batch server.environments[0].apps[1].services=stock,warehous æ˜ å°„ï¼š @ConfigMapping(prefix = \"server\") public interface ServerCollections { Set\u003cEnvironment\u003e environments(); interface Environment { String name(); List\u003cApp\u003e apps(); interface App { String name(); List\u003cString\u003e services(); Optional\u003cList\u003cString\u003e\u003e databases(); } } } æ˜ å°„Map é…ç½®ï¼š server.host=localhost server.port=8080 server.form.login-page=login.html server.form.error-page=error.html server.form.landing-page=index.html æ˜ å°„ï¼š @ConfigMapping(prefix = \"server\") public interface Server { String host(); int port(); Map\u003cString, String\u003e form(); } é»˜è®¤å€¼ public interface Defaults { @WithDefault(\"foo\") String foo(); @WithDefault(\"bar\") String bar(); } éªŒè¯é…ç½® @ConfigMapping(prefix = \"server\") interface Server { @Size(min = 2, max = 20) String host(); @Max(10000) int port(); } éœ€è¦quarkus-hibernate-validatoræ‰©å±•ã€‚ ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:2:3","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"æ‰©å±•é…ç½® ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å®é™…çš„å·¥ä½œä¸­å¯èƒ½ä¸æ­¢devã€testã€prodä¸‰ç§ç¯å¢ƒï¼Œå¯èƒ½è¿˜éœ€è¦æ›´å¤šçš„é…ç½®ã€‚ ","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:3:0","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"è‡ªå®šä¹‰é…ç½®æº æ‰©å±•ConfigSource package org.acme.config; public class InMemoryConfigSource implements ConfigSource { /** * å†…å­˜ç¼“å­˜ */ private static final Map\u003cString, String\u003e configuration = new HashMap\u003c\u003e(); static { configuration.put(\"my.prop\", \"1234\"); } /** * å®šä¹‰åŠ è½½åºå· */ @Override public int getOrdinal() { return 275; } @Override public Set\u003cString\u003e getPropertyNames() { return configuration.keySet(); } @Override public String getValue(final String propertyName) { return configuration.get(propertyName); } /** * è¿”å›è¯¥é…ç½®çš„åç§° */ @Override public String getName() { return InMemoryConfigSource.class.getSimpleName(); } } æ³¨å†Œé…ç½®æº æ¥ä¸‹æ¥åœ¨META-INF/services/org.eclipse.microprofile.config.spi.ConfigSourceæ³¨å†Œé…ç½®ï¼š org.acme.config.InMemoryConfigSource åˆå§‹åŒ–é…ç½®æº å½“ Quarkus åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå¯ä»¥åˆå§‹åŒ–ä¸¤æ¬¡ã€‚ä¸€æ¬¡ç”¨äºé™æ€åˆå§‹åŒ–ï¼Œç¬¬äºŒæ¬¡ç”¨äºè¿è¡Œæ—¶åˆå§‹åŒ– é™æ€åˆå§‹åŒ–","date":"2021-09-07","objectID":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/:3:1","series":["Quarkus"],"tags":[],"title":"Quarkusè¯»å–é…ç½®","uri":"/quarkus%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE/"},{"categories":[],"content":"RealCallä¸­çš„ä¼ å€¼ private RealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) { this.client = client; this.originalRequest = originalRequest; this.forWebSocket = forWebSocket; this.retryAndFollowUpInterceptor = new RetryAndFollowUpInterceptor(client, forWebSocket); } RealCallåˆå§‹åŒ–æ—¶ï¼Œä¼šåˆ›å»ºè¿™ä¸ªRetryAndFollowUpInterceptoræ‹¦æˆªå™¨ï¼Œå¹¶ä¸”ä¼ é€’äº†OkHttpClientã€‚ è§‚å¯ŸRealCallä¸­çš„æ‰€æœ‰é»˜è®¤æ‹¦æˆªå™¨ï¼ŒRealCallå¯¹äºè¿™ä¸ªæ‹¦æˆªå™¨çš„å¤„ç†ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œç”šè‡³åœ¨æ„é€ æ–¹æ³•ä¸­å°±åˆå§‹åŒ–äº†ï¼Œè€Œä¸”åœ¨ä¼—å¤šå†…ç½®æ‹¦æˆªå™¨ä¸­ï¼ŒRealCallå•åªç»™RetryAndFollowUpInterceptorä¼ é€’äº†OkhttpClientï¼Œå¯è§è¿™ä¸ªæ‹¦æˆªå™¨çš„é‡è¦æ€§ï¼ ","date":"2021-09-07","objectID":"/retryandfollowupinterceptor/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"RetryAndFollowUpInterceptor","uri":"/retryandfollowupinterceptor/"},{"categories":[],"content":"RetryAndFollowUpInterceptorçš„å¤„ç†è¿‡ç¨‹ public final class RetryAndFollowUpInterceptor implements Interceptor { private static final int MAX_FOLLOW_UPS = 20; private final OkHttpClient client; private final boolean forWebSocket; private volatile StreamAllocation streamAllocation; private Object callStackTrace; private volatile boolean canceled; public RetryAndFollowUpInterceptor(OkHttpClient client, boolean forWebSocket) { this.client = client; this.forWebSocket = forWebSocket; } // å–æ¶ˆï¼Œä¸éœ€è¦çœ‹äº† public void cancel() { canceled = true; StreamAllocation streamAllocation = this.streamAllocation; if (streamAllocation != null) streamAllocation.cancel(); } @Override public Response intercept(Chain chain) throws IOException { Request request = chain.request(); RealInterceptorChain realChain = (RealInterceptorChain) chain; Call call = realChain.call(); EventListener eventListener = realChain.eventListener(); // åˆå§‹åŒ–æ•°æ®æµåˆ†é…å™¨ StreamAllocation streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(request.url()), call, eventListener, callStackTrace); this.streamAllocation = streamAllocation; // é‡å®šå‘æ¬¡æ•° int followUpCount = 0; // å‰ä¸€ä¸ªresponse Response priorResponse = null; // åˆæ˜¯ä¸ªæ°¸åŠ¨æœº while (true) { Response response; boolean releaseConnection = true; try { // è°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæœ€ç»ˆè·å–åˆ°response response = realChain.proceed(request, streamAllocation, null, null); releaseConnection = false; } catch (RouteException e) { //å‘ç°å¼‚å¸¸å°±é‡è¯• if (!recover(e.getLastConnectException(), streamAllocation, false, request)) { throw e.getLastConnectException(); } releaseConnection = false; continue; } catch (IOException e) { //å‘ç°å¼‚å¸¸å°±é‡è¯• ... continue; } finally { // é‡Šæ”¾è¿æ¥ if (releaseConnection) { streamAllocation.streamFailed(null); streamAllocation.release(); } } // é™„åŠ å‰ä¸€ä¸ªresponseï¼Œè¿™ç§éƒ½æ˜¯æ²¡æœ‰body if (priorResponse != null) { response = response.newBuilder() .priorResponse(priorResponse.newBuilder() .body(null)//æ²¡æœ‰body .build()) .build(); } // æ ¹æ®ä¸Šä¸€ä¸ªresponseï¼Œç”Ÿæˆé‡å®šå‘éœ€è¦çš„request Request followUp = followUpRequest(response, streamAllocation.route()); // å¦‚æœä¸å†éœ€è¦é‡å®šå‘ï¼Œå°±ç›´æ¥è¿”å›responseäº† if (followUp == null) { if (!forWebSocket) { streamAllocation.release(); } return response; } // å…³é—­ responseçš„body closeQuietly(response.body()); // å¦‚æœé‡å®šå‘/é‡è¯•æ¬¡æ•°å¤§äº20æ¬¡å°±ä¼šæŠ¥é”™ if (++followUpCount \u003e MAX_FOLLOW_UPS) { streamAllocation.release(); throw new ProtocolException(\"Too many follow-up requests: \" + followUpCount); } ... // å¦‚æœä¸æ˜¯åŒä¸€ä¸ªä¸»æœºåœ°å€ï¼Œåˆ™è¿æ¥ä¸èƒ½å¤ç”¨ï¼Œåªèƒ½é‡Šæ”¾ä¸Šä¸€ä¸ªï¼Œå¹¶ä¸”æ–°å»ºä¸€ä¸ªè¿æ¥ï¼›å¦åˆ™å°†å¤ç”¨ä¹‹å‰åˆ›å»ºå¥½çš„è¿æ¥ if (!sameConnection(response, followUp.url())) { // ç”¨requesté‡å»ºè¿æ¥ streamAllocation.release(); streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(followUp.url()), call, eventListener, callStackTrace); this.streamAllocation = streamAllocation; } request = followUp; priorResponse = response; } } // æ‹¼è£…åœ°å€ï¼ŒåŒ…å«ä¸»æœºã€ç«¯å£å·ã€DNSç­‰ç­‰ private Address createAddress(HttpUrl url) { SSLSocketFactory sslSocketFactory = null; HostnameVerifier hostnameVerifier = null; CertificatePinner certificatePinner = null; // åˆ¤æ–­æ˜¯å¦https if (url.isHttps()) { sslSocketFactory = client.sslSocketFactory(); hostnameVerifier = client.hostnameVerifier(); certificatePinner = client.certificatePinner(); } return new Address(url.host(), url.port(), client.dns(), client.socketFactory(), sslSocketFactory, hostnameVerifier, certificatePinner, client.proxyAuthenticator(), client.proxy(), client.protocols(), client.connectionSpecs(), client.proxySelector()); } // å°è¯•ä»ä¸æœåŠ¡å™¨é€šä¿¡å¤±è´¥ä¸­æ¢å¤ï¼ˆé‡è¯•ï¼‰ private boolean recover(IOException e, StreamAllocation streamAllocation, boolean requestSendStarted, Request userRequest) { streamAllocation.streamFailed(e); // é‡è¯• // return false - åº”ç”¨å±‚æ‹’ç»äº†é‡è¯•,è¿™æ˜¯æˆ‘ä»¬åœ¨åˆå§‹åŒ–clientæ—¶è®¾ç½®çš„ if (!client.retryOnConnectionFailure()) return false; ... // å¦‚æœæœ‰æ›´å¤šçš„è·¯ç”±ï¼Œæ¯”å¦‚DNSè¿”å›äº†å¤šä¸ªCDNçš„ipåœ°å€ï¼Œå°±åˆ‡æ¢çº¿è·¯é‡è¯•ï¼Œå¦åˆ™å–æ¶ˆã€‚ if (!streamAllocation.hasMoreRoutes()) return false; ... return true; } // åˆ¤æ–­è¿æ¥æ˜¯å¦å¯ä»¥æ¢å¤ private boolean isRecoverable(IOException e, boolean requestSendStarted) { ... } // æ ¹æ®responseCodeåˆ¤æ–­ï¼Œå¦‚æœresponseéœ€è¦é‡å®šå‘ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªé‡å®šå‘æ‰€éœ€çš„request private Request followUpRequest(Response userResponse, Route route","date":"2021-09-07","objectID":"/retryandfollowupinterceptor/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"RetryAndFollowUpInterceptor","uri":"/retryandfollowupinterceptor/"},{"categories":[],"content":"æ€»ç»“ RetryAndFollowUpInterceptorçš„èŒè´£ï¼š æä¾›äº†å¼‚å¸¸é‡è¯•åŠŸèƒ½ï¼› æä¾›å›ºå®šä¸è¶…è¿‡20æ¬¡é‡å®šå‘åŠŸèƒ½ï¼› æä¾›ã€Œå–æ¶ˆè¯·æ±‚ã€åŠŸèƒ½ã€‚ æœ¬æ¥æ ¹æ®å•ä¸€åŸåˆ™ï¼Œä¸åº”è¯¥æŠŠä¸‰ä¸ªåŠŸèƒ½è€¦åˆåˆ°ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆJWå¤§ç¥è¿˜æ˜¯å¦‚æ­¤æ¥è®¾è®¡å‘¢ï¼Ÿ è€Œä¸”æˆ‘è¿˜æœ‰ä¸ªç–‘é—®å°±æ˜¯ï¼Œé‡è¯•æ¬¡æ•°ç«Ÿç„¶æ˜¯å›ºå®šä¸è¶…è¿‡20æ¬¡ï¼Œä¸èƒ½ç”±æˆ‘ä»¬è‡ªå·±æ¥è®¾ç½®ã€‚ ","date":"2021-09-07","objectID":"/retryandfollowupinterceptor/:0:3","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"RetryAndFollowUpInterceptor","uri":"/retryandfollowupinterceptor/"},{"categories":[],"content":"è§£å†³ä¸èƒ½è‡ªå®šä¹‰é‡è¯•æ¬¡æ•°çš„é—®é¢˜ æ–¹å¼ä¸€ï¼šè‡ªå®šä¹‰é‡è¯•æ‹¦æˆªå™¨ é¦–å…ˆå…³é—­OkHttpè‡ªå¸¦çš„é‡è¯•æœºåˆ¶ OkHttpClient.Builder() .retryOnConnectionFailure(false) .build() ç„¶åè‡ªå®šä¹‰ä¸€ä¸ªé‡è¯•æ‹¦æˆªå™¨ï¼Œå¦‚ä¸‹ï¼š public class RetryIntercepter implements Interceptor { public int maxRetry;//æœ€å¤§é‡è¯•æ¬¡æ•° private int retryNum = 0;//å‡å¦‚è®¾ç½®ä¸º3æ¬¡é‡è¯•çš„è¯ï¼Œåˆ™æœ€å¤§å¯èƒ½è¯·æ±‚4æ¬¡ï¼ˆé»˜è®¤1æ¬¡+3æ¬¡é‡è¯•ï¼‰ public RetryIntercepter(int maxRetry) { this.maxRetry = maxRetry; } @Override public Response intercept(Chain chain) throws IOException { Request request = chain.request(); System.out.println(\"retryNum=\" + retryNum); Response response = chain.proceed(request); while (!response.isSuccessful() \u0026\u0026 retryNum \u003c maxRetry) { retryNum++; System.out.println(\"retryNum=\" + retryNum); response = chain.proceed(request); } return response; } } ä¸Šé¢æ˜¯æˆ‘ä»ç½‘ä¸Šæ‰¾åˆ°çš„ä¾‹å­ï¼Œå…¶å®ä»–å†™çš„å¹¶ä¸å¥½ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸ºä¸€ä¸ªæ€è·¯ã€‚ æ–¹å¼äºŒ RxJavaçš„retryWhenæ“ä½œç¬¦ ","date":"2021-09-07","objectID":"/retryandfollowupinterceptor/:0:4","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"RetryAndFollowUpInterceptor","uri":"/retryandfollowupinterceptor/"},{"categories":[],"content":"åˆå§‹åŒ–è°ƒç”¨ public final class RetryAndFollowUpInterceptor implements Interceptor { ... @Override public Response intercept(Chain chain) throws IOException { ... // åˆå§‹åŒ–æ•°æ®æµåˆ†é…å™¨ StreamAllocation streamAllocation = new StreamAllocation(client.connectionPool(),createAddress(request.url()), call, eventListener, callStackTrace); StreamAllocationæ˜¯åœ¨RetryAndFollowUpInterceptoræ‹¦æˆªæ—¶è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œä¼ é€’äº†clientçš„è¿æ¥æ± ï¼Œurlï¼Œcallï¼Œå’ŒeventListenerã€‚ ","date":"2021-09-07","objectID":"/streamallocation/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"StreamAllocation","uri":"/streamallocation/"},{"categories":[],"content":"æºç  public final class StreamAllocation { // åœ°å€ public final Address address; private RouteSelector.Selection routeSelection; private Route route; private final ConnectionPool connectionPool; public final Call call; public final EventListener eventListener; private final Object callStackTrace; // State guarded by connectionPool. private final RouteSelector routeSelector; private int refusedStreamCount; private RealConnection connection; private boolean reportedAcquired; private boolean released; private boolean canceled; private HttpCodec codec; public StreamAllocation(ConnectionPool connectionPool, Address address, Call call, EventListener eventListener, Object callStackTrace) { this.connectionPool = connectionPool; this.address = address; this.call = call; this.eventListener = eventListener; this.routeSelector = new RouteSelector(address, routeDatabase(), call, eventListener); this.callStackTrace = callStackTrace; } /** * æ‰¾åˆ°å¥åº·çš„è¿æ¥ï¼Œåˆ›å»ºHttpCodecå¹¶è¿”å› */ public HttpCodec newStream( OkHttpClient client, Interceptor.Chain chain, boolean doExtensiveHealthChecks) { int connectTimeout = chain.connectTimeoutMillis(); int readTimeout = chain.readTimeoutMillis(); int writeTimeout = chain.writeTimeoutMillis(); int pingIntervalMillis = client.pingIntervalMillis(); boolean connectionRetryEnabled = client.retryOnConnectionFailure(); try { // æ‰¾åˆ°ä¸€ä¸ªå¥åº·çš„è¿æ¥ RealConnection resultConnection = findHealthyConnection(connectTimeout, readTimeout, writeTimeout, pingIntervalMillis, connectionRetryEnabled, doExtensiveHealthChecks); // åˆå§‹åŒ– HttpCodec HttpCodec resultCodec = resultConnection.newCodec(client, chain, this); synchronized (connectionPool) { codec = resultCodec; return resultCodec; } } catch (IOException e) { throw new RouteException(e); } } /** * æ‰¾åˆ°ä¸€ä¸ªå¥åº·çš„è¿æ¥ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸ªå¥åº·çš„ */ private RealConnection findHealthyConnection(int connectTimeout, int readTimeout, int writeTimeout, int pingIntervalMillis, boolean connectionRetryEnabled, boolean doExtensiveHealthChecks) throws IOException { // æ³¨æ„è¿™ä¸ªæ­»å¾ªç¯ while (true) { RealConnection candidate = findConnection(connectTimeout, readTimeout, writeTimeout, pingIntervalMillis, connectionRetryEnabled); synchronized (connectionPool) { if (candidate.successCount == 0) { return candidate; } } // Do a (potentially slow) check to confirm that the pooled connection is still good. If it // isn't, take it out of the pool and start again. // å¦‚æœæ²¡æœ‰å¥åº·çš„è¿æ¥ï¼Œå°±ç»§ç»­å¾ªç¯å»ç­‰ if (!candidate.isHealthy(doExtensiveHealthChecks)) { noNewStreams(); continue; } return candidate; } } /** * Returns a connection to host a new stream. This prefers the existing connection if it exists, * then the pool, finally building a new connection. */ /** * æ‰¾åˆ°ä¸€ä¸ªå¥åº·çš„è¿æ¥ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸ªå¥åº·çš„ */ private RealConnection findConnection(int connectTimeout, int readTimeout, int writeTimeout, int pingIntervalMillis, boolean connectionRetryEnabled) throws IOException { boolean foundPooledConnection = false; RealConnection result = null; Route selectedRoute = null; Connection releasedConnection; Socket toClose; //é”åŠ åˆ°äº†è¿æ¥æ± ä¸Š synchronized (connectionPool) { if (released) throw new IllegalStateException(\"released\"); if (codec != null) throw new IllegalStateException(\"codec != null\"); if (canceled) throw new IOException(\"Canceled\"); // Attempt to use an already-allocated connection. We need to be careful here because our // already-allocated connection may have been restricted from creating new streams. releasedConnection = this.connection; // å…³é—­è¿æ¥ï¼Œå›æ”¶socket toClose = releaseIfNoNewStreams(); // å¤ç”¨this.connection if (this.connection != null) { result = this.connection; releasedConnection = null; } if (!reportedAcquired) { // If the connection was never reported acquired, don't report it as released! releasedConnection = null; } if (result == null) { // ä»è¿æ¥æ± ä¸­æ‹¿å‡ºä¸€ä¸ªè¿æ¥ Internal.instance.get(connectionPool, address, this, null); if (connection != null) { foundPooledConnection = true; result = connection; } else { selectedRoute = route; } } } // å…³é—­Socket closeQuietly(toClose); if (releasedConnection != nu","date":"2021-09-07","objectID":"/streamallocation/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"StreamAllocation","uri":"/streamallocation/"},{"categories":[],"content":"å›é¡¾å¹¶ä¸”æ·±å…¥ä¸€ä¸‹OkHttpï¼ˆv3.10.0ï¼‰çš„åŸç†ã€‚ ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:0","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"ç”¨æ³• val client = OkHttpClient.Builder().build(); val request = Request.Builder() .url(\"https://wanandroid.com/wxarticle/chapters/json\") .get() .build() client.newCall(request).enqueue(responseCallback = object : Callback { override fun onFailure(call: Call, e: IOException) { val i = 0; } override fun onResponse(call: Call, response: Response) { val i = 0; } }) ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:1","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"æ„å»ºOkHttpClient æ„é€ æ–¹æ³•å…¶å®å°±æ˜¯è°ƒç”¨äº†å»ºé€ è€…æ¨¡å¼ã€‚ public Builder() { // æ‰§è¡Œç­–ç•¥ï¼ŒåŒæ­¥orå¼‚æ­¥ dispatcher = new Dispatcher(); // åè®® protocols = DEFAULT_PROTOCOLS; connectionSpecs = DEFAULT_CONNECTION_SPECS; // äº‹ä»¶ç›‘å¬å™¨ eventListenerFactory = EventListener.factory(EventListener.NONE); // ä»£ç† proxySelector = ProxySelector.getDefault(); // cookie cookieJar = CookieJar.NO_COOKIES; // å¥—æ¥å­—å·¥å‚ socketFactory = SocketFactory.getDefault(); // åŸŸåéªŒè¯ hostnameVerifier = OkHostnameVerifier.INSTANCE; // è¯ä¹¦ certificatePinner = CertificatePinner.DEFAULT; // ä»£ç†è®¤è¯ proxyAuthenticator = Authenticator.NONE; // ç”¨æˆ·èº«ä»½è®¤è¯ authenticator = Authenticator.NONE; // åˆå§‹åŒ–é“¾æ¥æ±  connectionPool = new ConnectionPool(); // DNS dns = Dns.SYSTEM; // followSslRedirects = true; followRedirects = true; retryOnConnectionFailure = true; connectTimeout = 10_000; readTimeout = 10_000; writeTimeout = 10_000; pingInterval = 0; } OkHttpClientä¸»è¦ä½œç”¨å°±æ˜¯å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œé…ç½®ã€‚ Dispatcher ä»»åŠ¡åˆ†å‘å™¨ï¼ŒåŒæ­¥ä¸å¼‚æ­¥æœ‰ä¸åŒçš„åˆ†å‘æœºåˆ¶ public final class Dispatcher { private int maxRequests = 64; private int maxRequestsPerHost = 5; private @Nullable Runnable idleCallback; // çº¿ç¨‹æ±  private @Nullable ExecutorService executorService; // å‡†å¤‡é˜Ÿåˆ—ï¼Œç¼“å­˜äº†å³å°†è¢«æ‰§è¡Œçš„å¼‚æ­¥call private final Deque\u003cAsyncCall\u003e readyAsyncCalls = new ArrayDeque\u003c\u003e(); // å¼‚æ­¥è¿è¡Œé˜Ÿåˆ—ï¼Œç¼“å­˜æ­£åœ¨è¿è¡Œä¸­ï¼Œæˆ–è€…å·²ç»å–æ¶ˆä½†æ˜¯è¿˜æ²¡ç»“æŸçš„call private final Deque\u003cAsyncCall\u003e runningAsyncCalls = new ArrayDeque\u003c\u003e(); // åŒæ­¥è¿è¡Œé˜Ÿåˆ— private final Deque\u003cRealCall\u003e runningSyncCalls = new ArrayDeque\u003c\u003e(); // æ„é€ æ–¹æ³• public Dispatcher(ExecutorService executorService) { this.executorService = executorService; } public Dispatcher() { } // é»˜è®¤çš„çº¿ç¨‹æ±  // æ ¸å¿ƒçº¿ç¨‹ä¸º0ï¼Œ // æœ€å¤§çº¿ç¨‹æ•°ä¸ºæ— é™å¤§ // ä¿æ´»æ—¶é—´ä¸º60ç§’ // public synchronized ExecutorService executorService() { if (executorService == null) { executorService = new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60, TimeUnit.SECONDS, new SynchronousQueue\u003cRunnable\u003e(), Util.threadFactory(\"OkHttp Dispatcher\", false)); } return executorService; } // è®¾ç½®æœ€å¤§ã€Œå¹¶å‘ã€è¯·æ±‚æ•° public synchronized void setMaxRequests(int maxRequests) { if (maxRequests \u003c 1) { throw new IllegalArgumentException(\"max \u003c 1: \" + maxRequests); } this.maxRequests = maxRequests; promoteCalls(); } public synchronized int getMaxRequests() { return maxRequests; } // è®¾ç½®æ¯ä¸ªhostçš„æœ€å¤§å¹¶å‘è¯·æ±‚æ•° public synchronized void setMaxRequestsPerHost(int maxRequestsPerHost) { if (maxRequestsPerHost \u003c 1) { throw new IllegalArgumentException(\"max \u003c 1: \" + maxRequestsPerHost); } this.maxRequestsPerHost = maxRequestsPerHost; promoteCalls(); } public synchronized int getMaxRequestsPerHost() { return maxRequestsPerHost; } // é—²ç½®æ—¶å›è°ƒ // å½“æ²¡æœ‰è¿è¡Œä¸­çš„callæ—¶ // åŒæ­¥ä¸å¼‚æ­¥call æœ‰ä¸åŒçš„é—²æ—¶åˆ¤å®š public synchronized void setIdleCallback(@Nullable Runnable idleCallback) { this.idleCallback = idleCallback; } // åŒæ­¥æ‰§è¡Œ synchronized void executed(RealCall call) { // æ·»åŠ è¿›é˜Ÿåˆ— runningSyncCalls.add(call); } // å¼‚æ­¥æ‰§è¡Œ synchronized void enqueue(AsyncCall call) { if (runningAsyncCalls.size() \u003c maxRequests \u0026\u0026 runningCallsForHost(call) \u003c maxRequestsPerHost) { // æ·»åŠ é˜Ÿåˆ— runningAsyncCalls.add(call); // çº¿ç¨‹æ± æ‰§è¡Œ executorService().execute(call); } else { readyAsyncCalls.add(call); } } } Dispatcheræ˜¯ç­–ç•¥æ‰§è¡Œå™¨ï¼Œæ ¸å¿ƒæ˜¯ä¸‰æ¡é˜Ÿåˆ—ï¼š // å‡†å¤‡é˜Ÿåˆ—ï¼Œç¼“å­˜äº†å³å°†è¢«æ‰§è¡Œçš„å¼‚æ­¥call private final Deque\u003cAsyncCall\u003e readyAsyncCalls = new ArrayDeque\u003c\u003e(); // å¼‚æ­¥è¿è¡Œé˜Ÿåˆ—ï¼Œç¼“å­˜æ­£åœ¨è¿è¡Œä¸­ï¼Œæˆ–è€…å·²ç»å–æ¶ˆä½†æ˜¯è¿˜æ²¡ç»“æŸçš„call private final Deque\u003cAsyncCall\u003e runningAsyncCalls = new ArrayDeque\u003c\u003e(); // åŒæ­¥è¿è¡Œé˜Ÿåˆ— private final Deque\u003cRealCall\u003e runningSyncCalls = new ArrayDeque\u003c\u003e(); åŒæ­¥ï¼šç›´æ¥å°†callæ·»åŠ è¿›äº†åŒæ­¥é˜Ÿåˆ—ã€‚ å¼‚æ­¥ï¼šåˆ¤æ–­å½“å‰è¿è¡Œä¸­çš„è¯·æ±‚æ•°æ˜¯å¦å³°å€¼ï¼Œå¦‚æœå·²ç»è¾¾åˆ°æœ€å¤§æ•°ï¼Œåˆ™å°†callæ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼›å¦åˆ™æ”¾å…¥å¼‚æ­¥è¿è¡Œä¸­é˜Ÿåˆ—ï¼Œå¹¶ä¸”è®©çº¿ç¨‹æ± ç«‹å³æ‰§è¡Œã€‚ è¿™é‡Œä½¿ç”¨äº†ArrayDequeè¿™ä¸ªç±»ï¼ŒArrayDequeæ˜¯Javaé›†åˆä¸­åŒç«¯é˜Ÿåˆ—çš„æ•°ç»„å®ç°ï¼Œç›¸ä¼¼çš„è¿˜æœ‰åŒç«¯é˜Ÿåˆ—çš„é“¾è¡¨å®ç°ï¼ˆLinkedListï¼‰ã€‚å®ƒä½œä¸ºæ ˆä½¿ç”¨æ—¶æ¯” Stack ç±»æ•ˆç‡è¦é«˜ï¼Œä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨æ—¶æ¯”LinkedListè¦å¿«ã€‚ åè®® Protocol public enum Protocol { // http 1.0 HTTP_1_0(\"http/1.0\"), // http1.1 HTTP_1_1(\"http/1.1\"), // ä¸è®¤è¯†è¿™ä¸ª SPDY_3(\"spdy/3.1\"), // http2.0 HTTP_2(\"h2\"), // Http3.0,è°·æ­ŒåŸºäºudpå®ç°çš„quicåè®®ï¼Œè§£å†³äº†å¤´éƒ¨é˜»å¡å’Œå¼±ç½‘ç¯å¢ƒä¸‹ç½‘ç»œç¨³å®šé—®é¢˜ QUIC(\"quic\"); } ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:2","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Request Requestæ˜¯ä¸ªæœ€ç»ˆç±»ï¼Œåªæ˜¯ç”¨æ¥è¡¨ç¤ºè¯·æ±‚æ‰€éœ€çš„ä¿¡æ¯ï¼š public final class Request { final HttpUrl url; final String method; final Headers headers; final @Nullable RequestBody body; final Object tag; private volatile CacheControl cacheControl; // Lazily initialized. ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:3","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Response public final class Response implements Closeable { final Request request; final Protocol protocol; final int code; final String message; // æ¡æ‰‹ final @Nullable Handshake handshake; final Headers headers; final @Nullable ResponseBody body; final @Nullable Response networkResponse; final @Nullable Response cacheResponse; final @Nullable Response priorResponse; final long sentRequestAtMillis; final long receivedResponseAtMillis; private volatile CacheControl cacheControl; ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:4","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Call è¡¨ç¤ºè¯·æ±‚çš„è¡Œä¸ºè¿‡ç¨‹ Callæ¥å£ public interface Call extends Cloneable { // è¿”å›Request Request request(); // åŒæ­¥æ‰§è¡Œï¼Œå¯ç›´æ¥è¿”å›Response Response execute() throws IOException; // å¼‚æ­¥æ‰§è¡Œï¼Œéœ€è¦ä¼ é€’å›è°ƒ void enqueue(Callback responseCallback); // å–æ¶ˆ void cancel(); boolean isExecuted(); boolean isCanceled(); // å…‹éš† Call clone(); // å·¥å‚ interface Factory { Call newCall(Request request); } } Callæ¥å£ä¸»è¦æ˜¯å®šä¹‰äº†è¯·æ±‚çš„è¡Œä¸ºï¼ŒåŒ…å«åŒæ­¥è¯·æ±‚çš„è¡Œä¸ºå’Œå¼‚æ­¥è¯·æ±‚çš„è¡Œä¸ºï¼Œä»–çš„å®ç°ç±»æ˜¯RealCallã€‚ RealCall final class RealCall implements Call { final OkHttpClient client; final RetryAndFollowUpInterceptor retryAndFollowUpInterceptor; // çŠ¶æ€ç›‘å¬å™¨ private EventListener eventListener; final Request originalRequest; final boolean forWebSocket; private boolean executed; private RealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) { this.client = client; this.originalRequest = originalRequest; this.forWebSocket = forWebSocket; this.retryAndFollowUpInterceptor = new RetryAndFollowUpInterceptor(client, forWebSocket); } static RealCall newRealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) { // Safely publish the Call instance to the EventListener. RealCall call = new RealCall(client, originalRequest, forWebSocket); call.eventListener = client.eventListenerFactory().create(call); return call; } // åŒæ­¥æ‰§è¡Œ @Override public Response execute() throws IOException { synchronized (this) { if (executed) throw new IllegalStateException(\"Already Executed\"); executed = true; } captureCallStackTrace(); eventListener.callStart(this); try { client.dispatcher().executed(this); Response result = getResponseWithInterceptorChain(); if (result == null) throw new IOException(\"Canceled\"); return result; } catch (IOException e) { eventListener.callFailed(this, e); throw e; } finally { client.dispatcher().finished(this); } } // å¼‚æ­¥æ‰§è¡Œ @Override public void enqueue(Callback responseCallback) { synchronized (this) { if (executed) throw new IllegalStateException(\"Already Executed\"); executed = true; } captureCallStackTrace(); eventListener.callStart(this); client.dispatcher().enqueue(new AsyncCall(responseCallback)); } @Override public void cancel() { retryAndFollowUpInterceptor.cancel(); } @Override public synchronized boolean isExecuted() { return executed; } @Override public boolean isCanceled() { return retryAndFollowUpInterceptor.isCanceled(); } @SuppressWarnings(\"CloneDoesntCallSuperClone\") // We are a final type \u0026 this saves clearing state. @Override public RealCall clone() { return RealCall.newRealCall(client, originalRequest, forWebSocket); } StreamAllocation streamAllocation() { return retryAndFollowUpInterceptor.streamAllocation(); } final class AsyncCall extends NamedRunnable { private final Callback responseCallback; AsyncCall(Callback responseCallback) { super(\"OkHttp %s\", redactedUrl()); this.responseCallback = responseCallback; } String host() { return originalRequest.url().host(); } Request request() { return originalRequest; } RealCall get() { return RealCall.this; } @Override protected void execute() { boolean signalledCallback = false; try { Response response = getResponseWithInterceptorChain(); if (retryAndFollowUpInterceptor.isCanceled()) { signalledCallback = true; responseCallback.onFailure(RealCall.this, new IOException(\"Canceled\")); } else { signalledCallback = true; responseCallback.onResponse(RealCall.this, response); } } catch (IOException e) { if (signalledCallback) { // Do not signal the callback twice! Platform.get().log(INFO, \"Callback failure for \" + toLoggableString(), e); } else { eventListener.callFailed(RealCall.this, e); responseCallback.onFailure(RealCall.this, e); } } finally { client.dispatcher().finished(this); } } } String redactedUrl() { return originalRequest.url().redact(); } // ä»OkhttpClientä¸­æ‹¿å‡ºå„ç§æ‰€éœ€çš„æ‹¦æˆªå™¨ç»™è‡ªå·± // æœ€åè°ƒç”¨chain.proceed(originalRequest)æ¥å¤„ç†è¯·æ±‚ Response getResponseWithInterceptorChain() throws IOException { // Build a full stack of interceptors. List\u003cInterceptor\u003e interceptors = new ArrayList\u003c\u003e(); interceptors.addAll(client.interceptors()); interceptors.add(retr","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:5","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"æ‹¦æˆªå™¨ è´Ÿè´£å°†Requestå¤„ç†ä¸ºResponse public interface Interceptor { // æ‹¦æˆªå›è°ƒæ–¹æ³• Response intercept(Chain chain) throws IOException; // æ‹¦æˆªå™¨å­ç±»ï¼šæ‹¦æˆªå™¨é“¾å¼ç®¡ç†å™¨ï¼Œå®ç°ç±»æ˜¯RealInterceptorChain interface Chain { Request request(); Response proceed(Request request) throws IOException; @Nullable Connection connection(); Call call(); int connectTimeoutMillis(); Chain withConnectTimeout(int timeout, TimeUnit unit); int readTimeoutMillis(); Chain withReadTimeout(int timeout, TimeUnit unit); int writeTimeoutMillis(); Chain withWriteTimeout(int timeout, TimeUnit unit); } } ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:6","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"æ‹¦æˆªå™¨ç®¡ç†å™¨(æ‹¦æˆªå™¨é“¾) çœ‹åˆ°è¿™ï¼Œæˆ‘å°±è§‰å¾—JWå¤§ç¥å†™çš„ä»£ç æ˜¯çœŸç‰›é€¼å•Šï¼Œä¸æœéƒ½ä¸è¡Œï¼Œå±‚æ¬¡åˆ†æ˜ï¼Œå„å±‚éƒ½ç¬¦åˆå…­å¤§åŸåˆ™ï¼Œçœ‹çš„å¤ªçˆ½äº†ã€‚ public final class RealInterceptorChain implements Interceptor.Chain { private final List\u003cInterceptor\u003e interceptors; private final StreamAllocation streamAllocation; private final HttpCodec httpCodec; private final RealConnection connection; // ä¸€å¼€å§‹ä¸º0 private final int index; private final Request request; private final Call call; private final EventListener eventListener; private final int connectTimeout; private final int readTimeout; private final int writeTimeout; // åˆå§‹ä¸º0 private int calls; // æ³¨æ„çœ‹è¿™ä¸ªæ„é€ æ–¹æ³• private RealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) { this.client = client; this.originalRequest = originalRequest; this.forWebSocket = forWebSocket; // ç›´æ¥åˆå§‹åŒ–äº†ä¸€ä¸ªé‡è¯•æ‹¦æˆªå™¨ this.retryAndFollowUpInterceptor = new RetryAndFollowUpInterceptor(client, forWebSocket); } static RealCall newRealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) { // Safely publish the Call instance to the EventListener. RealCall call = new RealCall(client, originalRequest, forWebSocket); call.eventListener = client.eventListenerFactory().create(call); return call; } public Response proceed(Request request, StreamAllocation streamAllocation, HttpCodec httpCodec,RealConnection connection) throws IOException { if (index \u003e= interceptors.size()) throw new AssertionError(); calls++; // æ³¨æ„è¿™é‡Œçš„index+1 RealInterceptorChain next = new RealInterceptorChain(interceptors, streamAllocation, httpCodec, connection, index + 1, request, call, eventListener, connectTimeout, readTimeout, writeTimeout); Interceptor interceptor = interceptors.get(index); Response response = interceptor.intercept(next); return response; } } è¿™ä¸ªä¸œè¥¿å…¶å®åº”è¯¥å«åšã€ŒçœŸæ­£çš„æ‹¦æˆªå™¨é“¾ã€ï¼Œè€Œæˆ‘ä¸ºäº†æ˜ç¡®å…¶ä½œç”¨ï¼Œå«åšã€Œæ‹¦æˆªå™¨ç®¡ç†å™¨ã€ã€‚ ä½œç”¨å°±æ˜¯è®©é˜Ÿåˆ—ä¸­çš„æ‹¦æˆªå™¨one by oneçš„å¤„ç†è¯·æ±‚ï¼Œä¸Šä¸€ä¸ªæ‹¦æˆªå™¨è´Ÿè´£å¤„ç†ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨çš„è¿”å›ç»“æœï¼Œæ‰€ä»¥è°ƒç”¨æ˜¯ä»ArrayListçš„é¦–ä¸ªå…ƒç´ å¼€å§‹å‘ä¸‹éå†åˆ°é˜Ÿå°¾ï¼Œå†é€æ¸popå›æ¥ã€‚ æˆ‘ä»¬æŠŠæ¯ä¸€ä¸ªRealInterceptorChainçœ‹ä½œé“¾æ¡ä¸­çš„ä¸€ç¯ï¼Œæ¯ä¸€ç¯çš„processd()æ–¹æ³•ä¸­ï¼Œé€šè¿‡æŒ‡å®šindex+1æ¥åˆ›å»ºä¸‹ä¸€ç¯ï¼Œä¹‹åé€šè¿‡indexæ‹¿åˆ°å¯¹åº”çš„æ‹¦æˆªå™¨ï¼Œé æ‹¦æˆªå™¨å»å¤„ç†ä¸‹ä¸€ç¯ï¼Œå¦‚æ­¤é€’å½’è°ƒç”¨ï¼Œæœ€åå±‚å±‚è¿”å›responseã€‚ è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Œå½“ç„¶æ˜¯è´´åˆhttpçš„è¯·æ±‚è¿‡ç¨‹ã€‚ä½†æ˜¯é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ–¹æ³•è°ƒç”¨å±‚çº§è¿‡æ·±ï¼Œå¹¶ä¸”requestçš„å¤„ç†é€»è¾‘ä¼šä¸responseçš„é€»è¾‘å¤„ç†è€¦åˆåœ¨ä¸€èµ·ï¼Œå˜å¾—å¯†ä¸å¯åˆ†ã€‚ å…¶å®ä»¥å‰ç”¨OKçš„æ—¶å€™å°±æœ‰è¿™ä¸ªæ„Ÿè§‰äº†ï¼Œå¹¶ä¸”åæ¥å†™Flutterçš„æ—¶å€™ç”¨åˆ°äº†dioæ¡†æ¶ï¼Œå®ƒçš„æ‹¦æˆªå™¨æŠŠrequestã€responseã€erroråˆ†å¼€å¤„ç†ï¼Œç»“æ„æ›´åŠ çš„æ¸…æ™°ã€‚ é‚£ä¹ˆæˆ‘è§‰å¾—ï¼Œå¯¹äºè‡ªèº«çš„interceptorsæ¥è¯´ï¼Œæœ€åæ·»åŠ çš„æ‹¦æˆªå™¨æ˜¯æœ€å…ˆå¤„ç†responseçš„ï¼Œä¹Ÿå°±æ˜¯å»ºç«‹è¿æ¥çš„å§‹ä½œä¿‘è€…ã€‚ interceptors.addAll(client.interceptors()); interceptors.add(retryAndFollowUpInterceptor); interceptors.add(new BridgeInterceptor(client.cookieJar())); interceptors.add(new CacheInterceptor(client.internalCache())); interceptors.add(new ConnectInterceptor(client)); if (!forWebSocket) { interceptors.addAll(client.networkInterceptors()); } // CallServerInterceptoræ‹¦æˆªå™¨ç”¨æ¥å»ºç«‹è¿æ¥ interceptors.add(new CallServerInterceptor(forWebSocket)); ç„¶è€Œåœ¨CallServerInterceptorä¸­æˆ‘æ‰¾ä¸åˆ°ä»»ä½•å»ºç«‹è¿æ¥çš„ä»£ç ã€‚é€šè¿‡è§‚å¯Ÿï¼Œæˆ‘å‘ç°è¿™ä¸ªretryAndFollowUpInterceptorå¾ˆæœ‰æ„æ€ï¼Œäºæ˜¯æ¥ä¸‹æ¥è¦å»çœ‹çœ‹å®ƒæ˜¯åšä»€ä¹ˆç”¨çš„ã€‚ ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:7","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"äº‹ä»¶ç›‘å¬å™¨eventListener public abstract class EventListener { /// ç©ºçš„ç›‘å¬å™¨ public static final EventListener NONE = new EventListener() { }; /// é™æ€å·¥å‚æ–¹æ³• static EventListener.Factory factory(final EventListener listener) { return new EventListener.Factory() { // æˆ‘å°±ä¸æ˜ç™½ï¼Œè¿™é‡Œä¼ äº†ä¸ªCallæ ¹æœ¬å°±æ²¡ç”¨ä¸Š public EventListener create(Call call) { return listener; } }; } // å½“callè¢«executeæˆ–è€…enqueueæ—¶å›è°ƒï¼Œä½†æ˜¯æ­¤æ—¶å¯èƒ½requestè¿˜æ²¡æœ‰æ‰§è¡Œ public void callStart(Call call) { } //å½“è°ƒç”¨ Dns.lookup(String)æ—¶å›è°ƒï¼Œå¯èƒ½å›è°ƒå¤šæ¬¡ public void dnsStart(Call call, String domainName) { } //å½“dnsStartä¹‹åå›è°ƒ public void dnsEnd(Call call, String domainName, List\u003cInetAddress\u003e inetAddressList) { } //å½“Socketé“¾æ¥å»ºç«‹åå›è°ƒ public void connectStart(Call call, InetSocketAddress inetSocketAddress, Proxy proxy) { } //å½“åŠ å¯†ï¼ˆTSLï¼‰é“¾æ¥å¼€å§‹æ—¶è°ƒç”¨ï¼Œ public void secureConnectStart(Call call) { } // åŠ å¯†ç»“æŸåè°ƒç”¨ public void secureConnectEnd(Call call, @Nullable Handshake handshake) { } //Socketå°è¯•å»ºç«‹è¿æ¥ä¹‹åè°ƒç”¨ public void connectEnd(Call call, InetSocketAddress inetSocketAddress, Proxy proxy, @Nullable Protocol protocol) { } // é“¾æ¥å¤±è´¥ public void connectFailed(Call call, InetSocketAddress inetSocketAddress, Proxy proxy, @Nullable Protocol protocol, IOException ioe) { } // é“¾æ¥å»ºç«‹åå›è°ƒ public void connectionAcquired(Call call, Connection connection) { } // é“¾æ¥é‡Šæ”¾åå›è°ƒ public void connectionReleased(Call call, Connection connection) { } // è¯·æ±‚headå¼€å§‹ public void requestHeadersStart(Call call) { } // è¯·æ±‚headç»“æŸ public void requestHeadersEnd(Call call, Request request) { } // è¯·æ±‚bodyå¼€å§‹ public void requestBodyStart(Call call) { } /// è¯·æ±‚bodyç»“æŸ public void requestBodyEnd(Call call, long byteCount) { } // å“åº”headå¼€å§‹ public void responseHeadersStart(Call call) { } // å“åº”headç»“æŸ public void responseHeadersEnd(Call call, Response response) { } // å“åº”bodyå¼€å§‹ public void responseBodyStart(Call call) { } // å“åº”bodyç»“æŸ public void responseBodyEnd(Call call, long byteCount) { } // callå®Œæˆ public void callEnd(Call call) { } // call å¤±è´¥ public void callFailed(Call call, IOException ioe) { } public interface Factory { EventListener create(Call call); } } äº‹ä»¶ç›‘å¬å™¨ï¼Œç”¨æ¥ä¾¦å¬ä¸€æ¬¡è¯·æ±‚ä¸­ç»å†çš„å„ç§çŠ¶æ€ã€‚ ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:8","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"NamedRunnable public abstract class NamedRunnable implements Runnable { protected final String name; public NamedRunnable(String format, Object... args) { this.name = Util.format(format, args); } @Override public final void run() { String oldName = Thread.currentThread().getName(); Thread.currentThread().setName(name); try { execute(); } finally { Thread.currentThread().setName(oldName); } } protected abstract void execute(); } ","date":"2021-09-07","objectID":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/:0:9","series":["ç¬¬ä¸‰æ–¹æ¡†æ¶"],"tags":[],"title":"OkHttp3è§£è¯»","uri":"/okhttp%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"æ¦‚è¿° æ¦‚å¿µï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ä¾èµ–ä¼ è¾“å±‚ä¸­çš„TCPåè®®ï¼Œæ•°æ®é“¾è·¯å±‚ä¸­çš„IPåè®®ï¼Œä½†è‡ªå·±æœ¬èº«ä½äºåº”ç”¨å±‚ã€‚ é»˜è®¤ç«¯å£å·ï¼š80ã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:1","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"URL ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚ http://host[\":\"port][abs_path] ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:2","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"ç‰¹ç‚¹ æ— è¿æ¥ï¼šæ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚åç«‹å³å¼€å§‹æŒ¥æ‰‹ï¼Œä»¥æœ€å¿«çš„é€Ÿåº¦æ–­å¼€è¿æ¥ä»¥èŠ‚çœèµ„æºï¼› åª’ä½“ç‹¬ç«‹ï¼šé€šè¿‡æŒ‡å®šMIME-typeï¼Œå¯ä»¥ä¼ è¾“ä»»ä½•ç±»å‹çš„æ•°æ®ï¼› æ— çŠ¶æ€ï¼šå¯¹äºäº‹åŠ¡çš„å¤„ç†æ²¡æœ‰è®°å¿†åŠŸèƒ½ï¼Œä¸èƒ½æŒä¹…åŒ–ï¼Œæ‰€ä»¥éœ€è¦å…¶ä»–æŠ€æœ¯æ‰‹æ®µæ¥å‚¨å­˜ä¿¡æ¯ï¼Œå¦‚cookie; æ˜æ–‡ä¼ è¾“ã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:3","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"è¯·æ±‚ç»“æ„ å›è½¦ç¬¦ä¸æ¢è¡Œç¬¦ å›è½¦ç¬¦\\rï¼šå‘Šè¯‰æ‰“å­—æœºæŠŠæ‰“å°å¤´å®šä½åˆ°å·¦è¾¹ç•Œï¼› æ¢è¡Œç¬¦\\nï¼šå‘Šè¯‰æ‰“å­—æœºæŠŠçº¸ä¸‹ç§»ä¸€è¡Œã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:4","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"å“åº”ç»“æ„ HTTP/1.1 200 OK/r/n Date: Sat, 31 Dec 2005 23:59:59 GMT/r/n Content-Type: text/html;charset=ISO-8859-1/r/n Content-Length: 122/r/n /r/n \u003chtml\u003e \u003c/html\u003e ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:5","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"è¯·æ±‚ç±»å‹ ç±»å‹ ä½œç”¨ OPTIONS è¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥åˆ©ç”¨å‘WebæœåŠ¡å™¨å‘é€â€™*â€˜çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§ã€‚ HEAD å‘æœåŠ¡å™¨ç´¢è¦ä¸GETè¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ã€‚è¿™ä¸€æ–¹æ³•å¯ä»¥åœ¨ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚ GET å‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ã€‚ POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„åˆ›å»ºå’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ PUT å‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ã€‚ DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤ Request-URI æ‰€æ ‡è¯†çš„èµ„æºã€‚ content/posts/Technology/ç½‘ç»œåè®®/HTTPåè®® CONNECT HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:6","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"çŠ¶æ€ç  ç³»åˆ— ç³»åˆ—æè¿° 1** ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œã€‚ 2** æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†ã€‚ 3** é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ã€‚ 4** å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ã€‚ 5** æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:7","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"ç‰ˆæœ¬æ›´è¿­ 0.9 ä»…æ”¯æŒGETè¯·æ±‚ï¼Œä»…èƒ½è®¿é—®htmlèµ„æºã€‚ 1.0 å¿…é¡»åœ¨è¯·æ±‚è¡Œä¸­æ ‡æ˜ç‰ˆæœ¬å·http/1.0; å¢åŠ äº†POSTå’ŒHEADè¯·æ±‚æ–¹æ³•ï¼› å¢åŠ äº†Content-Typeå¤šåª’ä½“ç±»å‹æ”¯æŒï¼› å¢åŠ äº†å®¢æˆ·ç«¯cacheçš„æ”¯æŒï¼› è¯·æ±‚å¿…é¡»åŒ…å‡½å¤´ä¿¡æ¯ï¼› å¢åŠ çŠ¶æ€ç æ”¯æŒï¼› å¢åŠ ç”¨æˆ·é‰´æƒï¼› æ¯æ¬¡Tcontent/posts/Technology/ç½‘ç»œåè®®/HTTPåè®®ä¼šå…³é—­ï¼Œå¦‚æœå†æ¬¡è¯·æ±‚åˆ™éœ€è¦é‡æ–°å»ºç«‹TCPè¿æ¥ï¼Œå¼€é”€å¤§æ•ˆç‡ä½ã€‚ 1.1 å¼•å…¥æŒä¹…è¿æ¥ï¼› åŠ å…¥NIOæœºåˆ¶ï¼Œå…è®¸åœ¨åŒä¸€ä¸ªTCPè¿æ¥ä¸­åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå¢åŠ äº†å¹¶å‘æ€§ï¼Œæé«˜æ•ˆç‡ï¼› åˆ†å—ä¼ è¾“æ•°æ®ï¼› å¢åŠ PUTã€PATCHã€OPTIONSã€DELETEè¯·æ±‚ï¼› è¯·æ±‚å¤´ä¸­å¢åŠ Hostå­—æ®µï¼› æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼ˆRANGE:bytesï¼‰ã€‚ Http1.1ä¸­è™½ç„¶å¤ç”¨äº†TCPè¿æ¥ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘é€è¯·æ±‚ï¼Œä½†æ˜¯æœåŠ¡ç«¯è¿˜æ˜¯æŒ‰é˜Ÿåˆ—é¡ºåºæ¥å¤„ç†ï¼Œå‡è®¾å‰é¢è¯·æ±‚çš„å¤„ç†æ—¶é—´è¿‡é•¿ï¼Œå¯¼è‡´åé¢æœ‰å¾ˆå¤šçš„è¯·æ±‚æ’é˜Ÿç­‰å¾…ï¼Œä¼šé€ æˆã€Œå¤´éƒ¨é˜»å¡ã€é—®é¢˜ã€‚ ç”±äºHttpæ˜¯æ— çŠ¶æ€è¿æ¥ï¼Œå› æ­¤æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦æ·»åŠ é‡å¤çš„å­—æ®µï¼Œé™ä½äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚ å¤šè·¯å¤ç”¨å¸¦æ¥ä¸€ä¸ªä¸¥é‡é—®é¢˜ï¼Œå³é‡è¦çš„è¯·æ±‚å¯èƒ½ä¸€ç›´è¢«é˜»å¡ã€‚ 2.0 å¢åŠ åŒå·¥æ¨¡å¼ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œè§£å†³å¤´éƒ¨é—®é¢˜ï¼› å¢åŠ æœåŠ¡å™¨ä¸»åŠ¨æ¨é€èƒ½åŠ›ã€‚ 3.0(Quick UDP Internet Connections) 3.0åŸºäºUDPå®ç°ï¼ŒåŸç†å½“ç„¶å°±æ˜¯é€šè¿‡çŸ­æŠ¥æ–‡è§£å†³å„ç§ç–‘éš¾æ‚ç—‡ï¼š TCPå»ºç«‹è¿æ¥æ—¶é—´é•¿ï¼› å¤´éƒ¨é˜»å¡ï¼› å¼±ç½‘ç¯å¢ƒï¼Œæ–­çº¿ã€‚ã€‚ã€‚ ","date":"2021-08-31","objectID":"/http%E5%8D%8F%E8%AE%AE/:0:8","series":["ç½‘ç»œåè®®"],"tags":[],"title":"HTTPåè®®","uri":"/http%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":" ç‰©ç†å±‚ ä½œç”¨ï¼šå®šä¹‰ä¸€äº›ç”µå™¨ã€æœºæ¢°ã€è¿‡ç¨‹å’Œè§„èŒƒï¼Œå¦‚é›†çº¿å™¨ï¼› è®¾å¤‡ï¼šé›†çº¿å™¨ã€‚ æ•°æ®é“¾è·¯å±‚ ä½œç”¨ï¼šè´Ÿè´£æŠŠç‰©ç†å±‚çš„æ¯”ç‰¹æµå°è£…æˆå¸§æ•°æ®ä¼ é€’ç»™ä¸Šä¸€å±‚ï¼Œä¹Ÿæ”¯æŒé€†å‘ã€‚ è®¾å¤‡ï¼šäº¤æ¢æœºé€šè¿‡MACåœ°å€è½¬å‘æ•°æ®ï¼Œé€»è¾‘é“¾è·¯æ§åˆ¶ã€‚ ç½‘ç»œå±‚ ä½œç”¨ï¼šå®šä¹‰ä¸€ä¸ªé€»è¾‘çš„æ®‰èŒï¼Œé€‰æ‹©æœ€ä½³è·¯å¾„ä¼ è¾“ï¼Œè·¯ç”±æ•°æ®åŒ…ã€‚ å…¸å‹åè®®ï¼šIPã€‚ è®¾å¤‡ï¼šè·¯ç”±å™¨ã€‚ ä¼ è¾“å±‚ ä½œç”¨ï¼šæä¾›å¯é å’Œå°½åŠ›è€Œä¸ºçš„ä¼ è¾“ã€‚ åè®®ï¼šTCPï¼ŒUDP è´Ÿè´£ç½‘ç»œä¼ è¾“å’Œä¼šè¯çš„å»ºç«‹ã€‚ ä¼šè¯å±‚ ä½œç”¨ï¼šæ§åˆ¶ä¼šè¯ï¼Œå»ºç«‹ç®¡ç†ç»ˆæ­¢åº”ç”¨ç¨‹åºä¼šè¯ã€‚ åè®®ï¼šSQLã€JSP è´Ÿè´£ä¼šè¯å»ºç«‹ï¼› è¡¨ç¤ºå±‚ ä½œç”¨ï¼šæ ¼å¼åŒ–æ•°æ®ã€‚ åè®®ï¼šjsonã€pngã€wav åº”ç”¨å±‚ ç½‘ç»œä¼ è¾“çš„åº”ç”¨ç¨‹åºï¼Œå¦‚Httpã€‚ ","date":"2021-08-23","objectID":"/%E4%B8%83%E5%B1%82%E5%8D%8F%E8%AE%AE/:0:0","series":["ç½‘ç»œåè®®"],"tags":[],"title":"ä¸ƒå±‚åè®®","uri":"/%E4%B8%83%E5%B1%82%E5%8D%8F%E8%AE%AE/"},{"categories":[],"content":"æ¦‚å¿µ å±å¹•å°ºå¯¸ å±å¹•å¯¹è§’çº¿çš„é•¿åº¦ï¼Œå•ä½æ˜¯è‹±å¯¸ã€‚ 1è‹±å¯¸ = 2.54å˜ç±³ã€‚ å±å¹•åˆ†è¾¨ç‡ å±å¹•åˆ†è¾¨ç‡æ˜¯æŒ‡åœ¨æ¨ªçºµå‘ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯pxï¼Œ1px=1ä¸ªåƒç´ ç‚¹ã€‚ å±å¹•åƒç´ å¯†åº¦ å±å¹•åƒç´ å¯†åº¦æ˜¯æŒ‡æ¯è‹±å¯¸ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯dpiã€‚ å¯†åº¦ç±»å‹ åŒ¹é…åˆ†è¾¨ç‡ åƒç´ å¯†åº¦ ldpi 240*320 120 mdpi 320*480 160 hdpi 480*800 240 xhdpi 720*1280 320 xxhdpi 1080*1920 480 ","date":"2021-08-10","objectID":"/android%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/:0:1","series":[],"tags":["Android"],"title":"Androidå±å¹•é€‚é…","uri":"/android%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/"},{"categories":[],"content":"æ¦‚è¿° ActivityManagerServiceè¯ç”Ÿè‡ªSystemServerï¼Œä¸»è¦è´Ÿè´£å››å¤§ç»„ä»¶çš„å¯åŠ¨ã€åˆ‡æ¢ã€è°ƒåº¦ä»¥åŠåº”ç”¨è¿›ç¨‹çš„ç®¡ç†å’Œè°ƒåº¦å·¥ä½œã€‚ ä¸»è¦åˆ†ä¸º: æœåŠ¡ä»£ç†ï¼šç”±ActivityManagerProxyå®ç°ï¼Œç”¨äºä¸Serverç«¯æä¾›çš„ç³»ç»ŸæœåŠ¡è¿›è¡ŒIPCï¼› æœåŠ¡ä¸­æ¢ï¼šActivityManagerNativeç»§æ‰¿è‡ªBinderå¹¶å®ç°IActivityManagerï¼Œå®ƒæä¾›äº†æœåŠ¡æ¥å£å’ŒBinderæ¥å£çš„ç›¸äº’è½¬åŒ–åŠŸèƒ½ï¼Œå¹¶åœ¨å†…éƒ¨å­˜å‚¨æœåŠ¡ä»£ç†å¯¹åƒï¼Œå¹¶æä¾›äº†getDefaultæ–¹æ³•è¿”å›æœåŠ¡ä»£ç†ï¼› Clientï¼šç”±ActivityManagerå°è£…ä¸€éƒ¨åˆ†æœåŠ¡æ¥å£ä¾›Clientè°ƒç”¨ã€‚ActivityManagerå†…éƒ¨é€šè¿‡è°ƒç”¨ActivityManagerNativeçš„getDefaultæ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°ä¸€ActivityManagerProxyå¯¹åƒçš„å¼•ç”¨ï¼Œè¿›è€Œé€šè¿‡è¯¥ä»£ç†å¯¹åƒè°ƒç”¨è¿œç¨‹æœåŠ¡çš„æ–¹æ³•ï¼› Server: ç”±ActivityManagerServiceå®ç°ï¼Œæä¾›Serverç«¯çš„ç³»ç»ŸæœåŠ¡ã€‚ å®é™…ä¸Šä»–å°±æ˜¯ä¸ªBinder,å¯ä»¥ç”¨æ¥IPC ","date":"2021-08-09","objectID":"/ams/:0:1","series":["AndroidFramework"],"tags":["Android"],"title":"AMS","uri":"/ams/"},{"categories":[],"content":"Hookç‚¹ binderå¤©ç„¶å¸¦æœ‰è°ƒç”¨è€…çš„èº«ä»½ä¿¡æ¯uidå’Œè¿›ç¨‹ä¿¡æ¯pid ã€‚ ","date":"2021-08-09","objectID":"/ams/:0:2","series":["AndroidFramework"],"tags":["Android"],"title":"AMS","uri":"/ams/"},{"categories":[],"content":"TODO ","date":"2021-08-09","objectID":"/android%E8%99%9A%E6%8B%9F%E6%9C%BA/:0:0","series":["AndroidFramework"],"tags":[],"title":"Androidè™šæ‹Ÿæœº","uri":"/android%E8%99%9A%E6%8B%9F%E6%9C%BA/"},{"categories":[],"content":"Crashï¼ˆåº”ç”¨å´©æºƒï¼‰æ˜¯ç”±äºä»£ç å¼‚å¸¸è€Œå¯¼è‡´ App éæ­£å¸¸é€€å‡ºï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºæ— æ³•ç»§ç»­ä½¿ç”¨ï¼Œæ‰€æœ‰å·¥ä½œéƒ½åœæ­¢çš„ç°è±¡ã€‚å‘ç”Ÿ Crash åéœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ï¼ˆæœ‰äº›æƒ…å†µä¼šè‡ªåŠ¨é‡å¯ï¼‰ï¼Œè€Œä¸”ä¸ç®¡åº”ç”¨åœ¨å¼€å‘é˜¶æ®µåšå¾—å¤šä¹ˆä¼˜ç§€ï¼Œä¹Ÿæ— æ³•é¿å… Crash å‘ç”Ÿï¼Œç‰¹åˆ«æ˜¯åœ¨ Android ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿç¢ç‰‡åŒ–ä¸¥é‡ã€å„ ROM ä¹‹é—´çš„å·®å¼‚ï¼Œç”šè‡³ç³»ç»ŸBugï¼Œéƒ½å¯èƒ½ä¼šå¯¼è‡´Crashçš„å‘ç”Ÿã€‚åœ¨ Android åº”ç”¨ä¸­å‘ç”Ÿçš„ Crash æœ‰ä¸¤ç§ç±»å‹ï¼ŒJava å±‚çš„ Crash å’Œ Native å±‚ Crashã€‚è¿™ä¸¤ç§Crash çš„ç›‘æ§å’Œè·å–å †æ ˆä¿¡æ¯æœ‰æ‰€ä¸åŒã€‚ ","date":"2021-08-09","objectID":"/crash%E7%9B%91%E6%8E%A7/:0:0","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Crashç›‘æ§","uri":"/crash%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"ä»€ä¹ˆæ˜¯å´©æºƒ æœªå¤„ç†çš„å¼‚å¸¸æˆ–ä¿¡å·å¯¼è‡´çš„æ„å¤–é€€å‡ºï¼Œä¼šä½¿ Android åº”ç”¨å´©æºƒã€‚ å½“åº”ç”¨å´©æºƒæ—¶ï¼ŒAndroid ä¼šç»ˆæ­¢åº”ç”¨çš„è¿›ç¨‹å¹¶æ˜¾ç¤ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå‘ŠçŸ¥ç”¨æˆ·åº”ç”¨å·²åœæ­¢ã€‚ ä½¿ç”¨ Java ç¼–å†™çš„åº”ç”¨ä¼šåœ¨æŠ›å‡ºæœªå¤„ç†çš„å¼‚å¸¸ï¼ˆç”± Throwable ç±»è¡¨ç¤ºï¼‰æ—¶å´©æºƒã€‚ä½¿ç”¨åŸç”Ÿä»£ç è¯­è¨€ç¼–å†™çš„åº”ç”¨ï¼Œä¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°æœªå¤„ç†çš„ä¿¡å·ï¼ˆå¦‚ SIGSEGVï¼‰æ—¶å´©æºƒã€‚ ","date":"2021-08-09","objectID":"/crash%E7%9B%91%E6%8E%A7/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Crashç›‘æ§","uri":"/crash%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"Java Crash ç›‘æ§ æˆ‘ä»¬å¯ä»¥é€šè¿‡Thread.setDefaultUncaughtExceptionHandleræ–¹æ³•æ¥è®¾ç½®çº¿ç¨‹çš„é»˜è®¤å¼‚å¸¸å¤„ç†å™¨ã€‚ public class App extends Application { @Override public void onCreate() { super.onCreate(); Thread.setDefaultUncaughtExceptionHandler(new MyUncaughtExcetionHandler()); } public static class MyUncaughtExcetionHandler implements Thread.UncaughtExceptionHandler { @Override public void uncaughtException(@NonNull Thread t, @NonNull Throwable e) { } } } Threadçš„é»˜è®¤UncaughtExceptionHandlerï¼Œæ˜¯RuntimeInit#KillApplicationHandlerï¼ŒåŠŸèƒ½å°±æ˜¯æ€æ‰ç¨‹åºï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ›´æ”¹çš„è¯ï¼Œç¨‹åºå°±ä¼šå¼¹çª—å¹¶é€€å‡ºã€‚ æµ‹è¯•è¡Œä¸º æµ‹è¯•æ–¹å¼ï¼Œæˆ‘åœ¨UIé‡Œé¢å®šä¹‰äº†ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»åä¼šè§¦å‘ä¸€ä¸ªæœªæ•è·çš„NPEï¼š public void test(View v) { String content = null; content.length(); } å®æµ‹ç‚¹å‡»ç¨‹åºå´©æºƒã€‚ å½“è®¾ç½®äº†Thread.setDefaultUncaughtExceptionHandlerä¹‹åï¼Œå†æ¬¡ç‚¹å‡»æŒ‰é’®è§¦å‘NPEï¼Œå¯ä»¥æ‹¦æˆªåˆ°æœªæ•è·å¼‚å¸¸ï¼Œè€Œä¸”ç¨‹åºæ²¡æœ‰å´©æºƒã€‚ ","date":"2021-08-09","objectID":"/crash%E7%9B%91%E6%8E%A7/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Crashç›‘æ§","uri":"/crash%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"NDK Crash ç›‘æ§ Linuxä¿¡å·æœºåˆ¶ linuxä¿¡å·æœºåˆ¶æ˜¯IPCçš„ä¸€ç§æ–¹å¼ï¼ŒåŒæ—¶ä¹Ÿè´Ÿè´£ç›‘æ§ç³»ç»Ÿå¼‚å¸¸åŠä¸­æ–­ã€‚ å½“ç¨‹åºå‘ç”Ÿè¿è¡Œå¼‚å¸¸æ—¶ï¼Œlinuxå†…æ ¸å°†ä¼šäº§ç”Ÿé”™è¯¯ä¿¡å·å¹¶é€šçŸ¥å½“å‰è¿›ç¨‹ï¼Œå½“å‰è¿›ç¨‹åœ¨æ”¶åˆ°è¯¥é”™è¯¯ä¿¡å·åï¼Œå¯ä»¥åˆä¸‰ç§å¤„ç†æ–¹å¼ï¼š å¿½ç•¥ä¿¡å·ï¼› æ•æ‰ä¿¡å·å¹¶æ‰§è¡Œä¿¡å·å¤„ç†é€»è¾‘ï¼› æ‰§è¡Œä¿¡å·çš„é»˜è®¤æ“ä½œï¼ˆè®°å½•ä¿¡æ¯ï¼Œç„¶åç»ˆæ­¢è¿›ç¨‹ï¼‰ã€‚ crashä¿¡å· ä¿¡å· æè¿° SIGSEGV å†…å­˜å¼•ç”¨æ— æ•ˆ SIGBUS è®¿é—®å†…å­˜å¯¹è±¡çš„æœªå®šä¹‰éƒ¨åˆ† SIGFPE ç®—æœ¯è¿ç®—é”™è¯¯ï¼ˆ0åšé™¤æ•°ï¼‰ SIGILL éæ³•æŒ‡ä»¤ï¼Œå¦‚æ‰§è¡Œåƒåœ¾æˆ–ç‰¹æƒæŒ‡ä»¤ SIGSYS ç³Ÿç³•çš„ç³»ç»Ÿè°ƒç”¨ SIGXCPU è¶…è¿‡CPUæ—¶é™ SIGFSZ è¶…å‡ºæ–‡ä»¶å¤§å°é™åˆ¶ ä¸€èˆ¬çš„å‡ºç°å´©æºƒä¿¡å·ï¼ŒAndroidç³»ç»Ÿé»˜è®¤ç¼ºçœæ“ä½œæ˜¯ç›´æ¥é€€å‡ºæˆ‘ä»¬çš„ç¨‹åºã€‚ä½†æ˜¯ç³»ç»Ÿå…è®¸æˆ‘ä»¬ç»™æŸä¸€ä¸ªè¿›ç¨‹çš„æŸä¸€ä¸ªç‰¹å®šä¿¡å·æ³¨å†Œä¸€ä¸ªç›¸åº”çš„å¤„ç†å‡½æ•°ï¼ˆsignalï¼‰ï¼Œå³å¯¹è¯¥ä¿¡å·çš„é»˜è®¤å¤„ç†åŠ¨ä½œè¿›è¡Œä¿®æ”¹ã€‚å› æ­¤NDK Crashçš„ç›‘æ§å¯ä»¥é‡‡ç”¨è¿™ç§ä¿¡å·æœºåˆ¶ï¼Œæ•è·å´©æºƒä¿¡å·æ‰§è¡Œæˆ‘ä»¬è‡ªå·±çš„ä¿¡å·å¤„ç†å‡½æ•°ä»è€Œæ•è·NDK Crashã€‚ ","date":"2021-08-09","objectID":"/crash%E7%9B%91%E6%8E%A7/:0:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Crashç›‘æ§","uri":"/crash%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"å¢“ç¢‘æ–‡ä»¶ Androidæœ¬æœºç¨‹åºæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªLinuxç¨‹åºï¼Œå½“å®ƒåœ¨æ‰§è¡Œæ—¶å‘ç”Ÿä¸¥é‡é”™è¯¯ï¼Œä¹Ÿä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œç„¶åäº§ ç”Ÿä¸€ä¸ªè®°å½•å´©æºƒçš„ç°åœºä¿¡æ¯çš„æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶åœ¨Androidç³»ç»Ÿä¸­å°±æ˜¯ tombstones å¢“ç¢‘æ–‡ä»¶ã€‚ä½äº~/data/tombstones/ä¸‹ã€‚æ™®é€šåº”ç”¨æ²¡æœ‰è¯»å–æƒé™ã€‚ ","date":"2021-08-09","objectID":"/crash%E7%9B%91%E6%8E%A7/:0:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Crashç›‘æ§","uri":"/crash%E7%9B%91%E6%8E%A7/"},{"categories":[],"content":"APKæ–‡ä»¶çš„æ„æˆ META-INF/ï¼šåŒ…å«CERT.SFå’ŒCERT.RSAç­¾åæ–‡ä»¶ï¼Œå’ŒMANIFEST.MFæ¸…å•æ–‡ä»¶ï¼› assets/ï¼šä¸éœ€ç¼–è¯‘çš„èµ„æºæ–‡ä»¶ï¼› res/ï¼šåŒ…å«éœ€è¦ç¼–è¯‘åˆ°resource.arscï¼Œä½†è¿˜æœªç¼–è¯‘çš„èµ„æºï¼› lib/ï¼šåŒ…å«ç‰¹å®šäºå¤„ç†å™¨è½¯ä»¶å±‚çš„å·²ç¼–è¯‘ä»£ç armeabiç­‰ï¼› resource.arscï¼šåŒ…å«å·²ç¼–è¯‘çš„èµ„æºï¼› classes.dexï¼šæˆ‘ä»¬çš„ä»£ç ï¼› AndroidManifest.xmlï¼šæ ¸å¿ƒAndroidæ¸…å•æ–‡ä»¶ã€‚ ","date":"2021-08-09","objectID":"/apk%E7%98%A6%E8%BA%AB/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"APKç˜¦èº«","uri":"/apk%E7%98%A6%E8%BA%AB/"},{"categories":[],"content":"ç˜¦èº«æ–¹æ³• ç§»é™¤æœªä½¿ç”¨èµ„æº å¯ä»¥é€šè¿‡IDEæä¾›çš„å»ºè®®ï¼Œå’Œlintæ£€æŸ¥å·¥å…·æ£€æµ‹å‡ºæœªä½¿ç”¨çš„èµ„æºã€æ— ç”¨çš„importã€å­—æ®µã€æ–¹æ³•ã€ç±»ï¼Œç„¶ååˆ æ‰ã€‚ å¦‚ä½•ä¿æŠ¤å¿…é¡»èµ„æº lint å·¥å…·ä¸ä¼šæ‰«æ assets/ æ–‡ä»¶å¤¹ã€é€šè¿‡åå°„å¼•ç”¨çš„èµ„æºæˆ–å·²é“¾æ¥è‡³åº”ç”¨çš„åº“æ–‡ä»¶ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿä¸ä¼šç§»é™¤èµ„æºï¼Œåªä¼šæé†’æ‚¨å®ƒä»¬çš„å­˜åœ¨ã€‚ é‚£ä¹ˆæœ‰äº›èµ„æºæš‚æ—¶ç”¨ä¸åˆ°ï¼Œæˆ‘ä»¬åˆéœ€è¦ä¿ç•™çš„ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªåŒ…å«\u003cresources\u003eçš„xmlæ–‡ä»¶ï¼š \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cresources xmlns:tools=\"http://schemas.android.com/tools\" tools:keep=\"@layout/l_used*_c,@layout/l_used_a,@layout/l_used_b*\" tools:discard=\"@layout/unused2\" /\u003e tools:keep æŒ‡å®šæ¯ä¸ªè¦ä¿ç•™çš„èµ„æºï¼› tools:discard æŒ‡å®šè¦èˆå¼ƒçš„èµ„æºï¼› è¿™ä¸¤ä¸ªå±æ€§éƒ½æ¥å—é€—å·åˆ†éš”ç¬¦å’Œ*å·é€šé…ç¬¦ã€‚ å¯ç”¨èµ„æºç¼©å‡ minifyEnabledï¼Œå¼€å¯ä»£ç æ··æ·†ï¼› shrinkResourcesï¼Œå¼€å¯èµ„æºç¼©å‡ã€‚ æŒ‡å®šæœ¬åœ°åŒ–è¯­è¨€ å¦‚æœä½¿ç”¨äº†åŒ…å«äº†è¯­è¨€çš„åº“ï¼ˆå¦‚AppCompatï¼‰ï¼Œé‚£ä¹ˆæ‰“åŒ…çš„æ—¶å€™ä¼šæŠŠæ‰€æœ‰å·²ç¿»è¯‘çš„è¯­è¨€çš„å­—ç¬¦ä¸²éƒ½æ‰“åŒ…è¿›å»ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‡å®šéœ€è¦çš„è¯­è¨€æ¥ç¼©å‡apkä½“ç§¯ï¼š android { defaultConfig { ... resConfigs \"zh-rCN\" } } æŒ‡å®šéœ€è¦çš„åŠ¨æ€åº“so android{ defaultConfig{ ndk{ abiFilters \"armeabi-v7a\" } } } armeabi-v7aå…¼å®¹arm64æ¶æ„ï¼Œä½†æ˜¯ä¸å¦‚arm64çš„soæ€§èƒ½é«˜ã€‚æˆ‘ä»¬å¯ä»¥é…åˆproductFlavorå’ŒflavorDimensionsæ¥åˆ†åˆ«é’ˆå¯¹armå’Œarm64è®¾å¤‡æ¥æ‰“åŒ…ã€‚ å›¾ç‰‡ç˜¦èº« å¯ä»¥ä½¿ç”¨webpæ›¿ä»£pngå’Œjpgï¼Œå¯ä»¥ä½¿ç”¨VectorDrawableçŸ¢é‡å›¾æ›¿ä»£åº”ç”¨å›¾æ ‡ã€‚ å¯ä»¥é€šè¿‡ImageViewçš„tintå±æ€§å‰å°æ”¹è‰²ï¼Œè¾¾åˆ°å¤ç”¨å›¾ç‰‡çš„ç›®çš„ã€‚ å¼€å¯æœ¬åœ°åº“å‹ç¼© \u003capplication android:name=\"io.flutter.app.FlutterApplication\" android:extractNativeLibs=\"true\" android:icon=\"@mipmap/ic_launcher\" android:label=\"@string/app_name\" android:networkSecurityConfig=\"@xml/network_security_config\" android:requestLegacyExternalStorage=\"true\" android:usesCleartextTraffic=\"true\"\u003e å½“android:extractNativeLibs = trueæ—¶ï¼Œgradleæ‰“åŒ…ä¼šå¯¹å·¥ç¨‹ä¸­çš„soè¿›è¡Œå‹ç¼©ï¼Œä½¿æœ€ç»ˆç”Ÿæˆçš„apkä½“ç§¯å˜å°ã€‚ä½†ç”¨æˆ·åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šå¯¹soåº“è§£å‹ï¼Œä»è€Œé€ æˆapkå®‰è£…æ—¶é—´å˜é•¿ã€‚ ","date":"2021-08-09","objectID":"/apk%E7%98%A6%E8%BA%AB/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"APKç˜¦èº«","uri":"/apk%E7%98%A6%E8%BA%AB/"},{"categories":[],"content":"ç½‘ç»œè¿æ¥æµç¨‹ DNSè§£æ-\u003eIP-\u003eSocket(TCP/IP)-\u003eæœåŠ¡ç«¯ ","date":"2021-08-06","objectID":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç½‘ç»œä¼˜åŒ–","uri":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ç½‘ç»œè¿æ¥æé€Ÿ ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œçœæ‰DNSè§£æè¿‡ç¨‹ï¼› å¤ç”¨è¿æ¥æˆ–è€…ä½¿ç”¨åŒä¸€æ¡é•¿è¿æ¥ï¼› å‹ç¼©æ•°æ®ï¼Œå‡å°æ•°æ®ä¼ è¾“é‡ã€‚ ","date":"2021-08-06","objectID":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç½‘ç»œä¼˜åŒ–","uri":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"DNSè§£æåŸŸåæµç¨‹ å…ˆä»æœ¬åœ°ç¼“å­˜ä¸­æŸ¥æ‰¾åŸŸåï¼› æŸ¥ä¸åˆ°ä¼šä»å°±è¿‘çš„å…¶ä»–DNSæœåŠ¡å™¨æŸ¥è¯¢ï¼› å†æŸ¥ä¸åˆ°ä¼šå»ä¸»åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼› è¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹æ˜¯ç›¸å½“æ¼«é•¿çš„ï¼Œè€Œä¸”æ¯ä¸€çº§éƒ½æœ‰ç¼“å­˜ï¼Œç¼“å­˜æœ‰è¿‡æœŸé™åˆ¶ï¼Œä¸€æ—¦è¿‡æœŸå°±è¦é‡æ–°å»æŸ¥ã€‚ DNSçš„ç¼ºç‚¹ è§£ææµç¨‹æ¼«é•¿ï¼Œè€—æ—¶å¤šï¼› ç”±äºç¼“å­˜æ—¶é™è¿‡é•¿ï¼ŒåŸŸåä¸èƒ½å³æ—¶æ›´æ–°ï¼› ç”±äºç¼“å­˜æ—¶é™è¿‡çŸ­å½±å“è¯·æ±‚é€Ÿåº¦ï¼› è§£æè¿‡ç¨‹ä¸å—æ§åˆ¶ï¼Œä¸èƒ½ä¿è¯è§£æåˆ°æœ€å¿«çš„IPï¼ˆæœ€è¿‘çš„ä¸ä¸€å®šæœ€å¿«ï¼‰ï¼› ä¸€æ¬¡è¯·æ±‚åªèƒ½è§£æä¸€ä¸ªåŸŸåï¼› å®¹æ˜“é­åˆ°ä¸­é—´äººæ”»å‡»æˆ–è¢«è¿è¥å•†åŠ«æŒã€‚ HTTPDNS å°±æ˜¯è‡ªå·±åœ¨æœåŠ¡å™¨ä¸ŠåšåŸŸåè§£æï¼Œé€šè¿‡HTTPè¯·æ±‚åå°æ‹¿åˆ°åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚ HTTPDNSçš„ä¼˜åŠ¿ ç›´æ¥é€šè¿‡IPåœ°å€è¯·æ±‚ï¼Œä¸å­˜åœ¨domainè§£æï¼Œé¿å…è¢«åŠ«æŒï¼› è§£æè¿‡ç¨‹ç”±è‡ªå·±æ§åˆ¶ï¼Œå¯ä»¥ç¡®ä¿è§£æåˆ°æœ€å¿«çš„IPåœ°å€ï¼› ä¸€æ¬¡è¯·æ±‚å¯è§£æå¤šä¸ªåŸŸåã€‚ ","date":"2021-08-06","objectID":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/:0:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç½‘ç»œä¼˜åŒ–","uri":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"è¿æ¥ä¼˜åŒ– keep-alive httpåè®®ä¸­å­˜åœ¨keep-aliveï¼ˆå°±åœ¨è¯·æ±‚å¤´é‡Œï¼‰ï¼Œåœ¨HTTP1.1å¼€å§‹é»˜è®¤å¼€å¯ï¼Œä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†æ¯æ¬¡è¯·æ±‚éƒ½è¦ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥çš„è€—æ—¶ã€‚ åŸç†æ˜¯è¯·æ±‚å®Œæˆä¹‹åä¸é‡Šæ”¾è¿æ¥ï¼Œè€Œä¸”æ”¾åˆ°è¿æ¥æ± ä¸­ç¼“å­˜ã€‚ ä½†æ˜¯ï¼Œå¼€å¯keep-aliveçš„è¿æ¥ä¸€æ¬¡æ€§åªèƒ½å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨ä¸Šä¸€ä¸ªè¯·æ±‚å¤„ç†å®Œæˆä¹‹å‰ï¼Œæ— æ³•æ¥å—æ–°çš„è¯·æ±‚ã€‚è‹¥åŒæ—¶å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œä¼šå‘ç”Ÿï¼š è‹¥ä¸²è¡Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥ä»¥é˜»å¡é˜Ÿåˆ—çš„æ–¹å¼å¤ç”¨åŒä¸€ä¸ªè¿æ¥ï¼Œä½†æ˜¯é€Ÿåº¦å¾ˆæ…¢ï¼› è‹¥å¹¶è¡Œå‘é€è¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½è¦è¿›ç¨‹ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹æ–°è¿æ¥çš„è¿‡ç¨‹ã€‚ é—®é¢˜è§£å†³ http2æå‡ºäº†å¤šè·¯å¤ç”¨æ¥è§£å†³å¹¶è¡Œè¯·æ±‚çš„é—®é¢˜ã€‚ http2ä¸­ï¼Œä¹Ÿæ˜¯å¤ç”¨è¿æ¥ï¼Œä½†æ˜¯ä¸€æ¡è¿æ¥æ”¯æŒåŒæ—¶å¤„ç†å¤šæ¡è¯·æ±‚ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¯ä»¥å¹¶å‘åœ¨è¿™æ¡è¿æ¥ä¸Šè¿›è¡Œã€‚ åŸç†æ˜¯æŠŠè¿æ¥ä¼ è¾“çš„æ•°æ®éƒ½æ‰“åŒ…æˆä¸€ä¸ªä¸ªçš„streamï¼Œæ¯ä¸ªstreaméƒ½å…·æœ‰æ ‡è¯†ï¼Œstreamçš„å‘é€å’Œæ¥å—å¯ä»¥æ˜¯ä¹±åºçš„ï¼Œä¹Ÿä¸å­˜åœ¨é˜»å¡çš„é—®é¢˜ï¼Œæ¥æ”¶ç«¯æ ¹æ®æ ‡è¯†æ¥åŒºåˆ†è¯·æ±‚ï¼Œå†è¿›è¡Œæ•°æ®æ‹¼æ¥ï¼Œå¾—åˆ°æœ€ç»ˆæ•°æ®ã€‚ OkHttpé»˜è®¤ä¼šå¼€å¯keep-aliveï¼Œå¹¶ä¸”åœ¨Okhttp3ä»¥ä¸Šä¹Ÿæ”¯æŒäº†Http2ã€‚ ","date":"2021-08-06","objectID":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/:0:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç½‘ç»œä¼˜åŒ–","uri":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"æ•°æ®å‹ç¼© é€‰æ‹©åºåˆ—åŒ–æ–¹å¼ json protobuf è¯·æ±‚ä½“å‹ç¼© é‡‡ç”¨gzipå¯¹bodyè¿›è¡Œå‹ç¼©ã€‚ OkHttpçš„BridgeInterceptorè¿™ä¸ªæ‹¦æˆªå™¨ä¼šé»˜è®¤å¼€å¯gzipè§£å‹æ”¯æŒï¼š boolean transparentGzip = false; if (userRequest.header(\"Accept-Encoding\") == null \u0026\u0026 userRequest.header(\"Range\") == null) { transparentGzip = true; requestBuilder.header(\"Accept-Encoding\", \"gzip\"); } å‹ç¼©ä¹‹åä¼šåœ¨Headerä¸­æ·»åŠ Content-Encodin:gzipã€‚ å…¶ä»– webpä»£æ›¿pngå’Œjpgï¼› 2/3Gç½‘ç»œä¸‹è®©æœåŠ¡å™¨ä¸‹å‘ä½æ¸…å›¾ç‰‡ï¼› ç¼“å­˜ã€‚ ","date":"2021-08-06","objectID":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/:0:5","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç½‘ç»œä¼˜åŒ–","uri":"/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ç”µé‡ä¼˜åŒ–æ–¹æ³• å‡å°‘ä¸å¿…è¦çš„æ“ä½œï¼Œä¾‹å¦‚ç¼“å­˜æ•°æ®ï¼Œè€Œä¸æ¯æ¬¡éƒ½è¯·æ±‚æ•°æ® å»¶è¿Ÿæ“ä½œï¼Œç­‰è®¾å¤‡æ»¡ç”µæˆ–å……ç”µæ—¶å†æ‰§è¡Œã€‚ åˆå¹¶æ“ä½œï¼Œæ‰¹å¤„ç†ï¼Œå‡å°‘è®¾å¤‡å¤„äºæ´»åŠ¨çŠ¶æ€çš„æ—¶é—´ã€‚ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:1:0","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Dozeæ‰“ç›¹æ¨¡å¼ Android6.0æ¨å‡ºã€‚ é’ˆå¯¹æ•´ä¸ªç³»ç»Ÿã€‚ å¦‚æœè®¾å¤‡æœªå……ç”µï¼Œå±å¹•ç†„ç­ï¼Œè®©è®¾å¤‡åœ¨ä¸€æ®µæ—¶é—´åå‘ç”Ÿé—´æ­‡æ€§æ‰“ç›¹-è‹é†’ï¼Œæ‰“ç›¹æ—¶é˜»å¡æ‰€æœ‰ä»»åŠ¡ï¼Œç­‰è‹é†’æ—¶ä¸€å¹¶å¤„ç†ï¼Œä¸”æ‰“ç›¹æ—¶é—´ä¼šè¶Šæ¥è¶Šé•¿ã€‚ å½±å“èŒƒå›´ï¼š æš‚åœç½‘ç»œ å¿½ç•¥PowerManager. WakeLockå”¤é†’ï¼› å»¶è¿ŸAlarmManager. ä¸æ‰§è¡ŒWIFIæ‰«æï¼› ä¸æ‰§è¡Œè´¦å·åŒæ­¥ ä¸æ‰§è¡ŒJobSchedulerã€‚ å¦‚æœéœ€è¦ä¸ç½‘ç»œå»ºç«‹æŒä¹…æ€§é“¾æ¥ï¼Œåº”å¯èƒ½ä½¿ç”¨Firebaseäº‘æ¶ˆæ¯ä¼ é€’FCMï¼ˆä»¥å‰å«GCMï¼‰ã€‚ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:0","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Dozeæœºåˆ¶ä¸‹çš„é—¹é’Ÿå¤„ç† setAndAlarmWhileIdle()ä¸€æ¬¡æ€§é—¹é’Ÿï¼› setExactAndAllowWhileIdle()é«˜ç²¾åº¦ä¸€æ¬¡æ€§é—¹é’Ÿï¼› setAlarmClockè®¾ç½®çš„é—¹é’Ÿå¯ä»¥æ­£å¸¸è§¦å‘ï¼Œå‡ºå‘å‰ç³»ç»Ÿä¼šé€€å‡ºä½ç”µè€—æ¨¡å¼ã€‚ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Dozeæµ‹è¯• å¯åŠ¨Doze # å¯åŠ¨Doze adb shell dumpsys deviceidle enable # å¼ºåˆ¶å¯åŠ¨Dozeå¹¶å…³é—­å±å¹• adb shell dumpsys deviceidle force-idle æ•²å®Œå‘½ä»¤åï¼Œå¿…é¡»è¦å…³é—­å±å¹•æ‰èƒ½çœŸæ­£è¿›å…¥Dozeæ¨¡å¼ã€‚ é€€å‡ºDoze # å…³é—­Doze adb shell dumpsys deviceidle disable # é€€å‡ºDoze adb shell dumpsys deviceidle unforce é‡ç½®è®¾å¤‡ # é‡ç½®ç”µæ± è®¾ç½® adb shell dumpsys battery reset æŸ¥çœ‹Dozeç™½åå• adb shell dumpsys deviceidle whitelist ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"StandByå¾…æœºæ¨¡å¼ é’ˆå¯¹ç‰¹å®šåº”ç”¨ã€‚ åº”ç”¨å¾…æœºæ¨¡å¼ä¼šå»¶è¿Ÿç”¨æˆ·è¿‘æœŸæœªä¸ä¹‹äº¤äº’çš„åº”ç”¨çš„åå°ç½‘ç»œæ´»åŠ¨ã€‚ å½“ç”¨æˆ·å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä¸åº”ç”¨äº¤äº’ï¼Œå¹¶ä¸”ï¼Œåº”ç”¨æ²¡æœ‰ä¸€ä¸‹è¡¨ç°ï¼Œåˆ™ç³»ç»Ÿä¼šä½¿å…¶è¿›å…¥ç©ºé—²çŠ¶æ€ï¼š ç”¨æˆ·æ˜ç¡®çš„å¯åŠ¨åº”ç”¨ï¼› æœ‰å‰å°ï¼ˆæ´»åŠ¨æˆ–æœåŠ¡ï¼‰è¿›ç¨‹åœ¨è¿è¡Œï¼› åº”ç”¨ç”Ÿæˆäº†é€šçŸ¥ã€‚ å½“æ’å…¥ç”µæºæ—¶ï¼Œç³»ç»Ÿä¼šä»å¾…æœºçŠ¶æ€é‡Šæ”¾åº”ç”¨ï¼Œå¦‚æœè®¾å¤‡é•¿æ—¶é—´å¤„äºé—²ç½®çŠ¶æ€ï¼Œç³»ç»Ÿä¼šå…è®¸é™åˆ¶çš„åº”ç”¨è®¿é—®ç½‘ç»œï¼Œé¢‘ç‡å¤§æ¦‚ä¸€å¤©ä¸€æ¬¡ã€‚ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ç”µæ± ä¼˜åŒ–ç™½åå• åœ¨ä½ç”µè€—æ¨¡å¼å’Œåº”ç”¨å¾…æœºæ¨¡å¼æœŸé—´ï¼Œåˆ—å…¥ç™½åå•çš„åº”ç”¨å¯ä»¥ä½¿ç”¨ç½‘ç»œå¹¶ä¿ç•™éƒ¨åˆ†å”¤é†’é”å®šã€‚ä¸è¿‡ï¼Œåˆ—å…¥ç™½åå•çš„åº”ç”¨ä»ä¼šå—åˆ°å…¶ä»–é™åˆ¶ï¼Œå°±åƒå…¶ä»–åº”ç”¨ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œåˆ—å…¥ç™½åå•çš„åº”ç”¨çš„ä½œä¸šå’ŒåŒæ­¥ä¼šå»¶è¿Ÿï¼ˆåœ¨6.0åŠä»¥ä¸‹çš„è®¾å¤‡ä¸Šï¼‰ï¼Œå¹¶ä¸”å…¶å¸¸è§„ AlarmManager é—¹é’Ÿä¸ä¼šè§¦å‘ã€‚ ç®€è¨€ä¹‹ï¼Œjust agree but not easyã€‚ä»…ä»…åŒæ„ä½¿ç”¨ç½‘ç»œå’Œcpuå”¤é†’ï¼Œä½†æ˜¯ä»æ—§æœ‰é™åˆ¶ï¼Œä¸ä¿è¯ä½ ç”¨çš„èˆ’æœã€‚ æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•å†… PowerManager.isIgnoringBatteryOptimizations() è·³è½¬ç³»ç»Ÿç”µæ± ä¼˜åŒ–é¡µé¢ startActivity(new Intent(Settings.ACTION_IGNORE_BATTERY_OPTIMIZATION_SETTINGS)); ç”³è¯·åŠ å…¥ç™½åå• æƒé™ï¼š REQUEST_IGNORE_BATTERY_OPTIMIZATIONS ã€‚ è¯¥æƒé™å¯ä»¥è§¦å‘ä¸€ä¸ªç³»ç»Ÿå¯¹è¯æ¡†ï¼Œè®©ç”¨æˆ·ç›´æ¥å°†è¯¥åº”ç”¨æ·»åŠ åˆ°ç™½åå•ï¼Œæ— éœ€è·³è½¬åˆ°è®¾ç½®é¡µé¢ï¼š \u003c!-- å¿…é¡»å£°æ˜æƒé™ --\u003e \u003cuses-permission android:name=\"android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS\" /\u003e Intent intent = new Intent(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS); intent.setData(Uri.parse(\"package:\"+getPackageName())); startActivity(intent); StandByæ¨¡å¼æµ‹è¯• æ–­å¼€å……ç”µ adb shell dumpsys battery unplug å¯åœStandby adb shell am set-inactive \u003cåŒ…å\u003e true/false æŸ¥çœ‹æ˜¯å¦å¤„äºStandby adb shell am get-inactive \u003cåŒ…å\u003e é‡ç½®ç”µæ± è®¾ç½® adb shell dumpsys battery reset ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ç›‘æ§ç”µæ± çŠ¶æ€ é€šè¿‡ç³»ç»Ÿå¹¿æ’­Intent.ACTION_BATTERY_CHANGEDï¼Œå¯ä»¥ç›‘æ§åˆ°ç”µæ± æ˜¯å¦åœ¨å……ç”µï¼Œæ˜¯å¦å……æ»¡ï¼Œç”¨USBè¿˜æ˜¯ç”¨å……ç”µå™¨ï¼š IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED); Intent batteryStatus = registerReceiver(null, ifilter); // æ˜¯å¦æ­£åœ¨å……ç”µ int status = batteryStatus.getIntExtra(BatteryManager.EXTRA_STATUS, -1); boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING || status == BatteryManager.BATTERY_STATUS_FULL; // ä»€ä¹ˆæ–¹å¼å……ç”µï¼Ÿ int chargePlug = batteryStatus.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1); //usb boolean usbCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_USB; //å……ç”µå™¨ boolean acCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_AC; Log.e(TAG, \"isCharging: \" + isCharging + \" usbCharge: \" + usbCharge + \" acCharge:\" + acCharge); ç³»ç»Ÿå¹¿æ’­ Intent. ACTION_POWER_CONNECTED å’Œ Intent. ACTION_POWER_DISCONNECTED å¯ä»¥ç›‘æ§åˆ°ç”µæ± çŠ¶æ€çš„å˜åŒ–ï¼š /æ³¨å†Œå¹¿æ’­ IntentFilter ifilter = new IntentFilter(); //å……ç”µçŠ¶æ€ ifilter.addAction(Intent.ACTION_POWER_CONNECTED); ifilter.addAction(Intent.ACTION_POWER_DISCONNECTED); //ç”µé‡æ˜¾è‘—å˜åŒ– ifilter.addAction(Intent.ACTION_BATTERY_LOW); //ç”µé‡ä¸è¶³ ifilter.addAction(Intent.ACTION_BATTERY_OKAY); //ç”µé‡ä»ä½å˜å›é«˜ powerConnectionReceiver = new PowerConnectionReceiver(); registerReceiver(powerConnectionReceiver, ifilter); public class PowerConnectionReceiver extends BroadcastReceiver { @Override public void onReceive(Context context, Intent intent) { if (intent.getAction().equals(Intent.ACTION_POWER_CONNECTED)) { Toast.makeText(context, \"å……ç”µçŠ¶æ€ï¼šCONNECTED\", Toast.LENGTH_SHORT).show(); } else if (intent.getAction().equals(Intent.ACTION_POWER_DISCONNECTED)) { Toast.makeText(context, \"å……ç”µçŠ¶æ€ï¼šDISCONNECTED\", Toast.LENGTH_SHORT).show(); } else if (intent.getAction().equals(Intent.ACTION_BATTERY_LOW)) { Toast.makeText(context, \"ç”µé‡è¿‡ä½\", Toast.LENGTH_SHORT).show(); } else if (intent.getAction().equals(Intent.ACTION_BATTERY_OKAY)) { Toast.makeText(context, \"ç”µé‡ä»ä½å˜å›é«˜\", Toast.LENGTH_SHORT).show(); } } } ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:5","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"WorkManager WorkManagerå¯ä»¥æ ¹æ®ç”µæ± çŠ¶æ€è°ƒåº¦åå°ä»»åŠ¡ã€‚ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:6","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Battery Historianå·¥å…· Battery Historianæ˜¯ä¸€ä¸ªå¯ä»¥äº†è§£è®¾å¤‡éšæ—¶é—´çš„è€—ç”µæƒ…å†µçš„å·¥å…· ã€‚åœ¨ç³»ç»Ÿçº§åˆ«ï¼Œè¯¥å·¥å…·ä»¥ HTML çš„å½¢å¼å¯è§†åŒ–æ¥ è‡ªç³»ç»Ÿæ—¥å¿—çš„ç”µæºç›¸å…³äº‹ä»¶ã€‚åœ¨å…·ä½“åº”ç”¨çº§åˆ«ï¼Œè¯¥å·¥å…·å¯æä¾›å„ç§æ•°æ®ï¼Œå¸®åŠ©æ‚¨è¯†åˆ«è€—ç”µçš„åº”ç”¨è¡Œä¸ºï¼š è¿‡äºé¢‘ç¹çš„è§¦å‘å”¤é†’æé†’ï¼ˆè‡³å°‘æ¯10ç§’ä¸€æ¬¡ï¼‰ï¼› æŒç»­ä¿ç•™GPSé”å®šï¼› è‡³å°‘æ¯30ç§’è°ƒåº¦ä¸€æ¬¡ä½œä¸šï¼› è‡³å°‘æ¯30ç§’è°ƒåº¦ä¸€æ¬¡åŒæ­¥ï¼› ä½¿ç”¨æ‰‹æœºæ— çº¿è£…ç½®çš„é¢‘ç‡é«˜äºé¢„æœŸã€‚ ä¾èµ–GOã€Pythonå’ŒGitï¼Œæ‹‰å€’å§~ ","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:7","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Profileå·¥å…·","date":"2021-08-06","objectID":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/:2:8","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ç”µé‡ä¼˜åŒ–","uri":"/%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ANRçš„æ¦‚å¿µ æ˜¯æŒ‡åº”ç”¨ç¨‹åºæœªå“åº”ã€‚ ç”± ActivityManager å’Œ WindowManager ä¸¤ä¸ªç³»ç»ŸæœåŠ¡è¿›è¡Œç›‘è§†çš„ã€‚ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"ANRäº§ç”Ÿåœºæ™¯ ä¸»çº¿ç¨‹è€—æ—¶æ“ä½œ SP åºåˆ—åŒ– å¹¶å‘é€ æˆæ­»é”ï¼Œblockäº†ä¸»çº¿ç¨‹ ç³»ç»Ÿèµ„æºè€—å°½ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"è¡Œä¸º å‰å°äº§ç”ŸANRå¼¹æ¡†è¯¢é—®ç”¨æˆ·æ˜¯å¦ç­‰å¾…ï¼› åå°äº§ç”Ÿçš„ANRç›´æ¥å´©æºƒã€‚ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"æ—¶é™ åœºæ™¯ æ—¶å¸¸ å‰å°æœåŠ¡ 20S åå°æœåŠ¡ 200S å‰å°å¹¿æ’­ 10S åå°å¹¿æ’­ 60S ContentProvider 10S è¾“å…¥äº‹ä»¶ 5S ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"ANRçš„é”™è¯¯æ—¥å¿— 2021-08-04 14:07:55.885 4563-4574/com.vee.myapplication I/e.myapplicatio: Thread[7,tid=4574,WaitingInMainSignalCatcherLoop,Thread*=0x7250d39c00,peer=0x167402a0,\"Signal Catcher\"]: reacting to signal 3 2021-08-04 14:07:56.015 4563-4574/com.vee.myapplication I/e.myapplicatio: Wrote stack traces to tombstoned 2021-08-04 14:08:07.027 4563-4563/com.vee.myapplication I/Choreographer: Skipped 1202 frames! The application may be doing too much work on its main thread. æœ€é‡è¦çš„ä¸€å¥è¯ The application may be doing too much work on its main thread. ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:5","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"traceæ–‡ä»¶ ä½ç½®ï¼š data/anr/traces_*.txt æ‰¾åˆ°firstPidï¼Œå³å‘ç”ŸANRçš„è¿›ç¨‹idã€‚ traceåŒ…å«ANRçš„æ—¶é—´ç‚¹å’ŒCPUä½¿ç”¨ç‡ã€ä¸»çº¿ç¨‹çŠ¶æ€ã€å…¶ä»–çº¿ç¨‹çŠ¶æ€ç­‰é‡è¦ä¿¡æ¯ã€‚ ä½†æ˜¯5.0ä¹‹åä¼šè¢«selinuxæŒ¡ä½ï¼Œè·å–ä¸åˆ°ã€‚ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:6","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"å¢“ç¢‘æ–‡ä»¶ çœ‹logä¸­é—´çš„ä¸€æ¡ Wrote stack traces to tombstoned ï¼Œæ„æ€å·²ç»æŠŠå¯¹æˆ˜è¿½è¸ªå†™å…¥äº†å¢“ç¢‘æ–‡ä»¶ã€‚å¢“ç¢‘æ–‡ä»¶æ²¡æœ‰è¯»å†™æƒé™ã€‚ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:7","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"çº¿ä¸Šç›‘æ§ çº¿ä¸Šç›‘æ§çš„éš¾ç‚¹å°±åœ¨äºï¼Œå‰å°å‘ç”Ÿçš„ANRæ²¡æœ‰å´©æºƒ FileObserver æ­¤æ–¹æ¡ˆåŸºæœ¬ä¸èƒ½ç”¨äº†ã€‚ åŸç†æ˜¯ç›‘æ§ /data/anr æ–‡ä»¶å¤¹çš„å˜åŒ–ï¼Œç„¶ååˆ¤æ–­pidã€‚ BlockCanary ç”±äºAndroidæ˜¯åŸºäºæ¶ˆæ¯é©±åŠ¨çš„ï¼Œåœ¨Loop.loop()æ–¹æ³•ä¸­ï¼š public static void loop(){ ... for(;;){ Message msg = queue.next(); if(logging != null){ logging.print(\"\u003e\u003e\u003e\u003eDispatching to\"+msg.target+msg.what); } msg.target.dispatchMessage(msg); } } æ ¹æ® queue.next() ä¸ msg.target.dispatchMessage(msg) çš„æ—¶é—´å·®æ¥åˆ¤æ–­æ˜¯å¦å‘ç”ŸANRï¼Œåšæ³•æ˜¯è‡ªå®šä¹‰ä¸€ä¸ªloogingä¼ è¿›å»ï¼š Looper.getMainLooper.setMessageLogging(myLogging); é€šè¿‡é‡å†™ print æ–¹æ³•åŠ å…¥æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘ã€‚ é—®é¢˜ï¼šloggingæœ‰å¯èƒ½è¢«æ”¹æˆnullï¼Œåè€Œé€ æˆNPEé—®é¢˜ã€‚ SafeLooper åå°„hookä¸»çº¿ç¨‹çš„looperï¼Œæ¥ç®¡åŠŸèƒ½ï¼Œæ’å…¥æ—¶é—´å·®åˆ¤æ–­ï¼Œä½†åå°„å¯¼è‡´å¤§é‡æ€§èƒ½æŸè€—ã€‚ ä»¿WatchDog å¯åŠ¨ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ï¼Œå…ˆå‘ä¸»çº¿ç¨‹å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œå†é€šè¿‡ handler.postDelay() ä¼‘çœ ï¼Œè€Œdelayæ—¶é—´å°±æ˜¯ANRçš„é˜ˆå€¼ï¼Œdelayåˆ°æœŸååˆ¤æ–­ä¸»çº¿ç¨‹æ˜¯å¦ç¡®å®æ”¶åˆ°æ¶ˆæ¯ã€‚ å¾®ä¿¡çš„è§£å†³æ–¹æ¡ˆ è…¾è®¯Matrix for Androidå¯¹ANRç›‘æ§çš„åŸç† çœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œè®©æˆ‘æ·±æ·±çš„è®¤è¯†åˆ°äº†ä»€ä¹ˆæ˜¯å·®è·ï¼Œä»€ä¹ˆæ˜¯ä»·å€¼ã€‚ ","date":"2021-08-04","objectID":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/:0:8","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"ANRé—®é¢˜è§£å†³","uri":"/anr%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"categories":[],"content":"Systrace Systrace æ˜¯Androidå¹³å°æä¾›çš„ä¸€æ¬¾å·¥å…·ï¼Œç”¨äºè®°å½•çŸ­æœŸå†…çš„è®¾å¤‡æ´»åŠ¨ã€‚è¯¥å·¥å…·ä¼šç”Ÿæˆä¸€ä»½æŠ¥å‘Šï¼Œå…¶ä¸­æ±‡æ€»äº†Android å†…æ ¸ä¸­çš„æ•°æ®ï¼Œä¾‹å¦‚ CPU è°ƒåº¦ç¨‹åºã€ç£ç›˜æ´»åŠ¨å’Œåº”ç”¨çº¿ç¨‹ã€‚Systraceä¸»è¦ç”¨æ¥åˆ†æç»˜åˆ¶æ€§èƒ½æ–¹é¢çš„é—®é¢˜ã€‚åœ¨å‘ç”Ÿå¡é¡¿æ—¶ï¼Œé€šè¿‡è¿™ä»½æŠ¥å‘Šå¯ä»¥çŸ¥é“å½“å‰æ•´ä¸ªç³»ç»Ÿæ‰€å¤„çš„çŠ¶æ€ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…æ›´ç›´è§‚çš„åˆ†æç³»ç»Ÿç“¶é¢ˆï¼Œæ”¹è¿›æ€§èƒ½ã€‚ éœ€è¦å®‰è£…Pythonï¼Œå¥½å§ï¼Œæ»šï¼ ","date":"2021-08-04","objectID":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"UIå¡é¡¿ä¸å¸ƒå±€ä¼˜åŒ–","uri":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"è¿‡åº¦æ¸²æŸ“ å¸ƒå±€å±‚çº§ä¼˜åŒ– å¼€å‘è€…å·¥å…·ä¸­å¼€å¯é¡µé¢è¿‡åº¦ç»˜åˆ¶ç›‘æ§ï¼Œåœ¨å±å¹•ä¸Šç”¨é¢œè‰²å†·æš–è‰²è°ƒæ¥ç›‘æ§ç»˜åˆ¶æ¬¡æ•°ã€‚ ä½¿ç”¨Layout Inspectorå·¥å…·å¯ä»¥ç›´è§‚çš„æ£€æŸ¥å¸ƒå±€å±‚çº§ã€‚ ConstraintLayoutå‡å°‘åµŒå¥—ï¼› mergeæ ‡ç­¾é‡ç”¨çˆ¶çº§å¸ƒå±€ï¼› ViewStubæ‡’åŠ è½½ä¸éœ€è¦ç«‹å³æ˜¾ç¤ºçš„è§†å›¾å…ƒç´ ã€‚ èƒŒæ™¯ä¼˜åŒ– å»é™¤ä¸å¿…è¦çš„èƒŒæ™¯ï¼Œæ¯”å¦‚éƒ¨åˆ†Activityã€fragmentä¸­å­˜åœ¨èƒŒæ™¯å›¾ç‰‡ï¼Œä½†æ˜¯å¹¶ä¸å¯è§ï¼Œå°±éœ€è¦ç§»é™¤ã€‚ å‡å°‘alphaçš„ä½¿ç”¨ å¯¹äºä¸é€æ˜çš„Viewï¼Œåªéœ€è¦ç»˜åˆ¶ä¸€æ¬¡å³å¯ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªViewè®¾ç½®äº†Alphaï¼Œåˆ™è‡³å°‘éœ€è¦ä¸¤æ¬¡ç»˜åˆ¶ã€‚ è§£å†³æ–¹æ³•æ˜¯å‡å°‘é€æ˜Viewçš„ä½¿ç”¨ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ARGBæ›¿ä»£ã€‚ å¤æ‚é¡µé¢å¼‚æ­¥å¤„ç† éœ€è¦ç”¨åˆ°AsyncLayoutInflaterç±»ï¼š dependencies { implementation \"androidx.asynclayoutinflater:asynclayoutinflater:1.0.0\" } ä½¿ç”¨ï¼š new AsyncLayoutInflater(this) .inflate(R.layout.activity_main, null, new AsyncLayoutInflater.OnInflateFinishedListener() { @Override public void onInflateFinished(@NonNull View view, int resid, @Nullable ViewGroup parent) { setContentView(view); //...... } }); GCä¼˜åŒ– ç”±äºJavaçš„å›æ”¶æœºåˆ¶æ˜¯stop the worldï¼Œæ‰€ä»¥ä¸€æ—¦å‘ç”ŸGCå°±ä¼šæŒ‚èµ·æ‰€æœ‰çš„çº¿ç¨‹ï¼ŒåŒ…æ‹¬ä¸»çº¿ç¨‹ï¼Œè¿™å°±é€ æˆäº†UIçš„å¡é¡¿ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦å°½å¯èƒ½å°‘çš„å‘ç”ŸGCï¼Œé‚£ä¹ˆå°±è¦ç¦æ­¢åœ¨å¾ªç¯æˆ–è€…é€’å½’ä¸­åˆ›å»ºæ— ç”¨çš„ä¸´æ—¶å˜é‡ã€‚ ","date":"2021-08-04","objectID":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"UIå¡é¡¿ä¸å¸ƒå±€ä¼˜åŒ–","uri":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"å¤§æ‹› ç³»ç»Ÿåœ¨æ¸²æŸ“é¡µé¢å‰åšäº†ä¸‰ä»¶äº‹ï¼š è¯»å–layout.xml é€’å½’è§£æxml å±‚å±‚åå°„ç”Ÿæˆå¯¹è±¡ è§£å†³æ–¹å¼ï¼š åˆ©ç”¨ç¼–è¯‘æ—¶æ³¨è§£å¤„ç†å™¨ï¼Œé€šè¿‡javaæ–‡ä»¶ç”Ÿæˆå™¨ï¼ˆJavaPoetï¼‰åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆå¸ƒå±€çš„ViewGroupç±»ï¼Œæ³¨å…¥åˆ°Activityä¸­ã€‚ ç¼ºç‚¹ï¼šä¸èƒ½ä½¿ç”¨mergeæ ‡ç­¾ï¼Œå› ä¸ºåªæœ‰åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“çˆ¶çº§ä½¿ç”¨ä»€ä¹ˆå¸ƒå±€ã€‚ ","date":"2021-08-04","objectID":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/:0:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"UIå¡é¡¿ä¸å¸ƒå±€ä¼˜åŒ–","uri":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"è‡ªå®šä¹‰Viewä¼˜åŒ– Drawæ–¹æ³•ä¸­å°½é‡ä¸è¦åˆ›å»ºå¯¹è±¡ã€‚ ","date":"2021-08-04","objectID":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/:0:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"UIå¡é¡¿ä¸å¸ƒå±€ä¼˜åŒ–","uri":"/ui%E5%8D%A1%E9%A1%BF%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"å›é¡¾å¯åŠ¨æµç¨‹ ç‚¹å‡»Appå›¾æ ‡ï¼› Launcherè¿›ç¨‹é€šè¿‡Binderå‘SystemServerè¿›ç¨‹å‘èµ·startActivityè¯·æ±‚ï¼› SystemServeræ”¶åˆ°è¯·æ±‚åå‘zygoteå‘èµ·åˆ›å»ºè¿›ç¨‹è¯·æ±‚ï¼› zygoteæ”¶åˆ°è¯·æ±‚forkè‡ªå·±åˆ›å»ºæ–°çš„å­è¿›ç¨‹ï¼ˆAppè¿›ç¨‹ï¼‰ï¼› Appè¿›ç¨‹é€šè¿‡binderå‘SystemServerè¿›ç¨‹å‘èµ·attachApplicationè¯·æ±‚ï¼› SystemServeræ”¶åˆ°è¯·æ±‚åï¼Œè¿›è¡Œä¸€ç³»åˆ—æ“ä½œåï¼Œé€šè¿‡Binderå‘Appè¿›ç¨‹å‘é€scheduleLauncherActivityè¯·æ±‚ï¼› Appè¿›ç¨‹æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡handlerå‘ä¸»çº¿ç¨‹å‘é€LAUNCH_ACTIVITYæ¶ˆæ¯ï¼› ä¸»çº¿ç¨‹æ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡åå°„åˆ›å»ºç›®æ ‡Activityï¼Œå¹¶è°ƒç”¨onCreateæ–¹æ³•ã€‚ ","date":"2021-08-03","objectID":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Androidå¯åŠ¨ä¼˜åŒ–","uri":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"åº”ç”¨å¯åŠ¨çŠ¶æ€ å†·å¯åŠ¨ï¼šæ˜¯æŒ‡åº”ç”¨ä»å¤´å¼€å§‹å¯åŠ¨ï¼Œç³»ç»Ÿè¿›ç¨‹åœ¨å†·å¯åŠ¨åæ‰åˆ›å»ºåº”ç”¨è¿›ç¨‹ï¼› çƒ­å¯åŠ¨ï¼šç³»ç»Ÿçš„æ‰€æœ‰å·¥ä½œå°±æ˜¯å°†Activityå¸¦åˆ°å‰å°ï¼Œä¸éœ€è¦é‡æ–°åˆ›å»ºã€åŠ è½½å’Œç»˜åˆ¶ï¼› æ¸©å¯åŠ¨ï¼š çŸ­æ—¶é—´å†…é‡å¯åº”ç”¨ï¼Œè¿›ç¨‹å¯èƒ½æœªè¢«é”€æ¯ï¼Œç›´æ¥ç»§ç»­è¿è¡Œï¼Œä½†æ˜¯éœ€è¦é‡èµ°ç”Ÿå‘½å‘¨æœŸã€‚ æˆ‘ä»¬ä¸€èˆ¬é’ˆå¯¹å†·å¯åŠ¨è¿›è¡Œä¼˜åŒ–ã€‚ ","date":"2021-08-03","objectID":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Androidå¯åŠ¨ä¼˜åŒ–","uri":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"åº”ç”¨å¯åŠ¨æ—¶é—´ æ˜¯æŒ‡ä»ç‚¹å‡»åˆ°launcherï¼Œç»è¿‡Applicationåˆ°ç¬¬ä¸€ä¸ªActivityåŠ è½½æ¸²æŸ“å®Œæ¯•çš„æ€»æ—¶é—´ã€‚ æ‰€ä»¥ä¼˜åŒ–çš„ç‚¹æœ‰ä¸¤ä¸ªï¼š Applicationçš„å¤„ç†é€Ÿåº¦ MainActivityçš„åŠ è½½é€Ÿåº¦ ","date":"2021-08-03","objectID":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/:0:3","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Androidå¯åŠ¨ä¼˜åŒ–","uri":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ç»Ÿè®¡å¯åŠ¨æ—¶é—´ é€šè¿‡logcatä¸­å¯¹displayå…³é”®å­—æ£€ç´¢ï¼Œåœ¨å¯åŠ¨åæœ‰ä¸ªDisplayed+åŒ…å+æ—¶é—´æ®µï¼› ActivityManager: Displayed com.android.myexample/.StartupTiming: +3s534ms é€šè¿‡adbå‘½ä»¤ï¼š adb shell am start -S -W [packageName]/{activityName} è¾“å‡ºï¼š ThisTime: 415 # å¯åŠ¨æ‰€æœ‰Activityçš„è€—æ—¶ TotalTime: 415 # è¡¨ç¤ºå†·å¯åŠ¨çš„è€—æ—¶ï¼Œä¸åŒ…æ‹¬å‰ä¸€ä¸ªActivityçš„pauseè€—æ—¶ WaitTime: 437 #æ€»çš„è€—æ—¶ï¼ŒåŒ…æ‹¬å‰ä¸€ä¸ªActivityçš„pauseè€—æ—¶å’Œæ–°Activityçš„å¯åŠ¨è€—æ—¶ é€šè¿‡Profileå·¥å…·ä¸­çš„CPUæ€§èƒ½å‰–æå™¨ã€‚ Call Chart å€’ç«ç„°å›¾ï¼› flame Chart ç«ç„°å›¾ï¼› TopDown è¯¦æƒ…è¯•å›¾ã€‚ Debug-APIï¼š Debug.startMethodTracing() Debug.stopMethodTracing() é€šè¿‡é…ç½®ä¸¥è‹›æ¨¡å¼ ","date":"2021-08-03","objectID":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/:0:4","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Androidå¯åŠ¨ä¼˜åŒ–","uri":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"é»‘ç™½å±å¤„ç† ä¸ºMainActivityè‡ªå®šä¹‰ä¸€ä¸ªstyleï¼Œè®¾ç½®èƒŒæ™¯å›¾ï¼Œå¦‚ä¸‹ï¼š \u003cstyle name=\"Theme.App.NoActionBar.Launcher\"\u003e \u003citem name=\"android:windowBackground\"\u003e@drawable/header\u003c/item\u003e \u003c/style\u003e ç„¶ååœ¨MainActivityçš„onCreateæ–¹æ³•ä¸­æŠŠä¸»é¢˜å†è®¾ç½®å›å»ï¼š class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { setTheme(R.style.Theme_App_NoActionBar) super.onCreate(savedInstanceState) setContent { NewsStory() } } } AsyncLayoutInflaterå¼‚æ­¥åŠ è½½ ","date":"2021-08-03","objectID":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/:0:5","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"Androidå¯åŠ¨ä¼˜åŒ–","uri":"/android%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ åˆ›å»º ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´ï¼Œä»çˆ¶åˆ°å­ä¾æ¬¡è°ƒç”¨æ„é€ å‡½æ•°ï¼Œæ„é€ å¯¹è±¡ã€‚ åº”ç”¨ å¯¹è±¡è‡³å°‘è¢«ä¸€ä¸ªå¼ºå¼•ç”¨æŒæœ‰ã€‚ ä¸å¯è§ å½“æ²¡æœ‰å¼ºå¼•ç”¨æ—¶ï¼Œå¯¹è±¡ä¸å¯è§ã€‚ ä¸å¯è¾¾ GCå¼€å§‹åšå¯è¾¾æ€§åˆ†æã€‚ æ”¶é›† å¯¹è±¡è¢«æ ‡è®°ä¸å¯è¾¾å¯¹è±¡ï¼Œç­‰å¾…GCå›æ”¶ã€‚ ç»ˆç»“ å›æ”¶å¯¹è±¡ï¼Œé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚ ","date":"2021-08-03","objectID":"/oom%E4%B8%8E%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"OOMä¸å†…å­˜ä¼˜åŒ–","uri":"/oom%E4%B8%8E%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"Javaå¯¹è±¡çš„å†…å­˜å¸ƒå±€ å¯¹è±¡å¤´ å®ä¾‹æ•°æ® å¯¹é½å¡«å……ï¼ˆéå¿…é¡»ï¼‰ ","date":"2021-08-03","objectID":"/oom%E4%B8%8E%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"OOMä¸å†…å­˜ä¼˜åŒ–","uri":"/oom%E4%B8%8E%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"ArrayListæ€§èƒ½ä¼˜åŒ– ArrayListç”±æ•°ç»„æ„æˆï¼Œåœ¨æ•°æ®ç»“æ„ä¸­å«åšâ€œé¡ºåºè¡¨â€æˆ–è€…â€œçº¿æ€§è¡¨â€ã€‚ArrayListçš„æ€§èƒ½æ¶ˆè€—ä¸»è¦åœ¨æ‰©å®¹å’Œå…ƒç´ ä½ç§»ä¸Šã€‚ å¢åˆ æ“ä½œå¸¦æ¥çš„æ€§èƒ½æŸè€— æ€§èƒ½ä¼˜åŒ–çš„ç‚¹ï¼Œå°±åœ¨add(T t)æ–¹æ³•ã€‚ addæ–¹æ³•åœ¨è°ƒç”¨æ—¶ï¼Œä½¿ç”¨System.arrayCopy()æ–¹æ³•ï¼Œå…¶å†…éƒ¨æ˜¯éå†æ•°ç»„ï¼Œæ›´æ”¹ä¸‹æ ‡ï¼Œè¾¾åˆ°åç§»çš„æ•ˆæœï¼Œè¿™ç§ä½ç§»ååˆ†æ¶ˆè€—æ€§èƒ½ã€‚ æ‰€ä»¥ArrayListçš„addå’Œremoveæ–¹æ³•éå¸¸æ¶ˆè€—æ€§èƒ½ã€‚ è§£å†³åŠæ³•ä¸€ï¼š å°½é‡ä¸è¦è°ƒç”¨add(int index,T t)ä»ä¸­é—´æ’å…¥ï¼Œè€Œæ˜¯ä»æœ€åaddï¼Œé‚£ä¹ˆå°±åªæœ‰æ•°ç»„æ‰©å®¹ï¼Œä¸éœ€è¦ä½ç§»ã€‚ è§£å†³æ–¹æ¡ˆäºŒï¼š ç”¨LinkedListæ›¿æ¢æé«˜å¢åˆ æ•ˆç‡ã€‚åœ¨æŸ¥è¯¢ä¹‹å‰ï¼Œè½¬æ¢ä¸ºArrayListã€‚ è§£å†³æ–¹æ¡ˆä¸‰ï¼š ç”¨Hashmapæ¥æ›¿æ¢ï¼Œhashmapçš„ç‰¹ç‚¹å°±æ˜¯å¢åˆ å¿«ï¼ŒæŸ¥è¯¢ä¹Ÿå¿«ã€‚ åˆå§‹åŒ–æ—¶æé«˜æ•ˆç‡ å› ä¸ºArrayListæ¯æ¬¡æ‰©å®¹å›ºå®š10ä¸ªï¼Œæ‰€ä»¥åœ¨åˆ›å»ºArrayListæ—¶å¯ä»¥è®¾ç½®é»˜è®¤é•¿åº¦ä¸º10ï¼Œä»¥æé«˜ç¬¬ä¸€addæ“ä½œæ—¶çš„æ€§èƒ½æ¶ˆè€—ã€‚ ","date":"2021-08-02","objectID":"/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/:0:1","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"æ•°æ®ç»“æ„ä¼˜åŒ–","uri":"/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"HashMapæ€§èƒ½ä¼˜åŒ– å®ç° JDK1.7ï¼šæ•°ç»„+é“¾è¡¨ JDK1.8ï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ æ€ä¹ˆè§£å†³å“ˆå¸Œç¢°æ’ ä½¿ç”¨é“¾è¡¨ç»“æ„æ¥è§£å†³å“ˆå¸Œç¢°æ’ã€‚å½“å‡ºç°å“ˆå¸Œç¢°æ’æ—¶ï¼Œä¸¤ä¸ªnodeé€šè¿‡Keyå–æ¨¡è¿ç®—å‡ºçš„indexæ˜¯ä¸€æ ·çš„ï¼Œå°±å‡ºç°äº†å“ˆå¸Œç¢°æ’ã€‚æ­¤æ—¶HashMapä¼šè·Ÿè¿›ä»Šåé¡ºåºï¼ŒæŠŠæ‰€æœ‰indexä¸€è‡´çš„èŠ‚ç‚¹éƒ½æ”¾åˆ°åŒä¸€ä¸ªindexçš„é“¾è¡¨ä¸Šï¼Œå½“æŸ¥è¯¢æ—¶å¦‚æœæŸ¥åˆ°å¯¹åº”çš„indexï¼Œä¼šç»§ç»­éå†é“¾è¡¨å»æŸ¥æ‰¾æŒ‡å®šçš„keyã€‚ å¤§æ•°æ®é‡æŸ¥è¯¢ä¼˜åŒ– å½“é“¾è¡¨é•¿åº¦è¿‡é•¿æ—¶ï¼Œæ€§èƒ½å°†æ˜æ˜¾ä¸‹é™ï¼Œæ‰€ä»¥JDK1.8é‡‡ç”¨çº¢é»‘æ ‘é™ä½äº†æŸ¥è¯¢æ—¶é—´ã€‚ è§£å†³æ–¹æ³•ï¼šé‡å†™keyçš„hashCodeé™ä½hashå†²çªæ¦‚ç‡ã€‚ æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€— å¦‚æœå‘ç”Ÿæ‰©å®¹ï¼Œæ•°ç»„é•¿åº¦ä¼šå˜å¤§ï¼Œç„¶åä¼šæŠŠæ‰€æœ‰èŠ‚ç‚¹é‡æ–°è®¡ç®—hashå€¼ï¼Œå†é‡æ–°åˆ†å¸ƒå‚¨å­˜ã€‚è¿™å¸¦æ¥çš„æ€§èƒ½æŸå¤±æ˜¯éå¸¸å¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…æ‰©å®¹ã€‚ è§£å†³æ–¹æ¡ˆä¸€ï¼š é¢„ä¼°æœ€å¤§å®¹é‡ï¼Œé˜ˆå€¼=é¢„ä¼°å€¼/0.75+1ï¼ŒåŠ 1æ˜¯å› ä¸ºé¢„ä¼°å€¼/0.75æœ‰å¯èƒ½å°±æ˜¯é˜ˆå€¼ï¼Œæ‰€ä»¥åŠ 1ä¸»åŠ¨è®©ä»–æ‰©å®¹ï¼Œé˜”å®Œå†ç”¨ã€‚ ä¸ºä»€ä¹ˆè¦å†Putæ—¶åˆå§‹åŒ–å“ˆå¸Œè¡¨ é¿å…åœ¨å…¨å±€ä½¿ç”¨æ—¶é€ æˆå†…å­˜æµªè´¹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†ä¸€ä¸ªæ‡’åŠ è½½ç­–ç•¥ã€‚ ä¸ºä»€ä¹ˆä¸€å®šä¿è¯æ˜¯2çš„æ¬¡å¹‚ SpaceArray\u003cint,Object\u003eåŸç† åŒæ•°ç»„æ¨¡å‹ï¼ŒäºŒåˆ†æŸ¥æ‰¾ã€‚ ","date":"2021-08-02","objectID":"/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/:0:2","series":["Androidæ€§èƒ½ä¼˜åŒ–"],"tags":["Android","æ€§èƒ½ä¼˜åŒ–"],"title":"æ•°æ®ç»“æ„ä¼˜åŒ–","uri":"/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96/"},{"categories":[],"content":"xxxxä»€ä¹ˆåƒåœ¾ç©æ„å„¿ï¼Œçœ‹çš„å¤´ç–¼","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"æ¦‚è¿° å¯åŠ¨ç”µæºæ—¶ï¼ŒèŠ¯ç‰‡å…ˆä»å›ºå®šä½ç½®åŠ è½½BootLoaderå¹¶æ‰§è¡Œï¼› BootLoaderæ‹‰èµ·linuxå†…æ ¸ï¼› linuxå†…æ ¸å¯åŠ¨ååŠ è½½init.rcå¹¶å¯åŠ¨initè¿›ç¨‹ï¼› initè¿›ç¨‹ä¸­åˆå§‹åŒ–å¹¶å¯åŠ¨å±æ€§æœåŠ¡å¹¶å¯åŠ¨Zygoteè¿›ç¨‹ï¼› Zygoteè´Ÿè´£åˆ›å»ºJVMï¼Œæ³¨å†ŒJNIï¼Œåˆ›å»ºæœåŠ¡ç«¯Socketï¼Œæœ€åå¯åŠ¨SystemServerï¼› SSä¸­åˆ›å»ºBinderçº¿ç¨‹æ± ï¼Œå¹¶å¯åŠ¨ç³»ç»ŸæœåŠ¡ï¼ŒåŒ…æ‹¬AMSå’ŒPMSï¼› PMSè´Ÿè´£å®‰è£…APKï¼ŒAMSåˆ™å¯åŠ¨Launcherã€‚ ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:1","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"å†…æ ¸ç©ºé—´æµç¨‹ æŒ‰ä¸‹å¼€æœºé”®ã€‚ åŠ è½½å¯åŠ¨å¼•å¯¼ç¨‹åºbootloaderåˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚ æ‹‰èµ·linuxå†…æ ¸ï¼Œè®¾ç½®ç¼“å­˜ï¼ŒåŠ è½½é©±åŠ¨. ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:2","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"ç”¨æˆ·ç©ºé—´æµç¨‹ å†…æ ¸å¯åŠ¨åï¼Œå¯åŠ¨initè¿›ç¨‹(pid=1)è°ƒç”¨initçš„å…¥å£mainå‡½æ•°ã€‚ åˆ›å»ºå’ŒæŒ‚è½½æ–‡ä»¶ç›®å½•ã€‚ åˆå§‹åŒ–å¹¶å¯åŠ¨ã€å±æ€§æœåŠ¡ã€‘ã€‚ æ³¨å†Œå­è¿›ç¨‹ä¿¡å·å¤„ç†å‡½æ•°ï¼Œç”¨æ¥å¤„ç†è¿›ç¨‹ç»ˆæ­¢ä¿¡å·ï¼Œé˜²æ­¢åƒµå°¸è¿›ç¨‹ã€‚ è§£æinit.rcæ–‡ä»¶ï¼Œå¹¶å¯åŠ¨Zygoteã€‚ æ ¹æ®ä¸åŒç³»ç»Ÿè¯»å–ä¸åŒçš„initã€‚zygotexx.rcå¯åŠ¨zygoteè¿›ç¨‹ï¼ˆå­µåŒ–å™¨ï¼‰ã€‚ å¯åŠ¨SystemServer åˆ›å»ºlauncher ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:3","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Zygoteå¯åŠ¨æµç¨‹ åˆ›å»ºJVM; é€šè¿‡JNIè°ƒç”¨ZygoteInitè¿™ä¸ªç±»çš„mainå‡½æ•°ï¼Œå¼€å§‹**è¿›å…¥javaæ¡†æ¶å±‚*(Â´â–½`Êƒâ™¡Æª)ï¼› åˆ›å»ºä¸€ä¸ªSocketæœåŠ¡ç«¯ï¼› forkå‡ºSystemServerè¿›ç¨‹ï¼ˆè¯¥è¿›ç¨‹ä¸­å¯åŠ¨ç³»ç»ŸæœåŠ¡ï¼‰ï¼› è°ƒç”¨zygote.runSelectLoopæ­»å¾ªç¯ï¼Œå¼€å§‹ç›‘å¬AMSçš„è¯·æ±‚ã€‚ ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:4","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"SystemServerçš„å¤„ç†è¿‡ç¨‹ SystemServer è¿›ç¨‹ç”¨æ¥åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼Œå¦‚AMSã€WMSå’ŒPMSç­‰ï¼Œä»–çš„å¤„ç†è¿‡ç¨‹ä¸ºï¼š å¯åŠ¨Binderçº¿ç¨‹æ± ï¼› åˆ›å»ºSystemServerManagerï¼Œç”¨äºå¯¹ç³»ç»ŸæœåŠ¡åˆ›å»ºã€å¯åŠ¨å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼› å¯åŠ¨ç³»ç»ŸæœåŠ¡ã€‚ è¿™é‡Œæå–ä¸€ä¸ªå…³é”®ç‚¹ï¼šSystemServerManageræ˜¯ç”¨æ¥ç®¡ç†ç³»ç»ŸæœåŠ¡çš„ã€‚ ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:5","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Launcherå¯åŠ¨è¿‡ç¨‹ SystemServerå¯åŠ¨æ—¶ä¼šåŒæ—¶å¯åŠ¨AMSå’ŒPackageManagerServiceï¼› è€ŒPMSå¯åŠ¨åä¼šå®‰è£…APKï¼› AMSä¼šè°ƒèµ·Launcherï¼› Launcheråœ¨onCreateä¸­æ¸²æŸ“åº”ç”¨å›¾æ ‡ï¼› ","date":"2021-07-28","objectID":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:0:6","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿå¯åŠ¨æµç¨‹","uri":"/android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"åœ¨Androidä¸­ï¼Œå¯åŠ¨ä¸€ä¸ªç¨‹åºï¼Œåˆ†ä¸ºã€è¿›ç¨‹å¯åŠ¨ã€‘å’Œã€Activityå¯åŠ¨ä¸¤éƒ¨åˆ†ã€‘ã€‚","date":"2021-07-27","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/","series":["AndroidFramework"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨è¿‡ç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/"},{"categories":[],"content":"æµç¨‹å›¾ ç‚¹å‡»æ¡Œé¢Appå›¾æ ‡ï¼ŒLauncheré€šè¿‡Binderå¯¹AMSå‘èµ·startActivityè¯·æ±‚ï¼› AMSæ¥æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡Socketå‘zygoteè¿›ç¨‹å‘é€åˆ›å»ºè¿›ç¨‹çš„è¯·æ±‚ï¼› Zygoteè¿›ç¨‹forkè‡ªå·±æå‡ºAppè¿›ç¨‹ï¼› Appè¿›ç¨‹ï¼Œé€šè¿‡Binderå‘AMSå‘èµ·attachApplicationè¯·æ±‚ï¼› AMSæ”¶åˆ°è¯·æ±‚åï¼Œè¿›è¡Œä¸€ç³»åˆ—å‡†å¤‡å·¥ä½œåï¼Œé€šè¿‡binderå‘Appè¿›ç¨‹å‘é€scheduleLaunchActivityè¯·æ±‚ï¼› Appè¿›ç¨‹çš„ApplicationThreadæ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡handlerå‘ActivityThreadå‘é€LAUNCH_ACTIVITYæ¶ˆæ¯ï¼› ActivityThreadæ”¶åˆ°æ¶ˆæ¯åï¼Œé€šè¿‡åå°„æœºåˆ¶åˆ›å»ºç›®æ ‡Activityï¼Œå¹¶å›è°ƒActivityçš„onCreate()ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ å½“onResumeæ‰§è¡Œå®Œæ¯•åUIå¼€å§‹æ¸²æŸ“ï¼Œæ¸²æŸ“å®Œæ¯•åï¼ŒAppæ­£å¼å¯åŠ¨å®Œæ¯•ã€‚ ","date":"2021-07-27","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/:0:1","series":["AndroidFramework"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨è¿‡ç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/"},{"categories":[],"content":" æˆ‘ä»¬ä¸»è¦å¼€å‘çš„æ˜¯Appå±‚ï¼Œä½†æ˜¯éœ€è¦é‡ç‚¹äº†è§£çš„æ˜¯Frameworkå±‚ï¼š ","date":"2021-07-27","objectID":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/:0:0","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿæ¶æ„","uri":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"categories":[],"content":"Java API Framework åç§° åŠŸèƒ½ ActivityManager ç®¡ç†å„ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ PackageManager ç®¡ç†æ‰€æœ‰å®‰è£…åœ¨Androidç³»ç»Ÿä¸­çš„åº”ç”¨ç¨‹åº ResourceManager æä¾›Appéœ€è¦çš„å„ç§éä»£ç èµ„æº WindowManager ç®¡ç†æ‰€æœ‰å¼€å¯çš„çª—å£ç¨‹åº ViewSystem æ„å»ºAppçš„åŸºæœ¬ç»„ä»¶ ContentProvider å†ä¸åŒAppä¹‹é—´å…±äº«æ•°æ® LocationManager æä¾›å®šä½åŠŸèƒ½ NotificationManager é€šçŸ¥ç®¡ç† TelephoneManager ç”µè¯ç®¡ç†å™¨ï¼Œç®¡ç†æ‰€æœ‰çš„ç§»åŠ¨è®¾å¤‡åŠŸèƒ½ ","date":"2021-07-27","objectID":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/:0:1","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿæ¶æ„","uri":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"categories":[],"content":"ç³»ç»Ÿè¿è¡Œåº“ Native C/C++Libraries åŒ…å«Webkitã€openGLä»€ä¹ˆçš„ã€‚ Android Runtime å®‰å“è¿è¡Œæ—¶åº“ Core Libraries æ ¸å¿ƒåº“ï¼Œæä¾›äº†javaè¯­è¨€æ ¸å¿ƒåº“çš„åŠŸèƒ½ï¼Œå’ŒAndroidè‡ªå¸¦çš„ä¸€äº›è¯­æ³•ç³–ã€å·¥å…·ç±»ï¼› AndroidRuntime å®‰å“è¿è¡Œæ—¶ï¼Œä»5.0å¼€å§‹ä» Dalvikå˜æ›´ä¸ºARTã€‚ ä¸¤ä¸ªå®‰å“è¿è¡Œæ—¶çš„åŒºåˆ« Dalvik å…è®¸åœ¨æœ‰é™çš„å†…å­˜ä¸­åŒæ—¶è¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºå®ä¾‹ï¼Œå¹¶ä¸”ç›¸äº’éš”ç¦»ï¼Œå³æ—¶ä¸€ä¸ªå´©äº†ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–å®ä¾‹ï¼Œæ¯ä¸€ä¸ªå®ä¾‹éƒ½ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„Linuxè¿›ç¨‹è¿è¡Œã€‚è¾¹è§£é‡Šè¾¹æ‰§è¡Œï¼Œéœ€è¦ä¾é JIT(å³æ—¶ç¼–è¯‘å™¨)æŠŠå­—èŠ‚ç è½¬æ¢æˆæœºå™¨ç ï¼Œè¿è¡Œæ•ˆç‡ä½ï¼› ART åœ¨å®‰è£…è¿‡ç¨‹ä¸­æŠŠå­—èŠ‚ç é¢„ç¼–è¯‘æˆæœºå™¨ç ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ã€‚ ","date":"2021-07-27","objectID":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/:0:2","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿæ¶æ„","uri":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"categories":[],"content":"ç¡¬ä»¶æŠ½è±¡å±‚ å…¶å®å°±ç±»ä¼¼æ¥å£éš”ç¦»ï¼Œç»Ÿä¸€äº†ä¸åŒå‚å•†ç¡¬ä»¶è°ƒç”¨çš„å¤–è§‚ã€‚ ","date":"2021-07-27","objectID":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/:0:3","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿæ¶æ„","uri":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"categories":[],"content":"Linuxå†…æ ¸å±‚ ä¸€ä¸ªlinuxç³»ç»Ÿï¼Œå¹¶ä¸”åµŒå…¥äº†Androidä¸“ç”¨çš„å„ç§é©±åŠ¨ã€‚ ","date":"2021-07-27","objectID":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/:0:4","series":["AndroidFramework"],"tags":["Android"],"title":"Androidç³»ç»Ÿæ¶æ„","uri":"/android%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"categories":[],"content":"åˆšåˆšç»™æ¥è§¦Androidçš„æ—¶å€™ï¼Œæ„Ÿè§‰Activityå°±ç±»ä¼¼iOSä¸­çš„Controllerï¼Œå°±æ˜¯ä¸€ä¸ªä¸ªçš„é¡µé¢ã€‚ä½†æ˜¯å…¶å®å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºAndroidåŒä¸€æ—¶é—´å¹¶ä¸æ˜¯åªç»˜åˆ¶ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚çŠ¶æ€æ ï¼Œå…¶ä»–åº”ç”¨çš„toastï¼Œæ‚¬æµ®çƒç­‰ç­‰ã€‚æ‰€ä»¥Androidä¸­å¿…ç„¶å­˜åœ¨ä¸€ç§\"ç®¡å®¶\"æœºåˆ¶ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰è¿›ç¨‹çš„ç»˜åˆ¶è¡Œä¸ºï¼Œä»–å°±æ˜¯WindowManagerServiceæœåŠ¡ã€‚","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Window Activityã€Windowã€DecorViewä¸‰è€…ä¸€ä¸€å¯¹åº”ã€‚ ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:1:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Windowçš„åˆ†ç±» æ™®é€šwindowï¼Œzè½´èŒƒå›´1~99ï¼› å­windowï¼Œzè½´èŒƒå›´1000~1999ï¼Œéœ€è¦ä¾é™„åœ¨çˆ¶windowä¸­ï¼Œæ¯”å¦‚dialogï¼› ç³»ç»Ÿwindowï¼Œzè½´èŒƒå›´2000~29999ï¼Œæ¯”å¦‚çŠ¶æ€æ ã€toastã€é”®ç›˜ç­‰ã€‚ ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:1:1","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"setContentViewæ–¹æ³• è¿™é‡Œç›´æ¥çœ‹Android30ç‰ˆæœ¬ï¼ŒAndroidXåŒ…ä¸‹çš„activity: public class AppCompatActivity extends FragmentActivity implements AppCompatCallback, TaskStackBuilder.SupportParentable, ActionBarDrawerToggle.DelegateProvider { @Override public void setContentView(@LayoutRes int layoutResID) { getDelegate().setContentView(layoutResID); } æˆ‘ä»¬çš„Activityé‡å†™äº†AppCompatActivityçš„onCreateæ–¹æ³•ï¼Œå¹¶ä¸”ç›´æ¥è°ƒç”¨äº†çˆ¶çº§çš„setContentViewæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸‰ä¸ªé‡è½½ï¼š @Override public void setContentView(View view) { getDelegate().setContentView(view); } é‡ç‚¹è¦çœ‹ä¸€ä¸‹è¿™ä¸ªgetDelegate()æ–¹æ³•ï¼š //å•ä¾‹åˆ›å»º @NonNull public AppCompatDelegate getDelegate() { if (mDelegate == null) { mDelegate = AppCompatDelegate.create(this, this); } return mDelegate; } @NonNull public static AppCompatDelegate create(@NonNull Activity activity, @Nullable AppCompatCallback callback) { return new AppCompatDelegateImpl(activity, callback); } æ¯ä¸€ä¸ªActivityå¯¹è±¡éƒ½æŒæœ‰ä¸€ä¸ªå•ä¾‹çš„ä»£ç†å¯¹è±¡ï¼ŒsetContentå…¶å®æ˜¯ç”±å®ƒæ¥å®Œæˆçš„ã€‚ä¸ºä»€ä¹ˆè¦æä¸ªä»£ç†å‘¢ï¼Ÿå› ä¸ºä¸åŒç‰ˆæœ¬çš„ç³»ç»Ÿï¼Œä½¿ç”¨äº†ä¸åŒåŒ…åä¸‹çš„Activityã€‚ æ¥ä¸‹æ¥çœ‹AppCompatDelegateImplï¼š @Override public void setContentView(View v) { //ç¡®ä¿å­˜åœ¨decor ensureSubDecor(); //æ‰¾åˆ°decorViewä¸­idä¸ºcontainerå®¹å™¨ ViewGroup contentParent = mSubDecor.findViewById(android.R.id.content); //æ¸…ç©ºæ‰€æœ‰view contentParent.removeAllViews(); //æŠŠæˆ‘ä»¬ä¼ é€’çš„viewé™„åŠ ä¸Šå» contentParent.addView(v); //å›è°ƒ mAppCompatWindowCallback.getWrapped().onContentChanged(); } ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:2:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"åˆ›å»ºSubDecorView åœ¨è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œæ¯ä¸ªActivityä¸­éƒ½å­˜åœ¨ä¸€ä¸ªSubDecorViewï¼Œå¹¶ä¸”SubDecorViewä¸­å­˜åœ¨ä¸€ä¸ªidä¸ºâ€™android.R.id.contentâ€™çš„ViewGroupã€‚ ç»§ç»­çœ‹å®ƒæ˜¯æ€ä¹ˆç¡®ä¿SubDecorçš„ï¼š private void ensureSubDecor() { if (!mSubDecorInstalled) { //æ ¹æ®æ ‡å¿—ä½åˆ¤æ–­ï¼ŒæŒ‰éœ€åˆ›å»ºDecor mSubDecor = createSubDecor(); ... } } private ViewGroup createSubDecor() { ... // é‡ç‚¹æ˜¯è¿™é‡Œï¼Œç¡®ä¿windowçš„å­˜åœ¨ ensureWindow(); mWindow.getDecorView(); //æ ¹æ®é£æ ¼ä¸»é¢˜ä»å¯¹åº”çš„æ¨¡æ¿å¡«å……SubDecorView if (!mWindowNoTitle) { if (mIsFloating) { subDecor = (ViewGroup) inflater.inflate( R.layout.abc_dialog_title_material, null); ... } else if (mHasActionBar) { ... subDecor = (ViewGroup) LayoutInflater.from(themedContext) .inflate(R.layout.abc_screen_toolbar, null); ... } } else { if (mOverlayActionMode) { subDecor = (ViewGroup) inflater.inflate( R.layout.abc_screen_simple_overlay_action_mode, null); } else { subDecor = (ViewGroup) inflater.inflate(R.layout.abc_screen_simple, null); } } mWindow.setContentView(subDecor); ... } ensureWindowç¡®ä¿Windowé™„åŠ  åœ¨AppCompatDelegateImplä¸­ï¼Œåœ¨setContentViewçš„æ—¶å€™ï¼Œä¼šå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨DecorViewï¼Œç„¶åæŒ‰éœ€åˆ›å»ºDecorï¼Œåœ¨åˆ›å»ºDecorçš„æ—¶å€™åˆå»æ£€æŸ¥æ˜¯å¦æŒæœ‰windowï¼Œç„¶åæŒ‰éœ€é™„åŠ Windowã€‚ private void ensureWindow() { if (mWindow == null \u0026\u0026 mHost instanceof Activity) { attachToWindow(((Activity) mHost).getWindow()); } } private void attachToWindow(@NonNull Window window) { ... mWindow = window; } æˆ‘è¿½è¸ª(Activity) mHost).getWindow()ï¼Œå‘ç°åœ¨setContentViewæ—¶ï¼Œwindowå¯¹è±¡å·²ç»è¢«åˆ›å»ºå¥½äº†ï¼Œé‚£ä¹ˆWindowæ˜¯ä½•æ—¶åˆ›å»ºçš„å‘¢ï¼Ÿ public Window getWindow() { return mWindow; } @UnsupportedAppUsage final void attach(Context context, ActivityThread aThread, Instrumentation instr, IBinder token, int ident, Application application, Intent intent, ActivityInfo info, CharSequence title, Activity parent, String id, NonConfigurationInstances lastNonConfigurationInstances, Configuration config, String referrer, IVoiceInteractor voiceInteractor, Window window, ActivityConfigCallback activityConfigCallback, IBinder assistToken) { ... mWindow = new PhoneWindow(this, window, activityConfigCallback); ... } windowæ˜¯Activityåœ¨attachçš„æ—¶å€™åˆ›å»ºçš„ï¼Œwindowæœ¬èº«æ˜¯ä¸ªæ¥å£ï¼Œå®ƒçš„å®ç°ç±»æ˜¯PhoneWindowã€‚ mWindow.getDecorView() ç»§ç»­å‰é¢çš„ä»£ç å¾€ä¸‹èµ°ï¼Œå°±é‡åˆ°äº†è¿™ä¸€å¥ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œè¿™é‡Œçš„windowå…¶å®å°±æ˜¯phoneWindowï¼Œç„¶åè¿›å…¥PhoneWindow.javaæ–‡ä»¶ä¸­æœç´¢getDecorView()æ–¹æ³•ï¼š @Override public final @NonNull View getDecorView() { if (mDecor == null || mForceDecorInstall) { installDecor(); } return mDecor; } //åˆ›å»ºå’Œé…ç½®DecorView private void installDecor() { mForceDecorInstall = false; if (mDecor == null) { //åˆ›å»ºDecorView mDecor = generateDecor(-1); ... } else { mDecor.setWindow(this); } ... } protected DecorView generateDecor(int featureId) { ... return new DecorView(context, featureId, this, getAttributes()); } ç„¶åçœ‹è¿™ä¸ªæ‰€è°“DecorViewåˆ°åº•æ˜¯ä¸ªå•¥ï¼š public class DecorView extends FrameLayout implements RootViewSurfaceTaker, WindowCallbacks { private static final String TAG = \"DecorView\"; private static final boolean DEBUG_MEASURE = false; å™”å™”å™”å™”ï¼Œæœç„¶å°±æ˜¯ä¸ªFrameLayoutï¼ ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:2:1","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"phoneWiodow.setContentView(resId) ç„¶åå°±æ˜¯è°ƒç”¨äº†phoneWindowçš„setContentView(subDecor)æ–¹æ³•ï¼Œè¿™ä¸ªè®¾è®¡æ¨¡å¼å¾ˆæ˜æ˜¾æ˜¯ä¸ªè£…é¥°è€…æ¨¡å¼ï¼š @Override public void setContentView(int layoutResID) { if (mContentParent == null) { //æ£€æŸ¥æœºåˆ¶ï¼Œç¡®ä¿DeecorViewä¸€å®šå­˜åœ¨ installDecor(); } else if (!hasFeature(FEATURE_CONTENT_TRANSITIONS)) { mContentParent.removeAllViews(); } if (hasFeature(FEATURE_CONTENT_TRANSITIONS)) { //æ’­æ”¾è·³è½¬åŠ¨ç”» final Scene newScene = Scene.getSceneForLayout(mContentParent, layoutResID, getContext()); transitionTo(newScene); } else { mLayoutInflater.inflate(layoutResID, mContentParent); } ... } ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:2:2","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"å½“å‰çš„Viewå±‚çº§ ","date":"2021-07-26","objectID":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/:2:3","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidé¡µé¢ç»˜åˆ¶æµç¨‹","uri":"/android%E9%A1%B5%E9%9D%A2%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"ä¸‰è€…ä¹‹é—´çš„åŒºåˆ« Flutter Moduleï¼šç”¨æ¥æŠŠflutteråŠŸèƒ½ä½œä¸ºç»„ä»¶é›†æˆåˆ°Androidæˆ–è€…iOSä¸»é¡¹ç›®ä¸­ï¼› Dart packageï¼šçº¯Dartå·¥ç¨‹ï¼Œä¸åŒ…å«Platformsï¼Œå°±æ˜¯ä¸€ä¸ªå¯ä»¥å¤–ç½®çš„åŒ…ï¼Œé‡Œé¢å­˜æ”¾å„ç§ç±»æ–‡ä»¶; Plugin packagesï¼šç±»ä¼¼äºä¸»å·¥ç¨‹çš„æ’ä»¶ï¼Œå¯ä»¥åŒ…å«å„ç§Platformså’Œæœ¬åœŸä»£ç ã€‚ è¿™ä¸ªæ˜¯å®˜æ–¹æ–‡æ¡£ä¸Šé¢ç†æ‰€å½“ç„¶çš„è§£é‡Šï¼Œä½†æ˜¯äº‹å®ä¸Šï¼Œpackageå’Œpluginå°±æ˜¯åŒä¸€ä¸ªç©æ„ï¼šåŒ…é‡Œé…ç½®ä¸Šplatformså·¥ç¨‹ï¼Œå°±æˆäº†pluginï¼›è€Œç›¸å¯¹çš„pluginå»é™¤æ‰flatformsä¹‹åï¼Œé‚£å°±æˆäº†åŒ…ã€‚ä½†æ˜¯ä¸ºå•¥è¦åŒºåˆ†å¼€å‘¢ï¼Œå› ä¸ºå®˜æ–¹é’ˆå¯¹åŒä¸€ä¸ªä¸œè¥¿ç»™å‡ºäº†ä¸¤ç§æ¨¡æ¿è€Œå·²ã€‚ ","date":"2021-07-23","objectID":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/:1:0","series":[],"tags":["Flutter"],"title":"Flutter æ¨¡å—ã€åŒ…å’Œæ’ä»¶(å¾…ç»­...)","uri":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"},{"categories":[],"content":"åˆ›å»ºå·¥ç¨‹ # åˆ›å»ºåŒ… flutter create -t plugin --platforms android --org com.vee plugin_test é‡‡ç”¨è„šæœ¬åˆ›å»ºçš„è¯ï¼Œå¿…é¡»è¦è‡ªå·±æŒ‡æ˜åŒ…å«çš„å¹³å°ï¼Œå¦åˆ™ä¸ä¼šåˆ›å»ºAndroidæˆ–è€…iOSçš„æœ¬åœŸä»£ç ã€‚æ¯”å¦‚ä»¥ä¸Šä»£ç ï¼Œæˆ‘é€šè¿‡platformsé€‰é¡¹ï¼Œåªé€‰æ‹©äº†Androidå¹³å°ï¼Œæ‰€ä»¥flutterç”Ÿæˆçš„é¡¹ç›®ä¸­ä¹Ÿåªå«æœ‰å®‰å“çš„åŒ…ï¼Œè€Œæ²¡æœ‰iOSçš„åŒ…ã€‚ ","date":"2021-07-23","objectID":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/:2:0","series":[],"tags":["Flutter"],"title":"Flutter æ¨¡å—ã€åŒ…å’Œæ’ä»¶(å¾…ç»­...)","uri":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"},{"categories":[],"content":"é€šä¿¡ ä¸‰ç§é€šé“ï¼š BasicMessageChannelï¼šç”¨äºä¼ é€’å­—ç¬¦ä¸²å’ŒåŠç»“æ„åŒ–çš„ä¿¡æ¯ï¼› MethodChannelï¼šç”¨äºä¼ é€’æ–¹æ³•è°ƒç”¨ï¼ˆmethod invocationï¼‰ï¼› EventChannel: ç”¨äºæ•°æ®æµï¼ˆevent streamsï¼‰çš„é€šä¿¡ã€‚ PSï¼šæ¶ˆæ¯ç¼–è§£ç å™¨ï¼Œæ˜¯JSONæ ¼å¼çš„äºŒè¿›åˆ¶åºåˆ—åŒ–ï¼Œæ‰€ä»¥è°ƒç”¨æ–¹æ³•çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯å¯JSONåºåˆ—åŒ–çš„ã€‚ PSï¼šæ–¹æ³•è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åå‘å‘é€è°ƒç”¨æ¶ˆæ¯ã€‚ ","date":"2021-07-23","objectID":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/:3:0","series":[],"tags":["Flutter"],"title":"Flutter æ¨¡å—ã€åŒ…å’Œæ’ä»¶(å¾…ç»­...)","uri":"/flutter-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"},{"categories":[],"content":" æ„é€ å‡½æ•° initState åˆå§‹åŒ–çŠ¶æ€ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼› didChangeDependenciesåœ¨initStateæ‰§è¡Œå®Œç«‹åˆ»è°ƒç”¨ï¼Œå½“ä¾èµ–çš„InheritedWidgetå‘ç”Ÿbuildæ—¶ä¹Ÿä¼šè°ƒç”¨ï¼› buildç”»ç”»ç”¨çš„ï¼› didUpdateWidgetçŠ¶æ€æ”¹å˜æ—¶è°ƒç”¨ï¼Œå¦‚è°ƒç”¨äº†setStateå‡½æ•°ï¼› deactivateç›¸å½“äºAndroidçš„onStopæ–¹æ³•ï¼› disposeé”€æ¯æ—¶è°ƒç”¨ã€‚ ","date":"2021-07-23","objectID":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/:0:0","series":[],"tags":["Flutter"],"title":"Flutterçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°","uri":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/"},{"categories":[],"content":"æµ‹è¯• ","date":"2021-07-23","objectID":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/:1:0","series":[],"tags":["Flutter"],"title":"Flutterçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°","uri":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/"},{"categories":[],"content":"é¡µé¢æ‰“å¼€ I/flutter (30299): è°ƒç”¨äº†initState I/flutter (30299): è°ƒç”¨äº†didChangeDependencies I/flutter (30299): è°ƒç”¨äº†build ","date":"2021-07-23","objectID":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/:1:1","series":[],"tags":["Flutter"],"title":"Flutterçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°","uri":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/"},{"categories":[],"content":"é¡µé¢åˆ·æ–° çŠ¶æ€æ²¡å˜ æµ‹è¯•ä»£ç ï¼š @override Widget build(BuildContext context) { print('è°ƒç”¨äº†build'); return Scaffold( appBar: AppBar(), body: Container( child: MaterialButton( child: Text('ä¸»åŠ¨åˆ·æ–°é¡µé¢'), onPressed: () { print('æˆ‘ä¸»åŠ¨è°ƒç”¨äº†setState'); setState(() {}); }), ), ); } è¾“å‡ºï¼š I/flutter (30299): æˆ‘ä¸»åŠ¨è°ƒç”¨äº†setState I/flutter (30299): è°ƒç”¨äº†build å¯ä»¥çœ‹åˆ°çŠ¶æ€æ²¡æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šè°ƒç”¨didUpdateWidgetå‡½æ•°çš„ã€‚ çŠ¶æ€æ”¹å˜æµ‹è¯•1 æµ‹è¯•ä»£ç ï¼š ///åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œé€šè¿‡æ”¹å˜è¿™ä¸ªå˜é‡æ¥æ”¹å˜çŠ¶æ€ int i = 0; @override Widget build(BuildContext context) { print('è°ƒç”¨äº†build'); return Scaffold( appBar: AppBar(), body: Container( child: MaterialButton( child: Text('ä¸»åŠ¨åˆ·æ–°é¡µé¢'), onPressed: () { print('æˆ‘ä¸»åŠ¨è°ƒç”¨äº†setState'); setState(() { i = 1; }); }), ), ); } è¾“å‡ºï¼š I/flutter (30299): è°ƒç”¨äº†initState I/flutter (30299): è°ƒç”¨äº†didChangeDependencies I/flutter (30299): è°ƒç”¨äº†build è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æŠŠèµ‹å€¼æ“ä½œå†™åœ¨setStateçš„å›è°ƒé‡Œé¢ï¼Œå¯ä»¥è§¦å‘è°ƒç”¨äº†didChangeDependenciesã€‚ çŠ¶æ€æ”¹å˜æµ‹è¯•2 æµ‹è¯•ä»£ç ï¼š ///åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œé€šè¿‡æ”¹å˜è¿™ä¸ªå˜é‡æ¥æ”¹å˜çŠ¶æ€ int i = 0; @override Widget build(BuildContext context) { print('è°ƒç”¨äº†build'); return Scaffold( appBar: AppBar(), body: Container( child: MaterialButton( child: Text('ä¸»åŠ¨åˆ·æ–°é¡µé¢'), onPressed: () { print('æˆ‘ä¸»åŠ¨è°ƒç”¨äº†setState'); i = 2; setState(() { }); }), ), ); } è¾“å‡ºï¼š I/flutter (30299): æˆ‘ä¸»åŠ¨è°ƒç”¨äº†setState I/flutter (30299): è°ƒç”¨äº†build è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æŠŠèµ‹å€¼æ“ä½œ**å†™åœ¨setStateçš„å›è°ƒå¤–é¢ï¼ŒdidChangeDependencieså‡½æ•°å°±ä¸ä¼šè§¦å‘äº†ã€‚ æ€»ç»“ å½“ä½¿ç”¨setStateæ–¹æ³•æ—¶ï¼š èµ‹å€¼å†™åœ¨æ‹¬å·é‡Œé¢ï¼Œå¯ä»¥è§¦å‘didChangeDependencieså‡½æ•°ï¼› èµ‹å€¼å†™åœ¨æ‹¬å·å¤–é¢ï¼Œä¸èƒ½è§¦å‘didChangeDependenciesã€‚ ","date":"2021-07-23","objectID":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/:1:2","series":[],"tags":["Flutter"],"title":"Flutterçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°","uri":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/"},{"categories":[],"content":"é¡µé¢é€€å‡º I/flutter (30299): è°ƒç”¨äº†deactivate I/flutter (30299): è°ƒç”¨äº†dispose ","date":"2021-07-23","objectID":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/:1:3","series":[],"tags":["Flutter"],"title":"Flutterçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°","uri":"/flutter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0/"},{"categories":[],"content":"ä»¥å‰ä½¿ç”¨Hexoçš„æ—¶å€™äº†è§£åˆ°äº†Travisè¿™ä¸ªå¥½ä¸œä¸œï¼Œåº”è¯¥æ˜¯æˆ‘è‡ªjenkinsä¹‹åæ¥è§¦è¿‡çš„ç¬¬äºŒä¸ªCIäº†ï¼ŒæŒºæœ‰æ„æ€ã€‚ ä¹‹å‰çš„åšæ³•ï¼Œæˆ–è€…è¯´ä¸€èˆ¬ç½‘ä¸Šçš„åšæ³•ï¼Œéƒ½æ˜¯åªå¼„ä¸€ä¸ªä»“åº“ï¼Œç„¶åæºç å’Œç”Ÿæˆç‰©åœ¨ä¸åŒçš„åˆ†æ”¯ï¼ŒåŒ…æ‹¬Traviså®˜æ–‡ä¸Šä¹Ÿæ˜¯è¿™æ ·å†™çš„ã€‚è¿™å°±å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š Travisåªæœ‰å‘å¸ƒåˆ°å¼€æºä»“åº“æ‰å…è´¹ï¼Œè€Œå‘å¸ƒåˆ°ç§æœ‰ä»“åº“æ¯æœˆå¥½åƒè¦100å¤šç¾å…ƒï¼› å¦‚æœå‘å¸ƒåˆ°å¼€æºä»“åº“çš„ä¸åŒåˆ†æ”¯ï¼Œé‚£æˆ‘ç§å¯†æ€§çš„åšå®¢ä¸å°±æºç å¯è§äº†å˜›ã€‚ æ‰€ä»¥æˆ‘è¿™é‡Œé‡‡ç”¨äº†ä¸¤ä¸ªä»“åº“ï¼š æºç ä»“åº“ï¼Œç§æœ‰ï¼Œåªç”¨æ¥å­˜æ”¾æºç ï¼› é™æ€æ–‡ä»¶ä»“åº“ï¼Œå¼€æºï¼Œåªç”¨æ¥å­˜æ”¾Hugoçš„ç”Ÿæˆç‰©ã€‚ .travis.yml language: go go: # æŒ‡å®šGolang 1.8 - \"1.8\" env: global: # å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ - GH_REF: github.com/vee-zhang/vee-zhang.github.io # åˆ†æ”¯ç™½åå•é™åˆ¶: åªæœ‰masteråˆ†æ”¯çš„æäº¤æ‰ä¼šè§¦å‘æ„å»º branches: only: # æŒ‡å®šmasteråˆ†æ”¯å‚ä¸æ„å»º - master install: # å®‰è£…hugo - wget -q -O hugo.deb https://github.com/gohugoio/hugo/releases/download/v0.86.0/hugo_extended_0.86.0_Linux-64bit.deb - sudo dpkg -i hugo.deb script: # è¿è¡Œhugoå‘½ä»¤ - hugo # gitç›´æ¥æ¨public - cd public - git init - git config user.name \"vee-zhang\" - git config user.password \"$githubtoken\" - git add -A - git commit -m \"Update Blog By TravisCI With Build $TRAVIS_BUILD_NUMBER\" - git push --force --quiet \"https://$githubtoken@${GH_REF}\" master:master æˆ‘é€šè¿‡å„ç§æ–¹æ³•æ¥å®‰è£…Hugoï¼ŒåŒ…æ‹¬go getç›´æ¥å®‰è£…ï¼Œcloneæºç ç„¶ågo installç¼–è¯‘å®‰è£…ï¼Œéƒ½æŠ¥é”™å¤±è´¥äº†ã€‚æœ€åä»ç½‘ä¸ŠæŸ¥åˆ°ç«Ÿç„¶å¯ä»¥ä½¿ç”¨wgetä¸‹è½½æˆå“ï¼ï¼ï¼ ä½†æ˜¯è¿™æ ·ä»¥æ¥ç¡®å®šä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯Hugoä¸èƒ½è‡ªåŠ¨æ›´æ–°äº†ã€‚ç•™å¾…ä»¥åè§£å†³å§ã€‚ ","date":"2021-07-22","objectID":"/travis%E6%8C%81%E7%BB%AD%E5%8F%91%E5%B8%83hugo%E5%8D%9A%E5%AE%A2/:0:0","series":[],"tags":["Travis","Hugo"],"title":"TravisæŒç»­å‘å¸ƒHugoåšå®¢","uri":"/travis%E6%8C%81%E7%BB%AD%E5%8F%91%E5%B8%83hugo%E5%8D%9A%E5%AE%A2/"},{"categories":[],"content":"æ·»åŠ Travisæ„å»ºç»“æœå›¾æ ‡ \u003cimg src=\"https://www.travis-ci.com/vee-zhang/VeeBlogSourceCode.svg?token=zr2k46J9vsyyAMcKzMGx\u0026amp;branch=master\u0026amp;status=passed\" alt=\"build:passed\"\u003e é¸£è°¢ï¼š qq_43103581 ","date":"2021-07-22","objectID":"/travis%E6%8C%81%E7%BB%AD%E5%8F%91%E5%B8%83hugo%E5%8D%9A%E5%AE%A2/:1:0","series":[],"tags":["Travis","Hugo"],"title":"TravisæŒç»­å‘å¸ƒHugoåšå®¢","uri":"/travis%E6%8C%81%E7%BB%AD%E5%8F%91%E5%B8%83hugo%E5%8D%9A%E5%AE%A2/"},{"categories":[],"content":"Future æœªæ¥çš„ä¸€æ¬¡å›è°ƒ Futureä½äºevent queueäº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚ Futureè¡¨ç¤ºæœªæ¥çš„ä¸€æ¬¡æ€§çš„ä»»åŠ¡å›è°ƒã€‚ ","date":"2021-07-21","objectID":"/dart-future%E5%92%8Cstream/:1:0","series":[],"tags":["Dart"],"title":"Dart-Futureå’ŒStream","uri":"/dart-future%E5%92%8Cstream/"},{"categories":[],"content":"waitæ–¹æ³• ç±»ä¼¼RxJavaä¸­çš„zipæ“ä½œç¬¦ï¼š final futures = [ Future.delayed(Duration(seconds: 3)), Future.delayed(Duration(seconds: 5)) ]; Future.wait(futures) .then((value) =\u003e print('æ‹¿åˆ°å€¼ï¼š$value')); ","date":"2021-07-21","objectID":"/dart-future%E5%92%8Cstream/:1:1","series":[],"tags":["Dart"],"title":"Dart-Futureå’ŒStream","uri":"/dart-future%E5%92%8Cstream/"},{"categories":[],"content":"Stream æŒç»­ç›‘å¬ Streamæ˜¯æŒç»­æ€§ç›‘å¬ï¼Œæ‰€ä»¥å°±å¿…é¡»è¦åœ¨ä¸éœ€è¦çš„æ—¶å€™æ‰‹åŠ¨é‡Šæ”¾ã€‚ final stream = File('').openRead(); //è®¢é˜… final listener = stream.listen((event) { //å¯åŠ¨ç›‘å¬ }); //è½¬æ¢æˆFuture Future future = listener.asFuture(); //æš‚åœ listener.pause(); //æš‚åœæ¢å¤ listener.resume(); //å–æ¶ˆ listener.cancel(); ","date":"2021-07-21","objectID":"/dart-future%E5%92%8Cstream/:2:0","series":[],"tags":["Dart"],"title":"Dart-Futureå’ŒStream","uri":"/dart-future%E5%92%8Cstream/"},{"categories":[],"content":"Streamçš„è®¢é˜…ä¸å¹¿æ’­ è®¢é˜… Streamé»˜è®¤å°±æ˜¯å•è®¢é˜…æ¨¡å¼ã€‚å¦‚æœé‡å¤è°ƒç”¨listen()æ–¹æ³•å°±ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚ï¼š final stream = File('').openRead(); //è®¢é˜… final listener = stream.listen((event) { //å¯åŠ¨ç›‘å¬ }); final listener1 = stream.listen((event) {}); æŠ¥é”™ï¼š å¹¿æ’­æ¨¡å¼ å¹¿æ’­æ¨¡å¼å…è®¸å¤šè®¢é˜…ã€‚å¯ä»¥æŠŠè®¢é˜…æ¨¡å¼è½¬ä¸ºå¹¿æ’­æ¨¡å¼ï¼š final stream = File('').openRead(); stream.asBroadcastStream(); //è®¢é˜… final listener = stream.listen((event) { //å¯åŠ¨ç›‘å¬ }); final listener1 = stream.listen((event) {}); ä¹Ÿå¯ä»¥é€šè¿‡StreamControllerç›´æ¥åˆ›å»ºå¹¿æ’­ï¼š final streamController = StreamController.broadcast(); streamController.stream.listen((event) { // todo å›è°ƒ }); streamController.add('value'); streamController.close(); StreamSink","date":"2021-07-21","objectID":"/dart-future%E5%92%8Cstream/:2:1","series":[],"tags":["Dart"],"title":"Dart-Futureå’ŒStream","uri":"/dart-future%E5%92%8Cstream/"},{"categories":[],"content":"Dartçš„æ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶ DartåƒAndroidä¸€æ ·ï¼Œæ˜¯åŸºäºæ¶ˆæ¯é©±åŠ¨çš„. ä¾é eventLoopä¸åœçš„ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯æˆ–è€…äº‹ä»¶æ¥é©±åŠ¨æ•´ä¸ªåº”ç”¨çš„è¿è¡Œï¼ŒåŒ…æ‹¬isolateå‘é€è¿‡æ¥çš„æ¶ˆæ¯å°±æ˜¯é€šè¿‡Loopå¤„ç†ã€‚ çœ‹èµ·æ¥å¾ˆåƒAndroidä¸­çš„handler+looper+msgæœºåˆ¶ã€‚ ä½†æ˜¯ä¸åŒçš„æ˜¯ï¼ŒAndroidä¸­æ¯ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªlooperå¯¹åº”ä¸€ä¸ªä¸€ä¸ªMessageQueueï¼Œä½†æ˜¯dartä¸­å­˜åœ¨ä¸¤ä¸ªé˜Ÿåˆ—ï¼š event queueäº‹ä»¶é˜Ÿåˆ—ï¼› microtask queueå¾®æœåŠ¡é˜Ÿåˆ—ã€‚ ","date":"2021-07-21","objectID":"/dart-%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97/:1:0","series":[],"tags":["Dart"],"title":"Dart-ä»»åŠ¡é˜Ÿåˆ—","uri":"/dart-%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97/"},{"categories":[],"content":"Dartçš„æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ Dartåœ¨æ‰§è¡Œå®Œmainæ–¹æ³•åï¼Œå°±ä¼šç”±loopå¼€å§‹æ‰§è¡Œä¸¤ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­eventã€‚ loopä¼šå…ˆæ‰§è¡Œå®Œæ‰€æœ‰çš„å¾®æœåŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰eventï¼Œå†å»æ‰§è¡Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªäº‹ä»¶ï¼Œone by oneï¼Œæ‰€ä»¥å¾®æœåŠ¡é˜Ÿåˆ—çš„ä¼˜å…ˆçº§é«˜äºäº‹ä»¶é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™é¡¹ç‰¹æ€§æ¥æ’é˜Ÿï¼š eg:æ‰“å°æ–‡ä»¶å†…å®¹ import 'dart:io'; void main(){ new File(\"/Users/enjoy/a.txt\").readAsString().then((content){ print(content); }); //æ­»å¾ªç¯é€ æˆé˜»å¡ while(true){} } æ–‡ä»¶å†…å®¹æ°¸è¿œä¹Ÿæ— æ³•æ‰“å°å‡ºæ¥ï¼Œå› ä¸ºmainå‡½æ•°è¿˜æ²¡æ‰§è¡Œå®Œã€‚è€Œthenæ–¹æ³•æ˜¯ç”±Loopæ£€æŸ¥Event queueæ‰§è¡Œçš„ã€‚ å¦‚æœéœ€è¦å¾€å¾®æœåŠ¡ä¸­æ’å…¥Eventè¿›è¡Œæ’é˜Ÿï¼š import 'dart:async'; import 'dart:io'; //ç»“æœæ˜¯å…ˆæ‰§è¡Œäº†microtaskç„¶åæ‰§è¡Œthenæ–¹æ³•ã€‚ void main(){ new File(\"/Users/enjoy/a.txt\").readAsString().then((content){ print(content); }); //futureå†…éƒ¨å°±æ˜¯è°ƒç”¨äº† scheduleMicrotask Future.microtask((){ print(\"future: excute microtask\"); }); // scheduleMicrotask((){ // print(\"\"); // }); } æ³¨æ„ï¼šå¦‚æœå¾®æœåŠ¡ä¸­å‡ºç°é˜»å¡ï¼Œé‚£ä¹ˆä¸¤ä¸ªé˜Ÿåˆ—ä¸­æ‰€æœ‰çš„åç»­ä»»åŠ¡éƒ½ä¸ä¼šæ‰§è¡Œï¼Œä¹Ÿæ˜¯å› ä¸ºå•çº¿ç¨‹æ¨¡å‹å¯¼è‡´ã€‚ ","date":"2021-07-21","objectID":"/dart-%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97/:2:0","series":[],"tags":["Dart"],"title":"Dart-ä»»åŠ¡é˜Ÿåˆ—","uri":"/dart-%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97/"},{"categories":["technology"],"content":"äº‹æƒ…çš„èµ·å› æ˜¯ï¼Œåœ¨å·¥ä½œé¡¹ç›®ä¸­ï¼Œä¸€å¼€å§‹åªæœ‰æˆ‘ä¸€ä¸ªäººç ”å‘ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å°è£…äº†ä¸€ä¸ªç½‘ç»œè®¿é—®å±‚ã€‚ä½†æ˜¯éšç€å›¢é˜Ÿè§„æ¨¡çš„æ‹“å±•ï¼Œé™†ç»­åŠ å…¥äº†å…¶ä»–äººï¼Œæ—¶é—´ç´§é¡¹ç›®é‡ï¼Œæ‰€ä»¥åç»­çš„ä¼™ä¼´æ²¡æœ‰æ—¶é—´æ¥é—®æˆ‘è¿™ä¸ªæ¡†æ¶æ€ä¹ˆä½¿ç”¨ï¼Œæ‰€ä»¥ä»–ä»¬ç›´æ¥ä¸Šæ‰‹æ”¹äº†æˆ‘çš„å°è£…ï¼ä½†æ˜¯åæœŸæ¶æ„è¦æ±‚åŠ å…¥oauth2.0æœºåˆ¶ï¼Œæ‰€ä»¥éœ€è¦å…¨å±€å¤„ç†tokençš„æœ‰æ•ˆè®¤è¯ï¼Œå¹¶ä¸”è‡ªåŠ¨åˆ·æ–°tokenã€‚ä¸ºäº†æ»¡è¶³è¿™ä¸€éœ€æ±‚ï¼Œæˆ‘éœ€è¦é‡æ–°ç¼–å†™ç½‘ç»œå±‚ï¼ŒåŒæ—¶ä¸ºäº†é¿å…ä¼™ä¼´ä¿®æ”¹æˆ‘çš„æŠ½è±¡ï¼Œæˆ‘æƒ³åˆ°äº†æœ¬æ–‡çš„ä¸»é¢˜â€”â€”æ­å»ºä¸ªpub.devç§æœå§ï¼ ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:0:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":["technology"],"content":"serveré…ç½® é¦–å…ˆåˆ°æˆ‘çš„ç äº‘cloneä¸ªé¡¹ç›®ä¸‹æ¥,ç„¶åä¹ æƒ¯æ€§flutter pub getã€‚ æ¥ä¸‹æ¥ä¿®æ”¹é…ç½®ï¼Œä¿®æ”¹pub_server/example/src/example.dartæ–‡ä»¶,æ‰¾åˆ°argsParser()ï¼š ArgParser argsParser() { var parser = ArgParser(); parser.addOption('directory', abbr: 'd', defaultsTo: 'pub_server-repository-data'); //hoståœ°å€ parser.addOption('host', abbr: 'h', defaultsTo: 'localhost'); //ç«¯å£å· parser.addOption('port', abbr: 'p', defaultsTo: '8080'); // è¿è¡Œæ¨¡å¼ parser.addFlag('standalone', abbr: 's', defaultsTo: false); return parser; } ç”±äºæˆ‘çš„8080ç«¯å£å·²ç»è¢«jenkieså ç”¨äº†ï¼Œæ‰€ä»¥åªèƒ½æŠŠpubçš„ç«¯å£æ”¹ä¸º9090ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œhosté»˜è®¤æ˜¯localhostï¼Œåªæ”¯æŒæœ¬æœºè®¿é—®ï¼Œå¦‚æœæˆ‘ä»¬è¦æŒ‚åˆ°æœåŠ¡ä¸Šï¼Œéœ€è¦æŠŠè¿™é‡Œæ”¹ä¸º0.0.0.0ä¹‹åï¼Œæˆ‘ä»¬æ‰èƒ½é€šè¿‡ipæˆ–è€…åŸŸåè®¿é—®æœåŠ¡ã€‚ ç„¶åå¯åŠ¨æœåŠ¡ï¼š dart example/example.dart -d /tmp/package-db å¦‚æœå‡ºç°ã€ŒTo make the pub client use this repository configureâ€¦ã€è¡¨ç¤ºæœåŠ¡å¯åŠ¨æˆåŠŸï¼ ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:1:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":["technology"],"content":"åˆ›å»ºæµ‹è¯•package æ€ä¹ˆåˆ›å»ºï¼Œä¸è¯´äº†ï¼Œè¿™é‡Œåªè´´å‡ºyamlæ–‡ä»¶ï¼š name: lk_dio description: ç”¨äºæ¥åº·ç§‘æŠ€å…¬å¸çš„ç½‘ç»œè¯·æ±‚å±‚å°è£…ï¼ŒåŒ…æ‹¬å¹³å°ã€å¤§è„‘çš„æ¥å£è°ƒç”¨è§„åˆ™å’Œtokenæœ‰æ•ˆæœŸéªŒè¯åŠè‡ªåŠ¨åˆ·æ–°æœºåˆ¶ã€‚ version: 0.0.2 author: William \u003cè‡ªå·±çš„é‚®ç®±@enn.cn\u003e homepage: 'http://é¡¹ç›®ä¸»é¡µåœ°å€.com' publish_to: 'http://localhost:9090' environment: sdk: \"\u003e=2.7.0 \u003c3.0.0\" flutter: \"\u003e=1.17.0\" dependencies: flutter: sdk: flutter dev_dependencies: flutter_test: sdk: flutter flutter: é…ç½®å¥½ä¹‹å,å¯ä»¥åœ¨æœ¬åœ°ç›´æ¥ä¾èµ–ï¼š lk_dio: path: user/william/lk_dio å½“ç„¶ä¹Ÿå¯ä»¥å‘å¸ƒåˆ°æˆ‘ä»¬çš„pubç§æœä¸Šï¼Œå‘å¸ƒä¹‹å‰å¯ä»¥é€šè¿‡å‘½ä»¤æ£€æŸ¥é”™è¯¯ï¼š flutter packages pub publish --dry-run æŒ‰ç…§æç¤ºè§£å†³é—®é¢˜ï¼Œç„¶åå‘å¸ƒï¼š flutter packages pub publish å‡ºç°å¦‚ä¸‹ä¿¡æ¯è¡¨æ˜å‘å¸ƒæˆåŠŸï¼š |-- lib | '-- helloworld.dart |-- pubspec.yaml '-- test '-- helloworld_test.dart Looks great! Are you ready to upload your package (y/n)? y Uploading... Successfully uploaded package. ä½†æ˜¯å¦‚æœä¸FQï¼Œæ˜¯ä¸€å®šä¸ä¼šæˆåŠŸçš„ï¼Œä½ çœ‹åˆ°çš„å°†æ˜¯å¦‚ä¸‹ä¿¡æ¯ï¼š Pub needs your authorization to upload packages on your behalf. å¤±è´¥çš„åŸå› å°±æ˜¯éœ€è¦googleçš„è®¤è¯ï¼Œæ€ä¹ˆåŠï¼Œfq? æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•ï¼Ÿ ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:2:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":["technology"],"content":"ç»•è¿‡googleè®¤è¯ å†cloneè¿™ä¸ªé¡¹ç›®ä¹‹åflutter pub getï¼Œç„¶åæ‰§è¡Œï¼š dart --snapshot=mypub.dart.snapshot bin/pub.dart å®Œäº‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªmypub.dart.snapshotã€‚ å¤åˆ¶ä¹‹åæ”¾å…¥${flutterSDK Path}/bin/cache/dart-sdk/bin/snapshots/ ç›®å½•ä¸‹ ç”¨txtç¼–è¾‘å™¨æ‰“å¼€${flutterSDK Path}/bin/cache/dart-sdk/bin/pubæ–‡ä»¶ï¼Œå°†å€’æ•°ç¬¬ä¸‰è¡Œçš„ï¼špub.dart.snapshot æ›¿æ¢ä¸º mypub.dart.snapshot,ç„¶åé‡æ–°å‘å¸ƒpackageå°±OKäº†ã€‚ ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:3:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":["technology"],"content":"ä¾èµ–è‡ªå·±çš„package lk_dio:#è¿™é‡Œè¦ä¸ä¹‹å‰ä¸€è‡´ hosted: name: lk_dio #è¿™é‡Œè¦ä¸ä¹‹å‰ä¸€è‡´ url: http://localhost:9090 version: ^1.0.0 æ·»åŠ äº†ä¾èµ–ä¹‹åï¼Œæˆ‘flutter pub getï¼Œæœ¬æœºæ²¡é—®é¢˜ï¼Œé¡¹ç›®æ­£å¸¸è·‘ï¼Œä¸‡åˆ†æ¿€åŠ¨ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚ å½“æˆ‘æŠŠserverå‘å¸ƒåˆ°å…¬å¸æœåŠ¡å™¨åï¼Œ**publishå¤±è´¥ï¼**ç»æŸ¥ï¼Œæ˜¯è¿ç»´æ²¡æœ‰å¼€æ”¾9090ç«¯å£ï¼Œæ‰¾è¿‡è¿ç»´ä¹‹åé—®é¢˜è§£å†³ã€‚ ç„¶åæˆ‘å†æ·»åŠ ä¾èµ–ï¼Œè¿è¡Œpub getï¼Œç«Ÿç„¶å¡ä½ä¸åŠ¨äº†ï¼Œå†…å¿ƒç¬é—´ä¸€ä¸‡åªè‰æ³¥é©¬å¾·ï¼Œä¸Šä¼ å¯ä»¥ä¸‹è½½å°±ä¸è¡Œæ€ªäº†ï¼åæ¥å‘ç°serverçš„é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸ªé…ç½®ï¼š // è¿è¡Œæ¨¡å¼ parser.addFlag('standalone', abbr: 's', defaultsTo: false); standaloneå¥½åƒæ˜¯ç‹¬ç«‹éƒ¨ç½²çš„æ„æ€ã€‚ æŠŠè¿™é‡Œçš„defaultToçš„å€¼æ”¹ä¸ºtrue,é‡æ–°éƒ¨ç½²ã€å¯åŠ¨ï¼Œå†é‡æ–°ä¸‹è½½ä¾èµ–pub getï¼Œç­‰ç­‰è¶³è¶³71ç§’åç«Ÿç„¶æˆåŠŸäº†ï¼åæ¥è¿ç»´è§£é‡Šï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆæ…¢æ˜¯å› ä¸ºä»åŒ—äº¬è®¿é—®æˆ‘ä»¬ç›åŸçš„æœåŠ¡å™¨ï¼Œè€Œä¸”æ²¡æœ‰CDNåŠ é€Ÿã€‚ ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:4:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":["technology"],"content":"é¸£è°¢ï¼š https://www.jianshu.com/p/59f4778864f0 ","date":"2021-07-15","objectID":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/:5:0","series":[],"tags":["flutter"],"title":"æ­å»ºpubç§æœåŠä¸Šä¼ package","uri":"/%E6%90%AD%E5%BB%BApub%E7%A7%81%E6%9C%8D%E5%8F%8A%E4%B8%8A%E4%BC%A0package/"},{"categories":null,"content":"å…³äºæˆ‘ ","date":"2021-07-15","objectID":"/about/:0:0","series":null,"tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":" /binï¼š bin æ˜¯ Binaries (äºŒè¿›åˆ¶æ–‡ä»¶) çš„ç¼©å†™, è¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ã€‚ /bootï¼š è¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨ Linux æ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚ /dev ï¼š dev æ˜¯ Device(è®¾å¤‡) çš„ç¼©å†™, è¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯ Linux çš„å¤–éƒ¨è®¾å¤‡ï¼Œåœ¨ Linux ä¸­è®¿é—®è®¾å¤‡çš„æ–¹å¼å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚ /etcï¼š etc æ˜¯ Etcetera(ç­‰ç­‰) çš„ç¼©å†™,è¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•ã€‚ /homeï¼š ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨ Linux ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ï¼Œå¦‚ä¸Šå›¾ä¸­çš„ aliceã€bob å’Œ eveã€‚ /libï¼š lib æ˜¯ Library(åº“) çš„ç¼©å†™è¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äº Windows é‡Œçš„ DLL æ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“ã€‚ /lost+foundï¼š è¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶ã€‚ /mediaï¼š linux ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼ŒLinux ä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚ /mntï¼š ç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨ /mnt/ ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚ /optï¼š opt æ˜¯ optional(å¯é€‰) çš„ç¼©å†™ï¼Œè¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚æ¯”å¦‚ä½ å®‰è£…ä¸€ä¸ªORACLEæ•°æ®åº“åˆ™å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚é»˜è®¤æ˜¯ç©ºçš„ã€‚ /procï¼š proc æ˜¯ Processes(è¿›ç¨‹) çš„ç¼©å†™ï¼Œ/proc æ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¹Ÿå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œè¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚ è¿™ä¸ªç›®å½•çš„å†…å®¹ä¸åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é‡Œé¢çš„æŸäº›æ–‡ä»¶ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥å±è”½ä¸»æœºçš„pingå‘½ä»¤ï¼Œä½¿åˆ«äººæ— æ³•pingä½ çš„æœºå™¨ï¼š echo 1 \u003e /proc/sys/net/ipv4/icmp_echo_ignore_all /rootï¼š è¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚ /sbinï¼š s å°±æ˜¯ Super User çš„æ„æ€ï¼Œæ˜¯ Superuser Binaries (è¶…çº§ç”¨æˆ·çš„äºŒè¿›åˆ¶æ–‡ä»¶) çš„ç¼©å†™ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚ /selinuxï¼š è¿™ä¸ªç›®å½•æ˜¯ Redhat/CentOS æ‰€ç‰¹æœ‰çš„ç›®å½•ï¼ŒSelinux æ˜¯ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç±»ä¼¼äº windows çš„é˜²ç«å¢™ï¼Œä½†æ˜¯è¿™å¥—æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯å­˜æ”¾selinuxç›¸å…³çš„æ–‡ä»¶çš„ã€‚ /srvï¼š è¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®ã€‚ /sysï¼š è¿™æ˜¯ Linux2.6 å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº† 2.6 å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚ sysfs æ–‡ä»¶ç³»ç»Ÿé›†æˆäº†ä¸‹é¢3ç§æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šé’ˆå¯¹è¿›ç¨‹ä¿¡æ¯çš„ proc æ–‡ä»¶ç³»ç»Ÿã€é’ˆå¯¹è®¾å¤‡çš„ devfs æ–‡ä»¶ç³»ç»Ÿä»¥åŠé’ˆå¯¹ä¼ªç»ˆç«¯çš„ devpts æ–‡ä»¶ç³»ç»Ÿã€‚ è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å†…æ ¸è®¾å¤‡æ ‘çš„ä¸€ä¸ªç›´è§‚åæ˜ ã€‚ å½“ä¸€ä¸ªå†…æ ¸å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•ä¹Ÿåœ¨å†…æ ¸å¯¹è±¡å­ç³»ç»Ÿä¸­è¢«åˆ›å»ºã€‚ /tmpï¼š tmp æ˜¯ temporary(ä¸´æ—¶) çš„ç¼©å†™è¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚ /usrï¼š usr æ˜¯ unix shared resources(å…±äº«èµ„æº) çš„ç¼©å†™ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äº windows ä¸‹çš„ program files ç›®å½•ã€‚ /usr/binï¼š ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚ /usr/sbinï¼š è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚ /usr/srcï¼š å†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚ /varï¼š var æ˜¯ variable(å˜é‡) çš„ç¼©å†™ï¼Œè¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†é‚£äº›ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶ã€‚ /runï¼š æ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰ /var/run ç›®å½•ï¼Œåº”è¯¥è®©å®ƒæŒ‡å‘ runã€‚ åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰å‡ ä¸ªç›®å½•æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œå¹³æ—¶éœ€è¦æ³¨æ„ä¸è¦è¯¯åˆ é™¤æˆ–è€…éšæ„æ›´æ”¹å†…éƒ¨æ–‡ä»¶ã€‚ /etcï¼š ä¸Šè¾¹ä¹Ÿæåˆ°äº†ï¼Œè¿™ä¸ªæ˜¯ç³»ç»Ÿä¸­çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä½ æ›´æ”¹äº†è¯¥ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸èƒ½å¯åŠ¨ã€‚ /bin, /sbin, /usr/bin, /usr/sbin: è¿™æ˜¯ç³»ç»Ÿé¢„è®¾çš„æ‰§è¡Œæ–‡ä»¶çš„æ”¾ç½®ç›®å½•ï¼Œæ¯”å¦‚ ls å°±æ˜¯åœ¨ /bin/ls ç›®å½•ä¸‹çš„ã€‚ å€¼å¾—æå‡ºçš„æ˜¯ï¼Œ/bin, /usr/bin æ˜¯ç»™ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„æŒ‡ä»¤ï¼ˆé™¤rootå¤–çš„é€šç”¨æˆ·ï¼‰ï¼Œè€Œ/sbin, /usr/sbin åˆ™æ˜¯ç»™ root ä½¿ç”¨çš„æŒ‡ä»¤ã€‚ /varï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç³»ç»Ÿä¸Šè·‘äº†å¾ˆå¤šç¨‹åºï¼Œé‚£ä¹ˆæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰ç›¸åº”çš„æ—¥å¿—äº§ç”Ÿï¼Œè€Œè¿™äº›æ—¥å¿—å°±è¢«è®°å½•åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œå…·ä½“åœ¨ /var/log ç›®å½•ä¸‹ï¼Œå¦å¤– mail çš„é¢„è®¾æ”¾ç½®ä¹Ÿæ˜¯åœ¨è¿™é‡Œ ","date":"2021-07-15","objectID":"/linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/:0:0","series":null,"tags":null,"title":"linuxç›®å½•ç»“æ„","uri":"/linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"è‡ªå®šä¹‰ViewGroupä¸è‡ªå®šä¹‰Viewä¸åŒï¼Œä¸€èˆ¬ä¸éœ€è¦é‡å†™onDrawï¼Œè€Œæ˜¯éœ€è¦é‡å†™onLayoutã€‚ import android.content.Context import android.util.AttributeSet import android.util.Log import android.view.MotionEvent import android.view.View import android.view.ViewGroup import kotlin.math.max class MyViewGroup(context: Context, attrs: AttributeSet?, defStyleAttr: Int, defStyleRes: Int) : ViewGroup(context, attrs, defStyleAttr, defStyleRes) { constructor(context: Context, attrs: AttributeSet?, defStyleAttr: Int) : this(context, attrs, defStyleAttr, 0) constructor(context: Context, attrs: AttributeSet?) : this(context, attrs, 0) constructor(context: Context) : this(context, null) private val TAG = \"æµ‹è¯•\" override fun generateLayoutParams(attrs: AttributeSet?): LayoutParams { return MarginLayoutParams(context, attrs) } override fun onMeasure(widthMeasureSpec: Int, heightMeasureSpec: Int) { //æµ‹é‡å­view measureChildren(widthMeasureSpec, heightMeasureSpec) var width1 = 0 var width2 = 0 var height1 = 0 var height2 = 0 var child: View var childWidth: Int var childHeight: Int var childLp: LayoutParams //å åŠ æ‰€æœ‰å­Viewçš„å®½é«˜ for (i in 0 until childCount) { child = getChildAt(i) childWidth = child.measuredWidth childHeight = child.measuredHeight childLp = child.layoutParams as MarginLayoutParams if (i \u003c 2) { width1 += childWidth + childLp.leftMargin + childLp.rightMargin height1 += childHeight + childLp.topMargin + childLp.bottomMargin } else { width2 += childWidth + childLp.leftMargin + childLp.rightMargin height2 += childHeight + childLp.topMargin + childLp.bottomMargin } } // è·å–çˆ¶å®¹å™¨æ¨èçš„å°ºå¯¸ val widthMode = MeasureSpec.getMode(widthMeasureSpec) val measureWidth = MeasureSpec.getSize(widthMeasureSpec) val heightMode = MeasureSpec.getMode(heightMeasureSpec) val measureHeight = MeasureSpec.getSize(heightMeasureSpec) // æ ¹æ®æƒ…å†µè®¡ç®—å‡ºå¯å®¹çº³æ‰€æœ‰childçš„å°ºå¯¸ val width = if (widthMode == MeasureSpec.EXACTLY) measureWidth else max(width1, width2) val height = if (heightMode == MeasureSpec.EXACTLY) measureHeight else max(height1, height2) setMeasuredDimension(width, height) } override fun onLayout(changed: Boolean, l: Int, t: Int, r: Int, b: Int) { var childLp: LayoutParams var child: View var cl: Int var ct: Int var cr: Int var cb: Int // ä¾æ¬¡ä¸ºæ‰€æœ‰çš„childå¸ƒå±€ for (i in 0 until childCount) { child = getChildAt(i) childLp = child.layoutParams as MarginLayoutParams when (i) { 0 -\u003e { cl = 0 + childLp.leftMargin ct = 0 + childLp.topMargin } 1 -\u003e { cl = width - child.measuredWidth - childLp.leftMargin - childLp.rightMargin ct = 0 + childLp.topMargin } 2 -\u003e { cl = 0 + childLp.leftMargin ct = height - child.measuredHeight - childLp.topMargin - childLp.bottomMargin } else -\u003e { cl = width - child.measuredWidth - childLp.leftMargin - childLp.rightMargin ct = height - child.measuredHeight - childLp.topMargin - childLp.bottomMargin } } cr = cl + child.measuredWidth cb = ct + child.measuredHeight //å¸ƒå±€ child.layout(cl, ct, cr, cb) } } } ","date":"2021-07-12","objectID":"/android%E8%87%AA%E5%AE%9A%E4%B9%89viewgroup/:0:0","series":null,"tags":["Android"],"title":"Androidè‡ªå®šä¹‰ViewGroup","uri":"/android%E8%87%AA%E5%AE%9A%E4%B9%89viewgroup/"},{"categories":null,"content":"ç”¨é€” è¯»å–.classæ–‡ä»¶çš„å­—èŠ‚ç å¹¶åŠ è½½æˆå†…å­˜å½¢å¼çš„ç±»å¯¹è±¡ã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:1:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"è¾¹è§£é‡Šè¾¹æ‰§è¡Œ JVMå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½å…¨éƒ¨çš„ç±»ï¼Œè€Œæ˜¯éœ€è¦ç”¨åˆ°æ‰ä¼šå»åŠ è½½ã€‚æ¯”å¦‚åŠ è½½äº†ç±»ï¼Œä½†æ˜¯ä¸ä¼šå»åŠ è½½ç±»é‡Œé¢å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å­—æ®µçš„ç±»ï¼Œå› ä¸ºæš‚æ—¶ç”¨ä¸åˆ°ã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:2:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"Javaå†…ç½®çš„ClassLoader BootstrapClassLoader è´Ÿè´£åŠ è½½ JVM è¿è¡Œæ—¶æ ¸å¿ƒç±»ï¼Œè¿™äº›ç±»ä½äº JAVA_HOME/lib/rt.jar æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨å†…ç½®åº“ java.xxx.* éƒ½åœ¨é‡Œé¢ï¼Œæ¯”å¦‚ java.util.ã€java.io.ã€java.nio.ã€java.lang. ç­‰ç­‰ã€‚è¿™ä¸ª ClassLoader æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ˜¯ç”± C ä»£ç å®ç°çš„ï¼Œæˆ‘ä»¬å°†å®ƒç§°ä¹‹ä¸ºã€Œæ ¹åŠ è½½å™¨ã€ã€‚ ExtensionClassLoader è´Ÿè´£åŠ è½½ JVM æ‰©å±•ç±»ï¼Œæ¯”å¦‚ swing ç³»åˆ—ã€å†…ç½®çš„ js å¼•æ“ã€xml è§£æå™¨ ç­‰ç­‰ï¼Œè¿™äº›åº“åé€šå¸¸ä»¥ javax å¼€å¤´ï¼Œå®ƒä»¬çš„ jar åŒ…ä½äº JAVA_HOME/lib/ext/*.jar ä¸­ï¼Œæœ‰å¾ˆå¤š jar åŒ…ã€‚ AppClassLoader è¿™æ‰æ˜¯ç›´æ¥é¢å‘æˆ‘ä»¬ç”¨æˆ·çš„åŠ è½½å™¨ï¼Œå®ƒä¼šåŠ è½½ Classpath ç¯å¢ƒå˜é‡é‡Œå®šä¹‰çš„è·¯å¾„ä¸­çš„ jar åŒ…å’Œç›®å½•ã€‚æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç ä»¥åŠä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ jar åŒ…é€šå¸¸éƒ½æ˜¯ç”±å®ƒæ¥åŠ è½½çš„ã€‚ URLClassLoader ä¸“é—¨ç”¨æ¥åŠ è½½ä½äºç½‘ç»œä¸Šé™æ€æ–‡ä»¶æœåŠ¡å™¨æä¾›çš„ jar åŒ…å’Œ classæ–‡ä»¶ã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:3:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"ClassLoaderçš„é€‰æ‹© å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªClassLoaderï¼Œå…¶å†…éƒ¨éƒ½åŒ…å«äº†ä¸€ä¸ªClassLoaderï¼Œå½“é‡åˆ°æœªçŸ¥çš„ç±»ï¼ŒJVMä¼šé€‰æ‹©è°ƒç”¨è€…è‡ªå·±çš„ClassLoaderå»åŠ è½½ã€‚ é‚£ä¹ˆæœ€åˆçš„è°ƒç”¨è€…ä¸€å®šæ˜¯æŒæœ‰main()æ–¹æ³•çš„ç±»ï¼Œä»–æŒæœ‰çš„æ˜¯AppClassLoaderã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:4:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"åŒäº²å§”æ´¾ AppClassLoaderåªè´Ÿè´£åŠ è½½Classpathä¸‹é¢çš„ç±»ç§’å¦‚æœé‡åˆ°æ²¡æœ‰åŠ è½½è¿‡çš„ç³»ç»Ÿç±»ï¼Œä»–ä¼šå°†ç³»ç»Ÿç±»åº“çš„åŠ è½½å·¥ä½œäº¤ç»™BootstrapClassLoaderå’ŒExtensionClassLoaderæ¥åšï¼Œè¿™å°±å«åŒäº²å§”æ´¾ã€‚ æ¯ä¸ªClassLoaderä¸­éƒ½æœ‰ä¸€ä¸ªparentå±æ€§æŒ‡å‘çˆ¶çº§ï¼Œç„¶åä¼šä¼˜å…ˆè®©çˆ¶çº§å»åŠ è½½ï¼Œè‹¥çˆ¶çº§åŠ è½½å¤±è´¥ï¼Œæ‰è½®åˆ°è‡ªå·±å»åŠ è½½ï¼š AppClassLoader -\u003e ExtensionClassLoader -\u003e BootstrapClassLoader ExtensionClassLoaderçš„parentçš„å€¼ä¸ºnullï¼Œåªè¦æ˜¯parent=nullçš„ï¼Œè¯´æ˜çˆ¶åŠ è½½å™¨å°±æ˜¯BootstrapClassLoaderã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:5:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"ä½¿ç”¨ClassLoader ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:6:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"Class.forName Class.forName(\"com.mysql.cj.jdbc.Driver\"); Class\u003c?\u003e forName(String name, boolean initialize, ClassLoader cl) è¿™ä¸ªæ–¹æ³•é»˜è®¤ä½¿ç”¨â€œè°ƒç”¨è€…â€çš„ClassLoaderæ¥åŠ è½½ç›®æ ‡ç±»ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©å…¶ä»–çš„ClassLoaderã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:6:1","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"ClassLoader.loadClass ClassLoader.getSystemClassLoader().loadClass(\"[I\"); ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:6:2","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"ä½¿ç”¨ ä½¿ç”¨æ—¶ä¸€èˆ¬éƒ½ä¼šç»“åˆåå°„ã€‚ Class\u003c?\u003e clazz1 = App.class.getClassLoader().loadClass(\"Student\"); Class\u003c?\u003e clazz2 = Student.class.getClassLoader().loadClass(\"Student\"); Class\u003c?\u003e clazz3 = ClassLoader.getSystemClassLoader().loadClass(\"Student\"); Class\u003c?\u003e clazz4 = Class.forName(\"Student\"); Object obj1 = clazz1.getConstructor().newInstance(); clazz1.getMethods()[0].invoke(obj1, \"obj1\"); Object obj2 = clazz2.getConstructor().newInstance(); clazz1.getMethods()[0].invoke(obj2, \"obj2\"); Object obj3 = clazz3.getConstructor().newInstance(); clazz1.getMethods()[0].invoke(obj3, \"obj3\"); Object obj4 = clazz4.getConstructor().newInstance(); clazz1.getMethods()[0].invoke(obj4, \"obj4\"); ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:7:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"è‡ªå®šä¹‰ç±»åŠ è½½å™¨ ClassLoader é‡Œé¢æœ‰ä¸‰ä¸ªé‡è¦çš„æ–¹æ³• loadClass()ã€findClass() å’Œ defineClass()ã€‚ ClassLoader ä¸é‡å†™ ç”¨æ¥åŠ è½½ç›®æ ‡ç±»çš„å…¥å£ã€‚é¦–å…ˆä¼šæŸ¥æ‰¾å½“å‰è‡ªå·±å’ŒåŒäº²æ˜¯å¦å·²ç»åŠ è½½ç›®æ ‡ç±»ï¼Œæ²¡æœ‰çš„è¯å°±è®©åŒäº²åŠ è½½ï¼Œå¼±å¤±è´¥ï¼Œå†è°ƒç”¨findClass()ã€‚ findClass() éœ€é‡å†™ å»è¯»å–å­—èŠ‚ç ï¼Œç„¶åè°ƒç”¨defineClass()ã€‚ defineClass() ä¸é‡å†™ ç”¨æ¥ä»å­—èŠ‚ç åŠ è½½ç±»å¯¹è±¡ã€‚ ","date":"2021-07-08","objectID":"/classloader%E5%AD%A6%E4%B9%A0/:8:0","series":null,"tags":["java"],"title":"ClassLoaderå­¦ä¹ .md","uri":"/classloader%E5%AD%A6%E4%B9%A0/"},{"categories":null,"content":"å­—èŠ‚æµ æ ‡å‡†ç”¨æ³•ï¼š DataOutputStream out = new DataOutputStream(//è´Ÿè´£æ•°æ®ç±»å‹ new BufferedOutputStream(//æ·»åŠ ç¼“å†²åŒºï¼Œæé«˜è¯»æµæ•ˆç‡ new FileOutputStream(//è´Ÿè´£æŠŠæ–‡ä»¶è½¬æˆæµ new File(file) ) ) ); //DataOutputStreamç±»å‹å¯ç›´æ¥è¯»å†™ä¸€èˆ¬ç±»å‹å˜é‡ out.writeString(\"å“ˆå“ˆ\"); // åœ¨è¯»å–æ—¶ï¼Œæ¯”å¦‚ä¸å†™å…¥æ—¶é¡ºåºä¸€æ ·ï¼Œæ‰èƒ½æˆåŠŸè¯»å‡ºæ¥ ä»¥ä¸Šä»£ç å……åˆ†ä½“ç°äº†è£…é¥°è€…æ¨¡å¼ã€‚ è£…é¥°æ¨¡å¼åœ¨Androidä¸­çš„ä½“ç°: ","date":"2021-07-06","objectID":"/javaio/:1:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"å­—ç¬¦æµ æœ€å¤§çš„åŒºåˆ«ï¼šreadLine() å­—ç¬¦æµè‡ªå¸¦ç¼–ç ã€‚ InputStreamReader isr = new InputStreamReader(in); BufferedReader br = new BufferedReader(isr); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); ","date":"2021-07-06","objectID":"/javaio/:2:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"å­—ç¬¦æµä¸å­—èŠ‚æµçš„ä¾èµ–å…³ç³» å­—ç¬¦æµ-\u003eå­—èŠ‚æµ-\u003eæ–‡ä»¶ ","date":"2021-07-06","objectID":"/javaio/:3:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"RadomAccessFileï¼ˆç”¨äºæ–­ç‚¹ç»­ä¼ ï¼‰ File æ‰“å“ªæŒ‡å“ª RadomAccessFile æŒ‡å“ªæ‰“å“ª ä¸»è¦æ˜¯é seek()æ–¹æ³•æ ‡è®°ç£å¤´ä½ç½®ã€‚ ","date":"2021-07-06","objectID":"/javaio/:4:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"NIOâ€”â€”FileChannel å¤§æ–‡ä»¶æ“ä½œæ—¶ä½¿ç”¨ã€‚ ","date":"2021-07-06","objectID":"/javaio/:5:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"Androidå„ç‰ˆæœ¬å¯¹æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´ ç‰ˆæœ¬å· ä¿®æ”¹å†…å®¹ 4.4 è®¿é—®å¤–éƒ¨å…¬å…±æ–‡ä»¶getExternalStoragePublicDirectory()éœ€è¦å…·å¤‡READ_EXTERNAL_STORAGEæƒé™ã€‚ 7.0 è·å–æœ¬åœ°æ–‡ä»¶çš„Uriæ–¹å¼ç”±Uri.fromFile(new File(filePath))æ”¹ä¸ºFileProvider.getUriForFile()ã€‚å¹¶ä¸”éœ€è¦åœ¨AndroidManifestä¸­æ·»åŠ provider 11.0 å¯ç”¨æ²™ç›’æœºåˆ¶ ","date":"2021-07-06","objectID":"/javaio/:6:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"Androidçš„æ–‡ä»¶ç³»ç»Ÿ ","date":"2021-07-06","objectID":"/javaio/:7:0","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"å†…éƒ¨å‚¨å­˜ /data/data/åº”ç”¨åŒ…å/ ç‰¹ç‚¹ï¼š æ— éœ€æƒé™ï¼Œç›´æ¥æ“ä½œï¼› ä¸€èˆ¬æƒ…å†µä¸‹åªæœ‰Appè‡ªå·±èƒ½å¤Ÿè®¿é—®ï¼› å¸è½½ååˆ é™¤ï¼› filesç›®å½• ç”¨æ¥é•¿æœŸä¿å­˜è‡ªå·±çš„æ–‡ä»¶ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ã€‚ //è·å–å†…éƒ¨æ ¹ç›®å½• context.getDir(String name,int mode) //è·å– File file = context.getFilesDir(); //åˆ—å‡ºæ–‡ä»¶å String[] files = context.fileList(); //åˆ é™¤ context.deleteFile(\"è·¯å¾„\"); //åˆ›å»ºæµ context.openFileOutput(String name, int mode); cacheç›®å½• ç”¨æ¥ä¸´æ—¶å­˜æ”¾æ–‡ä»¶ï¼Œç©ºé—´ä¸è¶³æ—¶ä¼˜å…ˆåˆ é™¤ã€‚æ¸…é™¤ç¼“å­˜æ—¶å¯åˆ é™¤ã€‚ File cacheFile = context.getCacheDir(); code_cacheç›®å½• å°±æ˜¯å½“Appå‡çº§æ—¶ï¼Œä¼šåˆ é™¤è¯¥ç›®å½•ä¸‹çš„å†…å®¹ï¼Œè¿™ä¸ªAPIè¦æ±‚å¤§äº21ã€‚ File code = context.getCodeCacheDir() ","date":"2021-07-06","objectID":"/javaio/:7:1","series":null,"tags":["IO"],"title":"Java IO","uri":"/javaio/"},{"categories":null,"content":"JDKã€JVMã€Jreä¹‹é—´çš„å…³ç³» JVM åªè´Ÿè´£æŠŠ.classæ–‡ä»¶ç¿»è¯‘æˆæ“ä½œç³»ç»Ÿå¯è¯†åˆ«çš„è¯­å¥ã€‚ Jre æä¾›Javaç¨‹åºçš„è¿è¡Œç¯å¢ƒ JDK æä¾›å·¥å…· ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:1:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"JVMçš„ä¸‰å¤§åŒºåŸŸ Javaç±»åŠ è½½å™¨ClassLoader è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆJVMå†…å­˜ï¼‰ æ‰§è¡Œå¼•æ“ æ³¨æ„ï¼š JVMæ˜¯è¾¹è§£é‡Šè¾¹æ‰§è¡Œçš„ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:2:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"è¿è¡Œæ—¶æ•°æ®åŒº å®šä¹‰ï¼šJreåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠä»–æ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†æˆè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚åŒ…æ‹¬ï¼š - ç¨‹åºè®¡æ•°å™¨ - è™šæ‹Ÿæœºæ ˆ - æœ¬åœ°æ–¹æ³•æ ˆ ç”¨æ¥ä¿å­˜nativeæ–¹æ³•çš„ä¿¡æ¯ - Javaå † - æ–¹æ³•åŒºï¼ˆè¿è¡Œæ—¶å¸¸é‡æ± ï¼‰ - ç›´æ¥å†…å­˜ï¼ˆä¹Ÿå«å †å¤–å†…å­˜ï¼Œç”¨äºnioï¼‰ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:3:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"çº¿ç¨‹ç§æœ‰ è™šæ‹Ÿæœºæ ˆï¼ˆAå‡½æ•°è°ƒç”¨Bå‡½æ•°ï¼ŒBå‡½æ•°ä¼šå…ˆå…¥æ ˆï¼Œæ­¤æ—¶Bå‡½æ•°ä½äºæ ˆé¡¶ï¼Œè¢«æ‰§è¡Œã€‚æ‰§è¡Œå®ŒBå‡ºæ ˆï¼Œä½¿Aå›åˆ°æ ˆé¡¶ï¼ŒAç»§ç»­æ‰§ï¼‰ æœ¬åœ°æ–¹æ³•æ ˆ ç¨‹åºè®¡æ•°å™¨ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:3:1","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"çº¿ç¨‹å…±äº« æ–¹æ³•åŒº å † ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:3:2","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"ç¨‹åºè®¡æ•°å™¨ ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€ä¸ªå¾ˆå°çš„å†…å­˜åŒºåŸŸï¼ŒæŒ‡å‘å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤å¯¹åº”çš„å­—èŠ‚ç åœ°å€ï¼ˆæŒ‡é’ˆï¼‰ã€‚ ä¸ºä»€ä¹ˆéœ€è¦ç¨‹åºè®¡æ•°å™¨ï¼Ÿ CPUæ—¶é—´ç‰‡è½®è½¬å›æ¥çš„æ—¶å€™ï¼Œé€šè¿‡ç¨‹åºè®¡æ•°å™¨æ‰ç›´åˆ°ç¨‹åºæ‰§è¡Œåˆ°äº†å“ªé‡Œï¼Œä»¥åŠä»å“ªç»§ç»­æ‰§è¡Œã€‚ JVMçš„å†…å­˜åŒºåŸŸä¸­ï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯å”¯ä¸€ä¸ä¼šOOMçš„å‚¨å­˜åŒºã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:4:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"è™šæ‹Ÿæœºæ ˆ æ ˆï¼šFILAï¼Œåè¿›å…ˆå‡ºã€‚ è™šæ‹Ÿæœºæ ˆç”¨æ¥å­˜å‚¨å½“å‰çº¿ç¨‹è¿è¡Œæ–¹æ³•æ‰€éœ€çš„æ•°æ®ã€æŒ‡ä»¤ã€è¿”å›åœ°å€ç­‰ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:5:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"æ ˆå¸§ å±€éƒ¨å˜é‡è¡¨:ç”¨æ¥å­˜å‚¨å±€éƒ¨å˜é‡ï¼ˆç»“æ„ä½“å’Œå¼•ç”¨ï¼‰ æ“ä½œæ•°æ ˆ:å­˜æ”¾å‡½æ•°çš„æ‰§è¡Œã€‚ åŠ¨æ€è¿æ¥: ç”¨äºå¤šæ€ å®Œæˆå‡ºå£ï¼ˆè¿”å›åœ°å€ï¼‰: private void test(){ int i = 0; } å½“ä»¥ä¸Šå‡½æ•°è¿›å…¥è™šæ‹Ÿæœºæ ˆæ—¶ï¼Œå°±æˆä¸ºäº†ä¸€ä¸ªæ ˆå¸§ï¼Œä»–å†…éƒ¨åšäº†ä¸¤ä»¶äº‹ï¼š é¦–å…ˆå‡½æ•°ä¸­æœ‰ä¸ªåˆ›å»ºå˜é‡içš„æ“ä½œï¼Œå…¥æ ˆåˆ°æ“ä½œæ•°æ ˆï¼› å°†æ“ä½œæ•°æ ˆçš„æ ˆé¡¶æ“ä½œç”Ÿæˆçš„æ•°æ®ï¼ˆiï¼‰å­˜å…¥å±€éƒ¨å˜é‡è¡¨ä¸‹æ ‡ä¸º[1]çš„ä½ç½®ï¼ˆå±€éƒ¨å˜é‡è¡¨ä¸‹æ ‡[0]ä½ç½®æ˜¯thisï¼Œä»£è¡¨å®ä¾‹è‡ªå·±ï¼‰ã€‚ Javaçš„è§£é‡Šæ‰§è¡Œæ˜¯åŸºäºæ“ä½œæ•°æ ˆï¼Œæ‰€ä»¥ç§»æ¤æ€§å’Œå…¼å®¹æ€§å¥½ï¼Œè€ŒCè¯­è¨€æ˜¯åŸºäºå¯„å­˜å™¨ï¼ˆç¡¬ä»¶ï¼‰è¿ç®—ï¼Œæ‰€ä»¥é€Ÿåº¦å¿«ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:5:1","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"è™šæ‹Ÿæœºæ ˆçš„å¤§å° -Xss ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:5:2","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"æœ¬åœ°æ–¹æ³•æ ˆ ç”¨æ¥ä¿å­˜nativeæ–¹æ³•çš„ä¿¡æ¯ã€‚æ¯”å¦‚hashCode()æ–¹æ³•ç­‰åŠ äº†nativeå…³é”®å­—çš„æ–¹æ³•ã€‚ æœ¬åœ°æ–¹æ³•æ ˆä¸­å­˜æ”¾çš„å…¶å®æ˜¯Cå‡½æ•°çš„é“¾æ¥ï¼Œç”±äºä¸æ˜¯javaæ–¹æ³•ï¼Œæ‰€ä»¥ç¨‹åºè®¡æ•°å™¨ä¸ä¼šè®¡æ•°ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:6:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"æ–¹æ³•åŒº ç”¨æ¥å­˜æ”¾ï¼š ç±»ä¿¡æ¯ å¸¸é‡ é™æ€å˜é‡ å³æ—¶ç¼–è¯‘åçš„ä»£ç  ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:7:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"Javaå † ç”¨æ¥å­˜æ”¾ï¼š å¯¹è±¡ æ•°ç»„ å‚æ•°ï¼š Xmx å †åŒºå†…å­˜å¯è¢«åˆ†é…çš„æœ€å¤§ä¸Šé™ Xms å †å†…å­˜åˆå§‹å†…å­˜åˆ†é…çš„å¤§å° ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:8:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"é—®é¢˜ï¼Œä¸ºä½•è¦åˆ†æˆæ–¹æ³•åŒºå’Œå † å †ä½äºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå›æ”¶é¢‘ç¹ï¼›è€Œæ–¹æ³•åŒºä½äºæ°¸ç”Ÿä»£ï¼ˆ1.8å«å…ƒç©ºé—´ï¼Œä½¿ç”¨çš„æ˜¯ç‰©ç†å†…å­˜ï¼Œæå‡äº†å®¹é‡ï¼‰ï¼Œå›æ”¶ä¸é¢‘ç¹ã€‚è¿™æ˜¯ä¸€ç§åŠ¨é™åˆ†ç¦»çš„æ€æƒ³ï¼Œæœ‰åˆ©äºå›æ”¶çš„é«˜æ•ˆã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:9:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"æ€ä¹ˆå¯è§†åŒ–æŸ¥çœ‹å†…å­˜ ASçš„profile JDK9çš„HSDB ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:10:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"å†…å­˜æº¢å‡º å¸¸è§çš„å†…å­˜æº¢å‡ºæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š java.lang.OutOfMemoryError: Java heap space â€”â€”\u003ejavaå †å†…å­˜æº¢å‡ºï¼Œæ­¤ç§æƒ…å†µæœ€å¸¸è§ï¼Œä¸€èˆ¬ç”±äºå†…å­˜æ³„éœ²æˆ–è€…å †çš„å¤§å°è®¾ç½®ä¸å½“å¼•èµ·ã€‚å¯¹äºå†…å­˜æ³„éœ²ï¼Œéœ€è¦é€šè¿‡å†…å­˜ç›‘æ§è½¯ä»¶æŸ¥æ‰¾ç¨‹åºä¸­çš„æ³„éœ²ä»£ç ï¼Œè€Œå †å¤§å°å¯ä»¥é€šè¿‡è™šæ‹Ÿæœºå‚æ•°-Xms,-Xmxç­‰ä¿®æ”¹ã€‚ java.lang.OutOfMemoryError: PermGen space â€”â€”\u003ejavaæ°¸ä¹…ä»£æº¢å‡ºï¼Œå³æ–¹æ³•åŒºæº¢å‡ºäº†ï¼Œä¸€èˆ¬å‡ºç°äºå¤§é‡Classæˆ–è€…jspé¡µé¢ï¼Œæˆ–è€…é‡‡ç”¨cglibç­‰åå°„æœºåˆ¶çš„æƒ…å†µï¼Œå› ä¸ºä¸Šè¿°æƒ…å†µä¼šäº§ç”Ÿå¤§é‡çš„Classä¿¡æ¯å­˜å‚¨äºæ–¹æ³•åŒºã€‚æ­¤ç§æƒ…å†µå¯ä»¥é€šè¿‡æ›´æ”¹æ–¹æ³•åŒºçš„å¤§å°æ¥è§£å†³ï¼Œä½¿ç”¨ç±»ä¼¼-XX:PermSize=64m -XX:MaxPermSize=256mçš„å½¢å¼ä¿®æ”¹ã€‚å¦å¤–ï¼Œè¿‡å¤šçš„å¸¸é‡å°¤å…¶æ˜¯å­—ç¬¦ä¸²ä¹Ÿä¼šå¯¼è‡´æ–¹æ³•åŒºæº¢å‡ºã€‚ java.lang.StackOverflowError â€”â€”\u003e ä¸ä¼šæŠ›OOM errorï¼Œä½†ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§çš„Javaå†…å­˜æº¢å‡ºã€‚JAVAè™šæ‹Ÿæœºæ ˆæº¢å‡ºï¼Œä¸€èˆ¬æ˜¯ç”±äºç¨‹åºä¸­å­˜åœ¨æ­»å¾ªç¯æˆ–è€…æ·±åº¦é€’å½’è°ƒç”¨é€ æˆçš„ï¼Œæ ˆå¤§å°è®¾ç½®å¤ªå°ä¹Ÿä¼šå‡ºç°æ­¤ç§æº¢å‡ºã€‚å¯ä»¥é€šè¿‡è™šæ‹Ÿæœºå‚æ•°-Xssæ¥è®¾ç½®æ ˆçš„å¤§å°ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:11:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":null,"content":"é—ç•™é—®é¢˜ 1.JVM æœ‰å“ªäº›å†…å­˜åŒºåŸŸï¼Ÿï¼ˆJVM çš„å†…å­˜å¸ƒå±€æ˜¯ä»€ä¹ˆï¼Ÿï¼‰ 2.StackOverFlowä¸OOMçš„åŒºåˆ«ï¼Ÿåˆ†åˆ«å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™ï¼ŒJVMæ ˆä¸­å­˜å‚¨çš„æ˜¯ä»€ä¹ˆï¼Ÿå †ä¸­å­˜å‚¨æ˜¯ä»€ä¹ˆï¼Ÿ ä»Šå¤©çŠ¶æ€ä¸å¥½ï¼Œå­¦çš„äº‘é‡Œé›¾é‡Œï¼Œæ—¶é—´ä¸å¤Ÿå¿«ä¸‹ç­äº†ï¼Œä¹Ÿæ‡’å¾—æ€»ç»“äº†ï¼Œç•™åˆ°åé¢å†è¯´å§ã€‚ ","date":"2021-07-06","objectID":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/:12:0","series":null,"tags":["JVM"],"title":"JVMå†…å­˜ç»“æ„","uri":"/jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"},{"categories":["technology"],"content":"åˆ›å»ºç±» class StudentEntity with JsonConvert\u003cStudentEntity\u003e { @JSONField(name: \"name\") late String name; } ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:1:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"ä½¿ç”¨ //åºåˆ—åŒ– Map\u003cString, dynamic\u003e json = StudentEntity(name: \"èµ°ä¸¤æ­¥è¯•è¯•\").toJson(); //ååºåˆ—åŒ–æ–¹å¼ä¸€ final student1 = StudentEntity().fromJson(json); //ååºåˆ—åŒ–æ–¹å¼äºŒ final student2 = JsonConvert.fromJsonAsT\u003cStudentEntity\u003e(json); print('student1:$student1'); print('student2:$student2'); ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:2:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"åºåˆ—åŒ–è¿‡ç¨‹ ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:3:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"JsonConvert /// å½“æˆ‘ä»¬æ··å…¥è¿™ä¸ªç±»æ—¶ï¼Œå°±å¿…é¡»ç¡®å®šè¿™ä¸ªæ³›å‹ class JsonConvert\u003cT\u003e { ///åºåˆ—åŒ– Map\u003cString, dynamic\u003e toJson() { //æ³¨æ„è¿™é‡Œè·å–åˆ°äº†runtimeType return _getToJson\u003cT\u003e(runtimeType, this); } ///é€šè¿‡é™æ€æ–¹æ³•åˆ†å‘ static _getToJson\u003cT\u003e(Type type, data) { switch (type) { case StudentEntity: //æ³¨æ„è¿™é‡Œçš„å¼ºè½¬ return studentEntityToJson(data as StudentEntity); } return data as T; } } } è¿™é‡Œé¦–å…ˆæ‹¿åˆ°äº†runtimeTypeã€‚æ¯ä¸ªdartå¯¹è±¡éƒ½ç»§æ‰¿äºObjectï¼š @pragma(\"vm:entry-point\") class Object { @pragma(\"vm:recognized\", \"other\") const Object(); external bool operator ==(Object other); external int get hashCode; external String toString(); @pragma(\"vm:entry-point\") external dynamic noSuchMethod(Invocation invocation); external Type get runtimeType; } Objectä¸­æœ‰ä¸ªgetå±æ€§ï¼Œè€Œä¸”åŠ äº†externalå…³é”®å­—ä¿®é¥°ï¼Œè¡¨æ˜dartä¼šè‡ªåŠ¨å¤„ç†ï¼Œä¸éœ€è¦æˆ‘ä»¬æ¥å®ç°ã€‚ æ¥ä¸‹æ¥å»çœ‹studentEntityToJson(data)æ–¹æ³•ï¼Œä½äºç”Ÿæˆçš„student_entity_helper.dartä¸­ã€‚ ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:3:1","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"ç”Ÿæˆçš„helpè¾…åŠ©æ–‡ä»¶ Map\u003cString, dynamic\u003e studentEntityToJson(StudentEntity entity) { final Map\u003cString, dynamic\u003e data = new Map\u003cString, dynamic\u003e(); data['name'] = entity.name; return data; } å®Œå…¨å°±æ˜¯éå†äº†StudentEntityæ–‡ä»¶ä¸­çš„å±æ€§ï¼Œç„¶åç”Ÿæˆäº†è¿™ä¹ˆä¸ªæ–¹æ³•ï¼Œä¸€åˆ‡çš„æ ¸å¿ƒéƒ½æ˜¯å¼ºè½¬ã€‚è¿™è®©æˆ‘æƒ³èµ·äº†å·ç§°æœ€å¿«çš„FastJsonï¼ŒåŸç†ä¹Ÿæ˜¯å¼ºè½¬ã€‚ ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:3:2","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"ååºåˆ—åŒ– ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:4:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"JsonConvert T fromJson(Map\u003cString, dynamic\u003e json) { return _getFromJson\u003cT\u003e(runtimeType, this, json); } static _getFromJson\u003cT\u003e(Type type, data, json) { switch (type) { case StudentEntity: return studentEntityFromJson(data as StudentEntity, json) as T; } return data as T; } ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:4:1","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"ç”Ÿæˆçš„helpè¾…åŠ©æ–‡ä»¶ studentEntityFromJson(StudentEntity data, Map\u003cString, dynamic\u003e json) { if (json['name'] != null) { data.name = json['name'].toString(); } return data; } ä¸ç”¨çŒœï¼Œä¾ç„¶æ˜¯å¼ºè½¬ï¼Œå°å­¦ç”Ÿçš„æ€ç»´è®¾è®¡ï¼Œç”šè‡³æ¯”ä¸ä¸ŠfastJsonè€ƒè™‘çš„å¤šã€‚ ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:4:2","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"é¡¶å±‚åˆ—è¡¨å¤„ç† static M fromJsonAsT\u003cM\u003e(json) { //ç›´æ¥é€šè¿‡ç±»å‹åˆ¤æ–­ if (json is List) { return _getListChildType\u003cM\u003e(json); } else { return _fromJsonSingle\u003cM\u003e(json) as M; } } //å•å¯¹è±¡å¤„ç† static _fromJsonSingle\u003cM\u003e( json) { //çœ‹çœ‹ï¼Œå¤šç®€å•çš„è®¾è®¡ï¼Œä½†æ˜¯æ€ç»´è¿˜æ˜¯æŒºå·§å¦™çš„ String type = M.toString(); if(type == (StudentEntity).toString()){ return StudentEntity().fromJson(json); } return null; } //åˆ—è¡¨å¤„ç† static M _getListChildType\u003cM\u003e(List data) { if(\u003cStudentEntity\u003e[] is M){ return data.map\u003cStudentEntity\u003e((e) =\u003e StudentEntity().fromJson(e)).toList() as M; } //å•Šï¼Œè¿™ä¸ªå¹¼ç¨šçš„å¼‚å¸¸ throw Exception(\"not fond\"); } ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:5:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":["technology"],"content":"æ€»ç»“ çœ‹å®Œä»¥åï¼Œå°±è§‰å¾—å§ï¼Œæˆ‘ä»¬çš„é¡¹ç›®å°±æ˜¯ç”¨è¿™ä¹ˆä¸ªæ–°æ‰‹å†™å°±çš„æ’ä»¶ä¸Šï¼Œå¥”è·‘äº†å¿«ä¸€å¹´æ—¶é—´ã€‚ä¸æ˜¯è¯´è¿™ä¸œè¥¿ä¸å¥½ï¼Œä»–ç¡®å®æ˜¯ç”¨äº†ç®€å•ç›´æ¥çš„æ–¹å¼ï¼Œè§£å†³äº†flutterç¼–ç¨‹ä¸Šçš„ä¸€å¤§ç—›ç‚¹ã€‚è€Œä¸”å½“æˆ‘åˆšåˆšæ¥è§¦flutterçš„æ—¶å€™ï¼Œä¹Ÿè§‰å¾—è¿™ä¸ªä¸œè¥¿å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å½“æ—¶å¿ƒé‡Œæ€»æ˜¯è§‰å¾—ä¸é è°±ï¼Œæ‰€ä»¥æ²¡æœ‰é‡‡ç”¨ã€‚ç›´åˆ°è¢«åˆ«äººå¼ºæ¨äº†ï¼Œé‚£å°±ç”¨å§ï¼Œç„¶åå°±æ˜¯ç£•ç£•ç»Šç»Šçš„å„ç§å°é—®é¢˜ï¼Œä¹Ÿéƒ½å¥½è§£å†³ï¼Œç›´åˆ°â€”â€”å½“æˆ‘éœ€è¦éƒ¨ç½²devOpsçš„æ—¶å€™ï¼Œæˆ‘æƒŠå–œçš„å‘ç°jenkinsä¸èƒ½alt+jå•Šï¼ é€šè¿‡äº†è§£æºç ï¼Œä¹Ÿæ„Ÿè§‰åŸä½œè€…è™½ç„¶æ˜¯ä¸ªç¼–ç¨‹æ–°æ‰‹ï¼Œä½†æ˜¯ä»–åœ¨çªç ´é—®é¢˜çš„æ—¶å€™ç¡®å®æ˜¯ä¸‹äº†ä¸€ç•ªåŠŸå¤«çš„ï¼Œè€Œä¸”ä»–çš„çŸ¥è¯†é¢ä¹Ÿæ¯”è¾ƒå®½ï¼Œç”šè‡³é€šè¿‡ideaæ’ä»¶çš„æ–¹å¼è§£å†³é—®é¢˜ï¼Œä¹Ÿæ˜¯å¾ˆå‰å®³çš„äº†ã€‚ æœ€ä¸»è¦çš„æ˜¯ï¼Œç¡®å®è§£å†³äº†flutterå¯¹äºjsonè§£æä¸æ–¹ä¾¿çš„ç—›ç‚¹ï¼Œæ‰€ä»¥æœ€åè¿˜æ˜¯å¯¹ä½œè€…è¡¨ç¤ºï¼šéå¸¸æ„Ÿè°¢ï¼ ","date":"2021-06-25","objectID":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/:6:0","series":null,"tags":["flutter","dart"],"title":"FlutterJsonBeanFactoryåŸç†","uri":"/flutterjsonbeanfactory%E5%8E%9F%E7%90%86/"},{"categories":null,"content":" æ‰“å¼€å‘½ä»¤é¢æ¿ ctrl+shift+P è·³è½¬è®¾ç½®é¡µé¢ ctrl+, ","date":"2021-06-24","objectID":"/vscode%E5%BF%AB%E6%8D%B7%E9%94%AE%E8%AE%B0%E5%BF%86/:0:0","series":null,"tags":["vscode"],"title":"vscodeå¿«æ·é”®è®°å¿†","uri":"/vscode%E5%BF%AB%E6%8D%B7%E9%94%AE%E8%AE%B0%E5%BF%86/"},{"categories":[],"content":"æµç¨‹ ç‚¹å‡»æ¡Œé¢Appå›¾æ ‡ï¼ŒLauncherè¿›ç¨‹é‡‡ç”¨Binder IPCå‘system_serverè¿›ç¨‹å‘èµ·startActivityè¯·æ±‚ï¼› system_serverè¿›ç¨‹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå‘zygoteè¿›ç¨‹å‘é€åˆ›å»ºè¿›ç¨‹çš„è¯·æ±‚ï¼› Zygoteè¿›ç¨‹forkå‡ºæ–°çš„å­è¿›ç¨‹ï¼Œå³Appè¿›ç¨‹ï¼› Appè¿›ç¨‹ï¼Œé€šè¿‡Binder IPCå‘sytem_serverè¿›ç¨‹å‘èµ·attachApplicationè¯·æ±‚ï¼› system_serverè¿›ç¨‹åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œè¿›è¡Œä¸€ç³»åˆ—å‡†å¤‡å·¥ä½œåï¼Œå†é€šè¿‡binder IPCå‘Appè¿›ç¨‹å‘é€scheduleLaunchActivityè¯·æ±‚ï¼› Appè¿›ç¨‹çš„binderçº¿ç¨‹ï¼ˆApplicationThreadï¼‰åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡handlerå‘ä¸»çº¿ç¨‹å‘é€LAUNCH_ACTIVITYæ¶ˆæ¯ï¼› ä¸»çº¿ç¨‹åœ¨æ”¶åˆ°Messageåï¼Œé€šè¿‡å‘å°„æœºåˆ¶åˆ›å»ºç›®æ ‡Activityï¼Œå¹¶å›è°ƒActivity.onCreate()ç­‰æ–¹æ³•ã€‚ åˆ°æ­¤ï¼ŒAppä¾¿æ­£å¼å¯åŠ¨ï¼Œå¼€å§‹è¿›å…¥Activityç”Ÿå‘½å‘¨æœŸï¼Œæ‰§è¡Œå®ŒonCreate/onStart/onResumeæ–¹æ³•ï¼ŒUIæ¸²æŸ“ç»“æŸåä¾¿å¯ä»¥çœ‹åˆ°Appçš„ä¸»ç•Œé¢ã€‚ ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:1:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"zygoteï¼ˆforkè‡ªå·±ï¼Œä¸æ–­å¢ç”Ÿï¼‰ zygoteæ„æ€æ˜¯å—ç²¾åµï¼Œæœ‰åˆ†è£‚å¢ç”Ÿçš„æ„æ€ã€‚ å®ƒåœ¨Androidä¸­æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹. åœ¨linuxä¸­ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½æ˜¯ä»initè¿›ç¨‹ä¸­forkå‡ºæ¥çš„ã€‚å½“ç³»ç»Ÿå¯åŠ¨åä¼šè‡ªåŠ¨ä»initè¿›ç¨‹forkå‡ºä¸€ä¸ªzygoteè¿›ç¨‹ï¼Œå½“éœ€è¦å¯åŠ¨Appæ—¶ï¼Œä¼šä»è¿™ä¸ªåˆå§‹zygoteå†forkå‡ºæ–°çš„è¿›ç¨‹ã€‚ zygoteè¢«forkå‡ºæ¥è¦åšçš„å°±æ˜¯é€šè¿‡binderå‘sytem_serverå‘é€attachApplicationè¯·æ±‚ã€‚ æ‰€ä»¥è¿™è´§å°±ä¸¤ä¸ªä½œç”¨ï¼š forkè‡ªå·±ï¼› é€šçŸ¥sytem_serveré™„åŠ Applicationã€‚ ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:2:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"system_server system_serverä¹Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œè€Œä¸”ä¹Ÿæ˜¯ä»zygoteä¸­forkå‡ºæ¥çš„ã€‚ å½“ä»–æ”¶åˆ°åº”ç”¨çš„é™„åŠ è¯·æ±‚åï¼Œä¼šé€šè¿‡binderé€šçŸ¥åº”ç”¨è¿›ç¨‹å»scheduleLaunchActivityã€‚è¿™é‡Œèƒ½å¤Ÿäº†è§£åˆ°ï¼Œå…·ä½“å¯åŠ¨å“ªä¸ªactivityæ˜¯ç”±appè¿›ç¨‹è¿›ç¨‹å†³å®šçš„ã€‚ ç³»ç»Ÿé‡Œé¢å¾ˆå¤šé‡è¦çš„æœåŠ¡éƒ½æ˜¯åœ¨è¿™é‡Œå¯åŠ¨çš„ï¼Œæ¯”å¦‚ActivityManagerServiceã€PackageManagerServiceã€WindowManagerServiceç­‰ã€‚ ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:3:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"ActivityManagerService(AMS) æœåŠ¡ç«¯å¯¹è±¡ï¼Œè´Ÿè´£ç®¡ç†ç³»ç»Ÿä¸­æ‰€æœ‰Activityçš„ç”Ÿå‘½å‘¨æœŸã€‚ ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:4:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"Instrumentation æ¯ä¸ªActivityéƒ½æŒæœ‰Instrumentationå¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½†æ˜¯æ•´ä¸ªè¿›ç¨‹åªä¼šå­˜åœ¨ä¸€ä¸ªInstrumentationå¯¹è±¡ã€‚è¿™ä¸ªç±»å°±æ˜¯å®Œæˆå¯¹Applicationå’ŒActivityåˆå§‹åŒ–å’Œç”Ÿå‘½å‘¨æœŸçš„å·¥å…·ç±»ã€‚ ActivityThreadï¼Œä¾èµ–äºUIçº¿ç¨‹ã€‚Appå’ŒAMSæ˜¯é€šè¿‡Binderä¼ é€’ä¿¡æ¯çš„ï¼Œé‚£ä¹ˆActivityThreadå°±æ˜¯ä¸“é—¨ä¸AMSçš„å¤–äº¤å·¥ä½œçš„ã€‚ ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:5:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":[],"content":"ApplicationThread ","date":"2021-06-21","objectID":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/:6:0","series":["Androidè¿è¡Œæµç¨‹"],"tags":["Android"],"title":"Androidåº”ç”¨å¯åŠ¨æµç¨‹","uri":"/android%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":".apkæ–‡ä»¶çš„ç»„æˆ apkæ–‡ä»¶å…¶å®å°±æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢åŒ…å«ï¼š classes.dexç¼–è¯‘åçš„ä»£ç æ–‡ä»¶ï¼Œå®‰å“çš„å¯æ‰§è¡Œæ–‡ä»¶ resource.arsc ç¼–è¯‘åçš„èµ„æºæ–‡ä»¶ï¼ˆrawï¼‰ AndroidManifest.xml åº”ç”¨é…ç½®æ–‡ä»¶ resæ–‡ä»¶å¤¹ æœªç¼–è¯‘çš„åº”ç”¨èµ„æº META-infoæ–‡ä»¶å¤¹ ç­¾åï¼ŒåŒ…ä¿¡æ¯ç­‰ ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:1:0","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"æ‰“åŒ…æµç¨‹ aaptç¼–è¯‘æ‰“åŒ…èµ„æºæ–‡ä»¶ï¼Œç”ŸæˆR.javaã€‚ ç¼–è¯‘AndroidManifestæˆäºŒè¿›åˆ¶ï¼› ç¼–è¯‘layoutç­‰xmlæ–‡ä»¶ï¼Œç”ŸæˆR.javaï¼Œå’Œresource.arscæ–‡ä»¶ã€‚ å¤„ç†aidlæ–‡ä»¶ï¼Œç”Ÿæˆå¯¹åº”çš„.javaæ–‡ä»¶ã€‚ javaç¼–è¯‘å™¨ï¼ˆjavacï¼‰ç¼–è¯‘é¡¹ç›®æºç ï¼Œç”Ÿæˆ.classæ–‡ä»¶ï¼Œä½äºbin/classesç›®å½•ä¸‹ï¼› Androidç¼–è¯‘å™¨ä½¿ç”¨dxå·¥å…·æ•´åˆæ‰€æœ‰çš„classæ–‡ä»¶ç”Ÿæˆclasses.dexæ–‡ä»¶ï¼› ç”±apkbuilderæ‰“åŒ…ç”Ÿæˆapkï¼› å¯¹åŒ…ç­¾åï¼› å¯¹é½å¤„ç†ï¼Œå°†åŒ…ä¸­çš„èµ„æºæ–‡ä»¶è·ç¦»æ–‡ä»¶èµ·å§‹åç§»ä¸º4å­—èŠ‚çš„æ•´æ•°å€ï¼Œè¿™æ ·é€šè¿‡å†…å­˜æ˜ å°„è®¿é—®apkæ–‡ä»¶æ—¶å¯æé«˜é€Ÿåº¦ï¼Œå‡å°‘è¿è¡Œæ—¶å†…å­˜çš„ä½¿ç”¨ã€‚ ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:2:0","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"å®‰è£…æµç¨‹ æ ¸å¿ƒç±»ï¼šPMS(PackageManagerService) å¤åˆ¶apkåˆ°data/appç›®å½•ä¸‹ï¼Œè§£å‹å¹¶æ‰«æå®‰è£…åŒ…ï¼ŒæŠŠclasses.dexæ–‡ä»¶ä¿å­˜åˆ°dalvik-cacheç›®å½•ï¼Œå¹¶å†data/dataç›®å½•ä¸‹åˆ›å»ºå¯¹åº”çš„åº”ç”¨æ•°æ®ç›®å½•ï¼› è§£æAndroidManifinestï¼Œæå–ä¿¡æ¯å†™å…¥/data/system/packages.xmlï¼› LauncheråŠ è½½æ¡Œé¢å›¾æ ‡ï¼› ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:3:0","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"APKå®‰è£…æ–¹å¼ æ–¹å¼ æœ‰æ— ç•Œé¢ ç³»ç»Ÿåº”ç”¨ æ—  marketåº”ç”¨ä¸‹è½½ æ—  ç¬¬ä¸‰æ–¹ä¸‹è½½ æœ‰ adb æ—  ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:4:0","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"åç¼–è¯‘ ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:5:0","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"æµç¨‹ è§£å‹.apk ä½¿ç”¨dex2jarå°†class.dexè½¬ä¸ºjaråŒ… ä½¿ç”¨jd-guiåç¼–è¯‘jaråŒ… ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:5:1","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"åŠ å›ºæ‰‹æ®µ åæ¨¡æ‹Ÿå™¨ æ¨¡æ‹Ÿå™¨è¿è¡Œapkï¼Œå¯ä»¥ç›‘æ§åˆ°å„ç§è¡Œä¸ºï¼Œæ‰€ä»¥å‘ç°æ—¶æ¨¡æ‹Ÿå™¨åœ¨è¿è¡Œå°±ç›´æ¥é€€å‡ºã€‚ ä»£ç è™šæ‹ŸåŒ– è‡ªå»ºä¸€ä¸ªè™šæ‹Ÿæ‰§è¡Œå¼•æ“ï¼Œç„¶åæŠŠåŸç”Ÿçš„å¯æ‰§è¡Œä»£ç è½¬æ¢æˆè‡ªå®šä¹‰çš„æŒ‡ä»¤è¿›è¡Œè™šæ‹Ÿæ‰§è¡Œã€‚ åŠ å¯† æ ·æœ¬çš„éƒ¨åˆ†å¯æ‰§è¡Œä»£ç æ˜¯ä»¥å‹ç¼©æˆ–è€…åŠ å¯†çš„å½¢å¼å­˜åœ¨çš„ï¼Œæ¯”å¦‚è¢«ä¿æŠ¤è¿‡çš„ä»£ç è¢«åˆ‡å‰²æˆå¤šä¸ªå°æ®µï¼Œå‰é¢çš„ä¸€æ®µä»£ç å…ˆæŠŠåé¢çš„ä»£ç ç‰‡æ®µåœ¨å†…å­˜ä¸­è§£å¯†ï¼Œç„¶åå†æ‰§è¡Œè§£å¯†ä¹‹åçš„ä»£ç ã€‚ ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:5:2","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":"dexæ–‡ä»¶ç»“æ„ ","date":"2021-06-21","objectID":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/:5:3","series":null,"tags":["Android"],"title":"Apkæ‰“åŒ…å’Œå®‰è£…æµç¨‹","uri":"/apk%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"},{"categories":null,"content":".apkæ–‡ä»¶çš„ç»„æˆ apkæ–‡ä»¶å…¶å®å°±æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢åŒ…å«ï¼š classes.dexæ–‡ä»¶ resource ","date":"2021-06-21","objectID":"/%E5%8F%8D%E7%BC%96%E8%AF%91/:1:0","series":null,"tags":["Android"],"title":"Apkåç¼–è¯‘æµç¨‹","uri":"/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"categories":null,"content":"æ‰“åŒ…æµç¨‹ aaptç¼–è¯‘æ‰“åŒ…èµ„æºæ–‡ä»¶ï¼Œç”ŸæˆR.javaã€‚ ç¼–è¯‘AndroidManifestæˆäºŒè¿›åˆ¶ï¼› ç¼–è¯‘layoutç­‰xmlæ–‡ä»¶ï¼Œç”ŸæˆR.javaï¼Œå’Œresource.arscæ–‡ä»¶ã€‚ å¤„ç†aidlæ–‡ä»¶ï¼Œç”Ÿæˆå¯¹åº”çš„.javaæ–‡ä»¶ã€‚ javaç¼–è¯‘å™¨ï¼ˆjavacï¼‰ç¼–è¯‘é¡¹ç›®æºç ï¼Œç”Ÿæˆ.classæ–‡ä»¶ï¼Œä½äºbin/classesç›®å½•ä¸‹ï¼› Androidç¼–è¯‘å™¨ä½¿ç”¨dxå·¥å…·æ•´åˆæ‰€æœ‰çš„classæ–‡ä»¶ç”Ÿæˆclasses.dexæ–‡ä»¶ï¼› ç”±apkbuilderæ‰“åŒ…ç”Ÿæˆapkï¼› å¯¹åŒ…ç­¾åï¼› å¯¹é½å¤„ç†ï¼Œå°†åŒ…ä¸­çš„èµ„æºæ–‡ä»¶è·ç¦»æ–‡ä»¶èµ·å§‹åç§»ä¸º4å­—èŠ‚çš„æ•´æ•°å€ï¼Œè¿™æ ·é€šè¿‡å†…å­˜æ˜ å°„è®¿é—®apkæ–‡ä»¶æ—¶å¯æé«˜é€Ÿåº¦ï¼Œå‡å°‘è¿è¡Œæ—¶å†…å­˜çš„ä½¿ç”¨ã€‚ ","date":"2021-06-21","objectID":"/%E5%8F%8D%E7%BC%96%E8%AF%91/:2:0","series":null,"tags":["Android"],"title":"Apkåç¼–è¯‘æµç¨‹","uri":"/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"categories":null,"content":"å®‰è£…æµç¨‹ æ ¸å¿ƒç±»ï¼šPMS(PackageManagerService) å¤åˆ¶apkåˆ°data/appç›®å½•ä¸‹ï¼Œè§£å‹å¹¶æ‰«æå®‰è£…åŒ…ï¼ŒæŠŠclasses.dexæ–‡ä»¶ä¿å­˜åˆ°dalvik-cacheç›®å½•ï¼Œå¹¶å†data/dataç›®å½•ä¸‹åˆ›å»ºå¯¹åº”çš„åº”ç”¨æ•°æ®ç›®å½•ï¼› è§£æAndroidManifinestï¼Œæå–ä¿¡æ¯å†™å…¥/data/system/packages.xmlï¼› LauncheråŠ è½½æ¡Œé¢å›¾æ ‡ï¼› ","date":"2021-06-21","objectID":"/%E5%8F%8D%E7%BC%96%E8%AF%91/:3:0","series":null,"tags":["Android"],"title":"Apkåç¼–è¯‘æµç¨‹","uri":"/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"categories":null,"content":"APKå®‰è£…æ–¹å¼ æ–¹å¼ æœ‰æ— ç•Œé¢ ç³»ç»Ÿåº”ç”¨ æ—  marketåº”ç”¨ä¸‹è½½ æ—  ç¬¬ä¸‰æ–¹ä¸‹è½½ æœ‰ adb æ—  ","date":"2021-06-21","objectID":"/%E5%8F%8D%E7%BC%96%E8%AF%91/:4:0","series":null,"tags":["Android"],"title":"Apkåç¼–è¯‘æµç¨‹","uri":"/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"categories":null,"content":"ReentrantLockçš„ä½¿ç”¨ ReentrantLock lock = new ReentrantLock(); try { lock.lock(); } finally { lock.unlock(); } ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:1:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"AQSåŸç†æ¦‚è¿° private volatile int state; ç»´æŠ¤äº†ä¸€ä¸ªint stateä½œä¸ºçŠ¶æ€æœºï¼ŒCLHé˜Ÿåˆ—Nodeæš‚å­˜é˜»å¡çš„çº¿ç¨‹ï¼Œé€šè¿‡åˆ¤æ–­çŠ¶æ€ä»¥åŠCASå˜æ›´çŠ¶æ€æœºï¼Œéµå¾ªFIFOæ–¹å¼ä»é˜Ÿåˆ—ä¸­æ‹¿å‡ºçº¿ç¨‹è¿è¡Œã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:2:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"javaä¸­å†…ç½®çš„å®ç°ï¼š ReentrantLock(å¯é‡å…¥é”) Semaphoreï¼ˆä¿¡å·é‡ï¼‰ CountDownLatchï¼ˆè®¡æ•°é”ï¼Œè¿™ä¸ªæ˜¯è€æœ‹å‹äº†ï¼‰ ReentrantReadWriteLockå¯é‡å…¥è¯»å†™é” SynchronousQueue FutureTask ThreadPoolExecutorä¸­çš„work ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:3:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"AQSé”åˆ†ç±» ç‹¬å é”ï¼šä¹Ÿå«æ’ä»–é”ï¼Œå³é”åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹è·å–ï¼Œè‹¥ä¸€ä¸ªçº¿ç¨‹è·å–äº†é”ï¼Œåˆ™å…¶ä»–æƒ³è¦è·å–é”çš„çº¿ç¨‹åªèƒ½ç­‰å¾…ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ã€‚eg:å†™é”ï¼› å…±äº«é”ï¼šé”å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ï¼Œé”è¢«è·å–ä¸€æ¬¡ï¼Œåˆ™é”çš„è®¡æ•°å™¨+1ã€‚eg:è¯»é”ï¼› ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:4:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æ ¸å¿ƒæ–¹æ³• ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:5:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æŠ½è±¡æ–¹æ³•ï¼š tryAcquire ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå®ç°è¯¥æ–¹æ³•éœ€è¦æŸ¥è¯¢å½“å‰çŠ¶æ€å¹¶åˆ¤æ–­åŒæ­¥çŠ¶æ€æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œç„¶åå†è¿›è¡ŒCASè®¾ç½®åŒæ­¥çŠ¶æ€ã€‚ tryRelease ç‹¬å å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œç­‰å¾…è·å–åŒæ­¥çŠ¶æ€çš„çº¿ç¨‹å°†æœ‰æœºä¼šè·å–åŒæ­¥çŠ¶æ€ï¼› tryAcquireShared å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œè¿”å›\u003e=0çš„å€¼ï¼Œè¡¨ç¤ºè·å–æˆåŠŸï¼Œåä¹‹è·å–å¤±è´¥ tryReleaseShared å…±äº«å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€ isHeldExclusively å½“å‰åŒæ­¥å™¨æ˜¯å¦å†ç‹¬å æ¨¡å¼ä¸‹è¢«çº¿ç¨‹å ç”¨ï¼Œä¸€èˆ¬è¯¥æ–¹æ³•è¡¨ç¤ºæ˜¯å¦è¢«å½“å‰çº¿ç¨‹æ‰€ç‹¬å  è®°å¿†æ–¹æ³•ï¼šåªè®°Acquireå’Œreleaseï¼Œå‰é¢åŠ sharedå°±æ˜¯å…±äº«ï¼Œæ²¡æœ‰å°±æ˜¯ç‹¬å ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:5:1","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æ¨¡æ¿æ–¹æ³•ï¼š acquire ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œåˆ™ç”±è¯¥æ–¹æ³•è¿”å›ï¼Œå¦åˆ™ï¼Œå°†ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾…ï¼Œè¯¥æ–¹æ³•å°†ä¼šè°ƒç”¨é‡å†™çš„tryAcquire(int arg)æ–¹æ³•ã€‚ acquireInterruptibly ä¸ä¸Šé¢æ–¹æ³•ä½œç”¨ç›¸åŒï¼Œä½†æ˜¯è¯¥æ–¹æ³•å“åº”ä¸­æ–­ï¼Œå½“å‰çº¿ç¨‹æœªè·å–åˆ°åŒæ­¥çŠ¶æ€è€Œè¿›å…¥åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œåˆ™è¯¥æ–¹æ³•ä¼šæŠ›å‡ºInterruptedExceptionå¹¶è¿”å› tryAcquireNanos(int arg,Long nanos) åœ¨ä¸Šä¸ªæ–¹æ³•åŸºç¡€ä¸Šå¢åŠ äº†è¶…æ—¶é™åˆ¶ï¼Œå¦‚æœå½“å‰çº¿ç¨‹åœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œé‚£ä¹ˆå°†ä¼šè¿”å›falseï¼Œå¦‚æœè·å–åˆ°äº†è¿”å›true acquireShared(int arg) å…±äº«å¼çš„è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æœªè·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œå°†ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾…ï¼Œä¸ç‹¬å å¼è·å–çš„ä¸»è¦åŒºåˆ«æ˜¯åœ¨åŒæ„æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹è·å–åˆ°åŒæ­¥çŠ¶æ€ acquireSharedInterruptibly(int arg) ä¸ä¸Šä¸ªæ–¹æ³•ç›¸åŒï¼Œä½†æ˜¯ä¼šå“åº”ä¸­æ–­ tryAcquireSharedNanos åœ¨ä¸Šä¸ªæ–¹æ³•åŸºç¡€ä¸Šæ€åŠ äº†è¶…æ—¶æœºåˆ¶ releaseï¼ˆint arg) ç‹¬å å¼çš„é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€åï¼Œå°†åŒæ­¥é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åŒ…å«çš„çº¿ç¨‹å”¤é†’ releaseShared(int arg) å…±äº«å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:5:2","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"åŒæ­¥é˜Ÿåˆ—CLH åŒæ­¥é˜Ÿåˆ—æ˜¯ä¸€ä¸ªéµå¾ªFIFOï¼ˆfirst in first outï¼‰åŸåˆ™çš„åŒå‘é“¾è¡¨ã€‚åŒå‘é“¾åŒ…å«å‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹ã€‚é€šå¸¸ç”¨äºè‡ªæ—‹åŒæ­¥åœºæ™¯ã€‚ å…¥é˜Ÿæ—¶éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ‹¼æ¥åˆ°é˜Ÿå°¾ï¼Œè€Œå‡ºé˜Ÿæ—¶åªéœ€è¦æŠŠé˜Ÿé¦–ç½®ç©ºå°±è¡Œäº†ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:6:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"AQSä¸­çš„åŒæ­¥é˜Ÿåˆ— public abstract class AbstractQueuedSynchronizer extends AbstractOwnableSynchronizer implements java.io.Serializable { //é˜Ÿé¦–å¼•ç”¨ private transient volatile Node head; //é˜Ÿå°¾å¼•ç”¨ private transient volatile Node tail; static final class Node { // è¡¨ç¤ºçº¿ç¨‹å–æ¶ˆç”³è¯·é” static final int CANCELLED = 1; // è¡¨ç¤ºçº¿ç¨‹æ­£åœ¨ç”³è¯·é”ï¼Œç­‰å¾…è¢«åˆ†é… static final int SIGNAL = -1; // è¡¨ç¤ºçº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶è¾¾æˆï¼Œå†è¿›å…¥ä¸‹ä¸€é˜¶æ®µ static final int CONDITION = -2; // è¡¨ç¤ºæŠŠå¯¹å½“å‰èŠ‚ç‚¹è¿›è¡Œçš„æ“ä½œï¼Œç»§ç»­å¾€é˜Ÿåˆ—ä¼ æ’­ä¸‹å» static final int PROPAGATE = -3; // è¡¨ç¤ºå½“å‰çº¿ç¨‹çš„çŠ¶æ€ï¼Œæœ‰äº”ç§ volatile int waitStatus; // åŒå‘é“¾ä¹‹ä¸€ï¼šå‰é©±èŠ‚ç‚¹ volatile Node prev; // åŒå‘é“¾ä¹‹ä¸€ï¼šåç»§èŠ‚ç‚¹ volatile Node next; // èŠ‚ç‚¹ä»£è¡¨çš„çº¿ç¨‹ volatile Thread thread; // æ¡ä»¶é˜Ÿåˆ—â€”â€”å•å‘é“¾ï¼Œé“¾æ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ Node nextWaiter; } AQSé€šè¿‡è¿™ä¸ªåŒæ­¥é˜Ÿåˆ—æ¥ç»´æŠ¤å½“å‰è·å–é”å¤±è´¥å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ã€‚ åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œæ¯ä¸€ä¸ªnodeå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å–é”å¤±è´¥ï¼Œä¼šè¢«åŠ å…¥åˆ°é˜Ÿå°¾ã€‚åªæœ‰é“¾é¦–æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ï¼Œå…¶ä»–éƒ½åœ¨é˜»å¡ä¸­ã€‚å½“é˜Ÿé¦–çš„çº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼Œä¼šå”¤é†’ä¸‹ä¸€ä¸ªnodeï¼Œè€Œä¸‹ä¸€ä¸ªnodeä¸­çš„çº¿ç¨‹ä¼šå°è¯•è·å–é”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™å°†ä¸Šä¸€ä¸ªnodeç§»é™¤ï¼Œä½¿è‡ªå·±è‡³äºé“¾é¦–ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:6:1","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"Nodeçš„äº”ç§çŠ¶æ€ 0ï¼šæ–°ç»“ç‚¹å…¥é˜Ÿæ—¶çš„é»˜è®¤çŠ¶æ€ï¼› CANCELLED(1)ï¼šè¡¨ç¤ºå½“å‰ç»“ç‚¹å·²å–æ¶ˆè°ƒåº¦ã€‚å½“timeoutæˆ–è¢«ä¸­æ–­ï¼ˆå“åº”ä¸­æ–­çš„æƒ…å†µä¸‹ï¼‰ï¼Œä¼šè§¦å‘å˜æ›´ä¸ºæ­¤çŠ¶æ€ï¼Œè¿›å…¥è¯¥çŠ¶æ€åçš„ç»“ç‚¹å°†ä¸ä¼šå†å˜åŒ–ã€‚ SIGNAL(-1)ï¼šè¡¨ç¤ºåç»§ç»“ç‚¹åœ¨ç­‰å¾…å½“å‰ç»“ç‚¹å”¤é†’ã€‚åç»§ç»“ç‚¹å…¥é˜Ÿæ—¶ï¼Œä¼šå°†å½“å‰ç»“ç‚¹çš„çŠ¶æ€æ›´æ–°ä¸ºSIGNALã€‚ CONDITION(-2)ï¼šè¡¨ç¤ºç»“ç‚¹ç­‰å¾…åœ¨Conditionä¸Šï¼Œå½“å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†Conditionçš„signal()æ–¹æ³•åï¼ŒCONDITIONçŠ¶æ€çš„ç»“ç‚¹å°†ä»ç­‰å¾…é˜Ÿåˆ—è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…è·å–åŒæ­¥é”ã€‚ PROPAGATE(-3)ï¼šå…±äº«æ¨¡å¼ä¸‹ï¼Œå‰é©±ç»“ç‚¹ä¸ä»…ä¼šå”¤é†’å…¶åç»§ç»“ç‚¹ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½ä¼šå”¤é†’åç»§çš„åç»§ç»“ç‚¹ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:6:2","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"Nodeçš„åŒå‘é“¾ç»“æ„ ä»¥Nodeçš„ç»“æ„æ¥çœ‹ï¼Œprev å’Œ next å±æ€§å°†å¯ä»¥æ”¯æŒAQSå¯ä»¥å°†è¯·æ±‚é”çš„çº¿ç¨‹æ„æˆåŒå‘é˜Ÿåˆ—ï¼Œè€Œå…¥é˜Ÿåˆ—å‡ºé˜Ÿåˆ—ï¼Œä»¥åŠå…ˆå…¥å…ˆå‡ºçš„ç‰¹æ€§ï¼Œéœ€è¦æ–¹æ³•æ¥æ”¯æŒã€‚ private transient volatile Node head; private transient volatile Node tail; private Node enq(final Node node) { for (;;) { Node t = tail; if (t == null) { // è¿›å…¥åˆ°è¿™é‡Œï¼Œè¯´æ˜æ²¡æœ‰headèŠ‚ç‚¹ï¼ŒCASæ“ä½œåˆ›å»ºä¸€ä¸ªheadèŠ‚ç‚¹ if (compareAndSetHead(new Node())) // å¦‚æœè¿™é‡Œå¤±è´¥ï¼Œè¯´æ˜å‘ç”Ÿäº†å¹¶å‘ï¼Œä¼šå†æ¬¡å¾ªç¯å¹¶èµ°åˆ°ä¸‹é¢çš„else tail = head; } else { node.prev = t; // æŠŠNodeåŠ å…¥åˆ°å°¾éƒ¨ï¼Œä¿è¯åŠ å…¥åˆ°ä¸ºæ­¢ï¼Œå¹¶å‘ä¼šé‡èµ° if (compareAndSetTail(t, node)) { t.next = node; return t; } } } } AQSä¸­ï¼Œä»¥headä¸ºCLHé˜Ÿåˆ—å¤´éƒ¨ï¼Œä»¥tailä¸ºCLHé˜Ÿåˆ—å°¾éƒ¨ï¼Œå½“åŠ å…¥èŠ‚ç‚¹æ—¶ï¼Œé€šè¿‡CASå’Œè‡ªæ—‹ä¿è¯èŠ‚ç‚¹æ­£ç¡®å…¥é˜Ÿï¼ˆåŠ å…¥é˜Ÿå°¾ï¼‰ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:6:3","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"ReentrantLockåŸç† ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:7:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æ„é€ æ–¹æ³• //æ— å‚æ„é€ æ–¹æ³• public ReentrantLock() { sync = new NonfairSync(); } //æœ‰å‚æ„é€ æ–¹æ³• public ReentrantLock(boolean fair) { sync = fair ? new FairSync() : new NonfairSync(); } æ„é€ æ–¹æ³•ä¸­åªæ˜¯åˆå§‹åŒ–äº†ä¸€ä¸ªSyncï¼Œè¿™å°±æ˜¯ä¸ªAQSï¼š abstract static class Sync extends AbstractQueuedSynchronizer { private static final long serialVersionUID = -5179523762034025860L; é‚£ä¹ˆæ„é€ æ–¹æ³•çš„ä½œç”¨å°±æ˜¯åˆå§‹åŒ–Syncè¿™ä¸ªAQSï¼Œä½†æ˜¯æ ¹æ®å‚æ•°ï¼Œæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š FairSyncå…¬å¹³é”ï¼šä¹Ÿå«ç‹¬å é”ï¼Œå¤šä¸ªçº¿ç¨‹æŒ‰ç…§ç”³è¯·é”çš„é¡ºåºå»è·å¾—é”ï¼Œåç”³è¯·é”çš„çº¿ç¨‹éœ€è¦æ’é˜Ÿï¼Œç­‰å®ƒä¹‹å‰çš„çº¿ç¨‹è·å¾—é”å¹¶é‡Šæ”¾åï¼Œå®ƒæ‰èƒ½è·å¾—é”ï¼› NonfairSyncéå…¬å¹³é”ï¼šçº¿ç¨‹è·å¾—é”çš„é¡ºåºäºç”³è¯·é”çš„é¡ºåºæ— å…³ï¼Œç”³è¯·é”çš„çº¿ç¨‹å¯ä»¥ç›´æ¥å°è¯•è·å¾—é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:7:1","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"lock() //æ³¨æ„è¿™é‡Œä¼ é€’äº†1 public void lock() { sync.acquire(1); } æ³¨æ„ï¼Œlockæ—¶å›ºå®šä¼ äº†æ•´æ•°1ã€‚ åŠ é”ï¼Œå°±æ˜¯è°ƒç”¨äº†AQSçš„acquire(int arg)æ–¹æ³•ã€‚å†…éƒ¨å®ç°æ˜¯ï¼š public final void acquire(int arg) { if (!tryAcquire(arg) \u0026\u0026 acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) //ä¸­æ–­å½“å‰çº¿ç¨‹ selfInterrupt(); } tryAcquire(arg)å°è¯•è·å–é”ï¼› å¦‚æœæ‹¿ä¸åˆ°ï¼Œåˆ™addWaiter(Node.EXCLUSIVE)åˆ›å»ºä¸€ä¸ªç­‰å¾…èŠ‚ç‚¹ï¼› ç„¶åacquireQueued(waiter)æ·»åŠ è¿›ç­‰å¾…é˜Ÿåˆ—ï¼› æœ€åä¸­æ–­ã€‚ tryAxquire(int arg)å°è¯•è·å–é” è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å°è¯•è·å–é”ï¼Œè¿”å›Booleanè¡¨ç¤ºæ˜¯å¦æˆåŠŸè·å–é”ï¼Œè¿™æ˜¯ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä»–åœ¨å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°æœ‰å·®åˆ«ã€‚ å½“æˆ‘çœ‹å®Œéƒ¨åˆ†æºç åï¼Œä¸å¾—ä¸ä½©æœè€å¤–çš„å‘½åèƒ½åŠ›ï¼Œtryç”¨çš„éå¸¸å‡†ç¡®ï¼ŒçœŸçš„åªæ˜¯å°è¯•è·å–é”ï¼Œå¹¶ä¸ä¿è¯ä¸€å®šèƒ½è·å–åˆ°é”ã€‚ å…¬å¹³é” static final class FairSync extends Sync { private static final long serialVersionUID = -3000897897090466540L; //å°è¯•è·å–é” @ReservedStackAccess protected final boolean tryAcquire(int acquires) { //æ‹¿åˆ°å½“å‰çº¿ç¨‹ final Thread current = Thread.currentThread(); //æ‹¿åˆ°AQSçš„çŠ¶æ€ int c = getState(); if (c == 0) { //å¦‚æœAQSæ˜¯åˆå§‹åŒ–çŠ¶æ€ if (!hasQueuedPredecessors() \u0026\u0026 compareAndSetState(0, acquires)) { //å¦‚æœæ²¡æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œå¹¶ä¸”CASç”±0åˆ°1é€šè¿‡ï¼ŒæŠŠå½“å‰çº¿ç¨‹ç¼“å­˜ä¸ºç‹¬å çº¿ç¨‹ setExclusiveOwnerThread(current); return true; } } else if (current == getExclusiveOwnerThread()) { //å¦‚æœå½“å‰çº¿ç¨‹å°±æ˜¯ç‹¬å çº¿ç¨‹ int nextc = c + acquires; if (nextc \u003c 0) throw new Error(\"Maximum lock count exceeded\"); //å°±é‡ç½®AQSçŠ¶æ€è®¡æ•° setState(nextc); return true; } return false; } } //æŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾… public final boolean hasQueuedPredecessors() { Node h, s; if ((h = head) != null) { //å¦‚æœheadä¸ä¸ºç©ºï¼Œ if ((s = h.next) == null || s.waitStatus \u003e 0) { //å¦‚æœheadçš„nextä¸ä¸ºç©ºï¼Œæˆ–è€…headå¤„äºç­‰å¾…çŠ¶æ€ s = null; for (Node p = tail; p != h \u0026\u0026 p != null; p = p.prev) { //ä»é˜Ÿå°¾éå†åˆ°é˜Ÿé¦– if (p.waitStatus \u003c= 0) //æ‰¾åˆ°æœ€æ—©å¼€å§‹ç­‰å¾…çš„node s = p; } } if (s != null \u0026\u0026 s.thread != Thread.currentThread()) //æœ€åæ‰¾åˆ°[æœ€æ—©å¼€å§‹ç­‰å¾…çš„node]å¹¶ä¸”å®ƒæ‰€åœ¨çš„çº¿ç¨‹ä¸æ˜¯å½“å‰çº¿ç¨‹ï¼Œå¦‚æœæœ‰å°±è¿”å›true return true; } return false; } åœ¨tryAcquireæ–¹æ³•ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­AQSçš„stateæ˜¯å¦ä¸º0ï¼Œä¸º0è¡¨ç¤ºå½“å‰æ²¡æœ‰çº¿ç¨‹æŒæœ‰é”ï¼Œåœ¨é”å¾…å‘½çš„çŠ¶æ€ä¸‹æ‰ä¼šå»è·å–é”ã€‚ ç„¶ååˆ¤æ–­æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…é”ï¼Œæ²¡æœ‰çš„è¯å°±CASé‚£ä¸ªstateç”±0åˆ°1ï¼ˆé˜²æ­¢å…¶ä»–çº¿ç¨‹ç«äº‰é”ï¼Œå…ˆåˆ°å…ˆå¾—ï¼‰ï¼Œé€šè¿‡å°±æŠŠå½“å‰çº¿ç¨‹è®¾ç½®ä¸ºAQSçš„ç‹¬å çº¿ç¨‹ï¼Œè¿”å›trueï¼Œè¿™æ ·å°±ä½¿å¾—çº¿ç¨‹ç”³è¯·åˆ°äº†é”ã€‚ å¦‚æœä¸æ˜¯åˆå§‹åŒ–çŠ¶æ€ï¼Œåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ç‹¬å çº¿ç¨‹ï¼Œæ˜¯çš„è¯ç›´æ¥è¿”å›trueï¼Œå¹¶ä¸”æŠŠstateåŠ 1å¹¶è¿”å›trueã€‚è¿™é‡Œå……åˆ†ä½“ç°äº†å¯é‡å…¥é”çš„ç‰¹ç‚¹ã€‚ é‚£ä¹ˆå¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…é”ä¼šæ€æ ·å‘¢ï¼Ÿå½“å‰çº¿ç¨‹ä¼šè·å–é”å¤±è´¥ï¼Œä¼šè¿”å›falseï¼Œç„¶åAQSä¼šæŠŠå½“å‰çº¿ç¨‹å°è£…æˆNodeï¼Œæ·»åŠ åˆ°CLHçš„é˜Ÿå°¾ï¼Œåé¢ä¼šè¯¦ç»†è¯´æ˜ã€‚ hasQueuedPredecessorsæ–¹æ³•è´Ÿè´£ä»é˜Ÿå°¾éå†åˆ°é˜Ÿé¦–ï¼Œæ‰¾åˆ°æœ€æ—©å¼€å§‹ç­‰å¾…å¹¶ä¸”æŒæœ‰å…¶ä»–çº¿ç¨‹çš„nodeï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è¯´æ˜æœ‰çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ã€‚ æ€»ç»“ä¸€ä¸‹å¯é‡å…¥é”çš„åŸç†ï¼š é€šè¿‡CASæ”¹å˜stateå¹¶ä¸”åˆ¤æ–­stateçŠ¶æ€ï¼Œé¿å…é”ç«äº‰ï¼› å·²ç»æŒæœ‰é”çš„çº¿ç¨‹å¯å…é™¤CASå†æ¬¡è·å–é”ã€‚ å†æ€»ç»“ä¸€ä¸‹å…¬å¹³é”çš„åŸç†ï¼šåˆ¤æ–­å½“å‰é”æ˜¯å¦è¢«å ç”¨ï¼Œå†éå†CLHé˜Ÿåˆ—ï¼Œå¦‚æœå­˜åœ¨å¤„äºç­‰å¾…çŠ¶æ€çš„å…¶ä»–çº¿ç¨‹ï¼Œåˆ™å½“å‰çº¿è·å–é”å¤±è´¥ï¼Œæ”¹å˜ä¸ºç­‰å¾…çŠ¶æ€ï¼Œæ·»åŠ åˆ°CLHçš„é˜Ÿå°¾ï¼Œä»¥ä¿è¯æ¯ä¸ªçº¿ç¨‹æŒ‰åºæŒæœ‰é”ã€‚ éå…¬å¹³é” static final class NonfairSync extends Sync { private static final long serialVersionUID = 7316153563782823691L; protected final boolean tryAcquire(int acquires) { //è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• return nonfairTryAcquire(acquires); } } nonfairTryAcquireæ–¹æ³•ä½äºçˆ¶ç±»Syncä¸­ï¼Œé‚£ä¹ˆè¿™é‡Œä¹Ÿä½“ç°äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ final boolean nonfairTryAcquire(int acquires) { //æ‹¿åˆ°å½“å‰çº¿ç¨‹ final Thread current = Thread.currentThread(); //æ‹¿åˆ°AQSä¸­çš„state int c = getState(); if (c == 0) { //å¦‚æœæ˜¯åˆå§‹çŠ¶æ€ if (compareAndSetState(0, acquires)) { //å¦‚æœCASç”±0åˆ°1é€šè¿‡ï¼Œé‚£ä¹ˆå°±æŠŠå½“å‰çº¿ç¨‹è®¾ç½®ä¸ºå¤–éƒ¨çº¿ç¨‹ï¼Œåˆ°è¿™é‡Œ setExclusiveOwnerThread(current); return true; } } else if (current == getExclusiveOwnerThread()) { int nextc = c + acquires; if (nextc \u003c 0) // overflow throw new Error(\"Maximum lock count exceeded\"); setState(nextc); return true; } return false; } ä»ä»£ç æ¥çœ‹ï¼Œéå…¬å¹³é”å¹¶æ²¡æœ‰åˆ¤æ–­æ˜¯å¦æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…é”ï¼Œæ‰€ä»¥å½“æ–°çº¿ç¨‹ç”³è¯·é”æ—¶ï¼Œèƒ½æ‹¿åˆ°é”å°±æ‹¿ï¼Œæ‹¿ä¸åˆ°å†åŠ å…¥é˜Ÿåˆ—å»ç­‰ã€‚ ReentrantLockçš„å…¬å¹³ä¸éå…¬å¹³é”éƒ½æ˜¯å¯é‡å…¥çš„ å…¬å¹³ä¸éå…¬å¹³é”çš„åŒºåˆ« å…¬å¹³é”ï¼šå¤šä¸ªçº¿ç¨‹æŒ‰ç…§ç”³è¯·é”çš„é¡ºåºå»è·å¾—é”ï¼Œçº¿ç¨‹ä¼šç›´æ¥è¿›å…¥é˜Ÿåˆ—å»æ’é˜Ÿï¼Œæ°¸è¿œéƒ½æ˜¯é˜Ÿé¦–çš„çº¿ç¨‹æ‰èƒ½å¾—åˆ°é”ã€‚ ä¼˜ç‚¹ï¼šæ‰€æœ‰çš„çº¿ç¨‹éƒ½èƒ½å¾—åˆ°èµ„æºï¼Œä¸ä¼šé¥¿æ­»åœ¨é˜Ÿåˆ—ä¸­ã€‚ ç¼ºç‚¹ï¼šååé‡ä¼šä¸‹é™å¾ˆå¤šï¼Œé˜Ÿåˆ—é‡Œé¢é™¤äº†ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶ä»–çš„çº¿ç¨‹éƒ½ä¼šé˜»å¡ï¼Œcpuå”¤é†’é˜»å¡çº¿ç¨‹çš„å¼€é”€ä¼šå¾ˆå¤§ã€‚ éå…¬å¹³é”ï¼šå¤šä¸ªçº¿ç¨‹å»è·å–é”çš„æ—¶å€™ï¼Œä¼šç›´æ¥å»å°è¯•è·å–ï¼Œè·å–ä¸åˆ°ï¼Œå†å»è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œå¦‚æœèƒ½è·å–åˆ°ï¼Œå°±ç›´æ¥è·å–åˆ°é”ã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥å‡å°‘CPUå”¤é†’çº¿ç¨‹çš„å¼€é”€ï¼ŒCPUä¹Ÿä¸å¿…å–å”¤é†’æ‰€æœ‰çº¿ç¨‹ï¼Œä¼šå‡å°‘å”¤èµ·çº¿ç¨‹çš„æ•°é‡ã€‚ ç¼ºç‚¹ï¼šä½ ä»¬å¯èƒ½ä¹Ÿå‘ç°äº†ï¼Œè¿™æ ·æœ‰å¯èƒ½å¯¼è‡´é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ä¸€ç›´è·å–ä¸åˆ°é”æˆ–è€…é•¿æ—¶é—´è·å–ä¸åˆ°é”ï¼Œå¯¼è‡´é¥¿æ­»ã€‚ addWaiter() æˆ‘ä»¬åœ¨åˆ†æå…¶å…¥åˆ—æ“ä½œåœ¨ç®€å•ä¸è¿‡ã€‚æ— éå°±æ˜¯å°†tailï¼ˆä½¿ç”¨CASä¿è¯åŸå­æ“ä½œï¼‰æŒ‡å‘æ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹çš„prevæŒ‡å‘é˜Ÿåˆ—ä¸­æœ€åä¸€èŠ‚ç‚¹ï¼ˆæ—§çš„tailèŠ‚ç‚¹ï¼‰ï¼ŒåŸé˜Ÿåˆ—ä¸­æœ€åä¸€èŠ‚ç‚¹çš„nextèŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ä»¥æ­¤æ¥å»ºç«‹è”ç³»ï¼Œæ¥å¼ å›¾å¸®åŠ©å¤§å®¶ç†è§£ã€‚ æ‘˜è‡ªï¼šhttps://www.jianshu.com/p/6fc0601ffe34 //ç©ºå ä½ static final Node EXCLUSIVE = null; /** * æŠŠå½“å‰çº¿ç¨‹å°è£…æˆnodeç½®äºé˜Ÿå°¾ * @param modeå›ºå®šæ˜¯null **/ private Node addWaiter(Node mode) { //åˆ›å»ºä¸€ä¸ªæŒæœ‰å½“å‰çº¿ç¨‹çš„node Node node = new Node(Thread.currentThread(), mode); Node pred = tail; if (pred != null) { //å¦‚æœtailå­˜åœ¨ï¼Œå°±æŠŠæ–°nodeç½®äºé˜Ÿå°¾ node.prev = pred; //å˜æ›´tailä¸ºæ–°åˆ›å»ºçš„node if (compareAndSetTail(pred, node)) { pred.next = node; return node; } } enq(node); return node; } //é€šè¿‡è®¾ç½®å¤´å°¾èŠ‚ç‚¹ï¼Œå»ºç«‹æ–°çš„é˜Ÿåˆ—é¡ºåº private Node enq(final Node node) { for (;;) { //æ‹¿åˆ°ç¼“å­˜çš„tail Node t = tail; if (t == null) { //å¦‚æœæ²¡æœ‰ç¼“å­˜å°±åˆå§‹åŒ–headå’Œtail if (compareAndSetHead(new Node())) tail = h","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:7:2","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"unlock() åŒæ­¥é˜Ÿåˆ—ï¼ˆCLHï¼‰éµå¾ªFIFOï¼Œé¦–èŠ‚ç‚¹æ˜¯è·å–åŒæ­¥çŠ¶æ€çš„èŠ‚ç‚¹ï¼Œé¦–èŠ‚ç‚¹çš„çº¿ç¨‹é‡Šæ”¾åŒæ­¥çŠ¶æ€åï¼Œå°†ä¼šå”¤é†’å®ƒçš„åç»§èŠ‚ç‚¹ï¼ˆnextï¼‰ï¼Œè€Œåç»§èŠ‚ç‚¹å°†ä¼šåœ¨è·å–åŒæ­¥çŠ¶æ€æˆåŠŸæ—¶å°†è‡ªå·±è®¾ç½®ä¸ºé¦–èŠ‚ç‚¹ï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸ç®€å•ã€‚å¦‚ä¸‹å›¾ï¼š è®¾ç½®é¦–èŠ‚ç‚¹æ˜¯é€šè¿‡è·å–é”æˆåŠŸçš„çº¿ç¨‹æ¥å®Œæˆçš„ï¼ˆè·å–åŒæ­¥çŠ¶æ€æ˜¯é€šè¿‡CASæ¥å®Œæˆï¼‰ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–åˆ°é”ï¼Œå› æ­¤è®¾ç½®å¤´èŠ‚ç‚¹çš„æ“ä½œå¹¶ä¸éœ€è¦CASæ¥ä¿è¯ï¼Œåªéœ€è¦å°†é¦–èŠ‚ç‚¹è®¾ç½®ä¸ºå…¶åŸé¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å¹¶æ–­å¼€åŸé¦–èŠ‚ç‚¹çš„nextï¼ˆç­‰å¾…GCå›æ”¶ï¼‰å³å¯ã€‚ public void unlock() { sync.release(1); } public final boolean release(int arg) { //å°è¯•é‡Šæ”¾é” if (tryRelease(arg)) { Node h = head; if (h != null \u0026\u0026 h.waitStatus != 0) unparkSuccessor(h); return true; } return false; } //å°è¯•é‡Šæ”¾é” @ReservedStackAccess protected final boolean tryRelease(int releases) { //æ£€æŸ¥çŠ¶æ€æœºï¼Œæ˜¯å¦å¯é‡Šæ”¾ int c = getState() - releases; if (Thread.currentThread() != getExclusiveOwnerThread()) //å¦‚æœå½“å‰çº¿ç¨‹ä¸æ˜¯ç‹¬å çº¿ç¨‹ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ throw new IllegalMonitorStateException(); //æ”¹æ ‡è®°ä½ boolean free = false; if (c == 0) { free = true; //é‡Šæ”¾ç‹¬å çº¿ç¨‹ setExclusiveOwnerThread(null); } //å˜æ›´çŠ¶æ€æœº setState(c); return free; } //å”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹ private void unparkSuccessor(Node node) { int ws = node.waitStatus; if (ws \u003c 0) //é‡ç½®nodeçš„çŠ¶æ€ node.compareAndSetWaitStatus(ws, 0); Node s = node.next; if (s == null || s.waitStatus \u003e 0) { s = null; for (Node p = tail; p != node \u0026\u0026 p != null; p = p.prev) if (p.waitStatus \u003c= 0) s = p; } //å¦‚æœå­˜åœ¨nextï¼Œå”¤é†’ä¸‹ä¸ªnodeçº¿ç¨‹ if (s != null) LockSupport.unpark(s.thread); } å…¶å®æˆ‘è§‰å¾—è¿™é‡Œå°±æ²¡å¿…è¦ç»†çœ‹äº†ï¼Œç»†çœ‹ä¹Ÿè®°ä¸ä½ã€‚ unlock()æ–¹æ³•ä¸»è¦æ˜¯é€šè¿‡AQSçš„release(int arg)å®ç°çš„ï¼Œå†…éƒ¨æœºåˆ¶æ— éå°±æ˜¯é‡ç½®çŠ¶æ€æœºï¼Œé‡Šæ”¾ç‹¬å çº¿ç¨‹ï¼Œå¹¶ä¸”å”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œå”¤é†’çº¿ç¨‹çš„æ–¹å¼ä¹Ÿå¿…ç„¶æ˜¯LockSupport.unpark(s.thread)ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:7:3","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"å…±äº«é”çš„ç”³è¯· å…ˆå›é¡¾ä¸€ä¸‹ç‹¬å é”çš„ç”³è¯·ï¼š public final void acquire(int arg) { if (!tryAcquire(arg) \u0026\u0026 acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) //ä¸­æ–­å½“å‰çº¿ç¨‹ selfInterrupt(); } çº¿ç¨‹ç”³è¯·ç‹¬å é”å¤±è´¥ä¼šé€šè¿‡acquireQueuedè¿›å…¥é˜Ÿåˆ—ç­‰å¾…ã€‚ å…±äº«é”çš„ç”³è¯·åˆ™è¦ç®€å•çš„å¤šï¼š public final void acquireShared(int arg) { //è°ƒç”¨æŠ½è±¡æ–¹æ³•tryAcquireSharedï¼Œå¯ä»¥çœ‹åˆ°è¿”å›äº†ä¸€ä¸ªè®¡æ•°ï¼Œå¦‚æœè®¡æ•°å¤§äº0å°±è¡¨ç¤ºæˆåŠŸæ‹¿åˆ°é” if (tryAcquireShared(arg) \u003c 0) //å¦‚æœè¿”å›å°äº0ä¼šè°ƒç”¨doAcquireShared doAcquireShared(arg); } static final Node SHARED = new Node(); private void doAcquireShared(int arg) { //åŒæ ·è°ƒç”¨äº†addWaiterï¼Œä½†æ˜¯ä¼ é€’çš„ä¸æ˜¯nullè€Œæ˜¯ä¸€ä¸ªç©ºNodeï¼ˆï¼‰ï¼Œè¿™æ ·å°±ä¿è¯Node.SHAREDä¸€ç›´æ˜¯[å½“å‰]èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ final Node node = addWaiter(Node.SHARED); boolean failed = true; try { boolean interrupted = false; for (;;) { //æ‹¿åˆ°ä¸Šä¸€èŠ‚ç‚¹ final Node p = node.predecessor(); if (p == head) { //å¦‚æœä¸Šä¸ªèŠ‚ç‚¹æ˜¯head //å†æ¬¡å°è¯•ç”³è¯·é” int r = tryAcquireShared(arg); if (r \u003e= 0) { //å¦‚æœæ‹¿åˆ°é”å°±é‡Šæ”¾head setHeadAndPropagate(node, r); p.next = null; // help GC if (interrupted) selfInterrupt(); failed = false; return; } } if (shouldParkAfterFailedAcquire(p, node) \u0026\u0026 parkAndCheckInterrupt()) //é˜»å¡çº¿ç¨‹ï¼Œå¹¶æ£€æµ‹çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ interrupted = true; } } finally { if (failed) cancelAcquire(node); } } å…ˆè°ƒç”¨addWaiter()å‘é˜Ÿå°¾æ·»åŠ ä¸€ä¸ªç©ºçš„nodeå¹¶åŒ…è£…å½“å‰çš„threadï¼Œç„¶åç»™è¿™ä¸ªç©ºçš„èŠ‚ç‚¹å¢åŠ åç»§èŠ‚ç‚¹Node.SHAREDã€‚å†è¿›å…¥è‡ªæ—‹ï¼Œä»å½“å‰èŠ‚ç‚¹å‘ä¸Šéå†ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯headï¼Œå°±å°è¯•ç”³è¯·é”ï¼Œç”³è¯·æˆåŠŸå°±é‡Šæ”¾headï¼Œå¹¶æŠŠè‡ªå·±ç½®äºé˜Ÿé¦–ã€‚å…¶ä»–ä½ç½®çš„çº¿ç¨‹ä¼šåˆ¤æ–­çŠ¶æ€æ˜¯å¦åº”è¯¥è¢«é˜»å¡ï¼Œç„¶åå†è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ æˆ‘ä»¬çœ‹åˆ°ï¼Œå…±äº«é”å…¨ç¨‹æ²¡æœ‰åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ç‹¬å çº¿ç¨‹ï¼Œåªè¦è°ƒç”¨tryAcquireShared()æ–¹æ³•ä¸è¿”å›è´Ÿæ•°ï¼Œå°±èƒ½æˆåŠŸç”³è¯·åˆ°é”ï¼Œè€Œä¸”åŒä¸€æ—¶é—´å¯ä»¥å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‹¿åˆ°é”ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:7:4","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"è‡ªå®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„é‡å…¥é” ä¸Šé¢ç»ˆäºæŠŠæºç å·´æ‹‰å®Œäº†ï¼Œä½†æ˜¯æ•´ä¸ªæµç¨‹è®°ä¸ä½ã€‚è®°ä¸ä½æ€ä¹ˆåŠï¼Ÿæƒ³åŠæ³•ï¼Œæ‰€ä»¥æˆ‘å†³å®šè‡ªå·±å®ç°ä¸€ä¸ªæœ€ç®€å•çš„å¯é‡å…¥éå…¬å¹³é”ï¼š /** * æˆ‘è‡ªå·±å®ç°çš„éå…¬å¹³é” */ public class MyLock { private final Sync sync; public MyLock() { this.sync = new Sync(); } public void lock() { sync.acquire(1); } public void unlock() { sync.release(1); } /** * AQSå®ç°ç±» */ class Sync extends AbstractQueuedSynchronizer { /** * é‡å†™tryAcquire */ @Override protected boolean tryAcquire(int acquires) { //æ‹¿åˆ°å½“å‰çº¿ç¨‹ final Thread current = Thread.currentThread(); //æ‹¿åˆ°AQSçš„çŠ¶æ€æœº int c = getState(); //åˆ¤æ–­çŠ¶æ€æœºå¦‚æœæ˜¯åˆå§‹çŠ¶æ€ if (c == 0) { //CASç”±0åˆ°1 if (compareAndSetState(0, acquires)) { //å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç‹¬å çº¿ç¨‹ setExclusiveOwnerThread(current); return true; } } else if (current == getExclusiveOwnerThread()) { //å¦‚æœå½“å‰çº¿ç¨‹å·²ç»æ˜¯ç‹¬å çº¿ç¨‹ï¼Œæ”¹å˜AQSçŠ¶æ€ int nextc = c + acquires; setState(nextc); return true; } return false; } /** * é‡å†™tryRelease */ @Override protected boolean tryRelease(int release) { int c = getState() - release; boolean free = false; if (c == 0) { free = true; //é‡Šæ”¾ç‹¬å çº¿ç¨‹ setExclusiveOwnerThread(null); } //æ”¹å˜çŠ¶æ€æœº setState(c); return free; } } } ä»è¿™é‡Œçœ‹å‡ºï¼Œåˆ©ç”¨AQSå®ç°ä¸€ä¸ªé”çš„æµç¨‹ï¼š ç»§æ‰¿AQSï¼› é‡å†™tryAcquireï¼Œå½“å‰çº¿ç¨‹ç½®ä¸ºç‹¬å çº¿ç¨‹ï¼ŒsetState()å˜æ›´çŠ¶æ€ï¼› é‡å†™tryRelease(int release)ï¼Œé‡Šæ”¾ç‹¬å çº¿ç¨‹ï¼ŒsetState()å˜æ›´çŠ¶æ€ã€‚ ç„¶åæ¿€åŠ¨çš„è¯•äº†ä¸€ä¸‹ï¼š private static int num; private static MyLock myLock = new MyLock(); public static void main(String[] args) throws Exception { Thread t1 = new Thread() { @Override public void run() { concat(); } }; Thread t2 = new Thread() { @Override public void run() { concat(); } }; t1.setName(\"t1\"); t2.setName(\"t2\"); t1.start(); t2.start(); } private static void concat() { try { myLock.lock(); for (int i = 0; i \u003c 10; i++) { try { Thread.sleep(3000); num++; System.out.println(\"çº¿ç¨‹\" + Thread.currentThread().getName() + \"æŠŠnumæ”¹ä¸º\" + num); } catch (InterruptedException e) { // TODO Auto-generated catch block e.printStackTrace(); } } } finally { myLock.unlock(); } } æœ€åæƒ´æƒ´ä¸å®‰çš„çœ‹äº†ä¸‹ç»“æœï¼š çº¿ç¨‹t1æŠŠnumæ”¹ä¸º1 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º2 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º3 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º4 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º5 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º6 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º7 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º8 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º9 çº¿ç¨‹t1æŠŠnumæ”¹ä¸º10 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º11 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º12 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º13 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º14 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º15 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º16 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º17 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º18 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º19 çº¿ç¨‹t2æŠŠnumæ”¹ä¸º20 æ²¡é—®é¢˜ï¼Œi did it ! ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:8:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"AQSçš„æ¡ä»¶é˜Ÿåˆ— ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:9:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æ¡ä»¶é˜Ÿåˆ—çš„ä½¿ç”¨VSObjectç›‘è§†å™¨æ–¹æ³• å¯¹è±¡ç›‘è§†å™¨é”ä½¿ç”¨ public class App { // åˆ›å»ºä¸€æŠŠé” private static Object obj = new Object(); public static void main(String[] args) { Thread t1 = new Thread() { @Override public void run() { //ä¸Šé” synchronized (obj) { try { System.out.println(getName() + \"å¼€å§‹ç­‰å¾…\"); //é˜»å¡ç­‰å¾… obj.wait(); System.out.println(getName() + \"å·²è¢«å”¤é†’\"); } catch (InterruptedException e) { e.printStackTrace(); } } } }; t1.setName(\"t1\"); Thread t2 = new Thread() { @Override public void run() { //ä¸Šé” synchronized (obj) { try { System.out.println(getName() + \"å·²å¼€å§‹æ‰§è¡Œï¼Œ3ç§’åå°†å”¤é†’t1\"); sleep(3000); //å”¤é†’ obj.notify(); } catch (InterruptedException e) { e.printStackTrace(); } } } }; t2.setName(\"t2\"); t1.start(); t2.start(); } } ç”¨æ³•è§£æï¼š é˜»å¡waitå’Œå”¤é†’notifyéƒ½å¿…é¡»åœ¨æŒæœ‰é”çš„å‰æä¸‹è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ¥å¼‚å¸¸ï¼› é€šè¿‡wait()é˜»å¡çº¿ç¨‹ï¼› é€šè¿‡notify()å”¤é†’çº¿ç¨‹ï¼› é˜»å¡waitä¹‹åä¸ä¼šå†æ‰§è¡Œä»»ä½•ä»£ç ï¼Œæ‰€ä»¥notifyä¸åº”è¯¥åœ¨awaitä¹‹åã€‚ è¾“å‡ºï¼š t1å¼€å§‹ç­‰å¾… t2å·²å¼€å§‹æ‰§è¡Œï¼Œ3ç§’åå°†å”¤é†’t1 t1å·²è¢«å”¤é†’ æ¡ä»¶é”ä½¿ç”¨ import java.util.concurrent.locks.Condition; import java.util.concurrent.locks.ReentrantLock; public class App2 { // åˆ›å»ºä¸€ä¸ªç‹¬å é” private static ReentrantLock lock = new ReentrantLock(); // ç”¨ç‹¬å é”åˆ›å»ºCondition private static Condition condition = lock.newCondition(); public static void main(String[] args) { Thread t1 = new Thread() { public void run() { try { lock.lock(); System.out.println(getName() + \"å¼€å§‹ç­‰å¾…\"); condition.await(); System.out.println(getName() + \"å·²è¢«å”¤é†’\"); } catch (InterruptedException e) { e.printStackTrace(); } finally { lock.unlock(); } }; }; t1.setName(\"t1\"); Thread t2 = new Thread() { public void run() { try { lock.lock(); System.out.println(getName() + \"å·²å¼€å§‹æ‰§è¡Œï¼Œ3ç§’åå°†å”¤é†’t1\"); sleep(3000); condition.signal(); } catch (InterruptedException e) { e.printStackTrace(); } finally { lock.unlock(); } }; }; t2.setName(\"t2\"); t1.start(); t2.start(); } } ç”¨æ³•è§£æï¼š ä¸è®ºé˜»å¡è¿˜æ˜¯ç¯å¢ƒï¼Œéƒ½éœ€è¦é€šè¿‡lock.lock()è·å–é”ï¼Œå¦åˆ™æˆ–æŠ¥ç›‘è§†å™¨å¼‚å¸¸ï¼› ä½¿ç”¨await()æ–¹æ³•é˜»å¡çº¿ç¨‹ï¼› ä½¿ç”¨signal()æ–¹æ³•å”¤é†’çº¿ç¨‹ï¼› await()é˜»å¡ä¹‹åä¸ä¼šæ‰§è¡Œä»»ä½•ä»£ç ï¼Œç›´åˆ°è¢«å”¤é†’ã€‚ è¾“å‡ºï¼š t1å¼€å§‹ç­‰å¾… t2å·²å¼€å§‹æ‰§è¡Œï¼Œ3ç§’åå°†å”¤é†’t1 t1å·²è¢«å”¤é†’ ä»ä¸Šé¢çš„å¯¹æ¯”å¯ä»¥çœ‹å‡ºï¼Œæ¡ä»¶é”ä¸å¯¹è±¡ç›‘è§†å™¨é”çš„ç”¨æ³•å‡ ä¹ä¸€æ ·ï¼š Object Condition ä½œç”¨ wait() await() é˜»å¡çº¿ç¨‹ notify() signal() å”¤é†’çº¿ç¨‹ notifyAll() signalAll() å”¤é†’å…¨éƒ¨çº¿ç¨‹ ä½†æ˜¯Conditionåœ¨ä½¿ç”¨èµ·æ¥æ›´åŠ çµæ´»ï¼Œä¸”åœ¨åŒä¸€æŠŠé”ä¸­æ”¯æŒå¤šä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥åº”è¯¥ä¼˜å…ˆä½¿ç”¨ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:9:1","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"ReentrantLock VS synchronized åŒºåˆ« synchronized ReentrantLock æ¥æº jvm JUCåŒ… åŸç† å¯¹è±¡ç›‘è§†å™¨ AQSé˜Ÿåˆ—+CAS+valatile æ˜“ç”¨ å¼º å¼± é‡Šæ”¾ è‡ªåŠ¨ æ‰‹åŠ¨unlock ä½ç½® å¯¹è±¡ã€æ–¹æ³•ã€ç±»ã€ä»£ç å— åªæœ‰ä»£ç å— å¯ä¸­æ–­ ä¸ å¯ å…¬å¹³é” ä¸æ”¯æŒ æ”¯æŒ ç²¾ç¡®å”¤é†’ ä¸æ”¯æŒ æ”¯æŒ å¤šæ¡ä»¶ ä¸æ”¯æŒ æ”¯æŒ ç»“æœ åªèƒ½ä¸€ç›´é˜»å¡ å¯è¿”å›ç»“æœ è¶…æ—¶ ä¸æ”¯æŒ æ”¯æŒ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:9:2","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"æ¡ä»¶é˜Ÿåˆ—åŸç† newCondition() final ConditionObject newCondition() { return new ConditionObject(); } å¾ˆç®€å•ï¼Œå°±æ˜¯æ„å»ºäº†ä¸€ä¸ªConditionObjectå¯¹è±¡ï¼Œä»–æ˜¯Conditionçš„å®ç°ç±»ã€‚ await()é˜»å¡æ–¹æ³• public final void await() throws InterruptedException { //å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ£€æŸ¥ï¼Œä¼šé‡ç½®ä¸­æ–­çŠ¶æ€ if (Thread.interrupted()) throw new InterruptedException(); Node node = addConditionWaiter(); //é‡Šæ”¾ä¹‹å‰è·å–åˆ°çš„é”èµ„æºï¼Œå› ä¸ºåç»­ä¼šé˜»å¡è¯¥çº¿ç¨‹ï¼Œæ‰€ä»¥å¦‚æœä¸é‡Šæ”¾çš„è¯ï¼Œå…¶ä»–çº¿ç¨‹å°†ä¼šç­‰å¾…è¯¥çº¿ç¨‹è¢«å”¤é†’ int savedState = fullyRelease(node); int interruptMode = 0; //isOnSyncQueueæ–¹æ³•ä¼šéå†CLHé˜Ÿåˆ—å¯»æ‰¾å½“å‰node while (!isOnSyncQueue(node)) { //å¦‚æœå½“å‰èŠ‚ç‚¹ä¸åœ¨CLHé˜Ÿåˆ—ä¸­åˆ™é˜»å¡ä½ï¼Œç­‰å¾…unparkå”¤é†’ //é˜»å¡å½“å‰çº¿ç¨‹ LockSupport.park(this); //ä¸­æ–­æ£€æµ‹ if ((interruptMode = checkInterruptWhileWaiting(node)) != 0) break; } //å”¤é†’åï¼Œä¼šå†æ¬¡è°ƒç”¨acquireQueuedæ¥é˜»å¡ï¼Œå¹¶ä¸”ä¼šä¸æ–­çš„tryAcquireé˜Ÿé¦–ï¼Œè®©é˜Ÿé¦–å°è¯•è·å–é” if (acquireQueued(node, savedState) \u0026\u0026 interruptMode != THROW_IE) interruptMode = REINTERRUPT; if (node.nextWaiter != null) // clean up if cancelled unlinkCancelledWaiters(); if (interruptMode != 0) reportInterruptAfterWait(interruptMode); } //æŠŠå½“å‰çº¿ç¨‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„nodeï¼Œå¹¶ä¸”è®¾ç½®æˆç­‰å¾…æ¡ä»¶çŠ¶æ€ï¼ŒåŠ å…¥æ¡ä»¶é˜Ÿåˆ— private Node addConditionWaiter() { Node t = lastWaiter; // If lastWaiter is cancelled, clean out. if (t != null \u0026\u0026 t.waitStatus != Node.CONDITION) { unlinkCancelledWaiters(); t = lastWaiter; } //å½“å‰çº¿ç¨‹åŒ…è£…æˆä¸€ä¸ªæ–°nodeï¼ŒçŠ¶æ€ä¸ºï¼šç­‰å¾…æ¡ä»¶ Node node = new Node(Thread.currentThread(), Node.CONDITION); if (t == null) firstWaiter = node; else //nodeçš„nextWaiteræ˜¯ä¸€æ¡å•å‘é“¾ï¼Œè¿™é‡Œæ˜¯æŠŠæ–°çš„èŠ‚ç‚¹åŠ å…¥æ¡ä»¶é˜Ÿåˆ—ä¸­ t.nextWaiter = node; lastWaiter = node; return node; } //æ¸…é™¤æ¡ä»¶é˜Ÿåˆ—ä¸­å·²ä¸æ˜¯ç­‰å¾…æ¡ä»¶çŠ¶æ€çš„èŠ‚ç‚¹ private void unlinkCancelledWaiters() { Node t = firstWaiter; Node trail = null; while (t != null) { Node next = t.nextWaiter; if (t.waitStatus != Node.CONDITION) { //é‡Šæ”¾é˜Ÿåˆ—ä¸­æ‰€æœ‰çŠ¶æ€ä¸æ˜¯æ¡ä»¶çš„èŠ‚ç‚¹ t.nextWaiter = null; if (trail == null) firstWaiter = next; else trail.nextWaiter = next; if (next == null) lastWaiter = trail; } else trail = t; t = next; } } final boolean isOnSyncQueue(Node node) { //å¦‚æœnodeæ˜¯conditionçŠ¶æ€æˆ–è€…æ²¡æœ‰å‰é©±èŠ‚ç‚¹è¿”å›false if (node.waitStatus == Node.CONDITION || node.prev == null) return false; //å¦‚æœå­˜åœ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿”å›trueï¼Œä¼šç»ˆæ­¢è‡ªæ—‹ if (node.next != null) // If has successor, it must be on queue return true; return findNodeFromTail(node); } //åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨äºCLHé˜Ÿåˆ—ä¸­ private boolean findNodeFromTail(Node node) { Node t = tail; for (;;) { if (t == node) return true; if (t == null) return false; t = t.prev; } } signal()å”¤é†’æ–¹æ³• public final void signal() { //å¦‚æœå½“å‰çº¿ç¨‹ä¸æ˜¯ç‹¬å çº¿ç¨‹ï¼Œå°±ä¼šæŠ›å¼‚å¸¸ if (!isHeldExclusively()) throw new IllegalMonitorStateException(); Node first = firstWaiter; if (first != null) //å”¤é†’çº¿ç¨‹ï¼Œæ”¹å˜çŠ¶æ€ doSignal(first); } private void doSignal(Node first) { do { if ( (firstWaiter = first.nextWaiter) == null) lastWaiter = null; //å‰”é™¤å½“å‰èŠ‚ç‚¹ first.nextWaiter = null; } while (!transferForSignal(first) \u0026\u0026 (first = firstWaiter) != null); } //æŠŠnodeçš„çŠ¶æ€ä»CONDITIONå˜ä¸ºå…¶ä»–çŠ¶æ€ï¼Œå”¤é†’çº¿ç¨‹ final boolean transferForSignal(Node node) { //CASæ“ä½œé‡ç½®nodeçš„çŠ¶æ€ if (!compareAndSetWaitStatus(node, Node.CONDITION, 0)) return false; //èµ°åˆ°è¿™é‡Œè¯´æ˜è¯¥èŠ‚ç‚¹çš„çŠ¶æ€å·²ç»è¢«ä¿®æ”¹æˆäº†åˆå§‹çŠ¶æ€0ã€‚æŠŠå…¶åŠ å…¥åˆ°CLHé˜Ÿåˆ—å°¾éƒ¨ï¼Œå¹¶è¿”å›å‰ä¸€ä¸ªèŠ‚ç‚¹ Node p = enq(node); int ws = p.waitStatus; if (ws \u003e 0 || !compareAndSetWaitStatus(p, ws, Node.SIGNAL)) //å”¤é†’çº¿ç¨‹ LockSupport.unpark(node.thread); return true; } isHeldExclusively å½“å‰åŒæ­¥å™¨æ˜¯å¦åœ¨ç‹¬å æ¨¡å¼ä¸‹è¢«çº¿ç¨‹å ç”¨ï¼Œä¸€èˆ¬è¯¥æ–¹æ³•è¡¨ç¤ºæ˜¯å¦è¢«å½“å‰çº¿ç¨‹æ‰€ç‹¬å ã€‚è¿™é‡Œçœ‹å‡ºè°ƒç”¨signal()æ—¶å¿…é¡»ä½äºç‹¬å çº¿ç¨‹ã€‚ ç”±ä»¥ä¸Šä»£ç å¯ä»¥çœ‹åˆ°ï¼š signal()å”¤èµ·çº¿ç¨‹æ—¶ï¼Œä¼šæŠŠçº¿ç¨‹ä»æ¡ä»¶é˜Ÿåˆ—ä¸­å‰”é™¤ï¼› await()æ–¹æ³•ä¸­é˜»å¡çš„çº¿ç¨‹è¢«å”¤èµ·æ—¶ä¼šè°ƒç”¨acquireQueued()æ–¹æ³•ä¸æ–­è·å–é”ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:9:3","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"å…¨æ–‡æ€»ç»“ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:10:0","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"ä¸€å¥è¯æ€»ç»“AQSåŸç† AQSå†…éƒ¨åŒ…å«int stateçŠ¶æ€æœºå’ŒCLHåŒæ­¥é˜Ÿåˆ—ï¼Œé€šè¿‡åˆ¤æ–­çŠ¶æ€æœºå†³å®šçº¿ç¨‹æ˜¯å¦èƒ½è·å¾—é”ï¼Œå¹¶åˆ©ç”¨CASåŸå­æ“ä½œæ”¹å˜çŠ¶æ€ï¼Œå¹¶è®©æ‹¿ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥CLHåŒæ­¥é˜Ÿåˆ—ï¼Œä¾èµ–LockSuport.partæ–¹æ³•é˜»å¡çº¿ç¨‹ï¼Œå½“é”é‡Šæ”¾æ—¶ä¼šå”¤é†’çº¿ç¨‹ï¼Œè®©é˜Ÿé¦–èŠ‚ç‚¹å‡ºé˜Ÿï¼Œå¹¶è®©ä¸‹ä¸€ä¸ªçº¿ç¨‹è‡ªæ—‹ç«äº‰é”ã€‚ åŒæ—¶AQSåˆ©ç”¨Nodeä¸­çš„nextWaiterå•å‘é“¾ä½œä¸ºæ¡ä»¶é˜Ÿåˆ—ï¼Œè®©å…¶ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹åŠ å…¥CLHé˜Ÿåˆ—è·å¾—ç«äº‰é”çš„æœºä¼šã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:10:1","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"å¯é‡å…¥é”çš„åŸç† ReentrantLockæ˜¯åœ¨AQSçš„åŸºç¡€ä¸Šé‡å†™äº†tryAcquire()æ–¹æ³•ï¼Œåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯ç‹¬å çº¿ç¨‹ï¼Œæ˜¯çš„è¯å°±ç›´æ¥è®©å½“å‰çº¿ç¨‹è·å¾—é”ã€‚ ","date":"2021-05-13","objectID":"/aqs%E5%8E%9F%E7%90%86/:10:2","series":null,"tags":null,"title":"ä»ReentrantLockçœ‹AQSåŸç†","uri":"/aqs%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"RVæ˜¯ä»€ä¹ˆ public class RecyclerView extends ViewGroup implements ScrollingView{ ... } å°±æ˜¯ä¸ªViewGroupï¼Œå¹¶ä¸”éµå¾ªäº†ScrollingViewæ¥å£ï¼Œæ‰€ä»¥æ”¯æŒæ»‘åŠ¨ã€‚ é‚£ä¹ˆï¼Œæ—¢ç„¶æ˜¯VGï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»VGçš„æ ¸å¿ƒæ–¹æ³•å…¥æ‰‹ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š onMeasure onLayout onDrow ","date":"2021-05-10","objectID":"/recyclerview%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":["Android"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/recyclerview%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"RVçš„çŠ¶æ€ åœ¨å¼€å§‹RVçš„å†…çª¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹RVæœ‰å‡ ç§çŠ¶æ€ï¼Œè¿™æ ·æœ‰åˆ©äºæˆ‘ä»¬çš„ç†è§£ã€‚ @IntDef(flag = true, value = { STEP_START, STEP_LAYOUT, STEP_ANIMATIONS }) @Retention(RetentionPolicy.SOURCE) @interface LayoutState {} @LayoutState int mLayoutStep = STEP_START; STEP_STARTï¼šå¼€å§‹çŠ¶æ€ STEP_LAYOUTï¼šå¸ƒå±€çŠ¶æ€ STEP_ANIMATIONSï¼šåŠ¨ç”»çŠ¶æ€ ","date":"2021-05-10","objectID":"/recyclerview%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":["Android"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/recyclerview%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"onMeasure @Override protected void onMeasure(int widthSpec, int heightSpec) { //å¦‚æœæ²¡æœ‰è®¾ç½®layoutManagerï¼Œåˆ™é‡‡ç”¨padding+æœ€å°å°ºå¯¸ if (mLayout == null) { defaultOnMeasure(widthSpec, heightSpec); return; } //åˆ¤æ–­layoutManagerä¸­çš„ä¸€ä¸ªæ ‡å¿—ä½ï¼Œä½†æ˜¯è¿™ä¸ªæ ‡å¿—ä½å·²ç»æ ‡æ˜è¿‡æœŸäº† if (mLayout.isAutoMeasureEnabled()) { //æ‹¿åˆ°mode final int widthMode = MeasureSpec.getMode(widthSpec); final int heightMode = MeasureSpec.getMode(heightSpec); //è®©layoutManageræµ‹é‡ mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec); final boolean measureSpecModeIsExactly = widthMode == MeasureSpec.EXACTLY \u0026\u0026 heightMode == MeasureSpec.EXACTLY; //å¦‚æœæ˜¯match_parentæˆ–è¿™æ˜¯ä¸ªç¡®å®šçš„å€¼ï¼Œè€Œæ­¤æ—¶æ²¡æœ‰adapterï¼Œé‚£å°±ä¸ç©äº†ï¼Œç­‰ä¸‹æ¬¡measureæ—¶å†å¤„ç† if (measureSpecModeIsExactly || mAdapter == null) { return; } //å¦‚æœæ˜¯å¼€å§‹çŠ¶æ€ï¼Œ if (mState.mLayoutStep == State.STEP_START) { //ç¬¬ä¸€æ¬¡layoutè¿‡ç¨‹ dispatchLayoutStep1(); } // set dimensions in 2nd step. Pre-layout should happen with old dimensions for // consistency mLayout.setMeasureSpecs(widthSpec, heightSpec); mState.mIsMeasuring = true; //ç¬¬äºŒæ¬¡layoutè¿‡ç¨‹ dispatchLayoutStep2(); // ä»childrenä¸­è·å–å®½é«˜ mLayout.setMeasuredDimensionFromChildren(widthSpec, heightSpec); //å¦‚æœRVå­˜åœ¨ä¸ç²¾ç¡®çš„å®½é«˜ï¼Œæˆ–è€…å­˜åœ¨childä¹Ÿä¸ç²¾ç¡®ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å†æ¬¡measure if (mLayout.shouldMeasureTwice()) { //ç”¨å½“å‰å·²æµ‹é‡è¿‡çš„å®½é«˜ï¼Œé‡æ–°ç”ŸæˆMeasureSpecï¼Œå¹¶è®¾ç½®ç»™layoutMnager mLayout.setMeasureSpecs( MeasureSpec.makeMeasureSpec(getMeasuredWidth(), MeasureSpec.EXACTLY), MeasureSpec.makeMeasureSpec(getMeasuredHeight(), MeasureSpec.EXACTLY)); mState.mIsMeasuring = true; //é‡å¯è¿‡ç¨‹2 dispatchLayoutStep2(); // now we can get the width and height from the children. mLayout.setMeasuredDimensionFromChildren(widthSpec, heightSpec); } } else { if (mHasFixedSize) { mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec); return; } // custom onMeasure if (mAdapterUpdateDuringMeasure) { startInterceptRequestLayout(); onEnterLayoutOrScroll(); processAdapterUpdatesAndSetAnimationFlags(); onExitLayoutOrScroll(); if (mState.mRunPredictiveAnimations) { mState.mInPreLayout = true; } else { // consume remaining updates to provide a consistent state with the layout pass. mAdapterHelper.consumeUpdatesInOnePass(); mState.mInPreLayout = false; } mAdapterUpdateDuringMeasure = false; stopInterceptRequestLayout(false); } else if (mState.mRunPredictiveAnimations) { // If mAdapterUpdateDuringMeasure is false and mRunPredictiveAnimations is true: // this means there is already an onMeasure() call performed to handle the pending // adapter change, two onMeasure() calls can happen if RV is a child of LinearLayout // with layout_width=MATCH_PARENT. RV cannot call LM.onMeasure() second time // because getViewForPosition() will crash when LM uses a child to measure. setMeasuredDimension(getMeasuredWidth(), getMeasuredHeight()); return; } if (mAdapter != null) { mState.mItemCount = mAdapter.getItemCount(); } else { mState.mItemCount = 0; } startInterceptRequestLayout(); mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec); stopInterceptRequestLayout(false); mState.mInPreLayout = false; // clear } } // å¦‚æœæ²¡æœ‰è®¾ç½®layoutManagerï¼Œåˆ™é‡‡ç”¨padding+æœ€å°å°ºå¯¸ void defaultOnMeasure(int widthSpec, int heightSpec) { final int width = LayoutManager.chooseSize(widthSpec,getPaddingLeft() + getPaddingRight(), ViewCompat.getMinimumWidth(this)); final int height = LayoutManager.chooseSize(heightSpec,getPaddingTop() + getPaddingBottom(), ViewCompat.getMinimumHeight(this)); setMeasuredDimension(width, height); } ","date":"2021-05-10","objectID":"/recyclerview%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":["Android"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/recyclerview%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Measureä¸¤æ¬¡çš„åŸå›  performMeasure(childWidthMeasureSpec, childHeightMeasureSpec); int width = host.getMeasuredWidth(); int height = host.getMeasuredHeight(); //æ˜¯å¦éœ€è¦å†æ¬¡æµ‹é‡ï¼Œé»˜è®¤ä¸ºfalse boolean measureAgain = false; if (lp.horizontalWeight \u003e 0.0f) { width += (int) ((mWidth - width) * lp.horizontalWeight); childWidthMeasureSpec = MeasureSpec.makeMeasureSpec(width, MeasureSpec.EXACTLY); measureAgain = true; } if (lp.verticalWeight \u003e 0.0f) { height += (int) ((mHeight - height) * lp.verticalWeight); childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.EXACTLY); measureAgain = true; } if (measureAgain) { if (DEBUG_LAYOUT) Log.v(mTag, \"And hey let's measure once more: width=\" + width + \" height=\" + height); performMeasure(childWidthMeasureSpec, childHeightMeasureSpec); } åœ¨ç¬¬ä¸€æ¬¡ performMeasure() æ–¹æ³•è°ƒç”¨åï¼Œ å¦‚æœå­View éœ€è¦çš„ç©ºé—´å¤§äºçˆ¶å®¹å™¨ä¸ºå®ƒæµ‹é‡çš„å¤§å°ï¼Œé‚£ä¹ˆå¯¹åº”çš„ verticalWeight å’Œ horizontalWeight å°†ä¼šå¤§äº0ï¼Œå³è¿™ä¸¤ä¸ªå­—æ®µåˆ†åˆ«å¯¹åº”å‚ç›´å’Œæ°´å¹³çš„æƒ…å†µä¸‹å­ View éœ€è¦çš„é¢å¤–ç©ºé—´ã€‚ è¿™æ—¶å€™ä¼šå°† measureAgain è®¾ç½®ä¸º trueï¼Œ å¹¶ä¸”å¼€å§‹ç¬¬äºŒæ¬¡æµ‹é‡ã€‚ æœªå®Œå¾…ç»­â€¦ ","date":"2021-05-10","objectID":"/recyclerview%E8%A7%A3%E8%AF%BB/:3:1","series":null,"tags":["Android"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/recyclerview%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"SharedPreferencesè§£è¯» SharedPreferencesæ˜¯æˆ‘ä»¬å¹³æ—¶å¸¸ç”¨çš„ç®€å•å‚¨å­˜å·¥å…·ã€‚ä¼˜ç‚¹å°±æ˜¯ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œè€Œä¸”çº¿ç¨‹å®‰å…¨ï¼Œç”šè‡³æœ‰çš„å…¬å¸å¹²è„†è¿sqLiteéƒ½ä¸ç”¨äº†ï¼Œå…¨ç”¨SPï¼ä½†æ˜¯çªç„¶æœ‰ä¸€å¤©è…¾è®¯å¼„å‡ºäº†ä¸ªMMKVç”¨æ¥æ›¿ä»£ä»–ï¼Œæœ€è¿‘googleä¹Ÿå¼„äº†ä¸ªDataStorageï¼Œè€Œä¸”æœ€è¿‘é¢è¯•ä¹Ÿæ˜¯å¿…é—®åŸç†ï¼Œäºæ˜¯æˆ‘å†³å®šæ­»ç£•ä¸€ä¸‹SPã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:0:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åˆå§‹åŒ– ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"getSharedPreferences æˆ‘ä»¬é€šè¿‡è¿™ä¸ªæ–¹æ³•æ‹¿åˆ°SPï¼Œè¯¥æ–¹æ³•åœ¨Activityä¸­å†…ç½®ï¼Œæœ€ç»ˆè°ƒç”¨çš„æ˜¯ContextWrapperçš„æ–¹æ³•ï¼š @Override public SharedPreferences getSharedPreferences(String name, int mode) { return mBase.getSharedPreferences(name, mode); } ContextWrapperé‡Œé¢è°ƒç”¨çš„mBaseçš„å¯¹åº”æ–¹æ³•ï¼Œé€šè¿‡ç™¾åº¦ï¼ŒæŸ¥åˆ°mBaseå…¶å®å°±æ˜¯ä¼ è¯´ä¸­çš„ContextImplï¼š @Override public SharedPreferences getSharedPreferences(String name, int mode) { if (mPackageInfo.getApplicationInfo().targetSdkVersion \u003c Build.VERSION_CODES.KITKAT) { if (name == null) { name = \"null\"; } } File file; synchronized (ContextImpl.class) { if (mSharedPrefsPaths == null) { mSharedPrefsPaths = new ArrayMap\u003c\u003e(); } file = mSharedPrefsPaths.get(name); if (file == null) { file = getSharedPreferencesPath(name); //æ‹¿åˆ°æ–‡ä»¶ååŠ å…¥ç¼“å­˜ï¼Œä¸‹æ¬¡å†æ‹¿æ–‡ä»¶å°±å¿«äº† mSharedPrefsPaths.put(name, file); } } //è°ƒç”¨é‡è½½æ–¹æ³•æ‰§è¡ŒçœŸæ­£çš„é€»è¾‘ return getSharedPreferences(file, mode); } è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥è·å–æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶æ”¾å…¥ArrayMapç¼“å­˜èµ·æ¥ä»¥å¤‡ä»¥åå†æ¬¡è·å–fileå¯ä»¥æé«˜æ•ˆç‡ã€‚keyå°±æ˜¯æ–‡ä»¶çš„pathï¼Œvalueå°±æ˜¯æ–‡ä»¶æ˜ å°„çš„Fileå¯¹è±¡ã€‚ ç„¶åä½¿ç”¨æ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨äº†åŒåçš„é‡è½½æ–¹æ³•ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:1","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ç”Ÿæˆæ–‡ä»¶ ä¸Šè¿°ä»£ç ä¸­å‡ºç°äº†ä¸€ä¸ªfileå±€éƒ¨å˜é‡ï¼Œå®ƒæ˜¯ä¸ªä»€ä¹ˆè§’è‰²å‘¢ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°±è¦æ¥æ­å¼€å®ƒç¥ç§˜çš„é¢çº±ã€‚ é¦–å…ˆçœ‹åˆ°Synchronizedå…³é”®å­—ï¼Œå¹¶ä¸”å……å½“äº†ContextImlçš„ç±»é”ï¼Œé‚£ä¹ˆå¸¦æ¥çº¿ç¨‹å®‰å…¨çš„åŒæ—¶ï¼Œä¼šä½¿æ‰€æœ‰å¹¶å‘è®¿é—®è¯¥ç±»çš„æ“ä½œé˜»å¡ã€‚é‚£ä¹ˆä¼šä¸ä¼šé€ æˆUIçº¿ç¨‹å¡é¡¿å‘¢ï¼Ÿä¼šï¼Œä½†æ˜¯ä¸æ˜æ˜¾ã€‚ mSharedPrefsPaths = new ArrayMap\u003c\u003e();ï¼Œé‚£ä¹ˆä¸ç”¨æƒ³ï¼ŒmSharedPrefsPathsæ˜¯ä¸ªArrayMapï¼Œä¸€å®šæ˜¯ä¸ªå†…å­˜ç¼“å­˜ã€‚ æ­¤å¤„ä»£ç ä¸é‡è¦ï¼Œè¯·ç›´æ¥çœ‹ä¸‹é¢æ–‡å­—ç»“è®ºã€‚ /** * æ‹¿åˆ°SPæ–‡ä»¶åœ°å€ **/ @Override public File getSharedPreferencesPath(String name) { return makeFilename(getPreferencesDir(), name + \".xml\"); } /** * æ‹¿åˆ°SPæ‰€åœ¨ç›®å½• **/ @UnsupportedAppUsage private File getPreferencesDir() { synchronized (mSync) { if (mPreferencesDir == null) { //åˆ›å»ºFileå¯¹è±¡ mPreferencesDir = new File(getDataDir(), \"shared_prefs\"); } //ç¡®ä¿æ–‡ä»¶ä¸€å®šå­˜åœ¨ return ensurePrivateDirExists(mPreferencesDir); } } /** * æ‹¿åˆ°æ•°æ®ç›®å½•ï¼Œé‡Œé¢åŒ…æ‹¬SPæ–‡ä»¶ **/ @Override public File getDataDir() { if (mPackageInfo != null) { File res = null; if (isCredentialProtectedStorage()) { res = mPackageInfo.getCredentialProtectedDataDirFile(); } else if (isDeviceProtectedStorage()) { res = mPackageInfo.getDeviceProtectedDataDirFile(); } else { res = mPackageInfo.getDataDirFile(); } if (res != null) { if (!res.exists() \u0026\u0026 android.os.Process.myUid() == android.os.Process.SYSTEM_UID) { Log.wtf(TAG, \"Data directory doesn't exist for package \" + getPackageName(), new Throwable()); } return res; } else { throw new RuntimeException( \"No data directory found for package \" + getPackageName()); } } else { throw new RuntimeException( \"No package details found for package \" + getPackageName()); } } private File makeFilename(File base, String name) { if (name.indexOf(File.separatorChar) \u003c 0) { final File res = new File(base, name); // We report as filesystem access here to give us the best shot at // detecting apps that will pass the path down to native code. BlockGuard.getVmPolicy().onPathAccess(res.getPath()); return res; } throw new IllegalArgumentException( \"File \" + name + \" contains a path separator\"); } ä¸Šè¿°ä»£ç æ²¡å¿…è¦ç ”ç©¶ï¼Œå°±æ˜¯ç»è¿‡ä¸€ç³»åˆ—æ‹¼æ‹¼å‡‘å‡‘ï¼Œæœ€åæ‹¿åˆ°/data/data/åŒ…å/shared_prefs/[name].xml æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ensurePrivateDirExistsæ–¹æ³•ç¡®ä¿æ–‡ä»¶ä¸€å®šå­˜åœ¨(ä¸å­˜åœ¨å°±åˆ›å»º)ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:2","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"getSharedPreferences é‡è½½æ–¹æ³• æ¥ä¸‹æ¥è°ƒç”¨äº†ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼Œä¸»è¦æ˜¯åˆ›å»ºSharedPreferenceImplå¯¹è±¡ï¼Œé€šè¿‡ç¼“å­˜è¿›arrayMapï¼Œå¹¶ä¸”ä»¥fileä½œä¸ºkeyä¸€ä¸€ç»‘å®šã€‚ @Override public SharedPreferences getSharedPreferences(File file, int mode) { SharedPreferencesImpl sp; synchronized (ContextImpl.class) { //è·å–ç¼“å­˜ï¼Œè¯¥ç¼“å­˜æŠŠfileå’ŒSharedPreferencesImplä¸€ä¸€ç»‘å®š final ArrayMap\u003cfile, sharedpreferencesimpl\u003e cache = getSharedPreferencesCacheLocked(); sp = cache.get(file); if (sp == null) { checkMode(mode); //åˆ›å»ºSharedPreferencesImpl sp = new SharedPreferencesImpl(file, mode); //ç¼“å­˜SP cache.put(file, sp); return sp; } } //å¦‚æœå¼€å¯å¤šè¿›ç¨‹æ¨¡å¼ï¼Œæˆ–è€…å°äº3.0ç‰ˆæœ¬ï¼Œåˆ™æ¯æ¬¡éƒ½é‡æ–°åŠ è½½æ–‡ä»¶ if ((mode \u0026 Context.MODE_MULTI_PROCESS) != 0 || getApplicationInfo().targetSdkVersion \u003c android.os.Build.VERSION_CODES.HONEYCOMB) { sp.startReloadIfChangedUnexpectedly(); } return sp; } private ArrayMap\u003cfile, sharedpreferencesimpl\u003e getSharedPreferencesCacheLocked() { if (sSharedPrefsCache == null) { sSharedPrefsCache = new ArrayMap\u003c\u003e(); } final String packageName = getPackageName(); ArrayMap\u003cfile, sharedpreferencesimpl\u003e packagePrefs = sSharedPrefsCache.get(packageName); if (packagePrefs == null) { packagePrefs = new ArrayMap\u003c\u003e(); sSharedPrefsCache.put(packageName, packagePrefs); } return packagePrefs; } è¿™ä¸ªé‡è½½æ–¹æ³•ï¼Œä¸»è¦æ˜¯åˆ›å»ºSharedPreferencesImplå¯¹è±¡å¹¶ä¸”ç¼“å­˜ï¼ŒFileä½œä¸ºkeyï¼ŒSharedPreferencesImplä½œä¸ºvalueï¼Œä¿è¯äº†Fileå’ŒSharedPreferencesImplçš„ä¸€ä¸€å¯¹åº”ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:3","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"SharedPreferencesImplæ„é€ æ–¹æ³• @UnsupportedAppUsage SharedPreferencesImpl(File file, int mode) { mFile = file; //åˆ›å»ºå¤‡ä»½æ–‡ä»¶å¯¹è±¡ mBackupFile = makeBackupFile(file); mMode = mode; mLoaded = false; mMap = null; mThrowable = null; //å¼€å§‹åŠ è½½ startLoadFromDisk(); } /** * åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œä»¥.bakä½œä¸ºåç¼€ **/ static File makeBackupFile(File prefsFile) { return new File(prefsFile.getPath() + \".bak\"); } åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œåœ¨spæ‰€åœ¨ç›®å½•ä¸­å…ˆåˆ›å»ºäº†ä¸€ä¸ªä»¥â€œ.bakâ€ä¸ºåç¼€çš„å¤‡ä»½æ–‡ä»¶çš„å¯¹è±¡ï¼Œç„¶ååœ¨å­çº¿ç¨‹ä¸­ä»ç¡¬ç›˜åŠ è½½æ–‡ä»¶ï¼š /** *åœ¨å­çº¿ç¨‹åŠ è½½æ–‡ä»¶ **/ @UnsupportedAppUsage private void startLoadFromDisk() { synchronized (mLock) { // å˜æ›´æ ‡å¿—ä½ mLoaded = false; } //å¼€å¯å­çº¿ç¨‹ä»ç¡¬ç›˜åŠ è½½æ–‡ä»¶ new Thread(\"SharedPreferencesImpl-load\") { public void run() { loadFromDisk(); } }.start(); } private void loadFromDisk() { synchronized (mLock) { //dlcæœºåˆ¶ if (mLoaded) { return; } //å¦‚æœå¤‡ä»½æ–‡ä»¶å®ä½“å­˜åœ¨ï¼Œåˆ™ä»å¤‡ä»½æ¢å¤spæ–‡ä»¶ if (mBackupFile.exists()) { mFile.delete(); mBackupFile.renameTo(mFile); } } Map\u003cstring, object=\"object\"\u003e map = null; StructStat stat = null; Throwable thrown = null; try { stat = Os.stat(mFile.getPath()); if (mFile.canRead()) { BufferedInputStream str = null; try { //è¯»å–æ–‡ä»¶å†…å®¹ str = new BufferedInputStream( new FileInputStream(mFile), 16 * 1024); //é‡‡ç”¨pollæ–¹å¼è§£æxml map = (Map\u003cstring, object=\"object\"\u003e) XmlUtils.readMapXml(str); } catch (Exception e) { Log.w(TAG, \"Cannot read \" + mFile.getAbsolutePath(), e); } finally { IoUtils.closeQuietly(str); } } } catch (ErrnoException e) { // An errno exception means the stat failed. Treat as empty/non-existing by // ignoring. } catch (Throwable t) { thrown = t; } //æ³¨æ„è¿™ä¸ªé” synchronized (mLock) { //å˜æ›´æ ‡å¿—ä½ mLoaded = true; mThrowable = thrown; try { if (thrown == null) { if (map != null) { mMap = map; mStatTimestamp = stat.st_mtim; mStatSize = stat.st_size; } else { mMap = new HashMap\u003c\u003e(); } } } catch (Throwable t) { mThrowable = t; } finally { //å”¯ä¸€å”¤é†’é”çš„æ—¶æœº mLock.notifyAll(); } } } getXXX() @Override @Nullable public String getString(String key, @Nullable String defValue) { //æ³¨æ„è¿™ä¸ªé” synchronized (mLock) { //æŒç»­ç­‰å¾… awaitLoadedLocked(); String v = (String)mMap.get(key); return v != null ? v : defValue; } } @GuardedBy(\"mLock\") private void awaitLoadedLocked() { if (!mLoaded) { BlockGuard.getThreadPolicy().onReadFromDisk(); } while (!mLoaded) { try { mLock.wait(); } catch (InterruptedException unused) { } } if (mThrowable != null) { throw new IllegalStateException(mThrowable); } } è¿™é‡Œè¦æ³¨æ„çš„å°±æ˜¯ï¼ŒgetXXX()æ–¹æ³•ä¸æ„é€ æ–¹æ³•ä¸­è¯»å–æ–‡ä»¶çš„åœ°æ–¹æ˜¯å…±äº«åŒä¸€æŠŠé”mLockï¼Œä»è€Œä½¿è¿™ä¸¤ä¸ªæ–¹æ³•å­˜åœ¨äº’æ–¥å…³ç³»ã€‚å¦‚æœæ–‡ä»¶å¾ˆå¤§ï¼Œé‚£ä¹ˆç¨‹åºè¿è¡ŒsharedPreferenceImplæ„é€ æ–¹æ³•çš„è€—æ—¶å°±ä¼šæ¯”è¾ƒé•¿ï¼Œæ­¤æ—¶è°ƒç”¨getXXX()æ–¹æ³•å› ä¸ºäº’æ–¥é”çš„å…³ç³»ï¼Œå°±ä¼šæŒç»­ç­‰å¾…ï¼Œä¸€ç›´åˆ°æ„é€ æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½è¿”å›ç»“æœï¼Œå¯¼è‡´ä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œå‡ºç°UIå¡é¡¿ï¼Œç”šè‡³å‡ºç°ANRã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:4","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"é˜¶æ®µæ€»ç»“ getSharedPreferences(String name,int mode)æ–¹æ³•ç”¨æ¥åˆå§‹åŒ–SPï¼Œä¸»è¦å°±æ˜¯åˆ›å»ºxmlæ–‡ä»¶ï¼Œè¿›è€Œä½¿ç”¨æ–‡ä»¶å’Œmodeåˆ›å»ºgetSharedPreferencesImplå¯¹è±¡å¹¶ä¸”è¿”å›ã€‚ è€Œåœ¨åˆ›å»ºgetSharedPreferencesImplæ—¶å°±ä¼šå¼€å¯ä¸€ä¸ªå­çº¿ç¨‹ä»ç¡¬ç›˜è§£æxmlæ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªä»¥.batä¸ºåç¼€çš„å¤‡ä»½æ–‡ä»¶ã€‚ å¦‚æœåœ¨æ„é€ æ–¹æ³•è¯»å–æ–‡ä»¶æœŸé—´è°ƒç”¨äº†getXXX()æ–¹æ³•ï¼Œåè€…ä¼šæŒç»­ç­‰å¾…å‰è€…å®Œæˆä¹‹åæ‰æ‰§è¡Œï¼Œä¼šé€ æˆUIå¡é¡¿ç”šè‡³ANRã€‚ å½“å¼€å¯å¤šè¿›ç¨‹æ¨¡å¼æ—¶ï¼Œæ¯æ¬¡è°ƒç”¨getSharedPreferences()æ—¶éƒ½ä¼šé‡æ–°è¯»å–æ–‡ä»¶ã€‚å› ä¸ºSPä¸çŸ¥é“æ–‡ä»¶æ˜¯å¦å·²è¢«æ›´æ–°ï¼Œæ‰€ä»¥åªèƒ½æ¯æ¬¡é‡æ–°è¯»å–ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:1:5","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Editor ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"è·å– æŒ‰ç…§SPçš„ä½¿ç”¨æµç¨‹ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦è·å–åˆ°Editorå¯¹è±¡äº†ï¼Œæˆ‘ä»¬é€šè¿‡Editoræä¾›çš„putXXX()æ–¹æ³•æ¥å‘SPä¸­å†™å…¥æ•°æ®ã€‚ Editoræ˜¯ä¸€ä¸ªæ¥å£ï¼Œæä¾›äº†ä¸€äº›åˆ—çš„putè™šæ–¹æ³•ã€‚æ¥å£æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è°ƒç”¨çš„å…¶å®æ˜¯ä»–çš„å®ç°ç±»â€”â€”EditorImplï¼Œå®ƒæ˜¯getSharedPreferencesImplçš„å†…éƒ¨åŒ¿åç±»ï¼Œç”±äºå†…éƒ¨åŒ¿åç±»æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥è®¿é—®å¤–å±‚ç±»çš„æˆå‘˜ï¼ @Override public Editor edit() { //åˆçœ‹åˆ°äº†è¿™æŠŠé” synchronized (mLock) { //æŒç»­ç­‰å¾… awaitLoadedLocked(); } //åˆ›å»ºEditorImpl return new EditorImpl(); } æ¯æ¬¡è°ƒç”¨sp.editor()æ–¹æ³•ï¼Œä¹Ÿä¼šå…±äº«mLockè¿™æŠŠé”ï¼Œé‚£ä¹ˆåŒæ ·ä¹Ÿå­˜åœ¨ä¸Šé¢è¯´çš„é—®é¢˜ï¼Œä¼šå‡ºç°å¡é¡¿ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:1","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"EditorImplå®šä¹‰å’ŒPutæ“ä½œ public final class EditorImpl implements Editor { //ä¸€æŠŠé” private final Object mEditorLock = new Object(); //ç¼“å­˜ @GuardedBy(\"mEditorLock\") private final Map\u003cstring, object\u003e mModified = new HashMap\u003c\u003e(); //æ ‡å¿—ä½ @GuardedBy(\"mEditorLock\") private boolean mClear = false; //å–œé—»ä¹è§çš„putString @Override public Editor putString(String key, @Nullable String value) { synchronized (mEditorLock) { mModified.put(key, value); return this; } } ...... ä»£ç å¾ˆç®€å•ï¼Œputæ“ä½œå…¶å®å°±æ˜¯å¯¹HashMapç¼“å­˜è¿›è¡Œå†™å…¥ï¼ŒåŒæ—¶ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ŒåŠ äº†é”ã€‚æ¯ä¸ªPUTæ“ä½œéƒ½æ˜¯äº’æ–¥å…³ç³»ã€‚æ”¹åŠ¨å¹¶æ²¡æœ‰å³æ—¶æäº¤åˆ°ç¡¬ç›˜æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰æäº¤åˆ°çœŸæ­£çš„ç¼“å­˜mMapï¼Œè€Œæ˜¯æäº¤åˆ°äº†editorå†…éƒ¨çš„ç¼“å­˜mModifiedé‡Œé¢äº†ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:2","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"remove @Override public Editor remove(String key) { synchronized (mEditorLock) { //ä¸ºä½•ä¸è®¾ç½®ä¸ºnull?; mModified.put(key, this); return this; } } å½“æˆ‘çœ‹åˆ°remove()æ–¹æ³•å®šä¹‰æ—¶ï¼Œæˆ‘æƒŠå‘†äº†ï¼mModifiedé‡Œé¢æ”¾äº†thisï¼Œè€ŒthisåˆæŒæœ‰äº†mModifiedï¼Œè¿™ä¸å°±é€ æˆå¾ªç¯å¼•ç”¨äº†å—ï¼Œä¸ä¼šå‡ºé—®é¢˜å—ï¼Ÿå¸Œæœ›æ—¥åèƒ½æ‰¾åˆ°ç­”æ¡ˆå§ã€‚ æˆ‘è§‰å¾—ä¸€èˆ¬äººéƒ½ä¼šè®¾ç½®nullå§ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:3","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"clear @Override public Editor clear() { synchronized (mEditorLock) { mClear = true; return this; } } clearæ–¹æ³•ä¹Ÿæ˜¯éå¸¸å¥‡æ€ªï¼Œåªæ˜¯è®¾ç½®äº†ä¸€ä¸‹æ ‡å¿—ä½ï¼Œå¹¶æ²¡æœ‰åšå…¶ä»–çš„äº‹æƒ…ã€‚ å°ç»“ æ€æ ·è§£å†³å¡é¡¿é—®é¢˜ï¼Ÿ å°½é‡æŠŠå¤§æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ã€‚ å°½é‡æå‰åˆå§‹åŒ–spã€‚ ç„¶åå°½é‡ä¸è¦åœ¨åˆå§‹åŒ–ä¹‹åé©¬ä¸Šå°±ç”¨spã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:4","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"commit() @Override public boolean commit() { //æäº¤åˆ°å†…å­˜ MemoryCommitResult mcr = commitToMemory(); //å­çº¿ç¨‹å†™å…¥æ–‡ä»¶ SharedPreferencesImpl.this.enqueueDiskWrite(mcr, null); try { //è®¡æ•°é”ç­‰å¾… mcr.writtenToDiskLatch.await(); } catch (InterruptedException e) { return false; } finally { } //é€šçŸ¥ç›‘è§†å™¨ notifyListeners(mcr); //è¿”å›è¯»å†™ç»“æœtrue or false return mcr.writeToDiskResult; } commitæ–¹æ³•é€šè¿‡è®¡æ•°é”é˜»å¡äº†å½“å‰çº¿ç¨‹ï¼Œç­‰å¾…å­çº¿ç¨‹ä¸­çš„å†™æ“ä½œå®Œæˆï¼Œæ‰ä¼šè¢«å”¤é†’ï¼Œå……åˆ†ä½“ç°äº†çº¿ç¨‹åä½œçš„æ€æƒ³ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:5","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"apply() @Override public void apply() { //æäº¤åˆ°å†…å­˜ final MemoryCommitResult mcr = commitToMemory(); //å…¶å®å¹¶ä¸èµ·ä½œç”¨ï¼Œè¿·ä¹‹æ“ä½œ final Runnable awaitCommit = new Runnable() { @Override public void run() { try { //è®¡æ•°é”å¼€å§‹ç­‰å¾… mcr.writtenToDiskLatch.await(); } catch (InterruptedException ignored) { } } }; //æ·»åŠ ç”Ÿå‘½å‘¨æœŸå›è°ƒ QueuedWork.addFinisher(awaitCommit); Runnable postWriteRunnable = new Runnable() { @Override public void run() { //åˆ©ç”¨è®¡æ•°é”é˜»å¡å½“å‰çº¿ç¨‹ awaitCommit.run(); //ç§»é™¤ç”Ÿå‘½å‘¨æœŸå›è°ƒ QueuedWork.removeFinisher(awaitCommit); } }; //å­çº¿ç¨‹å†™å…¥æ–‡ä»¶ SharedPreferencesImpl.this.enqueueDiskWrite(mcr, postWriteRunnable); //é€šçŸ¥ç›‘è§†å™¨ notifyListeners(mcr); } ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:6","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å°ç»“ è¿™ä¸¤ä¸ªæ–¹æ³•ä¸»è¦å¹²äº†ä¸‰ä»¶äº‹ï¼š è°ƒç”¨commitToMemory()æ–¹æ³•ä»mModifiedæäº¤æ”¹åŠ¨åˆ°mMapï¼› è°ƒç”¨SharedPreferencesImpl.this.enqueueDiskWrite(mcr, null);æŠŠæ”¹åŠ¨å†™å…¥æ–‡ä»¶ï¼› è°ƒç”¨notifyListeners(mcr);é€šçŸ¥ç›‘è§†å™¨ã€‚ ä¸åŒç‚¹åœ¨äºï¼Œcommitæ–¹æ³•åœ¨å†™å…¥æ–‡ä»¶æ—¶ï¼Œé€šè¿‡è®¡æ•°é”é˜»å¡äº†å½“å‰çº¿ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœåœ¨ä¸»çº¿ç¨‹è°ƒç”¨commitçš„è¯ï¼Œå°±ä¼šé€ æˆå¡é¡¿äº†ã€‚è€Œapplyæ–¹æ³•æ˜¯æŠŠè®¡æ•°é”æ”¾åˆ°äº†å¦ä¸€ä¸ªå­çº¿ç¨‹ä¸­å»æ‰§è¡Œäº†ï¼Œæ‰€ä»¥é˜»å¡çš„æ˜¯å¦ä¸€ä¸ªå­çº¿ç¨‹ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¯¹ä¸»çº¿ç¨‹æ²¡æœ‰å½±å“ã€‚ ä½†æ˜¯ï¼Œå½“ç”Ÿå‘½å‘¨æœŸå¤„äºhandleStopService() ã€ handlePauseActivity() ã€ handleStopActivity()æ—¶ï¼Œä¼šè°ƒç”¨ QueuedWorkçš„waitToFinish()æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šéå†æ‰§è¡Œæ‰€æœ‰çš„finisherï¼Œæ‰€ä»¥å¦‚æœå†…å®¹å¾ˆå¤šï¼ŒApplyæ–¹æ³•è¿˜æ˜¯ä¼šå¼•èµ·ANRã€‚ æœ€åï¼Œapplyæ–¹æ³•æ²¡æœ‰è¿”å›å†™å…¥çš„æˆåŠŸå¤±è´¥ã€‚ æ€ä¹ˆè§£å†³ANRé—®é¢˜ï¼Ÿ æˆ‘è§‰å¾—åœ¨å­çº¿ç¨‹ä¸­è°ƒç”¨commitæ–¹æ³•åº”è¯¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©å§ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:7","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"enqueueDiskWrite commitå’Œapplyä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•å®Œæˆå†™å…¥ï¼š /** *ä½¿å·²ç»æäº¤ç»™å†…å­˜çš„ç»“æœæ’é˜Ÿï¼Œä»¥å°†å…¶å†™å…¥ç£ç›˜ã€‚å®ƒä»¬å°†æŒ‰å…¥é˜Ÿçš„é¡ºåºä¸€æ¬¡å†™å…¥ç£ç›˜ **/ private void enqueueDiskWrite(final MemoryCommitResult mcr, final Runnable postWriteRunnable) { //commit-true apply-false final boolean isFromSyncCommit = (postWriteRunnable == null); final Runnable writeToDiskRunnable = new Runnable() { @Override public void run() { synchronized (mWritingToDiskLock) { writeToFile(mcr, isFromSyncCommit); } synchronized (mLock) { //æ–‡ä»¶å†™å®Œä¹‹åæ‰ä¼šå‡1 mDiskWritesInFlight--; } //applyä¼šæ‰§è¡Œ if (postWriteRunnable != null) { //ä¸»è¦æ˜¯ä¸ºäº†ç§»é™¤Finisher postWriteRunnable.run(); } } }; // commitæ‰§è¡Œ if (isFromSyncCommit) { boolean wasEmpty = false; synchronized (mLock) { //å¦‚æœåœ¨commitä¹‹åç´§æ¥ç€åˆè°ƒç”¨äº†commitï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯falseäº† wasEmpty = mDiskWritesInFlight == 1; } if (wasEmpty) { writeToDiskRunnable.run(); return; } } // applyæ‰§è¡Œï¼›é¢‘ç¹commitæ—¶åé¢çš„commitä¼šè½¬ä¸ºå¼‚æ­¥æ‰§è¡Œ QueuedWork.queue(writeToDiskRunnable, !isFromSyncCommit); } åœ¨è¿™é‡Œå…ˆå®šä¹‰äº†ä¸€ä¸ªRunnableå«åšwriteToDiskRunnable ï¼Œä¸€çœ‹åå­—å°±çŸ¥é“æ˜¯ç”¨æ¥IOå†™ç£ç›˜çš„ã€‚æ‰€ä»¥å…¶ä¸­å¿…ç„¶æœ‰writeToFileæ–¹æ³•çš„è°ƒç”¨å•¦ã€‚ç”±äºåœ¨åŒä¸€çº¿ç¨‹é¡ºåºæ‰§è¡Œï¼ŒwriteToFileæ–¹æ³•ä¸­å¿…ç„¶ä¼šæŠŠmcr.writtenToDiskLatch.countDown()ï¼Œæ‰€ä»¥åé¢çš„postWriteRunnable.run();åªæ˜¯ä¸ºäº†ç§»é™¤finisherï¼Œè€Œä¹‹å‰çš„awaitCommitè¿™ä¸ªRunnableä¸­çš„mcr.writtenToDiskLatch.await();å¹¶æ²¡æœ‰èµ·ä»€ä¹ˆä½œç”¨ã€‚ æˆ‘ä»¬çœ‹åˆ°ï¼Œç³»ç»Ÿé€šè¿‡å˜æ¢mDiskWritesInFlightå°½å¯èƒ½æŠŠcommitè½¬æ¢ä¸ºapplyå»æ‰§è¡Œã€‚ commitåœ¨å½“å‰çº¿ç¨‹å°±ç›´æ¥runäº†ï¼Œè€Œapplyåˆ™æ˜¯æäº¤ç»™äº†QueuedWork.queue(writeToDiskRunnable,false)ã€‚ è¿™é‡Œè¦æ³¨æ„mDiskWritesInFlightè¿™ä¸ªè®¡æ•°å™¨åªæœ‰åœ¨commitToMemory()æ–¹æ³•ä¸­æ‰ä¼š++ï¼Œåªæœ‰åœ¨writeToFile()å®Œæˆåæ‰ä¼šâ€“ï¼Œæ‰€ä»¥å½“commitä¹‹åï¼Œç´§æ¥ç€å†æ¬¡è°ƒç”¨commitï¼Œé‚£ä¹ˆä¹‹åçš„commitéƒ½ä¼šè½¬æˆå¼‚æ­¥æ–¹å¼æ‰§è¡Œå†™å…¥ï¼Œè€Œå¼‚æ­¥æ˜¯é€šè¿‡HandlerThreadå®ç°çš„ï¼ˆ8.0ä»¥å‰åˆ™æ˜¯é€šè¿‡SingleThreadPoolå®ç°ï¼‰ï¼ŒQueuedWork.queue()æ–¹æ³•æ˜¯æŠŠä»»åŠ¡æäº¤åˆ°äº†ä¸€ä¸ªé™æ€é˜Ÿåˆ—é‡Œé¢ï¼Œç”±HandlerThreadé¡ºåºæ‰§è¡Œã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:8","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"commitToMemory // Returns true if any changes were made private MemoryCommitResult commitToMemory() { long memoryStateGeneration; boolean keysCleared = false; List\u003cString\u003e keysModified = null; Set\u003cOnSharedPreferenceChangeListener\u003e listeners = null; Map\u003cString, Object\u003e mapToWriteToDisk; //æ³¨æ„è¿™æŠŠé” synchronized (SharedPreferencesImpl.this.mLock) { if (mDiskWritesInFlight \u003e 0) { mMap = new HashMap\u003cString, Object\u003e(mMap); } // è½¬æ¢å¯¹è±¡ mapToWriteToDisk = mMap; mDiskWritesInFlight++; //åŒæ ·æ˜¯è½¬æ¢å¯¹è±¡ boolean hasListeners = mListeners.size() \u003e 0; if (hasListeners) { keysModified = new ArrayList\u003cString\u003e(); listeners = new HashSet\u003cOnSharedPreferenceChangeListener\u003e(mListeners.keySet()); } //åˆä¸€æŠŠé” synchronized (mEditorLock) { boolean changesMade = false; //æ³¨æ„è¿™ä¸ªæ ‡å¿—ä½ï¼Œä¸ºtrueè¯´æ˜è°ƒç”¨è¿‡editor.clear()æ–¹æ³• if (mClear) { if (!mapToWriteToDisk.isEmpty()) { changesMade = true; mapToWriteToDisk.clear(); } keysCleared = true; mClear = false; } //éå†æ‹·è´ for (Map.Entry\u003cString, Object\u003e e : mModified.entrySet()) { String k = e.getKey(); Object v = e.getValue(); if (v == this || v == null) {//è¯´æ˜è¢«editor.remove()è¿‡äº† if (!mapToWriteToDisk.containsKey(k)) { continue; } mapToWriteToDisk.remove(k); } else { if (mapToWriteToDisk.containsKey(k)) { Object existingValue = mapToWriteToDisk.get(k); if (existingValue != null \u0026\u0026 existingValue.equals(v)) {//å¦‚æœå€¼æ²¡å˜å°±è·³è¿‡ continue; } } mapToWriteToDisk.put(k, v); } changesMade = true; if (hasListeners) { keysModified.add(k); } } //æ¸…é™¤editorç¼“å­˜ï¼Œé‡Šæ”¾å†…å­˜ mModified.clear(); if (changesMade) { mCurrentMemoryStateGeneration++; } memoryStateGeneration = mCurrentMemoryStateGeneration; } } //è¿”å›ç»“æœ return new MemoryCommitResult(memoryStateGeneration, keysCleared, keysModified, listeners, mapToWriteToDisk); } commitToMemoryæ–¹æ³•é¡¾åæ€ä¹‰å°±æ˜¯æŠŠeditorçš„mModifiedä¸­çš„å€¼æäº¤åˆ°sharedferenceImplçš„mMapã€‚ è¿™é‡ŒåŠ äº†SharedPreferencesImpl.this.mLockï¼Œè¯´æ˜å¤šæ¬¡è°ƒç”¨commitæˆ–applyæ–¹æ³•éƒ½ä¼šé˜»å¡æ‰§è¡Œï¼Œè€Œä¸”åœ¨è¿›è¡Œcommitæˆ–è€…applyè¿˜æ²¡ç»“æŸæ—¶å°±è°ƒç”¨getXXX()ï¼Œä¾ç„¶ä¼šé€ æˆå¡é¡¿ã€‚ è€Œè¿™é‡Œå‡ºç°çš„ç¬¬äºŒæŠŠé”mEditorLockæ˜¯ä¸ºäº†ä¿è¯mModifiedçš„çº¿ç¨‹å®‰å…¨ã€‚ MemoryCommitResult MemoryCommitResultæ˜¯ä¸€ä¸ªæ‰“åŒ…ç±»ï¼Œå®ƒæŠŠå½“å‰çš„å†…å­˜ç¼“å­˜ã€å†…å­˜çŠ¶æ€ã€ç›‘å¬å›è°ƒã€å†™å…¥ç»“æœå…¨éƒ¨è£…ç®±åˆ°ä¸€èµ·ã€‚ private static class MemoryCommitResult { //å†…å­˜çŠ¶æ€ç‰ˆæœ¬å· final long memoryStateGeneration; final boolean keysCleared; @Nullable final List\u003cstring\u003e keysModified; @Nullable final Set\u003consharedpreferencechangelistener\u003e listeners; final Map\u003cstring, object\u003e mapToWriteToDisk; final CountDownLatch writtenToDiskLatch = new CountDownLatch(1); @GuardedBy(\"mWritingToDiskLock\") volatile boolean writeToDiskResult = false; boolean wasWritten = false; //ç§æœ‰æ„é€ æ–¹æ³• private MemoryCommitResult(long memoryStateGeneration, boolean keysCleared, @Nullable List\u003cstring\u003e keysModified, @Nullable Set\u003consharedpreferencechangelistener\u003e listeners, Map\u003cstring, object\u003e mapToWriteToDisk) { this.memoryStateGeneration = memoryStateGeneration; this.keysCleared = keysCleared; this.keysModified = keysModified; this.listeners = listeners; this.mapToWriteToDisk = mapToWriteToDisk; } //å”¯ä¸€æä¾›çš„æ–¹æ³•ï¼Œç”¨æ¥å˜æ›´æ ‡è®°ä¸ºï¼Œå‚¨å­˜å†™å…¥ç»“æœ //åªæœ‰è¿™é‡Œèƒ½å”¤é†’è®¡æ•°é”ï¼ï¼ï¼ void setDiskWriteResult(boolean wasWritten, boolean result) { this.wasWritten = wasWritten; writeToDiskResult = result; writtenToDiskLatch.countDown(); } } ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:9","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"applyæ–¹æ³•çš„QueuedWorkæœºåˆ¶ /** * @hide å¾ˆå¥‡æ€ªä¸ºå•¥å¥½ä¸œè¥¿éƒ½ä¸è®©æˆ‘ä»¬ç”¨å‘¢ï¼Ÿ */ public class QueuedWork { private static final long DELAY = 100; /** æˆ‘æ˜¯ä¸€æŠŠé” */ private static final Object sLock = new Object(); private static Object sProcessingWork = new Object(); @GuardedBy(\"sLock\") @UnsupportedAppUsage private static final LinkedList\u003cRunnable\u003e sFinishers = new LinkedList\u003c\u003e(); @GuardedBy(\"sLock\") private static Handler sHandler = null; /** Work queued via {@link #queue} */ @GuardedBy(\"sLock\") private static final LinkedList\u003cRunnable\u003e sWork = new LinkedList\u003c\u003e(); @GuardedBy(\"sLock\") private static boolean sCanDelay = true; /** * Add task */ @UnsupportedAppUsage public static void addFinisher(Runnable finisher) { synchronized (sLock) { sFinishers.add(finisher); } } /** * Remove task */ @UnsupportedAppUsage public static void removeFinisher(Runnable finisher) { synchronized (sLock) { sFinishers.remove(finisher); } } /** * åœ¨ä¸»çº¿ç¨‹ç«‹å³å¤„ç†å‰©ä½™ä»»åŠ¡ */ public static void waitToFinish() { boolean hadMessages = false; Handler handler = getHandler(); synchronized (sLock) { //è§£é™¤loop if (handler.hasMessages(QueuedWorkHandler.MSG_RUN)) { //ç§»é™¤æ¶ˆæ¯ï¼Œä½¿handlerThreadå‰©ä½™çš„ä»»åŠ¡ä¸å†æ‰§è¡Œäº† handler.removeMessages(QueuedWorkHandler.MSG_RUN); } // We should not delay any work as this might delay the finishers sCanDelay = false; } //çº¿ç¨‹ä½¿ç”¨è‡ªæ£€ StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites(); try { //å½“ç”Ÿå‘½å‘¨æœŸå˜åŒ–æ—¶ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨è§¦å‘å†™å…¥ï¼Œè¿™å¯æ˜¯åœ¨ä¸»çº¿ç¨‹å“¦ processPendingWork(); } finally { //å…è®¸åœ¨å½“å‰çº¿ç¨‹è¿›è¡Œæ–‡ä»¶å†™å…¥æ“ä½œ StrictMode.setThreadPolicy(oldPolicy); } //äº‹åæ£€æŸ¥æœºåˆ¶ï¼Œä¿è¯æ‰€æœ‰finisheréƒ½è¢«æ‰§è¡Œ try { while (true) { Runnable finisher; synchronized (sLock) { finisher = sFinishers.poll(); } //ç”±äºåœ¨åŒä¸€çº¿ç¨‹ä¸­å…ˆè°ƒç”¨äº†processPendingWork()ï¼Œå®Œæˆå†™æ“ä½œåå°±ä¼šremoveæ‰finisherï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¼šèµ°åˆ°è¿™é‡Œ if (finisher == null) { break; } finisher.run(); } } finally { sCanDelay = true; } } //åŒä¸€ä¸ªæ–¹æ³•åœ¨7.0ä¸Šçš„å®ç° // åœ¨ä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œå°±å•çº¯çš„é countDownLatch.await()æ¥ç­‰å¾…å…¨éƒ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ã€‚ public static void waitToFinish() { Runnable toFinish; while ((toFinish = sPendingWorkFinishers.poll()) != null) { toFinish.run(); } } /** * ä¸€çœ‹å°±æ‡‚ */ public static boolean hasPendingWork() { synchronized (sLock) { return !sWork.isEmpty(); } } /** * å¼‚æ­¥ä»»åŠ¡è°ƒåº¦,å…¶å®å°±æ˜¯åˆ‡æ¢åˆ°å·¥ä½œçº¿ç¨‹ * @param shouldDelay apply=false */ @UnsupportedAppUsage public static void queue(Runnable work, boolean shouldDelay) { Handler handler = getHandler(); synchronized (sLock) { sWork.add(work); if (shouldDelay \u0026\u0026 sCanDelay) { handler.sendEmptyMessageDelayed(QueuedWorkHandler.MSG_RUN, DELAY); } else { handler.sendEmptyMessage(QueuedWorkHandler.MSG_RUN); } } } /** * åˆ›å»ºä¸€ä¸ªHandlerThreadï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå•ä¾‹çš„Handler * queueæ–¹æ³•å’ŒwaitToFinishä¸­è°ƒç”¨ */ @UnsupportedAppUsage private static Handler getHandler() { synchronized (sLock) { if (sHandler == null) { HandlerThread handlerThread = new HandlerThread(\"queued-work-looper\", Process.THREAD_PRIORITY_FOREGROUND); handlerThread.start(); sHandler = new QueuedWorkHandler(handlerThread.getLooper()); } return sHandler; } } /** * è‡ªå®šä¹‰çš„Handler **/ private static class QueuedWorkHandler extends Handler { static final int MSG_RUN = 1; QueuedWorkHandler(Looper looper) { super(looper); } public void handleMessage(Message msg) { if (msg.what == MSG_RUN) { //åˆ‡æ¢åˆ°äº†handlerThreadæ‰€åœ¨çº¿ç¨‹ processPendingWork(); } } } /** * ç”¨æ¥å¤„ç†æŒ‚èµ·çš„ä»»åŠ¡ï¼Œæ ¸å¿ƒæ–¹æ³•ï¼Œéå†æ‰§è¡Œtaskï¼Œæ­¤æ—¶å·²åˆ‡æ¢åˆ°å·¥ä½œçº¿ç¨‹ **/ private static void processPendingWork() { //è¿™é‡Œåˆæ˜¯ä¸€æŠŠé” synchronized (sProcessingWork) { LinkedList\u003cRunnable\u003e work; //è¿™é‡Œçš„é”æ³¨æ„ä¸€ä¸‹ synchronized (sLock) { //æµ…æ‹·è´ï¼Œè¿™é‡Œçš„workå…¶å®æ˜¯writeToDiskRunnableï¼ŒåŒ…å«æ–‡ä»¶çš„å†™å…¥æ“ä½œå’Œfinisherè°ƒç”¨ work = (LinkedList\u003cRunnable\u003e) sWork.clone(); //é‡Šæ”¾å†…å­˜ sWork.clear(); //é‡Šæ”¾msg getHandler().removeMessages(QueuedWorkHandler.MSG_RUN); } //éå†æ‰§è¡Œtask if (work.size() \u003e 0) { for (Runnable w : work) { w.run(); } } } } } Activityåœ¨OnPauseæ—¶ä¼šè°ƒç”¨ActivityThreadçš„handleStopActivityæ–¹æ³•: @Override public void handleStopActivity(IBinder token, int configChanges, PendingTransactionActions pendingActions, boolean finalStateRequest, String reason) { final ActivityClientRecord r = mActivities.get(token); r.activity.mConfigChangeFlags |= configChanges; final StopInfo stopInfo = new StopInfo(); performStopActivityInner(r, stopInfo, true /","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:10","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"notifyListeners private void notifyListeners(final MemoryCommitResult mcr) { if (mcr.listeners == null || (mcr.keysModified == null \u0026\u0026 !mcr.keysCleared)) { return; } if (Looper.myLooper() == Looper.getMainLooper()) { //å¦‚æœå½“å‰æ˜¯ä¸»çº¿ç¨‹ï¼Œå°±éå†MemoryCommitResultä¸­listener if (mcr.keysCleared \u0026\u0026 Compatibility.isChangeEnabled(CALLBACK_ON_CLEAR_CHANGE)) { for (OnSharedPreferenceChangeListener listener : mcr.listeners) { if (listener != null) { listener.onSharedPreferenceChanged(SharedPreferencesImpl.this, null); } } } for (int i = mcr.keysModified.size() - 1; i \u003e= 0; i--) { final String key = mcr.keysModified.get(i); for (OnSharedPreferenceChangeListener listener : mcr.listeners) { if (listener != null) { listener.onSharedPreferenceChanged(SharedPreferencesImpl.this, key); } } } } else { //å¦‚æœå½“å‰æ˜¯å­çº¿ç¨‹ï¼Œå°±åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹é‡æ–°è°ƒç”¨æ–¹æ³• ActivityThread.sMainThreadHandler.post(() -\u003e notifyListeners(mcr)); } } çœ‹äº†è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘æ‰çŸ¥é“SPè¿˜å¯ä»¥æ³¨å†Œç›‘å¬ã€‚å¹¶ä¸”åªæœ‰åœ¨commitæˆ–è€…applyæ—¶æ‰ä¼šè§¦å‘ç›‘å¬ã€‚è€Œä¸”å¿…å®šåœ¨ä¸»çº¿ç¨‹å›è°ƒã€‚é‚£ä¹ˆå¦‚æœç›‘å¬å¤ªå¤šï¼Œæˆ–è€…ç›‘å¬é‡Œé¢æœ‰è€—æ—¶æ“ä½œï¼Œé‚£ä¹ˆå¿…å®šè¿˜æ˜¯ä¼šANRã€‚ ä¸‹é¢æ˜¯ç›‘å¬çš„ç”¨æ³•ï¼š val sp = getSharedPreferences(\"æˆ‘æ“¦\", Context.MODE_PRIVATE) val listener = object: SharedPreferences.OnSharedPreferenceChangeListener{ override fun onSharedPreferenceChanged(sharedPreferences: SharedPreferences?, key: String?) { // do something } } sp.registerOnSharedPreferenceChangeListener(listener) sp.unregisterOnSharedPreferenceChangeListener(listener) ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:2:11","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šSPçš„ç¼“å­˜æœºåˆ¶ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å†…å­˜ç¼“å­˜ ContextImplä¸­ private ArrayMap\u003cString, File\u003e mSharedPrefsPaths; ç”¨æ¥ç¼“å­˜spçš„fileå¯¹è±¡ï¼Œå®ƒæŠŠnameä¸fileä¸€ä¸€å¯¹åº”ï¼Œç”¨æ¥æ ¹æ®nameå¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„fileã€‚ private static ArrayMap\u003cString, ArrayMap\u003cFile, SharedPreferencesImpl\u003e\u003e sSharedPrefsCache; ç”¨æ¥æ ¹æ®fileç¼“å­˜spImlå¯¹è±¡ã€‚ private final File mFile; spçš„ç¡¬ç›˜ç¼“å­˜ã€‚ spImplä¸­ private Map\u003cString, Object\u003e mMap; å†…å®¹çš„å†…å­˜ç¼“å­˜ï¼Œä¸»è¦ç”¨äºgetXXX()æ–¹æ³•ã€‚ EditorImplä¸­ private final Map\u003cstring, object\u003e mModified = new HashMap\u003c\u003e(); å†™ç¼“å­˜ï¼Œä¸»è¦ç”¨äºputXXX()æ–¹æ³•å†™å…¥çš„ç¼“å­˜ï¼Œä¼šå…ˆå­˜åˆ°è¿™é‡Œï¼Œç­‰è°ƒç”¨commitæˆ–è€…applyæ—¶ï¼Œé€šè¿‡commitToMemoryæ–¹æ³•ä¸€æ¬¡æ€§åˆ·å…¥mapToWriteToDiskä¸­ã€‚ MemoryCommitResultä¸­ final Map\u003cstring, object\u003e mapToWriteToDisk; ç”¨æ¥åšå†™å…¥å‰çš„ç¼“å­˜ï¼Œä½†å…¶å®å¹¶ä¸æ˜¯ç¼“å­˜ï¼Œè€Œæ˜¯mMapçš„å¼•ç”¨ã€‚ä¿®æ”¹å®ƒå°±æ˜¯ä¿®æ”¹mMapã€‚ ç¡¬ç›˜ç¼“å­˜ mFile ï¼šä½äº/data/data/åŒ…å/shared_prefs/[name].xmlï¼ŒçœŸæ­£çš„spæ–‡ä»¶ï¼Œxmlæ ¼å¼ã€‚ mBackupFile: ä½äº/data/data/åŒ…å/shared_prefs/[name].xml.bak,å¤‡ä»½æ–‡ä»¶ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:3:1","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šSPçš„å¤‡ä»½æ¢å¤æœºåˆ¶ å¤‡ä»½ private void writeToFile(MemoryCommitResult mcr, boolean isFromSyncCommit) { //å¦‚æœæ–‡ä»¶å­˜åœ¨è€Œå¤‡ä»½ä¸å­˜åœ¨ï¼Œåˆ™ä»æºæ–‡ä»¶åˆ›å»ºå¤‡ä»½æ–‡ä»¶ã€‚ if (!backupFileExists) { if (!mFile.renameTo(mBackupFile)) { mcr.setDiskWriteResult(false, false); return; } } else {//å¦‚æœæºæ–‡ä»¶å’Œå¤‡ä»½éƒ½å­˜åœ¨ï¼Œåˆ™åˆ é™¤æºæ–‡ä»¶ mFile.delete(); } ///å†™å…¥æºæ–‡ä»¶ï¼Œæ­¤æ—¶ä¸€å®šä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æºæ–‡ä»¶ FileOutputStream str = createFileOutputStream(mFile); ... // å¦‚æœå†™å…¥æˆåŠŸï¼Œå°±åˆ é™¤å¤‡ä»½ mBackupFile.delete(); ///å†™å…¥å¤±è´¥å°±åˆ é™¤è„æ–‡ä»¶ï¼Œä¿ç•™å¤‡ä»½ mFile.delete() } è¿™é‡Œå°±ä¸€å¥è¯ï¼šå†™å‰å¤‡ä»½ï¼Œå†™åæˆåŠŸåˆ å¤‡ä»½ï¼Œå¤±è´¥åˆ æºæ–‡ä»¶ã€‚ æ¢å¤ SharedPreferencesImpl(File file, int mode) { mFile = file; mBackupFile = makeBackupFile(file); mMode = mode; mLoaded = false; mMap = null; mThrowable = null; startLoadFromDisk(); } åœ¨spImplçš„æ„é€ æ–¹æ³•ä¸­ä¼šåˆ›å»ºä¸€ä¸ªmBackupFileã€‚ä¹‹åï¼Œå°±ä¼šå¼€å§‹ä»ç¡¬ç›˜åŠ è½½ï¼Œä¹Ÿå°±æ˜¯startLoadFromDiskã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šåˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼Œæ‰§è¡ŒloadFromDisk: private void loadFromDisk() { synchronized (mLock) { if (mLoaded) { return; } //å¦‚æœæœ‰å¤‡ä»½å°±åˆ æ‰åŸæ–‡ä»¶ï¼Œç„¶åä»å¤‡ä»½ä¸­æ¢å¤ if (mBackupFile.exists()) { mFile.delete(); mBackupFile.renameTo(mFile); } } //ä»mFileä¸­è§£æxmlåˆ°mMapç¼“å­˜ä¸­ } è€Œç¬¬ä¸€æ¬¡é€šè¿‡æ„é€ æ–¹æ³•è¿‡æ¥åˆ°è¿™é‡Œæ—¶ï¼ŒmBackupFileè¿˜æ²¡æœ‰åˆ›å»ºçœŸå®çš„ç‰©ç†æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸ä¼šèµ°æ¢å¤æµç¨‹ï¼Œè€Œæ˜¯ç›´æ¥ä»mFileä¸­åŠ è½½å†…å®¹ã€‚ ä½†æ˜¯å¦‚æœmBackupFileå·²ç»å­˜åœ¨ï¼Œåˆ™å…ˆåˆ æ‰æºæ–‡ä»¶ï¼Œå†ä»å¤‡ä»½ä¸­æ¢å¤ï¼Œæœ€åå†è¯»å–åˆ°å†…å­˜ç¼“å­˜ã€‚ æ€»ç»“ SPä¼šåœ¨å†™å…¥ç¡¬ç›˜ä¹‹å‰ï¼Œå…ˆæŠŠä»¥å‰çš„æ•°æ®å¤‡ä»½ï¼Œå†™å…¥æˆåŠŸå°±åˆ é™¤å¤‡ä»½ï¼Œå¤±è´¥å°±åˆ é™¤è„çš„æºæ–‡ä»¶è€Œä¿ç•™å¤‡ä»½ã€‚å¾…ä¸‹æ¬¡åˆå§‹åŒ–SPæ—¶ï¼Œä¼šé‡æ–°ä»ç¡¬ç›˜è¯»å–å†…å®¹åˆ°ç¼“å­˜ï¼Œæ­¤æ—¶å¦‚æœå­˜åœ¨å¤‡ä»½ï¼Œå°±å…ˆåˆ æ‰æºæ–‡ä»¶å†ä»å¤‡ä»½è¿˜åŸã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:4:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šSPä¸­çš„é” mLock ä¸»è¦ç”¨æ¥ä¿æŠ¤spImplå¯¹è±¡çš„å®‰å…¨ï¼Œå®ƒæ˜¯æ‰€æœ‰è®¿é—®spImplå¯¹è±¡çš„æ“ä½œé˜»å¡ï¼Œå·²è¾¾åˆ°å®‰å…¨æ€§ç›®çš„ã€‚ mWritingToDiskLockï¼šæ–‡ä»¶å†™å…¥é”ï¼Œå½“å¤šæ¬¡è°ƒç”¨applyæ—¶å¯ä»¥é˜»å¡å†™å…¥ã€‚ mEditorLockï¼šå¤šçº¿ç¨‹è°ƒç”¨editor.putXXX()æ–¹æ³•æ—¶çš„åŒæ­¥é”ï¼Œç”¨æ¥ä¿æŠ¤editorå†…éƒ¨çš„mModifiedç¼“å­˜çš„æ•°æ®å®‰å…¨æ€§ã€‚ sLockï¼šQueuedWorkä¸­ç”¨æ¥åŒæ­¥å¯åŠ¨HandlerThreadå’ŒåŒæ­¥è®¿é—®workå’Œfinisherè¿™ä¸¤æ¡é˜Ÿåˆ—çš„åŒæ­¥é”ã€‚ sProcessingWorkï¼šç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨processPendingWork()æ–¹æ³•(å‰é¢è¯´è¿‡applyä¼šä¸€éƒ¨è°ƒç”¨è¿™æ–¹æ³•ï¼Œè€ŒactivityThreadä¼šåœ¨ç”Ÿå‘½å‘¨æœŸå˜åŒ–æ—¶åŒæ­¥è°ƒç”¨è¿™æ–¹æ³•)ã€‚ writtenToDiskLatch: æ–‡ä»¶å†™å…¥ç»“æœMemoryCommitResultä¸­çš„è®¡æ•°é”ï¼Œé˜»å¡å½“å‰çº¿ç¨‹ï¼Œåªèƒ½countDownä¸€æ¬¡ï¼Œä»£è¡¨æ–‡ä»¶è¯»å†™å®Œæˆ(å¹¶ä¸ä»£è¡¨æˆåŠŸ)ï¼Œç„¶åæ‰èƒ½ç»§ç»­æ‰§è¡Œçº¿ç¨‹ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:5:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šSPé€ æˆçš„å¡é¡¿ä¸ANRåˆ†æ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:6:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"xmlæ–‡ä»¶é€ æˆçš„å¡é¡¿ SPåœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œè¦åˆ›å»ºSPImplå¯¹è±¡æ—¶ä¼šåˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹è®¿é—®ç¡¬ç›˜ï¼ŒåŠ è½½å¹¶è§£æxmlæ–‡ä»¶åˆ°å†…å­˜ç¼“å­˜ã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶æ¯”è¾ƒå¤§å°±ä¼šé€ æˆå¡é¡¿ã€‚é‚£ä¸ºä»€ä¹ˆåœ¨å­çº¿ç¨‹ä¸­ç©è¿™ä¸€å¥—ä¼šå½±å“åˆ°ä¸»çº¿ç¨‹å‘¢ï¼Ÿå°±å› ä¸ºç©çš„æ˜¯xmlæ ¼å¼æ–‡ä»¶ã€‚ SPä½¿ç”¨äº†é«˜æ•ˆçš„pollæ–¹å¼æ¥è§£æxmlæˆmapï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ä¼šåˆ›å»ºå¤§é‡çš„ä¸´æ—¶å¯¹è±¡ï¼Œé€ æˆé¢‘ç¹çš„GCï¼Œè€Œjavaåœ¨GCæ—¶ä¼šæš‚åœæ‰€æœ‰çš„çº¿ç¨‹ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ä¸»çº¿ç¨‹ï¼Œè¿™å°±é€ æˆäº†ä¸»çº¿ç¨‹çš„å¡é¡¿äº†ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:6:1","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åˆå§‹åŒ–åç›´æ¥è¯»å–é€ æˆçš„å¡é¡¿ åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨startLoadFromDisk()åŠ è½½æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶è¿˜æ²¡æœ‰åŠ è½½å®Œå°±åœ¨ä¸»çº¿ç¨‹è°ƒç”¨getXXX()æ–¹æ³•ä¹Ÿä¼šé€ æˆå¡é¡¿ï¼Œç”šè‡³ANRã€‚å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ç«äº‰**mLock**é”ï¼Œå¹¶ä¸”åœ¨getXXX()ä¸­è¿˜ä¼šæ­»å¾ªç¯è®©mLock.wait()ï¼Œè€Œåªæœ‰æ–‡ä»¶å…¨éƒ¨è¯»å–å®Œæˆåè¿™æŠŠé”æ‰ä¼šnotifyAllã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:6:2","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"commitæ–¹æ³•é€ æˆçš„å¡é¡¿ commitæ˜¯åœ¨å½“å‰çº¿ç¨‹å»å†™å…¥ï¼Œå†™å…¥å®Œæˆä¹‹åè¿˜ä¼šè¿”å›ç»“æœï¼Œå¦‚æœåœ¨ä¸»çº¿ç¨‹è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šå®¹æ˜“å¼•èµ·ANRã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:6:3","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"applyæ–¹æ³•å¼•èµ·çš„ANR applyæœ¬èº«æ˜¯ä¾é handlerThreadä»»åŠ¡é˜Ÿåˆ—æ¥å¼‚æ­¥å†™å…¥çš„ï¼Œä½†æ˜¯ActivityThreadåœ¨ç”Ÿå‘½å‘¨æœŸå‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šåœ¨ä¸»çº¿ç¨‹ä¸»åŠ¨è°ƒç”¨QueuedWorkçš„waitToFinish()æ–¹æ³•ï¼Œéå†æ‰§è¡Œæ‰€æœ‰çš„finisherï¼Œè€Œfinisherä¸­åªæœ‰ä¸€è¡Œä»£ç ï¼Œå°±æ˜¯è®©mcrçš„è®¡æ•°é”å»awaitå½“å‰çº¿ç¨‹ï¼Œå¯¹äºactivityThreadæ¥è¯´å°±æ˜¯ä¸»çº¿ç¨‹ã€‚ Android8.0ä¹‹åï¼Œè¿˜åŠ å…¥å¯ä¸»åŠ¨è°ƒç”¨processPendingWork()æ–¹æ³•æ‰§è¡Œå†™å…¥ï¼Œæ‰€ä»¥å¯¼è‡´Applyæ–¹æ³•ä¹Ÿå¾ˆå®¹æ˜“é€ æˆANRã€‚ è€Œå¦‚æœæˆ‘ä»¬è¿‡å¤šçš„ä½¿ç”¨äº†applyï¼Œé‚£ä¹ˆå°±æ”¾åˆ°äº†QueuedWorkä¸­çš„ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¾é ä»…ä»…ä¸€ä¸ªHandlerThreadï¼Œä¸€ä¸ªä¸€ä¸ªçš„æ…¢æ…¢å¤„ç†ã€‚é‚£ä¹ˆå½“ç”Ÿå‘½å‘¨æœŸæ”¹å˜æ—¶ï¼Œè¿™äº›workæ²¡æœ‰è¢«å¤„ç†å®Œï¼ŒwaitToFinish()æ–¹æ³•å°±ä¼šç§»é™¤å‰©ä½™çš„msgï¼Œå‰©ä¸‹çš„workä¼šåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ¥æ‰§è¡Œï¼Œå¹¶ä¸”é è®¡æ•°é”é˜»å¡ä¸»çº¿ç¨‹ï¼Œå°±é€ æˆäº†ANRã€‚ ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œgoogleå¸Œæœ›åœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸæ”¹å˜æ—¶ï¼Œspåº”è¯¥åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹åŒæ­¥å†™å…¥ï¼Œå®å¯é˜»å¡UIä¹Ÿè¦ä¿è¯spçš„å†™å…¥å®Œæ•´æ€§ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åˆ°ä¸‹ä¸€ä¸ªé¡µé¢æˆ‘ä»¬ç›´æ¥getæ—¶èƒ½å¤Ÿæ‹¿åˆ°æœ€æ–°çš„å€¼ã€‚åŒæ—¶è¿™é‡Œä¹Ÿä½“ç°äº†spåº”è¯¥åªå­˜å…¥å°‘é‡æ•°æ®çš„è®¾è®¡æ€æƒ³ã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:6:4","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šSPçš„é—®é¢˜æ¢³ç† xmlæ ¼å¼ï¼Œå¯¼è‡´æ–‡ä»¶åºå¤§ï¼Œå ç”¨ç¡¬ç›˜ï¼› xmlè§£æå¸¦æ¥çš„é¢‘ç¹GCï¼Œé€ æˆå¡é¡¿ï¼› åˆå§‹åŒ–æ—¶æŠŠæ‰€æœ‰æ–‡ä»¶å†…å®¹ç¼“å­˜ï¼Œé€ æˆå†…å­˜å‹åŠ›ï¼› commitå’Œapplyéƒ½ä¼šé€ æˆANRï¼› æ¯æ¬¡å…¨é‡å†™å…¥ï¼› è¿›ç¨‹ä¸å®‰å…¨ï¼› åªèƒ½åœ¨ä¸»çº¿ç¨‹ç›‘å¬ï¼› ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:7:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šæ³¨æ„äº‹é¡¹ï¼š ä¸è¦å­˜è¿‡å¤šå†…å®¹ï¼Œå°¤å…¶ä¸è¦å­˜jsonå­—ç¬¦ä¸²ï¼Œå› ä¸ºjsonå­—ç¬¦ä¸²ä¸­å­˜åœ¨å¤§é‡çš„è½¬ä¹‰å­—ç¬¦\u0026ï¼› å°½é‡æ‹†åˆ†å¤šä¸ªspæ–‡ä»¶ï¼› ä¸è¦åœ¨åˆå§‹åŒ–spåå°±ç›´æ¥put; ä¸è¦è¿‡å¤šè°ƒç”¨sp.edit()å› ä¸ºæ¯æ¬¡éƒ½ä¼šç”Ÿæˆæ–°çš„editorå¯¹è±¡ï¼› å°½é‡ä½¿ç”¨applyæ–¹æ³•ï¼Œä¸è¦å¤šæ¬¡ä½¿ç”¨applyæ–¹æ³•ã€‚ å¤šè¿›ç¨‹ä½¿ç”¨ä¾èµ–contentProviderã€‚ ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:8:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸“é¢˜ï¼šæ”¹é€ æ€è·¯ é‡‡ç”¨protobufå‡å°‘æ–‡ä»¶ä½“ç§¯ï¼Œæé«˜åºåˆ—åŒ–ã€ååºåˆ—åŒ–æ•ˆç‡ï¼Œæé«˜ioé€Ÿåº¦ï¼› å¼•å…¥æ‡’åŠ è½½æœºåˆ¶ï¼› å¢é‡å†™å…¥ï¼› è§£é™¤ç›‘å¬å›è°ƒçš„ä¸»çº¿ç¨‹é™åˆ¶ã€‚ ç»ˆææ–¹æ¡ˆå½“ç„¶æ˜¯æ”¹ç”¨mmkvæˆ–è€…dataStorge ","date":"2021-04-30","objectID":"/sharedpreferences%E8%A7%A3%E8%AF%BB/:9:0","series":null,"tags":["Android"],"title":"SharedPreferencesè§£è¯»","uri":"/sharedpreferences%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åŸå›  çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æŒæœ‰é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œé€ æˆçŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡åœ¨ä¸éœ€è¦ä½¿ç”¨æ—¶ä¸èƒ½è¢«å›æ”¶ã€‚ ","date":"2021-03-24","objectID":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/:1:0","series":null,"tags":["Android","å†…å­˜æ³„éœ²","NPE"],"title":"Androidå†…å­˜æ³„éœ²ä¸“é¢˜","uri":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/"},{"categories":null,"content":"é™æ€å˜é‡å¯¼è‡´ public class MainActivity extends AppCompatActivity { public static boolean RESULT; private static Activity mActivity; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mActivity = this; } } ","date":"2021-03-24","objectID":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/:1:1","series":null,"tags":["Android","å†…å­˜æ³„éœ²","NPE"],"title":"Androidå†…å­˜æ³„éœ²ä¸“é¢˜","uri":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/"},{"categories":null,"content":"LeakCanaryåŸç† class App extends Application { @Override public void onCreate() { super.onCreate(); registerActivityLifecycleCallbacks(new ActivityLifecycleCallbacks() { @Override public void onActivityCreated(@NonNull Activity activity, @Nullable Bundle savedInstanceState) { } @Override public void onActivityStarted(@NonNull Activity activity) { } @Override public void onActivityResumed(@NonNull Activity activity) { } @Override public void onActivityPaused(@NonNull Activity activity) { } @Override public void onActivityStopped(@NonNull Activity activity) { } @Override public void onActivitySaveInstanceState(@NonNull Activity activity, @NonNull Bundle outState) { } @Override public void onActivityDestroyed(@NonNull Activity activity) { } }); } } Applicationæä¾›äº†registerActivityLifecycleCallbacksæ–¹æ³•ï¼Œå¯ä»¥ç›‘å¬Activityçš„ç”Ÿå‘½å‘¨æœŸï¼Œè€ŒFragmentManagerä¸­æä¾›äº†registerFragmentLifecycleCallbacksæ–¹æ³•å¯ä»¥ç›‘å¬Fragmentçš„ç”Ÿå‘½å‘¨æœŸã€‚ åœ¨onActivityDestroyedæ–¹æ³•ä¸­ç›‘å¬åˆ°Activityæ­£åœ¨é”€æ¯ï¼Œå°±ç”¨å¼±å¼•ç”¨å»åŒ…è£…è¿™ä¸ªActivityï¼Œç„¶åæ”¾å…¥é˜Ÿåˆ—é‡Œé¢ï¼Œä»çº¿ç¨‹æ± ä¸­obtainå‡ºä¸€ä¸ªçº¿ç¨‹ï¼Œ5ç§’ä¹‹ååˆ¤æ–­è¿™ä¸ªActivityçš„å¼±å¼•ç”¨æ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullå°±æ˜¯å·²è¢«å›æ”¶äº†ã€‚å¦‚æœä¸æ˜¯nullï¼Œè¯´æ˜æ²¡æœ‰è¢«å›æ”¶ï¼Œå¯èƒ½å­˜åœ¨å†…å­˜æ³„éœ²ï¼Œè¿™æ—¶å€™å¼ºåˆ¶GCå›æ”¶ä»–ï¼Œå¦‚æœè¿˜ä¸ä¸ºnullï¼Œè¯´æ˜ç¡®å®å­˜åœ¨å†…å­˜æ³„éœ²ã€‚ ç„¶åé€šè¿‡HAHAè·å–å†…å­˜ä¸­heapå †å¿«æ‰¾å¼•ç”¨å…³ç³»ã€‚ ","date":"2021-03-24","objectID":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/:1:2","series":null,"tags":["Android","å†…å­˜æ³„éœ²","NPE"],"title":"Androidå†…å­˜æ³„éœ²ä¸“é¢˜","uri":"/android%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E4%B8%93%E9%A2%98/"},{"categories":["policy"],"content":"ä¸­å…±ä¸­å¤® å›½åŠ¡é™¢å°å‘æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ€»ä½“æ–¹æ¡ˆ ä¸­å…±ä¸­å¤® å›½åŠ¡é™¢å°å‘ã€Šæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ€»ä½“æ–¹æ¡ˆã€‹ æ–°åç¤¾åŒ—äº¬6æœˆ1æ—¥ç”µ ä¸­å…±ä¸­å¤®ã€å›½åŠ¡é™¢å°å‘äº†ã€Šæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ€»ä½“æ–¹æ¡ˆã€‹ï¼Œå¹¶å‘å‡ºé€šçŸ¥ï¼Œè¦æ±‚å„åœ°åŒºå„éƒ¨é—¨ç»“åˆå®é™…è®¤çœŸè´¯å½»è½å®ã€‚ ã€Šæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ€»ä½“æ–¹æ¡ˆã€‹ä¸»è¦å†…å®¹å¦‚ä¸‹ã€‚ æµ·å—æ˜¯æˆ‘å›½æœ€å¤§çš„ç»æµç‰¹åŒºï¼Œå…·æœ‰å®æ–½å…¨é¢æ·±åŒ–æ”¹é©å’Œè¯•éªŒæœ€é«˜æ°´å¹³å¼€æ”¾æ”¿ç­–çš„ç‹¬ç‰¹ä¼˜åŠ¿ã€‚æ”¯æŒæµ·å—é€æ­¥æ¢ç´¢ã€ç¨³æ­¥æ¨è¿›ä¸­å›½ç‰¹è‰²è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾ï¼Œåˆ†æ­¥éª¤ã€åˆ†é˜¶æ®µå»ºç«‹è‡ªç”±è´¸æ˜“æ¸¯æ”¿ç­–å’Œåˆ¶åº¦ä½“ç³»ï¼Œæ˜¯ä¹ è¿‘å¹³æ€»ä¹¦è®°äº²è‡ªè°‹åˆ’ã€äº²è‡ªéƒ¨ç½²ã€äº²è‡ªæ¨åŠ¨çš„æ”¹é©å¼€æ”¾é‡å¤§ä¸¾æªï¼Œæ˜¯å…šä¸­å¤®ç€çœ¼å›½å†…å›½é™…ä¸¤ä¸ªå¤§å±€ï¼Œæ·±å…¥ç ”ç©¶ã€ç»Ÿç­¹è€ƒè™‘ã€ç§‘å­¦è°‹åˆ’ä½œå‡ºçš„æˆ˜ç•¥å†³ç­–ã€‚å½“ä»Šä¸–ç•Œæ­£åœ¨ç»å†æ–°ä¸€è½®å¤§å‘å±•å¤§å˜é©å¤§è°ƒæ•´ï¼Œä¿æŠ¤ä¸»ä¹‰ã€å•è¾¹ä¸»ä¹‰æŠ¬å¤´ï¼Œç»æµå…¨çƒåŒ–é­é‡æ›´å¤§çš„é€†é£å’Œå›å¤´æµªã€‚åœ¨æµ·å—å»ºè®¾è‡ªç”±è´¸æ˜“æ¸¯ï¼Œæ˜¯æ¨è¿›é«˜æ°´å¹³å¼€æ”¾ï¼Œå»ºç«‹å¼€æ”¾å‹ç»æµæ–°ä½“åˆ¶çš„æ ¹æœ¬è¦æ±‚ï¼›æ˜¯æ·±åŒ–å¸‚åœºåŒ–æ”¹é©ï¼Œæ‰“é€ æ³•æ²»åŒ–ã€å›½é™…åŒ–ã€ä¾¿åˆ©åŒ–è¥å•†ç¯å¢ƒçš„è¿«åˆ‡éœ€è¦ï¼›æ˜¯è´¯å½»æ–°å‘å±•ç†å¿µï¼Œæ¨åŠ¨é«˜è´¨é‡å‘å±•ï¼Œå»ºè®¾ç°ä»£åŒ–ç»æµä½“ç³»çš„æˆ˜ç•¥é€‰æ‹©ï¼›æ˜¯æ”¯æŒç»æµå…¨çƒåŒ–ï¼Œæ„å»ºäººç±»å‘½è¿å…±åŒä½“çš„å®é™…è¡ŒåŠ¨ã€‚ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°åœ¨åº†ç¥æµ·å—å»ºçœåŠç»æµç‰¹åŒº30å‘¨å¹´å¤§ä¼šä¸Šçš„é‡è¦è®²è¯ç²¾ç¥ï¼Œè½å®ã€Šä¸­å…±ä¸­å¤®ã€å›½åŠ¡é™¢å…³äºæ”¯æŒæµ·å—å…¨é¢æ·±åŒ–æ”¹é©å¼€æ”¾çš„æŒ‡å¯¼æ„è§ã€‹è¦æ±‚ï¼ŒåŠ å¿«å»ºè®¾é«˜æ°´å¹³çš„ä¸­å›½ç‰¹è‰²è‡ªç”±è´¸æ˜“æ¸¯ï¼Œåˆ¶å®šæœ¬æ–¹æ¡ˆã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:0:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ä¸€ã€æ€»ä½“è¦æ±‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:1:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸€ï¼‰æŒ‡å¯¼æ€æƒ³ ä»¥ä¹ è¿‘å¹³æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ€æƒ³ä¸ºæŒ‡å¯¼ï¼Œå…¨é¢è´¯å½»å…šçš„åä¹å¤§å’Œåä¹å±ŠäºŒä¸­ã€ä¸‰ä¸­ã€å››ä¸­å…¨ä¼šç²¾ç¥ï¼ŒåšæŒå…šçš„å…¨é¢é¢†å¯¼ï¼ŒåšæŒç¨³ä¸­æ±‚è¿›å·¥ä½œæ€»åŸºè°ƒï¼ŒåšæŒæ–°å‘å±•ç†å¿µï¼ŒåšæŒé«˜è´¨é‡å‘å±•ï¼Œç»Ÿç­¹æ¨è¿›â€œäº”ä½ä¸€ä½“â€æ€»ä½“å¸ƒå±€ï¼Œåè°ƒæ¨è¿›â€œå››ä¸ªå…¨é¢â€æˆ˜ç•¥å¸ƒå±€ï¼Œå¯¹æ ‡å›½é™…é«˜æ°´å¹³ç»è´¸è§„åˆ™ï¼Œè§£æ”¾æ€æƒ³ã€å¤§èƒ†åˆ›æ–°ï¼Œèšç„¦è´¸æ˜“æŠ•èµ„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–ï¼Œå»ºç«‹ä¸é«˜æ°´å¹³è‡ªç”±è´¸æ˜“æ¸¯ç›¸é€‚åº”çš„æ”¿ç­–åˆ¶åº¦ä½“ç³»ï¼Œå»ºè®¾å…·æœ‰å›½é™…ç«äº‰åŠ›å’Œå½±å“åŠ›çš„æµ·å…³ç›‘ç®¡ç‰¹æ®ŠåŒºåŸŸï¼Œå°†æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ‰“é€ æˆä¸ºå¼•é¢†æˆ‘å›½æ–°æ—¶ä»£å¯¹å¤–å¼€æ”¾çš„é²œæ˜æ——å¸œå’Œé‡è¦å¼€æ”¾é—¨æˆ·ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:1:1","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆäºŒï¼‰åŸºæœ¬åŸåˆ™ å€Ÿé‰´å›½é™…ç»éªŒã€‚åšæŒé«˜èµ·ç‚¹è°‹åˆ’ã€é«˜æ ‡å‡†å»ºè®¾ï¼Œä¸»åŠ¨é€‚åº”å›½é™…ç»è´¸è§„åˆ™é‡æ„æ–°è¶‹åŠ¿ï¼Œå……åˆ†å­¦ä¹ å€Ÿé‰´å›½é™…è‡ªç”±è´¸æ˜“æ¸¯ï¼ˆé¦™æ¸¯ï¼Œæ–°åŠ å¡ï¼Ÿï¼‰çš„å…ˆè¿›ç»è¥æ–¹å¼ã€ç®¡ç†æ–¹æ³•å’Œåˆ¶åº¦å®‰æ’ï¼Œå½¢æˆå…·æœ‰å›½é™…ç«äº‰åŠ›çš„å¼€æ”¾æ”¿ç­–å’Œåˆ¶åº¦ï¼ŒåŠ å¿«å»ºç«‹å¼€æ”¾å‹ç»æµæ–°ä½“åˆ¶ï¼Œå¢å¼ºåŒºåŸŸè¾å°„å¸¦åŠ¨ä½œç”¨ï¼Œæ‰“é€ æˆ‘å›½æ·±åº¦èå…¥å…¨çƒç»æµä½“ç³»çš„å‰æ²¿åœ°å¸¦ã€‚ ä½“ç°ä¸­å›½ç‰¹è‰²ã€‚åšæŒå…šçš„é›†ä¸­ç»Ÿä¸€é¢†å¯¼ï¼ŒåšæŒä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰é“è·¯ï¼ŒåšæŒä»¥äººæ°‘ä¸ºä¸­å¿ƒï¼Œè·µè¡Œç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼Œç¡®ä¿æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ­£ç¡®æ–¹å‘ã€‚å……åˆ†å‘æŒ¥å…¨å›½ä¸Šä¸‹ä¸€ç›˜æ£‹å’Œé›†ä¸­åŠ›é‡åŠå¤§äº‹çš„åˆ¶åº¦ä¼˜åŠ¿ï¼Œè°ƒåŠ¨å„æ–¹é¢ç§¯ææ€§å’Œåˆ›é€ æ€§ï¼Œé›†èšå…¨çƒä¼˜è´¨ç”Ÿäº§è¦ç´ ï¼Œç€åŠ›åœ¨æ¨åŠ¨åˆ¶åº¦åˆ›æ–°ã€åŸ¹è‚²å¢é•¿åŠ¨èƒ½ã€æ„å»ºå…¨é¢å¼€æ”¾æ–°æ ¼å±€ç­‰æ–¹é¢å–å¾—æ–°çªç ´ï¼Œä¸ºå®ç°å›½å®¶æˆ˜ç•¥ç›®æ ‡æä¾›åšå®æ”¯æ’‘ã€‚åŠ å¼ºä¸ä¸œå—äºšå›½å®¶äº¤æµåˆä½œï¼Œä¿ƒè¿›ä¸ç²¤æ¸¯æ¾³å¤§æ¹¾åŒºè”åŠ¨å‘å±•ã€‚ ç¬¦åˆæµ·å—å®šä½ã€‚ç´§ç´§å›´ç»•å›½å®¶èµ‹äºˆæµ·å—å»ºè®¾å…¨é¢æ·±åŒ–æ”¹é©å¼€æ”¾è¯•éªŒåŒºã€å›½å®¶ç”Ÿæ€æ–‡æ˜è¯•éªŒåŒºã€å›½é™…æ—…æ¸¸æ¶ˆè´¹ä¸­å¿ƒå’Œå›½å®¶é‡å¤§æˆ˜ç•¥æœåŠ¡ä¿éšœåŒºçš„æˆ˜ç•¥å®šä½ï¼Œå……åˆ†å‘æŒ¥æµ·å—è‡ªç„¶èµ„æºä¸°å¯Œã€åœ°ç†åŒºä½ç‹¬ç‰¹ä»¥åŠèƒŒé è¶…å¤§è§„æ¨¡å›½å†…å¸‚åœºå’Œè…¹åœ°ç»æµç­‰ä¼˜åŠ¿ï¼ŒæŠ¢æŠ“å…¨çƒæ–°ä¸€è½®ç§‘æŠ€é©å‘½å’Œäº§ä¸šå˜é©é‡è¦æœºé‡ï¼Œèšç„¦å‘å±•(æ¥äº†): æ—…æ¸¸ä¸š ç°ä»£æœåŠ¡ä¸š é«˜æ–°æŠ€æœ¯äº§ä¸š åŠ å¿«åŸ¹è‚²å…·æœ‰æµ·å—ç‰¹è‰²çš„åˆä½œç«äº‰æ–°ä¼˜åŠ¿ã€‚ çªå‡ºæ”¹é©åˆ›æ–°ã€‚å¼ºåŒ–æ”¹é©åˆ›æ–°æ„è¯†ï¼Œèµ‹äºˆæµ·å—æ›´å¤§æ”¹é©è‡ªä¸»æƒï¼Œæ”¯æŒæµ·å—å…¨æ–¹ä½å¤§åŠ›åº¦æ¨è¿›æ”¹é©åˆ›æ–°ï¼Œç§¯ææ¢ç´¢å»ºç«‹é€‚åº”è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾çš„æ›´åŠ çµæ´»é«˜æ•ˆçš„æ³•å¾‹æ³•è§„ã€ç›‘ç®¡æ¨¡å¼å’Œç®¡ç†ä½“åˆ¶ï¼Œä¸‹å¤§åŠ›æ°”ç ´é™¤é˜»ç¢ç”Ÿäº§è¦ç´ æµåŠ¨çš„ä½“åˆ¶æœºåˆ¶éšœç¢ã€‚æ·±å…¥æ¨è¿›å•†å“å’Œè¦ç´ æµåŠ¨å‹å¼€æ”¾ï¼ŒåŠ å¿«æ¨åŠ¨è§„åˆ™ç­‰åˆ¶åº¦å‹å¼€æ”¾ï¼Œä»¥é«˜æ°´å¹³å¼€æ”¾å¸¦åŠ¨æ”¹é©å…¨é¢æ·±åŒ–ã€‚åŠ å¼ºæ”¹é©ç³»ç»Ÿé›†æˆï¼Œæ³¨é‡åè°ƒæ¨è¿›ï¼Œä½¿å„æ–¹é¢åˆ›æ–°ä¸¾æªç›¸äº’é…åˆã€ç›¸å¾—ç›Šå½°ï¼Œæé«˜æ”¹é©åˆ›æ–°çš„æ•´ä½“æ•ˆç›Šã€‚ åšæŒåº•çº¿æ€ç»´ã€‚åšæŒç¨³æ‰ç¨³æ‰“ã€æ­¥æ­¥ä¸ºè¥ï¼Œç»Ÿç­¹å®‰æ’å¥½å¼€æ”¾èŠ‚å¥å’Œè¿›åº¦ï¼Œæˆç†Ÿä¸€é¡¹æ¨å‡ºä¸€é¡¹ï¼Œä¸æ€¥äºæ±‚æˆã€æ€¥åŠŸè¿‘åˆ©ã€‚æ·±å…¥æ¨è¿›ç®€æ”¿æ”¾æƒã€æ”¾ç®¡ç»“åˆã€ä¼˜åŒ–æœåŠ¡ï¼Œå…¨é¢æ¨è¡Œå‡†å…¥ä¾¿åˆ©ã€ä¾æ³•è¿‡ç¨‹ç›‘ç®¡çš„åˆ¶åº¦ä½“ç³»ï¼Œå»ºç«‹ä¸å›½é™…æ¥è½¨çš„ç›‘ç®¡æ ‡å‡†å’Œè§„èŒƒåˆ¶åº¦ã€‚åŠ å¼ºé‡å¤§é£é™©è¯†åˆ«å’Œç³»ç»Ÿæ€§é£é™©é˜²èŒƒï¼Œå»ºç«‹å¥å…¨é£é™©é˜²æ§é…å¥—æªæ–½ã€‚å®Œå–„é‡å¤§ç–«æƒ…é˜²æ§ä½“åˆ¶æœºåˆ¶ï¼Œå¥å…¨å…¬å…±å«ç”Ÿåº”æ€¥ç®¡ç†ä½“ç³»ã€‚å¼€å±•å¸¸æ€åŒ–è¯„ä¼°å·¥ä½œï¼ŒåŠæ—¶çº åçº é”™ï¼Œç¡®ä¿æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ–¹å‘æ­£ç¡®ã€å¥åº·å‘å±•ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:1:2","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸‰ï¼‰å‘å±•ç›®æ ‡ åˆ°2025å¹´ åˆæ­¥å»ºç«‹ä»¥è´¸æ˜“è‡ªç”±ä¾¿åˆ©å’ŒæŠ•èµ„è‡ªç”±ä¾¿åˆ©ä¸ºé‡ç‚¹çš„è‡ªç”±è´¸æ˜“æ¸¯æ”¿ç­–åˆ¶åº¦ä½“ç³»ã€‚è¥å•†ç¯å¢ƒæ€»ä½“è¾¾åˆ°å›½å†…ä¸€æµæ°´å¹³ï¼Œå¸‚åœºä¸»ä½“å¤§å¹…å¢é•¿ï¼Œäº§ä¸šç«äº‰åŠ›æ˜¾è‘—æå‡ï¼Œé£é™©é˜²æ§æœ‰åŠ›æœ‰æ•ˆï¼Œé€‚åº”è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾çš„æ³•å¾‹æ³•è§„é€æ­¥å®Œå–„ï¼Œç»æµå‘å±•è´¨é‡å’Œæ•ˆç›Šæ˜æ˜¾æ”¹å–„ã€‚ æ„Ÿè§‰25å¹´ç›®æ ‡ä¸»è¦è¿˜æ˜¯å»ºç«‹åˆç†çš„æ”¿ç­–å’Œä½“ç³»åˆ¶åº¦ï¼Œä¼˜åŒ–è¥å•†ç¯å¢ƒã€‚é‚£ä¹ˆè¿™å°±æ˜¯ä¸ªæ·˜é‡‘æœŸäº†ã€‚ åˆ°2035å¹´ è‡ªç”±è´¸æ˜“æ¸¯åˆ¶åº¦ä½“ç³»å’Œè¿ä½œæ¨¡å¼æ›´åŠ æˆç†Ÿï¼Œä»¥è‡ªç”±ã€å…¬å¹³ã€æ³•æ²»ã€é«˜æ°´å¹³è¿‡ç¨‹ç›‘ç®¡ä¸ºç‰¹å¾çš„è´¸æ˜“æŠ•èµ„è§„åˆ™åŸºæœ¬æ„å»ºï¼Œå®ç°è´¸æ˜“è‡ªç”±ä¾¿åˆ©ã€æŠ•èµ„è‡ªç”±ä¾¿åˆ©ã€è·¨å¢ƒèµ„é‡‘æµåŠ¨è‡ªç”±ä¾¿åˆ©ã€äººå‘˜è¿›å‡ºè‡ªç”±ä¾¿åˆ©ã€è¿è¾“æ¥å¾€è‡ªç”±ä¾¿åˆ©å’Œæ•°æ®å®‰å…¨æœ‰åºæµåŠ¨ã€‚è¥å•†ç¯å¢ƒæ›´åŠ ä¼˜åŒ–ï¼Œæ³•å¾‹æ³•è§„ä½“ç³»æ›´åŠ å¥å…¨ï¼Œé£é™©é˜²æ§ä½“ç³»æ›´åŠ ä¸¥å¯†ï¼Œç°ä»£ç¤¾ä¼šæ²»ç†æ ¼å±€åŸºæœ¬å½¢æˆï¼Œæˆä¸ºæˆ‘å›½å¼€æ”¾å‹ç»æµæ–°é«˜åœ°ã€‚ 35å¹´è¾¾åˆ°æˆç†ŸæœŸï¼Œä½“åˆ¶æ›´åŠ å¥å…¨ï¼Œç›¸å¯¹æœºä¼šå°±ä¼šè¶Šæ¥è¶Šå°‘ã€‚ åˆ°æœ¬ä¸–çºªä¸­å¶ å…¨é¢å»ºæˆå…·æœ‰è¾ƒå¼ºå›½é™…å½±å“åŠ›çš„é«˜æ°´å¹³è‡ªç”±è´¸æ˜“æ¸¯ã€‚ åˆ°50å¹´åŸºæœ¬å…¨é¢å»ºæˆï¼Œé‚£ä¹ˆåŸºæœ¬ä¸Šèµ„æºä¼šè¢«å¤´éƒ¨å é¢†ï¼Œå„ç§å…³ç³»ä¹Ÿéƒ½ç¨³å›ºäº†ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:1:3","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆå››ï¼‰å®æ–½èŒƒå›´ã€‚ æµ·å—è‡ªç”±è´¸æ˜“æ¸¯çš„å®æ–½èŒƒå›´ä¸ºæµ·å—å²›å…¨å²›ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:1:4","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"äºŒã€åˆ¶åº¦è®¾è®¡ ä»¥è´¸æ˜“æŠ•èµ„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–ä¸ºé‡ç‚¹ï¼Œä»¥å„ç±»ç”Ÿäº§è¦ç´ è·¨å¢ƒè‡ªç”±æœ‰åºå®‰å…¨ä¾¿æ·æµåŠ¨å’Œç°ä»£äº§ä¸šä½“ç³»ä¸ºæ”¯æ’‘ï¼Œä»¥ç‰¹æ®Šçš„ç¨æ”¶åˆ¶åº¦å®‰æ’ã€é«˜æ•ˆçš„ç¤¾ä¼šæ²»ç†ä½“ç³»å’Œå®Œå¤‡çš„æ³•æ²»ä½“ç³»ä¸ºä¿éšœï¼Œåœ¨æ˜ç¡®åˆ†å·¥å’Œæœºåˆ¶æªæ–½ã€å®ˆä½ä¸å‘ç”Ÿç³»ç»Ÿæ€§é£é™©åº•çº¿çš„å‰æä¸‹ï¼Œæ„å»ºæµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ”¿ç­–åˆ¶åº¦ä½“ç³»ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸€ï¼‰è´¸æ˜“è‡ªç”±ä¾¿åˆ©ã€‚ åœ¨å®ç°æœ‰æ•ˆç›‘ç®¡çš„å‰æä¸‹ï¼Œå»ºè®¾å…¨å²›å°å…³è¿ä½œçš„æµ·å…³ç›‘ç®¡ç‰¹æ®ŠåŒºåŸŸã€‚å¯¹è´§ç‰©è´¸æ˜“ï¼Œå®è¡Œä»¥â€œé›¶å…³ç¨â€ä¸ºåŸºæœ¬ç‰¹å¾çš„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–åˆ¶åº¦å®‰æ’ã€‚å¯¹æœåŠ¡è´¸æ˜“ï¼Œå®è¡Œä»¥â€œæ—¢å‡†å…¥åˆå‡†è¥â€ä¸ºåŸºæœ¬ç‰¹å¾çš„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–æ”¿ç­–ä¸¾æªã€‚ â€œä¸€çº¿â€æ”¾å¼€ã€‚åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸ä¸­åäººæ°‘å…±å’Œå›½å…³å¢ƒå¤–å…¶ä»–å›½å®¶å’Œåœ°åŒºä¹‹é—´è®¾ç«‹â€œä¸€çº¿â€ã€‚â€œä¸€çº¿â€è¿›ï¼ˆå‡ºï¼‰å¢ƒç¯èŠ‚å¼ºåŒ–å®‰å…¨å‡†å…¥ï¼ˆå‡ºï¼‰ç›‘ç®¡ï¼ŒåŠ å¼ºå£å²¸å…¬å…±å«ç”Ÿå®‰å…¨ã€å›½é—¨ç”Ÿç‰©å®‰å…¨ã€é£Ÿå“å®‰å…¨ã€äº§å“è´¨é‡å®‰å…¨ç®¡æ§ã€‚åœ¨ç¡®ä¿å±¥è¡Œæˆ‘å›½ç¼”ç»“æˆ–å‚åŠ çš„å›½é™…æ¡çº¦æ‰€è§„å®šä¹‰åŠ¡çš„å‰æä¸‹ï¼Œåˆ¶å®šæµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç¦æ­¢ã€é™åˆ¶è¿›å‡ºå£çš„è´§ç‰©ã€ç‰©å“æ¸…å•ï¼Œæ¸…å•å¤–è´§ç‰©ã€ç‰©å“è‡ªç”±è¿›å‡ºï¼Œæµ·å…³ä¾æ³•è¿›è¡Œç›‘ç®¡ã€‚åˆ¶å®šæµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å£å¾ç¨å•†å“ç›®å½•ï¼Œç›®å½•å¤–è´§ç‰©è¿›å…¥è‡ªç”±è´¸æ˜“æ¸¯å…å¾è¿›å£å…³ç¨ã€‚ä»¥è”è¿æå•ä»˜è¿çš„è½¬è¿è´§ç‰©ä¸å¾ç¨ã€ä¸æ£€éªŒã€‚ä»æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç¦»å¢ƒçš„è´§ç‰©ã€ç‰©å“æŒ‰å‡ºå£ç®¡ç†ã€‚å®è¡Œä¾¿æ·é«˜æ•ˆçš„æµ·å…³ç›‘ç®¡ï¼Œå»ºè®¾é«˜æ ‡å‡†å›½é™…è´¸æ˜“â€œå•ä¸€çª—å£â€ã€‚ â€œäºŒçº¿â€ç®¡ä½ã€‚åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸ä¸­åäººæ°‘å…±å’Œå›½å…³å¢ƒå†…çš„å…¶ä»–åœ°åŒºï¼ˆä»¥ä¸‹ç®€ç§°å†…åœ°ï¼‰ä¹‹é—´è®¾ç«‹â€œäºŒçº¿â€ã€‚è´§ç‰©ä»æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å…¥å†…åœ°ï¼ŒåŸåˆ™ä¸ŠæŒ‰è¿›å£è§„å®šåŠç†ç›¸å…³æ‰‹ç»­ï¼Œç…§ç« å¾æ”¶å…³ç¨å’Œè¿›å£ç¯èŠ‚ç¨ã€‚å¯¹é¼“åŠ±ç±»äº§ä¸šä¼ä¸šç”Ÿäº§çš„ä¸å«è¿›å£æ–™ä»¶æˆ–è€…å«è¿›å£æ–™ä»¶åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯åŠ å·¥å¢å€¼è¶…è¿‡30%ï¼ˆå«ï¼‰çš„è´§ç‰©ï¼Œç»â€œäºŒçº¿â€è¿›å…¥å†…åœ°å…å¾è¿›å£å…³ç¨ï¼Œï¼ˆä½†æ˜¯ï¼‰ç…§ç« å¾æ”¶è¿›å£ç¯èŠ‚å¢å€¼ç¨ã€æ¶ˆè´¹ç¨ã€‚è¡Œé‚®ç‰©å“ç”±æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å…¥å†…åœ°ï¼ŒæŒ‰è§„å®šè¿›è¡Œç›‘ç®¡ï¼Œç…§ç« å¾ç¨ã€‚å¯¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å‰å¾€å†…åœ°çš„è¿è¾“å·¥å…·ï¼Œç®€åŒ–è¿›å£ç®¡ç†ã€‚è´§ç‰©ã€ç‰©å“åŠè¿è¾“å·¥å…·ç”±å†…åœ°è¿›å…¥æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ï¼ŒæŒ‰å›½å†…æµé€šè§„å®šç®¡ç†ã€‚å†…åœ°è´§ç‰©ç»æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸­è½¬å†è¿å¾€å†…åœ°æ— éœ€åŠç†æŠ¥å…³æ‰‹ç»­ï¼Œåº”åœ¨è‡ªç”±è´¸æ˜“æ¸¯å†…æµ·å…³ç›‘ç®¡ä½œä¸šåœºæ‰€ï¼ˆåœºåœ°ï¼‰è£…å¸ï¼Œä¸å…¶ä»–æµ·å…³ç›‘ç®¡è´§ç‰©åˆ†å¼€å­˜æ”¾ï¼Œå¹¶è®¾ç«‹æ˜æ˜¾æ ‡è¯†ã€‚åœºæ‰€ç»è¥ä¼ä¸šåº”æ ¹æ®æµ·å…³ç›‘ç®¡éœ€è¦ï¼Œå‘æµ·å…³ä¼ è¾“è´§ç‰©è¿›å‡ºåœºæ‰€ç­‰ä¿¡æ¯ã€‚ å²›å†…è‡ªç”±ã€‚æµ·å…³å¯¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…ä¼ä¸šåŠæœºæ„å®æ–½ä½å¹²é¢„ã€é«˜æ•ˆèƒ½çš„ç²¾å‡†ç›‘ç®¡ï¼Œå®ç°è‡ªç”±è´¸æ˜“æ¸¯å†…ä¼ä¸šè‡ªç”±ç”Ÿäº§ç»è¥ã€‚ç”±å¢ƒå¤–å¯è¿ï¼Œç»æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ¢è£…ã€åˆ†æ‹£é›†æ‹¼ï¼Œå†è¿å¾€å…¶ä»–å›½å®¶æˆ–åœ°åŒºçš„ä¸­è½¬è´§ç‰©ï¼Œç®€åŒ–åŠç†æµ·å…³æ‰‹ç»­ã€‚è´§ç‰©åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…ä¸è®¾å­˜å‚¨æœŸé™ï¼Œå¯è‡ªç”±é€‰æ‹©å­˜æ”¾åœ°ç‚¹ã€‚å®æ–½â€œé›¶å…³ç¨â€çš„è´§ç‰©ï¼Œæµ·å…³å…äºå®æ–½å¸¸è§„ç›‘ç®¡ã€‚ æ¨è¿›æœåŠ¡è´¸æ˜“è‡ªç”±ä¾¿åˆ©ã€‚å®æ–½è·¨å¢ƒæœåŠ¡è´¸æ˜“è´Ÿé¢æ¸…å•åˆ¶åº¦ï¼Œç ´é™¤è·¨å¢ƒäº¤ä»˜ã€å¢ƒå¤–æ¶ˆè´¹ã€è‡ªç„¶äººç§»åŠ¨ç­‰æœåŠ¡è´¸æ˜“æ¨¡å¼ä¸‹å­˜åœ¨çš„å„ç§å£å’ï¼Œç»™äºˆå¢ƒå¤–æœåŠ¡æä¾›è€…å›½æ°‘å¾…é‡ã€‚å®æ–½ä¸è·¨å¢ƒæœåŠ¡è´¸æ˜“é…å¥—çš„èµ„é‡‘æ”¯ä»˜ä¸è½¬ç§»åˆ¶åº¦ã€‚åœ¨å‘ŠçŸ¥ã€èµ„æ ¼è¦æ±‚ã€æŠ€æœ¯æ ‡å‡†ã€é€æ˜åº¦ã€ç›‘ç®¡ä¸€è‡´æ€§ç­‰æ–¹é¢ï¼Œè¿›ä¸€æ­¥è§„èŒƒå½±å“æœåŠ¡è´¸æ˜“è‡ªç”±ä¾¿åˆ©çš„å›½å†…è§„åˆ¶ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:1","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆäºŒï¼‰æŠ•èµ„è‡ªç”±ä¾¿åˆ©ã€‚ å¤§å¹…æ”¾å®½æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å¸‚åœºå‡†å…¥ï¼Œå¼ºåŒ–äº§æƒä¿æŠ¤ï¼Œä¿éšœå…¬å¹³ç«äº‰ï¼Œæ‰“é€ å…¬å¼€ã€é€æ˜ã€å¯é¢„æœŸçš„æŠ•èµ„ç¯å¢ƒï¼Œè¿›ä¸€æ­¥æ¿€å‘å„ç±»å¸‚åœºä¸»ä½“æ´»åŠ›ã€‚ å®æ–½å¸‚åœºå‡†å…¥æ‰¿è¯ºå³å…¥åˆ¶ã€‚ä¸¥æ ¼è½å®â€œéç¦å³å…¥â€ï¼Œåœ¨â€œç®¡å¾—ä½â€çš„å‰æä¸‹ï¼Œå¯¹å…·æœ‰å¼ºåˆ¶æ€§æ ‡å‡†çš„é¢†åŸŸï¼ŒåŸåˆ™ä¸Šå–æ¶ˆè®¸å¯å’Œå®¡æ‰¹ï¼Œå»ºç«‹å¥å…¨å¤‡æ¡ˆåˆ¶åº¦ï¼Œå¸‚åœºä¸»ä½“æ‰¿è¯ºç¬¦åˆç›¸å…³è¦æ±‚å¹¶æäº¤ç›¸å…³ææ–™è¿›è¡Œå¤‡æ¡ˆï¼Œå³å¯å¼€å±•æŠ•èµ„ç»è¥æ´»åŠ¨ã€‚å¤‡æ¡ˆå—ç†æœºæ„ä»æ”¶åˆ°å¤‡æ¡ˆæ—¶èµ·ï¼Œå³å¼€å§‹æ‰¿æ‹…å®¡æŸ¥è´£ä»»ã€‚å¯¹å¤–å•†æŠ•èµ„å®æ–½å‡†å…¥å‰å›½æ°‘å¾…é‡åŠ è´Ÿé¢æ¸…å•ç®¡ç†åˆ¶åº¦ï¼Œå¤§å¹…å‡å°‘ç¦æ­¢å’Œé™åˆ¶æ¡æ¬¾ã€‚ åˆ›æ–°å®Œå–„æŠ•èµ„è‡ªç”±åˆ¶åº¦ã€‚å®è¡Œä»¥è¿‡ç¨‹ç›‘ç®¡ä¸ºé‡ç‚¹çš„æŠ•èµ„ä¾¿åˆ©åˆ¶åº¦ã€‚å»ºç«‹ä»¥ç”µå­è¯ç…§ä¸ºä¸»çš„è®¾ç«‹ä¾¿åˆ©ï¼Œä»¥â€œæœ‰äº‹å¿…åº”â€ã€â€œæ— äº‹ä¸æ‰°â€ä¸ºä¸»çš„ç»è¥ä¾¿åˆ©ï¼Œä»¥å…¬å‘Šæ‰¿è¯ºå’Œä¼˜åŒ–ç¨‹åºä¸ºä¸»çš„æ³¨é”€ä¾¿åˆ©ï¼Œä»¥å°½èŒå±¥è´£ä¸ºä¸»çš„ç ´äº§ä¾¿åˆ©ç­‰æ”¿ç­–åˆ¶åº¦ã€‚ å»ºç«‹å¥å…¨å…¬å¹³ç«äº‰åˆ¶åº¦ã€‚å¼ºåŒ–ç«äº‰æ”¿ç­–çš„åŸºç¡€æ€§åœ°ä½ï¼Œç¡®ä¿å„ç±»æ‰€æœ‰åˆ¶å¸‚åœºä¸»ä½“åœ¨è¦ç´ è·å–ã€æ ‡å‡†åˆ¶å®šã€å‡†å…¥è®¸å¯ã€ç»è¥è¿è¥ã€ä¼˜æƒ æ”¿ç­–ç­‰æ–¹é¢äº«å—å¹³ç­‰å¾…é‡ã€‚æ”¿åºœé‡‡è´­å¯¹å†…å¤–èµ„ä¼ä¸šä¸€è§†åŒä»ã€‚åŠ å¼ºå’Œä¼˜åŒ–åå„æ–­æ‰§æ³•ï¼Œæ‰“ç ´è¡Œæ”¿æ€§å„æ–­ï¼Œé˜²æ­¢å¸‚åœºå„æ–­ï¼Œç»´æŠ¤å…¬å¹³ç«äº‰å¸‚åœºç§©åºã€‚ å®Œå–„äº§æƒä¿æŠ¤åˆ¶åº¦ã€‚ä¾æ³•ä¿æŠ¤ç§äººå’Œæ³•äººè´¢äº§çš„å–å¾—ã€ä½¿ç”¨ã€å¤„ç½®å’Œç»§æ‰¿çš„æƒåˆ©ï¼Œä»¥åŠä¾æ³•å¾æ”¶ç§äººå’Œæ³•äººè´¢äº§æ—¶è¢«å¾æ”¶è´¢äº§æ‰€æœ‰äººå¾—åˆ°è¡¥å¿çš„æƒåˆ©ã€‚è½å®å…¬å¸æ³•ç­‰æ³•å¾‹æ³•è§„ï¼ŒåŠ å¼ºå¯¹ä¸­å°æŠ•èµ„è€…çš„ä¿æŠ¤ã€‚åŠ å¤§çŸ¥è¯†äº§æƒä¾µæƒæƒ©ç½šåŠ›åº¦ï¼Œå»ºç«‹å¥å…¨çŸ¥è¯†äº§æƒé¢†åŸŸå¸‚åœºä¸»ä½“ä¿¡ç”¨åˆ†ç±»ç›‘ç®¡ã€å¤±ä¿¡æƒ©æˆ’ç­‰æœºåˆ¶ã€‚åŠ å¼ºåŒºå—é“¾æŠ€æœ¯åœ¨çŸ¥è¯†äº§æƒäº¤æ˜“ã€å­˜è¯ç­‰æ–¹é¢åº”ç”¨ï¼Œæ¢ç´¢é€‚åˆè‡ªç”±è´¸æ˜“æ¸¯å‘å±•çš„æ–°æ¨¡å¼ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:2","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸‰ï¼‰è·¨å¢ƒèµ„é‡‘æµåŠ¨è‡ªç”±ä¾¿åˆ©ã€‚ åšæŒé‡‘èæœåŠ¡å®ä½“ç»æµï¼Œé‡ç‚¹å›´ç»•è´¸æ˜“æŠ•èµ„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–ï¼Œåˆ†é˜¶æ®µå¼€æ”¾èµ„æœ¬é¡¹ç›®ï¼Œæœ‰åºæ¨è¿›æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸å¢ƒå¤–èµ„é‡‘è‡ªç”±ä¾¿åˆ©æµåŠ¨ã€‚ æ„å»ºå¤šåŠŸèƒ½è‡ªç”±è´¸æ˜“è´¦æˆ·ä½“ç³»ã€‚ä»¥å›½å†…ç°æœ‰æœ¬å¤–å¸è´¦æˆ·å’Œè‡ªç”±è´¸æ˜“è´¦æˆ·ä¸ºåŸºç¡€ï¼Œæ„å»ºæµ·å—é‡‘èå¯¹å¤–å¼€æ”¾åŸºç¡€å¹³å°ã€‚é€šè¿‡é‡‘èè´¦æˆ·éš”ç¦»ï¼Œå»ºç«‹èµ„é‡‘â€œç”µå­å›´ç½‘â€ï¼Œä¸ºæµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸å¢ƒå¤–å®ç°è·¨å¢ƒèµ„é‡‘è‡ªç”±ä¾¿åˆ©æµåŠ¨æä¾›åŸºç¡€æ¡ä»¶ã€‚ ä¾¿åˆ©è·¨å¢ƒè´¸æ˜“æŠ•èµ„èµ„é‡‘æµåŠ¨ã€‚è¿›ä¸€æ­¥æ¨åŠ¨è·¨å¢ƒè´§ç‰©è´¸æ˜“ã€æœåŠ¡è´¸æ˜“å’Œæ–°å‹å›½é™…è´¸æ˜“ç»“ç®—ä¾¿åˆ©åŒ–ï¼Œå®ç°é“¶è¡ŒçœŸå®æ€§å®¡æ ¸ä»äº‹å‰å®¡æŸ¥è½¬ä¸ºäº‹åæ ¸æŸ¥ã€‚åœ¨è·¨å¢ƒç›´æ¥æŠ•èµ„äº¤æ˜“ç¯èŠ‚ï¼ŒæŒ‰ç…§å‡†å…¥å‰å›½æ°‘å¾…é‡åŠ è´Ÿé¢æ¸…å•æ¨¡å¼ç®€åŒ–ç®¡ç†ï¼Œæé«˜å…‘æ¢ç¯èŠ‚ç™»è®°å’Œå…‘æ¢çš„ä¾¿åˆ©æ€§ï¼ˆèƒ½å¦æ¯”è‚©é¦™æ¸¯ï¼Ÿï¼‰ï¼Œæ¢ç´¢é€‚åº”å¸‚åœºéœ€æ±‚æ–°å½¢æ€çš„è·¨å¢ƒæŠ•èµ„ç®¡ç†ã€‚åœ¨è·¨å¢ƒèèµ„é¢†åŸŸï¼Œæ¢ç´¢å»ºç«‹æ–°çš„å¤–å€ºç®¡ç†ä½“åˆ¶ï¼Œè¯•ç‚¹åˆå¹¶äº¤æ˜“ç¯èŠ‚å¤–å€ºç®¡ç†æ¡†æ¶ï¼Œå®Œå–„ä¼ä¸šå‘è¡Œå¤–å€ºå¤‡æ¡ˆç™»è®°åˆ¶ç®¡ç†ï¼Œå…¨é¢å®æ–½å…¨å£å¾„è·¨å¢ƒèèµ„å®è§‚å®¡æ…ç®¡ç†ï¼Œç¨³æ­¥æ‰©å¤§è·¨å¢ƒèµ„äº§è½¬è®©èŒƒå›´ï¼Œæå‡å¤–å€ºèµ„é‡‘æ±‡å…‘ä¾¿åˆ©åŒ–æ°´å¹³ã€‚åœ¨è·¨å¢ƒè¯åˆ¸æŠ•èèµ„é¢†åŸŸï¼Œé‡ç‚¹æœåŠ¡å®ä½“ç»æµæŠ•èèµ„éœ€æ±‚ï¼Œæ‰¶æŒæµ·å—å…·æœ‰ç‰¹è‰²å’Œæ¯”è¾ƒä¼˜åŠ¿çš„äº§ä¸šå‘å±•ï¼Œå¹¶åœ¨å¢ƒå¤–ä¸Šå¸‚ã€å‘å€ºç­‰æ–¹é¢ç»™äºˆä¼˜å…ˆæ”¯æŒï¼Œç®€åŒ–æ±‡å…‘ç®¡ç†ã€‚ æ‰©å¤§é‡‘èä¸šå¯¹å†…å¯¹å¤–å¼€æ”¾ã€‚ç‡å…ˆåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è½å®é‡‘èä¸šæ‰©å¤§å¼€æ”¾æ”¿ç­–ã€‚æ”¯æŒå»ºè®¾å›½é™…èƒ½æºã€èˆªè¿ã€äº§æƒã€è‚¡æƒç­‰äº¤æ˜“åœºæ‰€ã€‚åŠ å¿«å‘å±•ç»“ç®—ä¸­å¿ƒã€‚ åŠ å¿«é‡‘èæ”¹é©åˆ›æ–°ã€‚æ”¯æŒä½æˆ¿ç§Ÿèµé‡‘èä¸šåŠ¡åˆ›æ–°å’Œè§„èŒƒå‘å±•ï¼Œæ”¯æŒå‘å±•æˆ¿åœ°äº§æŠ•èµ„ä¿¡æ‰˜åŸºé‡‘ï¼ˆREITsï¼‰ã€‚ç¨³æ­¥æ‹“å®½å¤šç§å½¢å¼çš„äº§ä¸šèèµ„æ¸ é“ï¼Œæ”¾å®½å¤–èµ„ä¼ä¸šèµ„æœ¬é‡‘ä½¿ç”¨èŒƒå›´ã€‚åˆ›æ–°ç§‘æŠ€é‡‘èæ”¿ç­–ã€äº§å“å’Œå·¥å…·ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:3","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆå››ï¼‰äººå‘˜è¿›å‡ºè‡ªç”±ä¾¿åˆ©ï¼ˆäººæ‰å¼•è¿›ï¼‰ æŒ‰ç…§å­¦å†ï¼ŒæŠŠäººåˆ†æˆå„ç§ç­‰çº§ï¼Œå”‰~ æ ¹æ®æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å‘å±•éœ€è¦ï¼Œé’ˆå¯¹é«˜ç«¯äº§ä¸šäººæ‰ï¼Œå®è¡Œæ›´åŠ å¼€æ”¾çš„äººæ‰å’Œåœå±…ç•™æ”¿ç­–ï¼Œæ‰“é€ äººæ‰é›†èšé«˜åœ°ã€‚åœ¨æœ‰æ•ˆé˜²æ§æ¶‰å¤–å®‰å…¨é£é™©éšæ‚£çš„å‰æä¸‹ï¼Œå®è¡Œæ›´åŠ ä¾¿åˆ©çš„å‡ºå…¥å¢ƒç®¡ç†æ”¿ç­–ã€‚ å¯¹å¤–ç±é«˜å±‚æ¬¡äººæ‰æŠ•èµ„åˆ›ä¸šã€è®²å­¦äº¤æµã€ç»è´¸æ´»åŠ¨æ–¹é¢æä¾›å‡ºå…¥å¢ƒä¾¿åˆ©ã€‚å®Œå–„å›½é™…äººæ‰è¯„ä»·æœºåˆ¶ï¼Œä»¥è–ªé…¬æ°´å¹³ä¸ºä¸»è¦æŒ‡æ ‡è¯„ä¼°äººåŠ›èµ„æºç±»åˆ«ï¼Œå»ºç«‹å¸‚åœºå¯¼å‘çš„äººæ‰æœºåˆ¶ã€‚å¯¹å¤–ç±äººå‘˜èµ´æµ·å—è‡ªç”±è´¸æ˜“æ¸¯çš„å·¥ä½œè®¸å¯å®è¡Œè´Ÿé¢æ¸…å•ç®¡ç†ï¼Œæ”¾å®½å¤–ç±ä¸“ä¸šæŠ€æœ¯æŠ€èƒ½äººå‘˜åœå±…ç•™æ”¿ç­–ã€‚å…è®¸ç¬¦åˆæ¡ä»¶çš„å¢ƒå¤–äººå‘˜æ‹…ä»»æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…æ³•å®šæœºæ„ã€äº‹ä¸šå•ä½ã€å›½æœ‰ä¼ä¸šçš„æ³•å®šä»£è¡¨äººï¼ˆä»¥åè¦å«å•Šsirï¼‰ã€‚å®è¡Œå®½æ¾çš„å•†åŠ¡äººå‘˜ä¸´æ—¶å‡ºå…¥å¢ƒæ”¿ç­–ã€‚ å»ºç«‹å¥å…¨äººæ‰æœåŠ¡ç®¡ç†åˆ¶åº¦ã€‚å®ç°å·¥ä½œè®¸å¯ã€ç­¾è¯ä¸å±…ç•™ä¿¡æ¯å…±äº«å’Œè”å®¡è”æ£€ã€‚æ¨è¿›å»ºç«‹äººæ‰æœåŠ¡ä¸­å¿ƒï¼Œæä¾›å·¥ä½œå°±ä¸šã€æ•™è‚²ç”Ÿæ´»æœåŠ¡ï¼Œä¿éšœå…¶åˆæ³•æƒç›Šã€‚ å®æ–½æ›´åŠ ä¾¿åˆ©çš„å‡ºå…¥å¢ƒç®¡ç†æ”¿ç­–ã€‚é€æ­¥å®æ–½æ›´å¤§èŒƒå›´é€‚ç”¨å…ç­¾å…¥å¢ƒæ”¿ç­–ï¼Œé€æ­¥å»¶é•¿å…ç­¾åœç•™æ—¶é—´ã€‚ä¼˜åŒ–å‡ºå…¥å¢ƒè¾¹é˜²æ£€æŸ¥ç®¡ç†ï¼Œä¸ºå•†åŠ¡äººå‘˜ã€é‚®è½®æ¸¸è‰‡æä¾›å‡ºå…¥å¢ƒé€šå…³ä¾¿åˆ©ã€‚ ï¼ˆ### äº”ï¼‰è¿è¾“æ¥å¾€è‡ªç”±ä¾¿åˆ©ã€‚ å®æ–½é«˜åº¦è‡ªç”±ä¾¿åˆ©å¼€æ”¾çš„è¿è¾“æ”¿ç­–ï¼Œæ¨åŠ¨å»ºè®¾è¥¿éƒ¨é™†æµ·æ–°é€šé“å›½é™…èˆªè¿æ¢çº½å’Œèˆªç©ºæ¢çº½ï¼ˆä¸œæ–¹ã€æ˜Œæ±Ÿå’Œç»æ´²ï¼Ÿï¼Ÿï¼‰ï¼ŒåŠ å¿«æ„å»ºç°ä»£ç»¼åˆäº¤é€šè¿è¾“ä½“ç³»ã€‚ å»ºç«‹æ›´åŠ è‡ªç”±å¼€æ”¾çš„èˆªè¿åˆ¶åº¦ã€‚å»ºè®¾â€œä¸­å›½æ´‹æµ¦æ¸¯â€èˆ¹ç±æ¸¯ã€‚æ”¯æŒæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å¼€å±•èˆ¹èˆ¶ç™»è®°ã€‚ç ”ç©¶å»ºç«‹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯èˆªè¿ç»è¥ç®¡ç†ä½“åˆ¶åŠæµ·å‘˜ç®¡ç†åˆ¶åº¦ã€‚è¿›ä¸€æ­¥æ”¾å®½ç©ºåŸŸç®¡åˆ¶ä¸èˆªè·¯èˆªæƒé™åˆ¶ï¼Œä¼˜åŒ–èˆªè¿è·¯çº¿ï¼Œé¼“åŠ±å¢åŠ è¿åŠ›æŠ•æ”¾ï¼Œå¢å¼€èˆªçº¿èˆªç­ã€‚ æå‡è¿è¾“ä¾¿åˆ©åŒ–å’ŒæœåŠ¡ä¿éšœæ°´å¹³ã€‚æ¨è¿›èˆ¹èˆ¶è”åˆç™»ä¸´æ£€æŸ¥ã€‚æ„å»ºé«˜æ•ˆã€ä¾¿æ·ã€ä¼˜è´¨çš„èˆ¹æ——å›½ç‰¹æ®Šç›‘ç®¡æ”¿ç­–ã€‚ä¸ºèˆ¹èˆ¶å’Œé£æœºèèµ„æä¾›æ›´åŠ ä¼˜è´¨é«˜æ•ˆçš„é‡‘èæœåŠ¡ï¼Œå–æ¶ˆèˆ¹èˆ¶å’Œé£æœºå¢ƒå¤–èèµ„é™åˆ¶ï¼Œæ¢ç´¢ä»¥ä¿é™©æ–¹å¼å–ä»£ä¿è¯é‡‘ã€‚åŠ å¼ºå†…åœ°ä¸æµ·å—è‡ªç”±è´¸æ˜“æ¸¯é—´è¿è¾“ã€é€šå…³ä¾¿åˆ©åŒ–ç›¸å…³è®¾æ–½è®¾å¤‡å»ºè®¾ï¼Œåˆç†é…å¤‡äººå‘˜ï¼Œæå‡è¿è¾“æ¥å¾€è‡ªç”±ä¾¿åˆ©æ°´å¹³ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:4","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆå…­ï¼‰æ•°æ®å®‰å…¨æœ‰åºæµåŠ¨ã€‚ åœ¨ç¡®ä¿æ•°æ®æµåŠ¨å®‰å…¨å¯æ§çš„å‰æä¸‹ï¼Œæ‰©å¤§æ•°æ®é¢†åŸŸå¼€æ”¾ï¼Œåˆ›æ–°å®‰å…¨åˆ¶åº¦è®¾è®¡ï¼Œå®ç°æ•°æ®å……åˆ†æ±‡èšï¼ŒåŸ¹è‚²å‘å±•æ•°å­—ç»æµã€‚ æœ‰åºæ‰©å¤§é€šä¿¡èµ„æºå’Œä¸šåŠ¡å¼€æ”¾ã€‚å¼€æ”¾å¢å€¼ç”µä¿¡ä¸šåŠ¡ï¼Œé€æ­¥å–æ¶ˆå¤–èµ„è‚¡æ¯”ç­‰é™åˆ¶ã€‚å…è®¸å®ä½“æ³¨å†Œã€æœåŠ¡è®¾æ–½åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…çš„ä¼ä¸šï¼Œé¢å‘è‡ªç”±è´¸æ˜“æ¸¯å…¨åŸŸåŠå›½é™…å¼€å±•åœ¨çº¿æ•°æ®å¤„ç†ä¸äº¤æ˜“å¤„ç†ç­‰ä¸šåŠ¡ï¼Œå¹¶åœ¨å®‰å…¨å¯æ§çš„å‰æä¸‹é€æ­¥é¢å‘å…¨å›½å¼€å±•ä¸šåŠ¡ã€‚å®‰å…¨æœ‰åºå¼€æ”¾åŸºç¡€ç”µä¿¡ä¸šåŠ¡ã€‚å¼€å±•å›½é™…äº’è”ç½‘æ•°æ®äº¤äº’è¯•ç‚¹ï¼Œå»ºè®¾å›½é™…æµ·åº•å…‰ç¼†åŠç™»é™†ç‚¹ï¼Œè®¾ç«‹å›½é™…é€šä¿¡å‡ºå…¥å£å±€ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:5","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸ƒï¼‰ç°ä»£äº§ä¸šä½“ç³»ã€‚ å¤§åŠ›å‘å±•æ—…æ¸¸ä¸šã€ç°ä»£æœåŠ¡ä¸šå’Œé«˜æ–°æŠ€æœ¯äº§ä¸šï¼Œä¸æ–­å¤¯å®å®ä½“ç»æµåŸºç¡€ï¼Œå¢å¼ºäº§ä¸šç«äº‰åŠ›ã€‚ è¿™é‡Œé‡ç‚¹è¿˜æ˜¯å®ä½“è¡Œä¸šã€‚ç»“åˆå‰é¢çš„æ”¿ç­–ï¼Œè¿™é‡Œçš„æ‰€è°“çš„â€œç°ä»£æœåŠ¡ä¸šâ€åº”è¯¥æ˜¯æŒ‡åŠ å·¥è¡Œä¸šï¼Œæ¯•ç«Ÿå¢å€¼30%åå°±å¯ä»¥å…å…³ç¨è¾“é€å†…åœ°äº†ã€‚â€œé«˜æ–°æŠ€æœ¯äº§ä¸š\"çš„è¯ï¼Œæˆ‘è§‰å¾—æ–°èƒ½æºå¯èƒ½æ¯”è¾ƒä¼˜å…ˆï¼Œèˆªç©ºèˆªå¤©ä¸šï¼Œæ¯•ç«Ÿæ–‡æ˜Œã€æµ·èˆªåœ¨é‚£ã€‚ æ—…æ¸¸ä¸šã€‚åšæŒç”Ÿæ€ä¼˜å…ˆã€ç»¿è‰²å‘å±•ï¼Œå›´ç»•å›½é™…æ—…æ¸¸æ¶ˆè´¹ä¸­å¿ƒå»ºè®¾ï¼Œæ¨åŠ¨æ—…æ¸¸ä¸æ–‡åŒ–ä½“è‚²ã€å¥åº·åŒ»ç–—ã€å…»è€å…»ç”Ÿç­‰æ·±åº¦èåˆï¼Œæå‡åšé³Œä¹åŸå›½é™…åŒ»ç–—æ—…æ¸¸å…ˆè¡ŒåŒºå‘å±•æ°´å¹³ï¼ˆé‚£ä¹ˆåšé³Œå¯èƒ½ä¼šå‘å±•åŒ»ç–—å’Œåº·å…»äº†ï¼‰ï¼Œæ”¯æŒå»ºè®¾æ–‡åŒ–æ—…æ¸¸äº§ä¸šå›­ï¼Œå‘å±•ç‰¹è‰²æ—…æ¸¸äº§ä¸šé›†ç¾¤ï¼ŒåŸ¹è‚²æ—…æ¸¸æ–°ä¸šæ€æ–°æ¨¡å¼ï¼Œåˆ›å»ºå…¨åŸŸæ—…æ¸¸ç¤ºèŒƒçœã€‚åŠ å¿«ä¸‰äºšå‘å›½é™…é‚®è½®æ¯æ¸¯å‘å±•ï¼Œæ”¯æŒå»ºè®¾é‚®è½®æ—…æ¸¸è¯•éªŒåŒºï¼Œå¸å¼•å›½é™…é‚®è½®æ³¨å†Œã€‚è®¾ç«‹æ¸¸è‰‡äº§ä¸šæ”¹é©å‘å±•åˆ›æ–°è¯•éªŒåŒºã€‚æ”¯æŒåˆ›å»ºå›½å®¶çº§æ—…æ¸¸åº¦å‡åŒºå’Œ5Açº§æ™¯åŒºã€‚ ç°ä»£æœåŠ¡ä¸šã€‚é›†èšå…¨çƒåˆ›æ–°è¦ç´ ï¼Œæ·±åŒ–å¯¹å†…å¯¹å¤–å¼€æ”¾ï¼Œå¸å¼•è·¨å›½å…¬å¸è®¾ç«‹åŒºåŸŸæ€»éƒ¨ã€‚åˆ›æ–°æ¸¯å£ç®¡ç†ä½“åˆ¶æœºåˆ¶ï¼Œæ¨åŠ¨æ¸¯å£èµ„æºæ•´åˆï¼Œæ‹“å±•èˆªè¿æœåŠ¡äº§ä¸šé“¾ï¼Œæ¨åŠ¨ä¿ç¨ä»“å‚¨ã€å›½é™…ç‰©æµé…é€ã€è½¬å£è´¸æ˜“ã€å¤§å®—å•†å“è´¸æ˜“ã€è¿›å£å•†å“å±•é”€ã€æµé€šåŠ å·¥ã€é›†è£…ç®±æ‹†æ‹¼ç®±ç­‰ä¸šåŠ¡å‘å±•ï¼Œæé«˜å…¨çƒä¾›åº”é“¾æœåŠ¡ç®¡ç†èƒ½åŠ›ï¼Œæ‰“é€ å›½é™…èˆªè¿æ¢çº½ï¼Œæ¨åŠ¨æ¸¯å£ã€äº§ä¸šã€åŸå¸‚èåˆå‘å±•ã€‚å»ºè®¾æµ·å—ï¼š å›½é™…è®¾è®¡å²› ç†å·¥å†œåŒ»ç±»å›½é™…æ•™è‚²åˆ›æ–°å²› åŒºåŸŸæ€§å›½é™…ä¼šå±•ä¸­å¿ƒ æ‰©å¤§ä¸“ä¸šæœåŠ¡ä¸šå¯¹å¤–å¼€æ”¾ã€‚ å®Œå–„æµ·æ´‹æœåŠ¡åŸºç¡€è®¾æ–½ï¼Œç§¯æå‘å±•ï¼š - æµ·æ´‹ç‰©æµ - æµ·æ´‹æ—…æ¸¸ - æµ·æ´‹ä¿¡æ¯æœåŠ¡ - æµ·æ´‹å·¥ç¨‹å’¨è¯¢ - æ¶‰æµ·é‡‘èï¼ˆæ¸¸è½®èµŒåœºå’Œæ€§æ„Ÿè·å®˜å—ï¼Ÿï¼‰ - æ¶‰æµ·å•†åŠ¡ç­‰ï¼Œ æ„å»ºå…·æœ‰å›½é™…ç«äº‰åŠ›çš„æµ·æ´‹æœåŠ¡ä½“ç³»ã€‚å»ºè®¾å›½å®¶å¯¹å¤–æ–‡åŒ–è´¸æ˜“åŸºåœ°ã€‚ é«˜æ–°æŠ€æœ¯äº§ä¸šã€‚èšç„¦å¹³å°è½½ä½“ï¼Œæå‡äº§ä¸šèƒ½çº§ï¼Œä»¥ç‰©è”ç½‘ã€äººå·¥æ™ºèƒ½ã€åŒºå—é“¾ã€æ•°å­—è´¸æ˜“ç­‰ä¸ºé‡ç‚¹å‘å±•ä¿¡æ¯äº§ä¸šã€‚ä¾æ‰˜æ–‡æ˜Œå›½é™…èˆªå¤©åŸã€ä¸‰äºšæ·±æµ·ç§‘æŠ€åŸï¼Œå¸ƒå±€å»ºè®¾é‡å¤§ç§‘æŠ€åŸºç¡€è®¾æ–½å’Œå¹³å°ï¼ŒåŸ¹è‚²æ·±æµ·æ·±ç©ºäº§ä¸šã€‚å›´ç»•ç”Ÿæ€ç¯ä¿ã€ç”Ÿç‰©åŒ»è¯ã€æ–°èƒ½æºæ±½è½¦ã€æ™ºèƒ½æ±½è½¦ç­‰å£®å¤§å…ˆè¿›åˆ¶é€ ä¸šã€‚å‘æŒ¥å›½å®¶å—ç¹ç§‘ç ”è‚²ç§åŸºåœ°ä¼˜åŠ¿ï¼Œå»ºè®¾å…¨çƒçƒ­å¸¦å†œä¸šä¸­å¿ƒå’Œå…¨çƒåŠ¨æ¤ç‰©ç§è´¨èµ„æºå¼•è¿›ä¸­è½¬åŸºåœ°ã€‚å»ºè®¾æ™ºæ…§æµ·å—ã€‚ ###ï¼ˆå…«ï¼‰ ç¨æ”¶åˆ¶åº¦ã€‚ æŒ‰ç…§é›¶å…³ç¨ã€ä½ç¨ç‡ã€ç®€ç¨åˆ¶ã€å¼ºæ³•æ²»ã€åˆ†é˜¶æ®µçš„åŸåˆ™ï¼Œé€æ­¥å»ºç«‹ä¸é«˜æ°´å¹³è‡ªç”±è´¸æ˜“æ¸¯ç›¸é€‚åº”çš„ç¨æ”¶åˆ¶åº¦ã€‚ é›¶å…³ç¨ã€‚å…¨å²›å°å…³è¿ä½œå‰ï¼Œå¯¹éƒ¨åˆ†è¿›å£å•†å“ï¼Œå…å¾è¿›å£å…³ç¨ã€è¿›å£ç¯èŠ‚å¢å€¼ç¨å’Œæ¶ˆè´¹ç¨ã€‚å…¨å²›å°å…³è¿ä½œã€ç®€å¹¶ç¨åˆ¶åï¼Œå¯¹è¿›å£å¾ç¨å•†å“ç›®å½•ä»¥å¤–ã€å…è®¸æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å£çš„å•†å“ï¼Œå…å¾è¿›å£å…³ç¨ã€‚ ä½ç¨ç‡ã€‚å¯¹åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å®è´¨ç»è¥çš„ä¼ä¸šï¼Œå®è¡Œä¼ä¸šæ‰€å¾—ç¨ä¼˜æƒ ç¨ç‡ã€‚å¯¹ç¬¦åˆæ¡ä»¶çš„ä¸ªäººï¼Œå®è¡Œä¸ªäººæ‰€å¾—ç¨ä¼˜æƒ ç¨ç‡ã€‚ ç®€ç¨åˆ¶ã€‚ç»“åˆæˆ‘å›½ç¨åˆ¶æ”¹é©æ–¹å‘ï¼Œæ¢ç´¢æ¨è¿›ç®€åŒ–ç¨åˆ¶ã€‚æ”¹é©ç¨ç§åˆ¶åº¦ï¼Œé™ä½é—´æ¥ç¨æ¯”ä¾‹ï¼Œå®ç°ç¨ç§ç»“æ„ç®€å•ç§‘å­¦ã€ç¨åˆ¶è¦ç´ å……åˆ†ä¼˜åŒ–ã€ç¨è´Ÿæ°´å¹³æ˜æ˜¾é™ä½ã€æ”¶å…¥å½’å±æ¸…æ™°ã€è´¢æ”¿æ”¶æ”¯å¤§ä½“å‡è¡¡ã€‚ å¼ºæ³•æ²»ã€‚ç¨æ”¶ç®¡ç†éƒ¨é—¨æŒ‰å®è´¨ç»æµæ´»åŠ¨æ‰€åœ¨åœ°å’Œä»·å€¼åˆ›é€ åœ°åŸåˆ™å¯¹çº³ç¨è¡Œä¸ºè¿›è¡Œè¯„ä¼°å’Œé¢„è­¦ï¼Œåˆ¶å®šç®€æ˜æ˜“è¡Œçš„å®è´¨ç»è¥åœ°ã€æ‰€åœ¨åœ°å±…ä½åˆ¤å®šæ ‡å‡†ï¼Œå¼ºåŒ–å¯¹å·æ¼ç¨é£é™©çš„è¯†åˆ«ï¼Œé˜²èŒƒç¨åŸºä¾µèš€å’Œåˆ©æ¶¦è½¬ç§»ï¼Œé¿å…æˆä¸ºâ€œé¿ç¨å¤©å ‚â€ã€‚ç§¯æå‚ä¸å›½é™…ç¨æ”¶å¾ç®¡åˆä½œï¼ŒåŠ å¼ºæ¶‰ç¨æƒ…æŠ¥ä¿¡æ¯å…±äº«ã€‚åŠ å¼ºç¨åŠ¡é¢†åŸŸä¿¡ç”¨åˆ†ç±»æœåŠ¡å’Œç®¡ç†ï¼Œä¾æ³•ä¾è§„å¯¹è¿æ³•å¤±ä¿¡ä¼ä¸šå’Œä¸ªäººé‡‡å–ç›¸åº”æªæ–½ã€‚ åˆ†é˜¶æ®µã€‚æŒ‰ç…§æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾çš„ä¸åŒé˜¶æ®µï¼Œåˆ†æ­¥éª¤å®æ–½é›¶å…³ç¨ã€ä½ç¨ç‡ã€ç®€ç¨åˆ¶çš„å®‰æ’ï¼Œæœ€ç»ˆå½¢æˆå…·æœ‰å›½é™…ç«äº‰åŠ›çš„ç¨æ”¶åˆ¶åº¦ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:6","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¹ï¼‰ç¤¾ä¼šæ²»ç† ç€åŠ›æ¨è¿›æ”¿åºœæœºæ„æ”¹é©å’Œæ”¿åºœèŒèƒ½è½¬å˜ï¼Œé¼“åŠ±åŒºå—é“¾ç­‰æŠ€æœ¯é›†æˆåº”ç”¨äºæ²»ç†ä½“ç³»å’Œæ²»ç†èƒ½åŠ›ç°ä»£åŒ–ï¼Œæ„å»ºç³»ç»Ÿå®Œå¤‡ã€ç§‘å­¦è§„èŒƒã€è¿è¡Œæœ‰æ•ˆçš„è‡ªç”±è´¸æ˜“æ¸¯æ²»ç†ä½“ç³»ã€‚ æ·±åŒ–æ”¿åºœæœºæ„æ”¹é©ã€‚è¿›ä¸€æ­¥æ¨åŠ¨æµ·å—å¤§éƒ¨é—¨åˆ¶æ”¹é©ï¼Œæ•´åˆåˆ†æ•£åœ¨å„éƒ¨é—¨ç›¸è¿‘æˆ–ç›¸ä¼¼çš„åŠŸèƒ½èŒè´£ï¼Œæ¨åŠ¨èŒèƒ½ç›¸è¿‘éƒ¨é—¨åˆå¹¶ã€‚æ§åˆ¶è¡Œæ”¿ç»¼åˆç±»å…¬åŠ¡å‘˜æ¯”ä¾‹ï¼Œè¡Œæ”¿äººå‘˜ç¼–åˆ¶å‘ç›‘ç®¡éƒ¨é—¨å€¾æ–œï¼Œæ¨è¡Œå¸‚åœºåŒ–çš„ä¸“ä¸šäººå‘˜è˜ä»»åˆ¶ã€‚ æ¨åŠ¨æ”¿åºœèŒèƒ½è½¬å˜ã€‚å¼ºåŒ–ç›‘ç®¡ç«‹æ³•å’Œæ‰§æ³•ï¼ŒåŠ å¼ºç¤¾ä¼šä¿¡ç”¨ä½“ç³»åº”ç”¨ï¼Œæ·±åŒ–â€œåŒéšæœºã€ä¸€å…¬å¼€â€çš„å¸‚åœºç›‘ç®¡ä½“åˆ¶ï¼ŒåšæŒå¯¹æ–°å…´ä¸šæ€å®è¡ŒåŒ…å®¹å®¡æ…ç›‘ç®¡ã€‚å……åˆ†å‘æŒ¥â€œäº’è”ç½‘+â€ã€å¤§æ•°æ®ã€åŒºå—é“¾ç­‰ç°ä»£ä¿¡æ¯æŠ€æœ¯ä½œç”¨ï¼Œé€šè¿‡æ”¿åŠ¡æœåŠ¡ç­‰å¹³å°å»ºè®¾è§„èŒƒæ”¿åºœæœåŠ¡æ ‡å‡†ã€å®ç°æ”¿åŠ¡æµç¨‹å†é€ å’Œæ”¿åŠ¡æœåŠ¡â€œä¸€ç½‘é€šåŠâ€ï¼ŒåŠ å¼ºæ•°æ®æœ‰åºå…±äº«ï¼Œæå‡æ”¿åºœæœåŠ¡å’Œæ²»ç†æ°´å¹³ã€‚æ”¿åºœä½œå‡ºçš„æ‰¿è¯ºé¡»è®¤çœŸå±¥è¡Œï¼Œå¯¹äºä¸èƒ½å±¥è¡Œæ‰¿è¯ºæˆ–æ‰§è¡Œä¸åˆ°ä½è€Œé€ æˆæŸå¤±çš„ï¼Œåº”åŠæ—¶äºˆä»¥èµ”å¿æˆ–è¡¥å¿ã€‚ æ‰“é€ å…±å»ºå…±æ²»å…±äº«çš„ç¤¾ä¼šæ²»ç†æ ¼å±€ã€‚æ·±åŒ–æˆ·ç±åˆ¶åº¦æ”¹é©ï¼Œè¿›ä¸€æ­¥æ”¾å®½æˆ·å£è¿ç§»æ”¿ç­–ï¼Œå®è¡Œä»¥å…¬æ°‘èº«ä»½å·ç ä¸ºå”¯ä¸€æ ‡è¯†ã€å…¨å²›ç»Ÿä¸€çš„å±…ä½è¯åˆ¶åº¦ã€‚èµ‹äºˆè¡Œä¸šç»„ç»‡æ›´å¤§è‡ªä¸»æƒï¼Œå‘æŒ¥å…¶åœ¨å¸‚åœºç§©åºç»´æŠ¤ã€æ ‡å‡†åˆ¶å®šå®æ–½ã€è¡Œä¸šçº çº·è°ƒå¤„ä¸­çš„é‡è¦ä½œç”¨ã€‚èµ‹äºˆç¤¾åŒºæ›´å¤§çš„åŸºå±‚æ²»ç†æƒé™ï¼ŒåŠ å¿«ç¤¾åŒºæœåŠ¡ä¸æ²»ç†åˆ›æ–°ã€‚ åˆ›æ–°ç”Ÿæ€æ–‡æ˜ä½“åˆ¶æœºåˆ¶ã€‚æ·±å…¥æ¨è¿›å›½å®¶ç”Ÿæ€æ–‡æ˜è¯•éªŒåŒºï¼ˆæµ·å—ï¼‰å»ºè®¾ï¼Œå…¨é¢å»ºç«‹èµ„æºé«˜æ•ˆåˆ©ç”¨åˆ¶åº¦ï¼Œå¥å…¨è‡ªç„¶èµ„æºäº§æƒåˆ¶åº¦å’Œæœ‰å¿ä½¿ç”¨åˆ¶åº¦ã€‚æ‰å®æ¨è¿›å›½åœŸç©ºé—´è§„åˆ’ä½“ç³»å»ºè®¾ï¼Œå®è¡Œå·®åˆ«åŒ–çš„è‡ªç„¶ç”Ÿæ€ç©ºé—´ç”¨é€”ç®¡åˆ¶ã€‚å¥å…¨è‡ªç„¶ä¿æŠ¤åœ°å†…è‡ªç„¶èµ„æºèµ„äº§ç‰¹è®¸ç»è¥æƒç­‰åˆ¶åº¦ï¼Œæ¢ç´¢ç”Ÿæ€äº§å“ä»·å€¼å®ç°æœºåˆ¶ã€‚å»ºç«‹çƒ­å¸¦é›¨æ—ç­‰å›½å®¶å…¬å›­ï¼Œæ„å»ºä»¥å›½å®¶å…¬å›­ä¸ºä¸»ä½“çš„è‡ªç„¶ä¿æŠ¤åœ°ä½“ç³»ã€‚æ¢ç´¢å»ºç«‹æ”¿åºœä¸»å¯¼ã€ä¼ä¸šå’Œç¤¾ä¼šå‚ä¸ã€å¸‚åœºåŒ–è¿ä½œã€å¯æŒç»­çš„ç”Ÿæ€ä¿æŠ¤è¡¥å¿æœºåˆ¶ã€‚åŠ å¿«æ„å»ºè‡ªç„¶èµ„æºç»Ÿä¸€è°ƒæŸ¥è¯„ä»·ç›‘æµ‹å’Œç¡®æƒç™»è®°åˆ¶åº¦ã€‚å¥å…¨ç”Ÿæ€ç¯å¢ƒç›‘æµ‹å’Œè¯„ä»·åˆ¶åº¦ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:7","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆåï¼‰æ³•æ²»åˆ¶åº¦ å»ºç«‹ä»¥æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ³•ä¸ºåŸºç¡€ï¼Œä»¥åœ°æ–¹æ€§æ³•è§„å’Œå•†äº‹çº çº·è§£å†³æœºåˆ¶ä¸ºé‡è¦ç»„æˆçš„è‡ªç”±è´¸æ˜“æ¸¯æ³•æ²»ä½“ç³»ï¼Œè¥é€ å›½é™…ä¸€æµçš„è‡ªç”±è´¸æ˜“æ¸¯æ³•æ²»ç¯å¢ƒã€‚ åˆ¶å®šå®æ–½æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ³•ã€‚ä»¥æ³•å¾‹å½¢å¼æ˜ç¡®è‡ªç”±è´¸æ˜“æ¸¯å„é¡¹åˆ¶åº¦å®‰æ’ï¼Œä¸ºè‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æä¾›åŸåˆ™æ€§ã€åŸºç¡€æ€§çš„æ³•æ²»ä¿éšœã€‚ åˆ¶å®šç»æµç‰¹åŒºæ³•è§„ã€‚åœ¨éµå¾ªå®ªæ³•è§„å®šå’Œæ³•å¾‹ã€è¡Œæ”¿æ³•è§„åŸºæœ¬åŸåˆ™å‰æä¸‹ï¼Œæ”¯æŒæµ·å—å……åˆ†è¡Œä½¿ç»æµç‰¹åŒºç«‹æ³•æƒï¼Œç«‹è¶³è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å®é™…ï¼Œåˆ¶å®šç»æµç‰¹åŒºæ³•è§„ã€‚ å»ºç«‹å¤šå…ƒåŒ–å•†äº‹çº çº·è§£å†³æœºåˆ¶ã€‚å®Œå–„å›½é™…å•†äº‹çº çº·æ¡ˆä»¶é›†ä¸­å®¡åˆ¤æœºåˆ¶ï¼Œæä¾›å›½é™…å•†äº‹ä»²è£ã€å›½é™…å•†äº‹è°ƒè§£ç­‰å¤šç§éè¯‰è®¼çº çº·è§£å†³æ–¹å¼ã€‚ ä»è¿™é‡Œæ¥çœ‹ï¼Œæ³•å¾‹è¡Œä¸šæœ‰ä¸é”™çš„æœºä¼šã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:8","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆåä¸€ï¼‰é£é™©é˜²æ§ä½“ç³» åˆ¶å®šå®æ–½æœ‰æ•ˆæªæ–½ï¼Œæœ‰é’ˆå¯¹æ€§é˜²èŒƒåŒ–è§£è´¸æ˜“ã€æŠ•èµ„ã€é‡‘èã€æ•°æ®æµåŠ¨ã€ç”Ÿæ€å’Œå…¬å…±å«ç”Ÿç­‰é¢†åŸŸé‡å¤§é£é™©ã€‚ è´¸æ˜“é£é™©é˜²æ§ã€‚é«˜æ ‡å‡†å»ºè®¾å¼€æ”¾å£å²¸å’Œâ€œäºŒçº¿å£å²¸â€åŸºç¡€è®¾æ–½ã€ç›‘ç®¡è®¾æ–½ï¼ŒåŠ å¤§ä¿¡æ¯åŒ–ç³»ç»Ÿå»ºè®¾å’Œç§‘æŠ€è£…å¤‡æŠ•å…¥åŠ›åº¦ï¼Œå®æ–½æ™ºèƒ½ç²¾å‡†ç›‘ç®¡ï¼Œä¾æ‰˜å…¨å²›â€œäººæµã€ç‰©æµã€èµ„é‡‘æµâ€ä¿¡æ¯ç®¡ç†ç³»ç»Ÿã€ç¤¾ä¼šç®¡ç†ç›‘ç®¡ç³»ç»Ÿã€å£å²¸ç›‘ç®¡ç³»ç»Ÿâ€œä¸‰é“é˜²çº¿â€ï¼Œå½¢æˆæµ·å—ç¤¾ä¼šç®¡ç†ä¿¡æ¯åŒ–å¹³å°ï¼Œå¯¹éè®¾å…³åœ°å®æ–½å…¨å¤©å€™åŠ¨æ€ç›‘æ§ã€‚åŠ å¼ºç‰¹å®šåŒºåŸŸç›‘ç®¡ï¼Œåœ¨æœªè®¾ç«‹å£å²¸æŸ¥éªŒæœºæ„çš„åŒºåŸŸè®¾ç«‹ç»¼åˆæ‰§æ³•ç‚¹ï¼Œå¯¹è½½è¿å·¥å…·ã€ä¸Šä¸‹è´§ç‰©ã€ç‰©å“å®æ—¶ç›‘æ§å’Œå¤„ç†ã€‚æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸å†…åœ°ä¹‹é—´è¿›å‡ºçš„è´§ç‰©ã€ç‰©å“ã€äººå‘˜ã€è¿è¾“å·¥å…·ç­‰å‡éœ€ä»å£å²¸è¿›å‡ºã€‚å®Œå–„å£å²¸ç›‘ç®¡è®¾å¤‡è®¾æ–½çš„é…ç½®ã€‚æµ·å…³è´Ÿè´£å£å²¸åŠå…¶ä»–æµ·å…³ç›‘ç®¡åŒºçš„ç›‘ç®¡å’ŒæŸ¥ç¼‰èµ°ç§å·¥ä½œã€‚æµ·å—çœæ”¿åºœè´Ÿè´£å…¨çœåèµ°ç§ç»¼åˆæ²»ç†å·¥ä½œï¼Œå¯¹ä¸‹çº§æ”¿åºœåèµ°ç§ç»¼åˆæ²»ç†å·¥ä½œè¿›è¡Œè€ƒè¯„ã€‚å»ºç«‹ä¸å¹¿ä¸œçœã€å¹¿è¥¿å£®æ—è‡ªæ²»åŒºç­‰åœ°çš„åèµ°ç§è”é˜²è”æ§æœºåˆ¶ã€‚ æŠ•èµ„é£é™©é˜²æ§ã€‚å®Œå–„ä¸æŠ•èµ„è§„åˆ™ç›¸é€‚åº”çš„è¿‡ç¨‹ç›‘ç®¡åˆ¶åº¦ï¼Œä¸¥æ ¼è½å®å¤‡æ¡ˆå—ç†æœºæ„çš„å®¡æŸ¥è´£ä»»å’Œå¤‡æ¡ˆä¸»ä½“çš„å¤‡æ¡ˆè´£ä»»ã€‚æ˜ç¡®åŠ å¼ºè¿‡ç¨‹ç›‘ç®¡çš„è§„åˆ™å’Œæ ‡å‡†ï¼Œå‹å®ç›‘ç®¡è´£ä»»ï¼Œä¾æ³•å¯¹æŠ•èµ„ç»è¥æ´»åŠ¨çš„å…¨ç”Ÿå‘½å‘¨æœŸå®æ–½æœ‰æ•ˆç›‘ç®¡ï¼Œå¯¹æ–°æŠ€æœ¯ã€æ–°äº§ä¸šã€æ–°ä¸šæ€ã€æ–°æ¨¡å¼å®è¡ŒåŒ…å®¹å®¡æ…ç›‘ç®¡ï¼Œå¯¹é«˜é£é™©è¡Œä¸šå’Œé¢†åŸŸå®è¡Œé‡ç‚¹ç›‘ç®¡ã€‚å»ºç«‹å¥å…¨æ³•å¾‹è´£ä»»åˆ¶åº¦ï¼Œé’ˆå¯¹å¤‡æ¡ˆä¸»ä½“æä¾›è™šå‡å¤‡æ¡ˆä¿¡æ¯ã€è¿æ³•ç»è¥ç­‰è¡Œä¸ºï¼Œåˆ¶å®šä¸¥å‰çš„æƒ©æˆ’æªæ–½ã€‚å®æ–½å¥½å¤–å•†æŠ•èµ„å®‰å…¨å®¡æŸ¥ï¼Œåœ¨åˆ›é€ ç¨³å®šã€é€æ˜å’Œå¯é¢„æœŸçš„æŠ•èµ„ç¯å¢ƒåŒæ—¶ï¼Œæœ‰æ•ˆé˜²èŒƒå›½å®¶å®‰å…¨é£é™©ã€‚ é‡‘èé£é™©é˜²æ§ã€‚ä¼˜åŒ–é‡‘èåŸºç¡€è®¾æ–½å’Œé‡‘èæ³•æ²»ç¯å¢ƒï¼ŒåŠ å¼ºé‡‘èæ¶ˆè´¹è€…æƒç›Šä¿æŠ¤ï¼Œä¾æ‰˜èµ„é‡‘æµä¿¡æ¯ç›‘æµ‹ç®¡ç†ç³»ç»Ÿï¼Œå»ºç«‹å¥å…¨èµ„é‡‘æµåŠ¨ç›‘æµ‹å’Œé£é™©é˜²æ§ä½“ç³»ã€‚å»ºç«‹è‡ªç”±è´¸æ˜“æ¸¯è·¨å¢ƒèµ„æœ¬æµåŠ¨å®è§‚å®¡æ…ç®¡ç†ä½“ç³»ï¼ŒåŠ å¼ºå¯¹é‡å¤§é£é™©çš„è¯†åˆ«å’Œç³»ç»Ÿæ€§é‡‘èé£é™©çš„é˜²èŒƒã€‚åŠ å¼ºåæ´—é’±ã€åææ€–èèµ„å’Œåé€ƒç¨å®¡æŸ¥ï¼Œç ”ç©¶å»ºç«‹æ´—é’±é£é™©è¯„ä¼°æœºåˆ¶ï¼Œå®šæœŸè¯„ä¼°æ´—é’±å’Œææ€–èèµ„é£é™©ã€‚æ„å»ºé€‚åº”æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾çš„é‡‘èç›‘ç®¡åè°ƒæœºåˆ¶ã€‚ ç½‘ç»œå®‰å…¨å’Œæ•°æ®å®‰å…¨é£é™©é˜²æ§ã€‚æ·±å…¥è´¯å½»å®æ–½ç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤åˆ¶åº¦ï¼Œé‡ç‚¹ä¿éšœå…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å’Œæ•°æ®å®‰å…¨ï¼Œå¥å…¨ç½‘ç»œå®‰å…¨ä¿éšœä½“ç³»ï¼Œæå‡æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾ç›¸å…³çš„ç½‘ç»œå®‰å…¨ä¿éšœèƒ½åŠ›å’Œæ°´å¹³ã€‚å»ºç«‹å¥å…¨æ•°æ®å‡ºå¢ƒå®‰å…¨ç®¡ç†åˆ¶åº¦ä½“ç³»ã€‚å¥å…¨æ•°æ®æµåŠ¨é£é™©ç®¡æ§æªæ–½ã€‚ å…¬å…±å«ç”Ÿé£é™©é˜²æ§ã€‚åŠ å¼ºå…¬å…±å«ç”Ÿé˜²æ§æ•‘æ²»ä½“ç³»å»ºè®¾ï¼Œå»ºç«‹ä¼ æŸ“ç—…å’Œçªå‘å…¬å…±å«ç”Ÿäº‹ä»¶ç›‘æµ‹é¢„è­¦ã€åº”æ€¥å“åº”å¹³å°å’Œå†³ç­–æŒ‡æŒ¥ç³»ç»Ÿï¼Œæé«˜æ—©æœŸé¢„é˜²ã€é£é™©ç ”åˆ¤å’ŒåŠæ—¶å¤„ç½®èƒ½åŠ›ã€‚åŠ å¼ºç–¾ç—…é¢„é˜²æ§åˆ¶ä½“ç³»å»ºè®¾ï¼Œé«˜æ ‡å‡†å»ºè®¾çœçº§ç–¾ç—…é¢„é˜²æ§åˆ¶ä¸­å¿ƒï¼Œå»ºç«‹å›½å®¶çƒ­å¸¦ç—…ç ”ç©¶ä¸­å¿ƒæµ·å—åˆ†ä¸­å¿ƒï¼ŒåŠ å¿«æ¨è¿›å„çº§ç–¾ç—…é¢„é˜²æ§åˆ¶æœºæ„åŸºç¡€è®¾æ–½å»ºè®¾ï¼Œä¼˜åŒ–å®éªŒå®¤æ£€éªŒæ£€æµ‹èµ„æºé…ç½®ã€‚åŠ å¼ºå…¬å…±å«ç”Ÿäººæ‰é˜Ÿä¼å»ºè®¾ï¼Œæå‡ç›‘æµ‹é¢„è­¦ã€æ£€éªŒæ£€æµ‹ã€ç°åœºæµè¡Œç—…å­¦è°ƒæŸ¥ã€åº”æ€¥å¤„ç½®å’ŒåŒ»ç–—æ•‘æ²»èƒ½åŠ›ã€‚å»ºè®¾ç”Ÿç‰©å®‰å…¨é˜²æŠ¤ä¸‰çº§å®éªŒå®¤å’Œä¼ æŸ“ç—…é˜²æ²»ç ”ç©¶æ‰€ï¼Œå¼ºåŒ–å…¨é¢æ£€æµ‹ã€å¿«é€Ÿç­›æŸ¥èƒ½åŠ›ï¼Œä¼˜åŒ–é‡è¦å«ç”Ÿåº”æ€¥ç‰©èµ„å‚¨å¤‡å’Œäº§èƒ½ä¿éšœä½“ç³»ã€‚å¥å…¨ä¼˜åŒ–é‡å¤§ç–«æƒ…æ•‘æ²»ä½“ç³»ï¼Œå»ºè®¾ä¼ æŸ“ç—…åŒ»ç–—æœåŠ¡ç½‘ç»œï¼Œä¾æ‰˜ç»¼åˆåŒ»é™¢æˆ–ä¸“ç§‘åŒ»é™¢å»ºç«‹çœçº§å’Œå¸‚çº§ä¼ æŸ“ç—…åŒ»ç–—ä¸­å¿ƒï¼Œæ”¹å–„ä¼ æŸ“ç—…åŒ»ç–—ä¸­å¿ƒå’Œä¼ æŸ“ç—…åŒ»é™¢åŸºç¡€è®¾æ–½å’ŒåŒ»ç–—æ¡ä»¶ã€‚é‡ç‚¹åŠ å¼ºåŸºå±‚ä¼ æŸ“ç—…åŒ»ç–—æœåŠ¡èƒ½åŠ›å»ºè®¾ï¼Œæå‡å¿çº§ç»¼åˆåŒ»é™¢ä¼ æŸ“ç—…è¯Šç–—èƒ½åŠ›ã€‚æ„å»ºç½‘æ ¼åŒ–ç´§å¯†å‹åŒ»ç–—é›†å›¢ï¼Œä¿ƒè¿›èµ„æºä¸‹æ²‰ã€åŒ»é˜²èåˆã€‚å®Œå–„åŸºå±‚åŒ»ç–—å«ç”Ÿæœºæ„æ ‡å‡†åŒ–å»ºè®¾ï¼Œå¼ºåŒ–å¸¸è§ç—…å¤šå‘ç—…è¯Šæ²»ã€å…¬å…±å«ç”ŸæœåŠ¡å’Œå¥åº·ç®¡ç†èƒ½åŠ›ã€‚åŠ å¼ºå›½é™…å«ç”Ÿæ£€ç–«åˆä½œå’Œå›½é™…ç–«æƒ…ä¿¡æ¯æœé›†ä¸åˆ†æï¼Œæå‡å£å²¸å«ç”Ÿæ£€ç–«æŠ€æœ¯è®¾æ–½ä¿éšœï¼Œå»ºè®¾ä¸€æµçš„å›½é™…æ—…è¡Œå«ç”Ÿä¿å¥ä¸­å¿ƒï¼Œä¸¥æ ¼è½å®å‡ºå…¥å¢ƒäººå‘˜å¥åº·ç”³æŠ¥åˆ¶åº¦ï¼ŒåŠ å¼ºå¯¹æ¥è‡ªé‡ç‚¹å›½å®¶æˆ–åœ°åŒºçš„äº¤é€šå·¥å…·ã€äººå‘˜å’Œè´§ç‰©ã€ç‰©å“çš„å«ç”Ÿæ£€ç–«ï¼Œå¼ºåŒ–è”é˜²è”æ§ï¼Œç­‘ç‰¢å£å²¸æ£€ç–«é˜²çº¿ã€‚åŠ å¼ºå¯¹å…¨çƒä¼ æŸ“ç—…ç–«æƒ…çš„ç›‘æµ‹ï¼Œæ¨è¿›å¢ƒå¤–ä¼ æŸ“ç—…ç–«æƒ…é£é™©æ—©æœŸé¢„è­¦ï¼Œä¸¥é˜²é‡å¤§ä¼ æŸ“ç—…è·¨å¢ƒä¼ æ’­ã€‚å»ºç«‹æµ·å…³ç­‰å¤šéƒ¨é—¨åä½œçš„å¢ƒå¤–ç–«ç—…ç–«æƒ…å’Œæœ‰å®³ç”Ÿç‰©è”é˜²è”æ§æœºåˆ¶ã€‚æå‡è¿›å‡ºå£å•†å“è´¨é‡å®‰å…¨é£é™©é¢„è­¦å’Œå¿«é€Ÿååº”ç›‘ç®¡èƒ½åŠ›ï¼Œå®Œå–„é‡ç‚¹æ•æ„Ÿè¿›å‡ºå£å•†å“ç›‘ç®¡ã€‚ ç”Ÿæ€é£é™©é˜²æ§ã€‚å®è¡Œä¸¥æ ¼çš„è¿›å‡ºå¢ƒç¯å¢ƒå®‰å…¨å‡†å…¥ç®¡ç†åˆ¶åº¦ï¼Œç¦æ­¢æ´‹åƒåœ¾è¾“å…¥ã€‚æ¨è¿›åŒ»ç–—åºŸç‰©ç­‰å±é™©åºŸç‰©å¤„ç½®è®¾æ–½å»ºè®¾ï¼Œæå‡çªå‘ç”Ÿæ€ç¯å¢ƒäº‹ä»¶åº”æ€¥å‡†å¤‡ä¸å“åº”èƒ½åŠ›ã€‚å»ºç«‹å¥å…¨ç¯ä¿ä¿¡ç”¨è¯„ä»·åˆ¶åº¦ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:2:9","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ä¸‰ã€åˆ†æ­¥éª¤åˆ†é˜¶æ®µå®‰æ’ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:3:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆä¸€ï¼‰2025å¹´å‰é‡ç‚¹ä»»åŠ¡ å›´ç»•è´¸æ˜“æŠ•èµ„è‡ªç”±åŒ–ä¾¿åˆ©åŒ–ï¼Œåœ¨æœ‰æ•ˆç›‘ç®¡åŸºç¡€ä¸Šï¼Œæœ‰åºæ¨è¿›å¼€æ”¾è¿›ç¨‹ï¼Œæ¨åŠ¨å„ç±»è¦ç´ ä¾¿æ·é«˜æ•ˆæµåŠ¨ï¼Œå½¢æˆæ—©æœŸæ”¶è·ï¼Œ##é€‚æ—¶å¯åŠ¨å…¨å²›å°å…³è¿ä½œ##ã€‚ åŠ å¼ºæµ·å…³ç‰¹æ®Šç›‘ç®¡åŒºåŸŸå»ºè®¾ã€‚åœ¨æ´‹æµ¦ä¿ç¨æ¸¯åŒºç­‰å…·å¤‡æ¡ä»¶çš„æµ·å…³ç‰¹æ®Šç›‘ç®¡åŒºåŸŸç‡å…ˆå®è¡Œâ€œä¸€çº¿â€æ”¾å¼€ã€â€œäºŒçº¿â€ç®¡ä½çš„è¿›å‡ºå£ç®¡ç†åˆ¶åº¦ã€‚æ ¹æ®æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾éœ€è¦ï¼Œå¢è®¾æµ·å…³ç‰¹æ®Šç›‘ç®¡åŒºåŸŸã€‚ å®è¡Œéƒ¨åˆ†è¿›å£å•†å“é›¶å…³ç¨æ”¿ç­–ã€‚é™¤æ³•å¾‹æ³•è§„å’Œç›¸å…³è§„å®šæ˜ç¡®ä¸äºˆå…ç¨ã€å›½å®¶è§„å®šç¦æ­¢è¿›å£çš„å•†å“å¤–ï¼Œå¯¹ä¼ä¸šè¿›å£è‡ªç”¨çš„ç”Ÿäº§è®¾å¤‡ï¼Œå®è¡Œâ€œé›¶å…³ç¨â€è´Ÿé¢æ¸…å•ç®¡ç†ï¼›å¯¹å²›å†…è¿›å£ç”¨äºäº¤é€šè¿è¾“ã€æ—…æ¸¸ä¸šçš„èˆ¹èˆ¶ã€èˆªç©ºå™¨ç­‰è¥è¿ç”¨äº¤é€šå·¥å…·åŠæ¸¸è‰‡ï¼Œå®è¡Œâ€œé›¶å…³ç¨â€æ­£é¢æ¸…å•ç®¡ç†ï¼›å¯¹å²›å†…è¿›å£ç”¨äºç”Ÿäº§è‡ªç”¨æˆ–ä»¥â€œä¸¤å¤´åœ¨å¤–â€æ¨¡å¼è¿›è¡Œç”Ÿäº§åŠ å·¥æ´»åŠ¨ï¼ˆæˆ–æœåŠ¡è´¸æ˜“è¿‡ç¨‹ä¸­ï¼‰æ‰€æ¶ˆè€—çš„åŸè¾…æ–™ï¼Œå®è¡Œâ€œé›¶å…³ç¨â€æ­£é¢æ¸…å•ç®¡ç†ï¼›å¯¹å²›å†…å±…æ°‘æ¶ˆè´¹çš„è¿›å¢ƒå•†å“ï¼Œå®è¡Œæ­£é¢æ¸…å•ç®¡ç†ï¼Œå…è®¸å²›å†…å…ç¨è´­ä¹°ã€‚å¯¹å®è¡Œâ€œé›¶å…³ç¨â€æ¸…å•ç®¡ç†çš„è´§ç‰©åŠç‰©å“ï¼Œå…å¾è¿›å£å…³ç¨ã€è¿›å£ç¯èŠ‚å¢å€¼ç¨å’Œæ¶ˆè´¹ç¨ã€‚æ¸…å•å†…å®¹ç”±æœ‰å…³éƒ¨é—¨æ ¹æ®æµ·å—å®é™…éœ€è¦å’Œç›‘ç®¡æ¡ä»¶è¿›è¡ŒåŠ¨æ€è°ƒæ•´ã€‚æ”¾å®½ç¦»å²›å…ç¨è´­ç‰©é¢åº¦è‡³æ¯å¹´æ¯äºº10ä¸‡å…ƒï¼Œæ‰©å¤§å…ç¨å•†å“ç§ç±»ã€‚ å‡å°‘è·¨å¢ƒæœåŠ¡è´¸æ˜“é™åˆ¶ã€‚åœ¨é‡ç‚¹é¢†åŸŸç‡å…ˆè§„èŒƒå½±å“æœåŠ¡è´¸æ˜“è‡ªç”±ä¾¿åˆ©çš„å›½å†…è§„åˆ¶ã€‚åˆ¶å®šå‡ºå°æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è·¨å¢ƒæœåŠ¡è´¸æ˜“è´Ÿé¢æ¸…å•ï¼Œç»™äºˆå¢ƒå¤–æœåŠ¡æä¾›è€…å›½æ°‘å¾…é‡ã€‚å»ºè®¾æµ·å—å›½é™…çŸ¥è¯†äº§æƒäº¤æ˜“æ‰€ï¼Œåœ¨çŸ¥è¯†äº§æƒè½¬è®©ã€è¿ç”¨å’Œç¨æ”¶æ”¿ç­–ç­‰æ–¹é¢å¼€å±•åˆ¶åº¦åˆ›æ–°ï¼Œè§„èŒƒæ¢ç´¢çŸ¥è¯†äº§æƒè¯åˆ¸åŒ–ã€‚ å®è¡Œâ€œæç®€å®¡æ‰¹â€æŠ•èµ„åˆ¶åº¦ã€‚åˆ¶å®šå‡ºå°æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ”¾å®½å¸‚åœºå‡†å…¥ç‰¹åˆ«æ¸…å•ã€å¤–å•†æŠ•èµ„å‡†å…¥è´Ÿé¢æ¸…å•ã€‚å¯¹å…ˆè¡Œå¼€æ”¾çš„ç‰¹å®šæœåŠ¡ä¸šé¢†åŸŸæ‰€è®¾ç«‹çš„å¤–å•†æŠ•èµ„ä¼ä¸šï¼Œæ˜ç¡®ç»è¥ä¸šåŠ¡è¦†ç›–çš„åœ°åŸŸèŒƒå›´ã€‚å»ºç«‹å¥å…¨å›½å®¶å®‰å…¨å®¡æŸ¥ã€äº§ä¸šå‡†å…¥ç¯å¢ƒæ ‡å‡†å’Œç¤¾ä¼šä¿¡ç”¨ä½“ç³»ç­‰åˆ¶åº¦ï¼Œå…¨é¢æ¨è¡Œâ€œæç®€å®¡æ‰¹â€åˆ¶åº¦ã€‚æ·±åŒ–â€œè¯ç…§åˆ†ç¦»â€æ”¹é©ã€‚å»ºç«‹å¥å…¨ä»¥ä¿¡ç”¨ç›‘ç®¡ä¸ºåŸºç¡€ã€ä¸è´Ÿé¢æ¸…å•ç®¡ç†æ–¹å¼ç›¸é€‚åº”çš„è¿‡ç¨‹ç›‘ç®¡ä½“ç³»ã€‚ è¯•ç‚¹æ”¹é©è·¨å¢ƒè¯åˆ¸æŠ•èèµ„æ”¿ç­–ã€‚æ”¯æŒåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…æ³¨å†Œçš„å¢ƒå†…ä¼ä¸šæ ¹æ®å¢ƒå†…å¤–èèµ„è®¡åˆ’åœ¨å¢ƒå¤–å‘è¡Œè‚¡ç¥¨ï¼Œä¼˜å…ˆæ”¯æŒä¼ä¸šé€šè¿‡å¢ƒå¤–å‘è¡Œå€ºåˆ¸èèµ„ï¼Œå°†ä¼ä¸šå‘è¡Œå¤–å€ºå¤‡æ¡ˆç™»è®°åˆ¶ç®¡ç†ä¸‹æ”¾è‡³æµ·å—çœå‘å±•æ”¹é©éƒ¨é—¨ã€‚æ¢ç´¢å¼€å±•è·¨å¢ƒèµ„äº§ç®¡ç†ä¸šåŠ¡è¯•ç‚¹ï¼Œæé«˜è·¨å¢ƒè¯åˆ¸æŠ•èèµ„æ±‡å…‘ä¾¿åˆ©ã€‚è¯•ç‚¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…ä¼ä¸šå¢ƒå¤–ä¸Šå¸‚å¤–æ±‡ç™»è®°ç›´æ¥åˆ°é“¶è¡ŒåŠç†ã€‚ åŠ å¿«é‡‘èä¸šå¯¹å†…å¯¹å¤–å¼€æ”¾ã€‚åŸ¹è‚²ã€æå‡æµ·å—é‡‘èæœºæ„æœåŠ¡å¯¹å¤–å¼€æ”¾èƒ½åŠ›ï¼Œæ”¯æŒé‡‘èä¸šå¯¹å¤–å¼€æ”¾æ”¿ç­–åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç‡å…ˆå®æ–½ã€‚æ”¯æŒç¬¦åˆæ¡ä»¶çš„å¢ƒå¤–è¯åˆ¸åŸºé‡‘æœŸè´§ç»è¥æœºæ„åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è®¾ç«‹ç‹¬èµ„æˆ–åˆèµ„é‡‘èæœºæ„ã€‚æ”¯æŒé‡‘èæœºæ„ç«‹è¶³æµ·å—æ—…æ¸¸ä¸šã€ç°ä»£æœåŠ¡ä¸šã€é«˜æ–°æŠ€æœ¯äº§ä¸šç­‰é‡ç‚¹äº§ä¸šå‘å±•éœ€è¦ï¼Œåˆ›æ–°é‡‘èäº§å“ï¼Œæå‡æœåŠ¡è´¨æ•ˆã€‚ä¾æ‰˜æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾ï¼Œæ¨åŠ¨å‘å±•ç›¸å…³çš„åœºå¤–è¡ç”Ÿå“ä¸šåŠ¡ã€‚æ”¯æŒæµ·å—åœ¨ä¼˜åŒ–å‡çº§ç°æœ‰äº¤æ˜“åœºæ‰€çš„å‰æä¸‹ï¼Œæ¨è¿›äº§æƒäº¤æ˜“åœºæ‰€å»ºè®¾ï¼Œç ”ç©¶å…è®¸éå±…æ°‘æŒ‰ç…§è§„å®šå‚ä¸äº¤æ˜“å’Œè¿›è¡Œèµ„é‡‘ç»“ç®—ã€‚æ”¯æŒæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å†…å·²ç»è®¾ç«‹çš„äº¤æ˜“åœºæ‰€åœ¨ä¼šå‘˜ã€äº¤æ˜“ã€ç¨è´Ÿã€æ¸…ç®—ã€äº¤å‰²ã€æŠ•èµ„è€…æƒç›Šä¿æŠ¤ã€åæ´—é’±ç­‰æ–¹é¢ï¼Œå»ºç«‹ä¸å›½é™…æƒ¯ä¾‹æ¥è½¨çš„è§„åˆ™å’Œåˆ¶åº¦ä½“ç³»ã€‚åœ¨ç¬¦åˆç›¸å…³æ³•å¾‹æ³•è§„çš„å‰æä¸‹ï¼Œæ”¯æŒåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è®¾ç«‹è´¢äº§é™©ã€äººèº«é™©ã€å†ä¿é™©å…¬å¸ä»¥åŠç›¸äº’ä¿é™©ç»„ç»‡å’Œè‡ªä¿å…¬å¸ã€‚ å¢å¼ºé‡‘èæœåŠ¡å®ä½“ç»æµèƒ½åŠ›ã€‚æ”¯æŒå‘è¡Œå…¬å¸ä¿¡ç”¨ç±»å€ºåˆ¸ã€é¡¹ç›®æ”¶ç›Šç¥¨æ®ã€ä½æˆ¿ç§Ÿèµä¸“é¡¹å€ºåˆ¸ç­‰ã€‚å¯¹æœ‰ç¨³å®šç°é‡‘æµçš„ä¼˜è´¨æ—…æ¸¸èµ„äº§ï¼Œæ¨åŠ¨å¼€å±•è¯åˆ¸åŒ–è¯•ç‚¹ã€‚æ”¯æŒé‡‘èæœºæ„åœ¨ä¾æ³•åˆè§„ã€æœ‰æ•ˆé˜²èŒƒé£é™©çš„å‰æä¸‹ï¼Œåœ¨æœåŠ¡è´¸æ˜“é¢†åŸŸå¼€å±•ä¿å•èèµ„ã€ä»“å•è´¨æŠ¼è´·æ¬¾ã€åº”æ”¶è´¦æ¬¾è´¨æŠ¼è´·æ¬¾ã€çŸ¥è¯†äº§æƒè´¨æŠ¼èèµ„ç­‰ä¸šåŠ¡ã€‚æ”¯æŒæ¶‰æµ·é«˜æ–°æŠ€æœ¯ä¼ä¸šåˆ©ç”¨è‚¡æƒã€çŸ¥è¯†äº§æƒå¼€å±•è´¨æŠ¼èèµ„ï¼Œè§„èŒƒã€ç¨³å¦¥å¼€å‘èˆªè¿ç‰©æµé‡‘èäº§å“å’Œä¾›åº”é“¾èèµ„äº§å“ã€‚ä¾æ³•æœ‰åºæ¨è¿›äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®ã€äº‘è®¡ç®—ç­‰é‡‘èç§‘æŠ€é¢†åŸŸç ”ç©¶æˆæœåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç‡å…ˆè½åœ°ã€‚æ¢ç´¢å»ºç«‹ä¸å›½é™…å•†ä¸šä¿é™©ä»˜è´¹ä½“ç³»ç›¸è¡”æ¥çš„å•†ä¸šæ€§åŒ»ç–—ä¿é™©æœåŠ¡ã€‚æ”¯æŒä¿é™©ä¸šé‡‘èæœºæ„ä¸å¢ƒå¤–æœºæ„åˆä½œå¼€å‘è·¨å¢ƒåŒ»ç–—ä¿é™©äº§å“ã€‚ å®æ–½æ›´åŠ ä¾¿åˆ©çš„å…ç­¾å…¥å¢ƒæªæ–½ã€‚å°†å¤–å›½äººå…ç­¾å…¥å¢ƒæ¸ é“ç”±æ—…è¡Œç¤¾é‚€è¯·æ¥å¾…æ‰©å±•ä¸ºå¤–å›½äººè‡ªè¡Œç”³æŠ¥æˆ–é€šè¿‡å•ä½é‚€è¯·æ¥å¾…å…ç­¾å…¥å¢ƒã€‚æ”¾å®½å¤–å›½äººç”³è¯·å…ç­¾å…¥å¢ƒäº‹ç”±é™åˆ¶ï¼Œå…è®¸å¤–å›½äººä»¥å•†è´¸ã€è®¿é—®ã€æ¢äº²ã€å°±åŒ»ã€ä¼šå±•ã€ä½“è‚²ç«æŠ€ç­‰äº‹ç”±ç”³è¯·å…ç­¾å…¥å¢ƒæµ·å—ã€‚å®æ–½å¤–å›½æ—…æ¸¸å›¢ä¹˜åé‚®è½®å…¥å¢ƒ15å¤©å…ç­¾æ”¿ç­–ã€‚ å®æ–½æ›´åŠ å¼€æ”¾çš„èˆ¹èˆ¶è¿è¾“æ”¿ç­–ã€‚ä»¥â€œä¸­å›½æ´‹æµ¦æ¸¯â€ä¸ºèˆ¹ç±æ¸¯ï¼Œç®€åŒ–æ£€éªŒæµç¨‹ï¼Œé€æ­¥æ”¾å¼€èˆ¹èˆ¶æ³•å®šæ£€éªŒï¼Œå»ºç«‹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å›½é™…èˆ¹èˆ¶ç™»è®°ä¸­å¿ƒï¼Œåˆ›æ–°è®¾ç«‹ä¾¿æ·ã€é«˜æ•ˆçš„èˆ¹èˆ¶ç™»è®°ç¨‹åºã€‚å–æ¶ˆèˆ¹èˆ¶ç™»è®°ä¸»ä½“å¤–èµ„è‚¡æ¯”é™åˆ¶ã€‚åœ¨ç¡®ä¿æœ‰æ•ˆç›‘ç®¡å’Œé£é™©å¯æ§çš„å‰æä¸‹ï¼Œå¢ƒå†…å»ºé€ çš„èˆ¹èˆ¶åœ¨â€œä¸­å›½æ´‹æµ¦æ¸¯â€ç™»è®°å¹¶ä»äº‹å›½é™…è¿è¾“çš„ï¼Œè§†åŒå‡ºå£å¹¶ç»™äºˆå‡ºå£é€€ç¨ã€‚å¯¹ä»¥æ´‹æµ¦æ¸¯ä½œä¸ºä¸­è½¬æ¸¯ä»äº‹å†…å¤–è´¸åŒèˆ¹è¿è¾“çš„å¢ƒå†…èˆ¹èˆ¶ï¼Œå…è®¸å…¶åŠ æ³¨æœ¬èˆªæ¬¡æ‰€éœ€çš„ä¿ç¨æ²¹ï¼›å¯¹å…¶åŠ æ³¨æœ¬èˆªæ¬¡æ‰€éœ€çš„æœ¬åœ°ç”Ÿäº§ç‡ƒæ–™æ²¹ï¼Œå®è¡Œå‡ºå£é€€ç¨æ”¿ç­–ã€‚å¯¹ç¬¦åˆæ¡ä»¶å¹¶ç»æ´‹æµ¦æ¸¯ä¸­è½¬ç¦»å¢ƒçš„é›†è£…ç®±è´§ç‰©ï¼Œè¯•è¡Œå¯è¿æ¸¯é€€ç¨æ”¿ç­–ã€‚åŠ å¿«æ¨è¿›ç¼å·æµ·å³¡æ¸¯èˆªä¸€ä½“åŒ–ã€‚ å®æ–½æ›´åŠ å¼€æ”¾çš„èˆªç©ºè¿è¾“æ”¿ç­–ã€‚åœ¨å¯¹ç­‰åŸºç¡€ä¸Šï¼Œæ¨åŠ¨åœ¨åŒè¾¹èˆªç©ºè¿è¾“åå®šä¸­å®ç°å¯¹åŒæ–¹æ‰¿è¿äººå¼€æ”¾å¾€è¿”æµ·å—çš„ç¬¬ä¸‰ã€ç¬¬å››èˆªæƒï¼Œå¹¶æ ¹æ®æˆ‘å›½æ•´ä½“èˆªç©ºè¿è¾“æ”¿ç­–ï¼Œæ‰©å¤§åŒ…æ‹¬ç¬¬äº”èˆªæƒåœ¨å†…çš„æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æ‰€å¿…éœ€çš„èˆªæƒå®‰æ’ã€‚æ”¯æŒåœ¨æµ·å—è¯•ç‚¹å¼€æ”¾ç¬¬ä¸ƒèˆªæƒã€‚å…è®¸ç›¸å…³å›½å®¶å’Œåœ°åŒºèˆªç©ºå…¬å¸æ‰¿è½½ç»æµ·å—è‡³ç¬¬ä¸‰å›½ï¼ˆåœ°åŒºï¼‰çš„å®¢è´§ä¸šåŠ¡ã€‚å®æ–½èˆªç©ºå›½é™…ä¸­è½¬æ—…å®¢åŠå…¶è¡Œæé€šç¨‹è”è¿ã€‚å¯¹ä½äºæµ·å—çš„ä¸»åŸºåœ°èˆªç©ºå…¬å¸å¼€æ‹“å›½é™…èˆªçº¿ç»™äºˆæ”¯æŒã€‚å…è®¸æµ·å—è¿›å‡ºå²›èˆªç­åŠ æ³¨ä¿ç¨èˆªæ²¹ã€‚ ä¾¿åˆ©æ•°æ®æµåŠ¨ã€‚åœ¨å›½å®¶æ•°æ®è·¨å¢ƒä¼ è¾“å®‰å…¨ç®¡ç†åˆ¶åº¦æ¡†æ¶ä¸‹ï¼Œå¼€å±•æ•°æ®è·¨å¢ƒä¼ è¾“å®‰å…¨ç®¡ç†è¯•ç‚¹ï¼Œæ¢ç´¢å½¢æˆæ—¢èƒ½ä¾¿åˆ©æ•°æ®æµåŠ¨åˆèƒ½ä¿éšœå®‰å…¨çš„æœºåˆ¶ã€‚ æ·±åŒ–äº§ä¸šå¯¹å¤–å¼€æ”¾ã€‚æ”¯æŒå‘å±•æ€»éƒ¨ç»æµã€‚ä¸¾åŠä¸­å›½å›½é™…æ¶ˆè´¹å“åšè§ˆä¼šï¼Œå›½å®¶çº§å±•ä¼šå¢ƒå¤–å±•å“åœ¨å±•æœŸå†…è¿›å£å’Œé”€å”®äº«å—å…ç¨æ”¿ç­–ï¼Œå…ç¨æ”¿ç­–ç”±æœ‰å…³éƒ¨é—¨å…·ä½“åˆ¶å®šã€‚æ”¯æŒæµ·å—å¤§åŠ›å¼•è¿›å›½å¤–ä¼˜è´¨åŒ»ç–—èµ„æºï¼ˆæ”¯æŒåŒ»ä¿å—ï¼Ÿï¼‰ã€‚æ€»ç»“åŒºåŸŸåŒ»ç–—ä¸­å¿ƒå»ºè®¾è¯•ç‚¹ç»éªŒï¼Œç ”ç©¶æ”¯æŒæµ·å—å»ºè®¾åŒºåŸŸåŒ»ç–—ä¸­å¿ƒã€‚å…è®¸å¢ƒå¤–ç†å·¥å†œåŒ»ç±»é«˜æ°´å¹³å¤§å­¦ã€èŒä¸šé™¢æ ¡åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç‹¬ç«‹åŠå­¦ï¼Œè®¾ç«‹å›½é™…å­¦æ ¡ã€‚æ¨åŠ¨å›½å†…é‡ç‚¹é«˜æ ¡å¼•è¿›å›½å¤–çŸ¥åé™¢æ ¡åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ä¸¾åŠå…·æœ‰ç‹¬ç«‹æ³•äººèµ„æ ¼çš„ä¸­å¤–åˆä½œåŠå­¦æœºæ„ï¼ˆè¯´çš„æ˜¯åŒ—å¤§é’é¸Ÿå—ï¼‰ã€‚å»ºè®¾æµ·å—å›½å®¶åŒºå—é“¾æŠ€æœ¯å’Œäº§ä¸šåˆ›æ–°å‘å±•åŸºåœ°ã€‚ ä¼˜åŒ–ç¨æ”¶æ”¿ç­–å®‰æ’ã€‚ä»æœ¬æ–¹æ¡ˆå‘å¸ƒä¹‹æ—¥èµ·ï¼Œå¯¹æ³¨å†Œåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å¹¶å®è´¨æ€§è¿è¥çš„é¼“åŠ±ç±»äº§ä¸šä¼ä¸šï¼Œå‡æŒ‰15%å¾æ”¶ä¼ä¸šæ‰€å¾—ç¨ã€‚å¯¹åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è®¾ç«‹çš„æ—…æ¸¸ä¸šã€ç°ä»£æœåŠ¡ä¸šã€é«˜æ–°æŠ€æœ¯äº§ä¸šä¼ä¸šï¼Œå…¶2025å¹´å‰æ–°å¢å¢ƒå¤–ç›´æ¥æŠ•èµ„å–å¾—çš„æ‰€å¾—ï¼Œå…å¾ä¼ä¸šæ‰€å¾—ç¨ã€‚å¯¹ä¼ä¸šç¬¦åˆæ¡ä»¶çš„èµ„æœ¬æ€§æ”¯å‡ºï¼Œå…è®¸åœ¨æ”¯å‡ºå‘ç”Ÿå½“æœŸä¸€æ¬¡æ€§ç¨å‰æ‰£é™¤æˆ–åŠ é€ŸæŠ˜æ—§å’Œæ‘Šé”€ã€‚å¯¹åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å·¥ä½œçš„é«˜ç«¯äººæ‰å’Œç´§ç¼ºäººæ‰ï¼Œå…¶ä¸ªäººæ‰€å¾—ç¨å®é™…ç¨è´Ÿè¶…è¿‡15%çš„éƒ¨åˆ†ï¼Œäºˆä»¥å…å¾ã€‚å¯¹äº«å—ä¸Šè¿°ä¼˜æƒ æ”¿ç­–çš„é«˜ç«¯äººæ‰å’Œç´§ç¼ºäººæ‰å®è¡Œæ¸…å•ç®¡ç†ï¼Œç”±æµ·å—çœå•†è´¢æ”¿éƒ¨ã€ç¨åŠ¡æ€»å±€åˆ¶å®šå…·ä½“ç®¡ç†åŠæ³•ã€‚ åŠ å¤§ä¸­å¤®è´¢æ”¿æ”¯æŒåŠ›åº¦ã€‚ä¸­å¤®è´¢æ”¿å®‰æ’ç»¼åˆè´¢åŠ›è¡¥åŠ©ï¼Œå¯¹åœ°æ–¹è´¢æ”¿å‡æ”¶äºˆä»¥é€‚å½“å¼¥è¡¥ã€‚é¼“åŠ±æµ·å—åœ¨å›½åŠ¡é™¢æ‰¹å‡†çš„é™é¢å†…å‘è¡Œåœ°æ–¹æ”¿åºœå€ºåˆ¸æ”¯æŒè‡ªç”±è´¸æ˜“æ¸¯é¡¹ç›®å»ºè®¾ã€‚åœ¨æœ‰æ•ˆé˜²èŒƒé£é™©çš„å‰æä¸‹ï¼Œç¨³æ­¥å¢åŠ æµ·å—åœ°æ–¹æ”¿åºœä¸“é¡¹å€ºåˆ¸å‘è¡Œé¢åº¦ï¼Œç”¨äºæ”¯æŒé‡å¤§åŸºç¡€è®¾æ–½å»ºè®¾ã€‚é¼“åŠ±åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å‘å…¨çƒç¬¦åˆæ¡ä»¶çš„å¢ƒå¤–æŠ•èµ„è€…å‘è¡Œåœ°æ–¹æ”¿åºœå€ºåˆ¸ã€‚ç”±æµ·å—ç»Ÿç­¹ä¸­å¤®èµ„é‡‘å’Œè‡ªæœ‰è´¢åŠ›ï¼Œè®¾ç«‹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æŠ•èµ„åŸºé‡‘ï¼ŒæŒ‰æ”¿åºœå¼•å¯¼ã€å¸‚åœºåŒ–æ–¹å¼è¿ä½œã€‚ ç»™äºˆå……åˆ†æ³•å¾‹æˆæƒã€‚æœ¬æ–¹æ¡ˆæå‡ºçš„å„é¡¹æ”¹é©æ”¿ç­–æªæ–½ï¼Œå‡¡æ¶‰åŠè°ƒæ•´ç°è¡Œæ³•å¾‹æˆ–è¡Œæ”¿æ³•è§„çš„ï¼Œç»å…¨å›½äººå¤§åŠå…¶å¸¸å§”ä¼šæˆ–å›½åŠ¡é™¢ç»Ÿä¸€æˆæƒåå®æ–½ã€‚ç ”ç©¶ç®€åŒ–è°ƒæ•´ç°è¡Œæ³•å¾‹æˆ–è¡Œæ”¿æ³•è§„çš„å·¥ä½œç¨‹åºï¼Œæ¨åŠ¨å°½å¿«è½åœ°ã€‚æˆæƒæµ·å—åˆ¶å®šå‡ºå°è‡ªç”±è´¸æ˜“æ¸¯å•†äº‹æ³¨é”€æ¡ä¾‹ã€ç ´äº§æ¡ä¾‹ã€å…¬å¹³ç«äº‰æ¡ä¾‹ã€å¾æ”¶å¾ç”¨æ¡ä¾‹ã€‚åŠ å¿«æ¨åŠ¨åˆ¶å®šå‡ºå°æµ·å—è‡ªç”±è´¸æ˜“æ¸¯æ³•ã€‚ å¼ºåŒ–ç”¨åœ°ç”¨æµ·ä¿éšœã€‚æˆæƒæµ·å—åœ¨ä¸çªç ´æµ·å—çœå›½åœŸç©ºé—´è§„åˆ’æ˜ç¡®çš„ç”Ÿæ€ä¿æŠ¤çº¢çº¿ã€æ°¸ä¹…åŸºæœ¬å†œç”°é¢ç§¯ã€è€•åœ°å’Œæ—åœ°ä¿æœ‰é‡ã€å»ºè®¾ç”¨åœ°æ€»è§„æ¨¡ç­‰é‡è¦æŒ‡æ ‡å¹¶ç¡®ä¿è´¨é‡ä¸é™ä½çš„å‰æä¸‹ï¼ŒæŒ‰ç…§å›½å®¶è§„å®šçš„æ¡ä»¶ï¼Œå¯¹å…¨çœè€•åœ°ã€æ°¸ä¹…åŸºæœ¬å†œç”°ã€æ—åœ°ã€å»ºè®¾ç”¨åœ°å¸ƒå±€è°ƒæ•´è¿›è¡Œå®¡æ‰¹å¹¶çº³å…¥æµ·å—çœå’Œå¸‚å¿å›½åœŸç©ºé—´è§„åˆ’ã€‚ç§¯ææ¨è¿›åŸä¹¡åŠå¦åŒºä¸€ä½“åŒ–åè°ƒå‘å±•å’Œå°åŸé•‡å»ºè®¾ç”¨åœ°æ–°æ¨¡å¼ï¼Œæ¨è¿›å†œå¦åœŸåœ°èµ„äº§åŒ–ã€‚å»ºç«‹é›†çº¦èŠ‚çº¦ç”¨åœ°åˆ¶åº¦ã€è¯„ä»·æ ‡å‡†ä»¥åŠå­˜é‡å»ºè®¾ç”¨åœ°ç›˜æ´»å¤„ç½®æ”¿ç­–ä½“ç³»ã€‚æ€»ç»“æ¨å¹¿æ–‡æ˜Œå†œæ‘åœŸåœ°åˆ¶åº¦æ”¹é©ä¸‰é¡¹è¯•ç‚¹ç»éªŒï¼Œæ”¯æŒæµ·å—åœ¨å…¨çœæ·±å…¥æ¨è¿›å†œæ‘åœŸåœ°åˆ¶åº¦æ”¹é©ã€‚ä¾æ³•ä¿éšœå›½å®¶é‡å¤§é¡¹ç›®ç”¨æµ·éœ€æ±‚ã€‚ åšå¥½å°å…³è¿ä½œå‡†å¤‡å·¥ä½œã€‚åˆ¶å®šå‡ºå°æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å£å¾ç¨å•†å“ç›®å½•ã€é™åˆ¶è¿›å£è´§ç‰©ç‰©å“æ¸…å•ã€ç¦æ­¢è¿›å£è´§ç‰©ç‰©å“æ¸…å•ã€é™åˆ¶å‡ºå£è´§ç‰©ç‰©å“æ¸…å•ã€ç¦æ­¢å‡ºå£è´§ç‰©ç‰©å“æ¸…å•ã€è¿è¾“å·¥å…·ç®¡ç†åŠæ³•ï¼Œä»¥åŠä¸å†…åœ°æµ·å…³é€šå…³å•è¯æ ¼å¼è§„èŒƒã€ä¸å†…åœ°æµ·å…³é€šå…³æ“ä½œè§„ç¨‹ã€å‡ºå£é€šå…³æ“ä½œè§„ç¨‹ç­‰ï¼Œå¢åŠ å¯¹å¤–å¼€æ”¾å£å²¸ï¼Œå»ºè®¾å…¨å²›å°å…³è¿ä½œçš„é…å¥—è®¾æ–½ã€‚ é€‚æ—¶å¯åŠ¨å…¨å²›å°å…³è¿ä½œã€‚2025å¹´å‰ï¼Œé€‚æ—¶å…¨é¢å¼€å±•å…¨å²›å°å…³è¿ä½œå‡†å¤‡å·¥ä½œæƒ…å†µè¯„ä¼°ï¼ŒæŸ¥å µå®‰å…¨æ¼æ´ã€‚å¾…æ¡ä»¶æˆç†Ÿåå†å®æ–½å…¨å²›å°å…³è¿ä½œï¼Œä¸å†ä¿ç•™æ´‹æµ¦ä¿ç¨æ¸¯åŒºã€æµ·å£ç»¼åˆä¿ç¨åŒºç­‰æµ·å…³ç‰¹æ®Šç›‘ç®¡åŒºåŸŸã€‚ç›¸å…³ç›‘ç®¡å®æ–½æ–¹æ¡ˆç”±æœ‰å…³éƒ¨é—¨å¦è¡Œåˆ¶å®šã€‚åœ¨å…¨å²›å°å…³è¿ä½œçš„åŒæ—¶ï¼Œä¾æ³•å°†ç°è¡Œå¢å€¼ç¨ã€æ¶ˆè´¹ç¨ã€è½¦è¾†è´­ç½®ç¨ã€åŸå¸‚ç»´æŠ¤å»ºè®¾ç¨åŠæ•™è‚²è´¹é™„åŠ ç­‰ç¨è´¹è¿›è¡Œç®€å¹¶ï¼Œå¯åŠ¨åœ¨è´§ç‰©å’ŒæœåŠ¡é›¶å”®ç¯èŠ‚å¾æ”¶é”€å”®ç¨ç›¸å…³å·¥ä½œã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:3:1","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ï¼ˆäºŒï¼‰2035å¹´å‰é‡ç‚¹ä»»åŠ¡ è¿›ä¸€æ­¥ä¼˜åŒ–å®Œå–„å¼€æ”¾æ”¿ç­–å’Œç›¸å…³åˆ¶åº¦å®‰æ’ï¼Œå…¨é¢å®ç°è´¸æ˜“è‡ªç”±ä¾¿åˆ©ã€æŠ•èµ„è‡ªç”±ä¾¿åˆ©ã€è·¨å¢ƒèµ„é‡‘æµåŠ¨è‡ªç”±ä¾¿åˆ©ã€äººå‘˜è¿›å‡ºè‡ªç”±ä¾¿åˆ©ã€è¿è¾“æ¥å¾€è‡ªç”±ä¾¿åˆ©å’Œæ•°æ®å®‰å…¨æœ‰åºæµåŠ¨ï¼Œæ¨è¿›å»ºè®¾é«˜æ°´å¹³è‡ªç”±è´¸æ˜“æ¸¯ã€‚ å®ç°è´¸æ˜“è‡ªç”±ä¾¿åˆ©ã€‚è¿›ä¸€æ­¥åˆ›æ–°æµ·å…³ç›‘ç®¡åˆ¶åº¦ï¼Œå»ºç«‹ä¸æ€»ä½“å›½å®¶å®‰å…¨è§‚ç›¸é€‚åº”çš„éå…³ç¨è´¸æ˜“æªæ–½ä½“ç³»ï¼Œå»ºç«‹è‡ªç”±è¿›å‡ºã€å®‰å…¨ä¾¿åˆ©çš„è´§ç‰©è´¸æ˜“ç®¡ç†åˆ¶åº¦ï¼Œå®ç°å¢ƒå¤–è´§ç‰©åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯è¿›å‡ºè‡ªç”±ä¾¿åˆ©ã€‚å»ºç«‹å¥å…¨è·¨å¢ƒæ”¯ä»˜ä¸šåŠ¡ç›¸å…³åˆ¶åº¦ï¼Œè¥é€ è‰¯å¥½çš„æ”¯ä»˜æœåŠ¡å¸‚åœºç¯å¢ƒï¼Œæå‡è·¨å¢ƒæ”¯ä»˜æœåŠ¡æ•ˆç‡ï¼Œä¾æ³•åˆè§„æ¨åŠ¨è·¨å¢ƒæœåŠ¡è´¸æ˜“è‡ªç”±åŒ–ä¾¿åˆ©åŒ–ã€‚ å®ç°æŠ•èµ„è‡ªç”±ä¾¿åˆ©ã€‚é™¤æ¶‰åŠå›½å®¶å®‰å…¨ã€ç¤¾ä¼šç¨³å®šã€ç”Ÿæ€ä¿æŠ¤çº¢çº¿ã€é‡å¤§å…¬å…±åˆ©ç›Šç­‰å›½å®¶å®è¡Œå‡†å…¥ç®¡ç†çš„é¢†åŸŸå¤–ï¼Œå…¨é¢æ”¾å¼€æŠ•èµ„å‡†å…¥ã€‚åœ¨å…·æœ‰å¼ºåˆ¶æ€§æ ‡å‡†çš„é¢†åŸŸï¼Œå»ºç«‹â€œæ ‡å‡†åˆ¶+æ‰¿è¯ºåˆ¶â€çš„æŠ•èµ„åˆ¶åº¦ï¼Œå¸‚åœºä¸»ä½“å¯¹ç¬¦åˆç›¸å…³è¦æ±‚ä½œå‡ºæ‰¿è¯ºï¼Œå³å¯å¼€å±•æŠ•èµ„ç»è¥æ´»åŠ¨ã€‚ å®ç°è·¨å¢ƒèµ„é‡‘æµåŠ¨è‡ªç”±ä¾¿åˆ©ã€‚å…è®¸ç¬¦åˆä¸€å®šæ¡ä»¶çš„éé‡‘èä¼ä¸šï¼Œæ ¹æ®å®é™…èèµ„éœ€è¦è‡ªä¸»å€Ÿç”¨å¤–å€ºï¼Œæœ€ç»ˆå®ç°æµ·å—è‡ªç”±è´¸æ˜“æ¸¯éé‡‘èä¼ä¸šå¤–å€ºé¡¹ä¸‹å®Œå…¨å¯å…‘æ¢ã€‚ å®ç°äººå‘˜è¿›å‡ºè‡ªç”±ä¾¿åˆ©ã€‚è¿›ä¸€æ­¥æ”¾å®½äººå‘˜è‡ªç”±è¿›å‡ºé™åˆ¶ã€‚å®è¡Œæ›´åŠ å®½æ¾çš„å•†åŠ¡äººå‘˜ä¸´æ—¶å‡ºå…¥å¢ƒæ”¿ç­–ã€ä¾¿åˆ©çš„å·¥ä½œç­¾è¯æ”¿ç­–ï¼Œè¿›ä¸€æ­¥å®Œå–„å±…ç•™åˆ¶åº¦ã€‚ å®ç°è¿è¾“æ¥å¾€è‡ªç”±ä¾¿åˆ©ã€‚å®è¡Œç‰¹æ®Šçš„èˆ¹èˆ¶ç™»è®°å®¡æŸ¥åˆ¶åº¦ã€‚è¿›ä¸€æ­¥æ”¾å®½ç©ºåŸŸç®¡åˆ¶ä¸èˆªè·¯èˆªæƒé™åˆ¶ã€‚é¼“åŠ±å›½å†…å¤–èˆªç©ºå…¬å¸å¢åŠ è¿åŠ›æŠ•æ”¾ï¼Œå¢å¼€èˆªçº¿èˆªç­ã€‚æ ¹æ®åŒè¾¹èˆªç©ºè¿è¾“åå®šï¼Œåœ¨å®¡æ ¸å¤–å›½èˆªç©ºå…¬å¸å›½é™…èˆªçº¿ç»è¥è®¸å¯æ—¶ï¼Œä¼˜å…ˆç­¾å‘è‡³æµ·å—çš„å›½é™…èˆªçº¿èˆªç­è®¸å¯ã€‚ å®ç°æ•°æ®å®‰å…¨æœ‰åºæµåŠ¨ã€‚åˆ›æ–°æ•°æ®å‡ºå¢ƒå®‰å…¨çš„åˆ¶åº¦è®¾è®¡ï¼Œæ¢ç´¢æ›´åŠ ä¾¿åˆ©çš„ä¸ªäººä¿¡æ¯å®‰å…¨å‡ºå¢ƒè¯„ä¼°åŠæ³•ã€‚å¼€å±•ä¸ªäººä¿¡æ¯å…¥å¢ƒåˆ¶åº¦æ€§å¯¹æ¥ï¼Œæ¢ç´¢åŠ å…¥åŒºåŸŸæ€§å›½é™…æ•°æ®è·¨å¢ƒæµåŠ¨åˆ¶åº¦å®‰æ’ï¼Œæå‡æ•°æ®ä¼ è¾“ä¾¿åˆ©æ€§ã€‚ç§¯æå‚ä¸è·¨å¢ƒæ•°æ®æµåŠ¨å›½é™…è§„åˆ™åˆ¶å®šï¼Œå»ºç«‹æ•°æ®ç¡®æƒã€æ•°æ®äº¤æ˜“ã€æ•°æ®å®‰å…¨å’ŒåŒºå—é“¾é‡‘èçš„æ ‡å‡†å’Œè§„åˆ™ã€‚ è¿›ä¸€æ­¥æ¨è¿›è´¢ç¨åˆ¶åº¦æ”¹é©ã€‚å¯¹æ³¨å†Œåœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å¹¶å®è´¨æ€§è¿è¥çš„ä¼ä¸šï¼ˆè´Ÿé¢æ¸…å•è¡Œä¸šé™¤å¤–ï¼‰ï¼Œå‡æŒ‰15%å¾æ”¶ä¼ä¸šæ‰€å¾—ç¨ã€‚å¯¹ä¸€ä¸ªçº³ç¨å¹´åº¦å†…åœ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯ç´¯è®¡å±…ä½æ»¡183å¤©çš„ä¸ªäººï¼Œå…¶å–å¾—æ¥æºäºæµ·å—è‡ªç”±è´¸æ˜“æ¸¯èŒƒå›´å†…çš„ç»¼åˆæ‰€å¾—å’Œç»è¥æ‰€å¾—ï¼ŒæŒ‰ç…§3%ã€10%ã€15%ä¸‰æ¡£è¶…é¢ç´¯è¿›ç¨ç‡å¾æ”¶ä¸ªäººæ‰€å¾—ç¨ã€‚æ‰©å¤§æµ·å—åœ°æ–¹ç¨æ”¶ç®¡ç†æƒé™ã€‚ä¼ä¸šæ‰€å¾—ç¨ã€ä¸ªäººæ‰€å¾—ç¨ä½œä¸ºä¸­å¤®ä¸åœ°æ–¹å…±äº«æ”¶å…¥ï¼Œé”€å”®ç¨åŠå…¶ä»–å›½å†…ç¨ç§æ”¶å…¥ä½œä¸ºåœ°æ–¹æ”¶å…¥ã€‚æˆæƒæµ·å—æ ¹æ®è‡ªç”±è´¸æ˜“æ¸¯å‘å±•éœ€è¦ï¼Œè‡ªä¸»å‡å¾ã€å…å¾ã€ç¼“å¾é™¤å…·æœ‰ç”Ÿæ€è¡¥å¿æ€§è´¨å¤–çš„æ”¿åºœæ€§åŸºé‡‘ï¼Œè‡ªä¸»è®¾ç«‹æ¶‰ä¼è¡Œæ”¿äº‹ä¸šæ€§æ”¶è´¹é¡¹ç›®ã€‚å¯¹ä¸­å¤®çº§è¡Œæ”¿äº‹ä¸šæ€§æ”¶è´¹ï¼ŒæŒ‰ç…§ä¸­å¤®ç»Ÿä¸€è§„å®šæ‰§è¡Œã€‚ä¸­å¤®è´¢æ”¿æ”¯æŒæ”¿ç­–ç»“åˆç¨åˆ¶å˜åŒ–æƒ…å†µç›¸åº”è°ƒæ•´ï¼Œå¹¶åŠ å¤§æ”¯æŒåŠ›åº¦ã€‚è¿›ä¸€æ­¥ç ”ç©¶æ”¹è¿›è¡¥è´´æ”¿ç­–æ¡†æ¶ï¼Œä¸ºæˆ‘å›½å‚ä¸è¡¥è´´é¢†åŸŸå›½é™…è§„åˆ™åˆ¶å®šæä¾›å‚è€ƒã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:3:2","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å››ã€ç»„ç»‡å®æ–½ ï¼ˆä¸€ï¼‰åŠ å¼ºå…šçš„å…¨é¢é¢†å¯¼ã€‚åšæŒç”¨ä¹ è¿‘å¹³æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ€æƒ³æ­¦è£…å…šå‘˜å¹²éƒ¨å¤´è„‘ï¼Œè®¤çœŸè´¯å½»è½å®å…šä¸­å¤®ã€å›½åŠ¡é™¢å†³ç­–éƒ¨ç½²ï¼Œå¢å¼ºâ€œå››ä¸ªæ„è¯†â€ï¼Œåšå®šâ€œå››ä¸ªè‡ªä¿¡â€ï¼Œåšåˆ°â€œä¸¤ä¸ªç»´æŠ¤â€ã€‚å»ºç«‹å¥å…¨å…šå¯¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å·¥ä½œçš„é¢†å¯¼ä½“åˆ¶æœºåˆ¶ï¼Œå……åˆ†å‘æŒ¥å…šæ€»æ½å…¨å±€ã€åè°ƒå„æ–¹çš„ä½œç”¨ï¼ŒåŠ å¼ºå…šå¯¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å„é¢†åŸŸå„æ–¹é¢å„ç¯èŠ‚çš„é¢†å¯¼ã€‚ä»¥å…šçš„æ”¿æ²»å»ºè®¾ä¸ºç»Ÿé¢†ï¼Œä»¥æå‡ç»„ç»‡åŠ›ä¸ºé‡ç‚¹ï¼Œå…¨é¢æé«˜å…šçš„å»ºè®¾è´¨é‡ï¼Œä¸ºæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾æä¾›åšå¼ºæ”¿æ²»ä¿éšœã€‚åŠ å¼ºåŸºå±‚å…šç»„ç»‡å»ºè®¾ï¼Œå¼•å¯¼å¹¿å¤§å…šå‘˜å‘æŒ¥å…ˆé”‹æ¨¡èŒƒä½œç”¨ï¼ŒæŠŠåŸºå±‚å…šç»„ç»‡å»ºè®¾æˆä¸ºæµ·å—æ¨åŠ¨è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾çš„åšå¼ºæˆ˜æ–—å ¡å’ã€‚å®Œå–„ä½“ç°æ–°å‘å±•ç†å¿µå’Œæ­£ç¡®æ”¿ç»©è§‚è¦æ±‚çš„å¹²éƒ¨è€ƒæ ¸è¯„ä»·ä½“ç³»ï¼Œå»ºç«‹æ¿€åŠ±æœºåˆ¶å’Œå®¹é”™çº é”™æœºåˆ¶ï¼Œæ——å¸œé²œæ˜åœ°ä¸ºæ•¢äºæ‹…å½“ã€è¸å®åšäº‹ã€ä¸è°‹ç§åˆ©çš„å¹²éƒ¨æ’‘è…°é¼“åŠ²ã€‚æŠŠç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚èå…¥ç»æµç¤¾ä¼šå‘å±•å„æ–¹é¢ã€‚æŒä¹‹ä»¥æ’æ­£é£è‚ƒçºªï¼Œå¼ºåŒ–çºªæ£€ç›‘å¯Ÿå·¥ä½œï¼Œè¥é€ é£æ¸…æ°”æ­£è‰¯å¥½ç¯å¢ƒã€‚ ï¼ˆäºŒï¼‰å¥å…¨å®æ–½æœºåˆ¶ã€‚åœ¨æ¨è¿›æµ·å—å…¨é¢æ·±åŒ–æ”¹é©å¼€æ”¾é¢†å¯¼å°ç»„æŒ‡å¯¼ä¸‹ï¼Œæµ·å—çœè¦åˆ‡å®å±¥è¡Œä¸»ä½“è´£ä»»ï¼ŒåŠ å¼ºç»„ç»‡é¢†å¯¼ï¼Œå…¨åŠ›æ¨è¿›æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å„é¡¹å·¥ä½œã€‚ä¸­å¤®å’Œå›½å®¶æœºå…³æœ‰å…³å•ä½è¦æŒ‰ç…§æœ¬æ–¹æ¡ˆè¦æ±‚ï¼Œä¸»åŠ¨æŒ‡å¯¼æ¨åŠ¨æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾ï¼Œè¿›ä¸€æ­¥ç»†åŒ–ç›¸å…³æ”¿ç­–æªæ–½ï¼Œåˆ¶å®šå‡ºå°å®æ–½æ–¹æ¡ˆï¼Œç¡®ä¿æ”¿ç­–è½åœ°è§æ•ˆã€‚æ¨è¿›æµ·å—å…¨é¢æ·±åŒ–æ”¹é©å¼€æ”¾é¢†å¯¼å°ç»„åŠå…¬å®¤ç‰µå¤´æˆç«‹æŒ‡å¯¼æµ·å—æ¨è¿›è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å·¥ä½œå°ç»„ï¼Œç”±å›½å®¶å‘å±•æ”¹é©å§”ã€è´¢æ”¿éƒ¨ã€å•†åŠ¡éƒ¨ã€ä¸­å›½äººæ°‘é“¶è¡Œã€æµ·å…³æ€»ç½²ç­‰éƒ¨é—¨åˆ†åˆ«æ´¾å‡ºå¹²éƒ¨é©»æµ·å—å®åœ°æŒ‡å¯¼å¼€å±•è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å·¥ä½œï¼Œæœ‰å…³æƒ…å†µåŠæ—¶ä¸ŠæŠ¥é¢†å¯¼å°ç»„ã€‚å›½åŠ¡é™¢å‘å±•ç ”ç©¶ä¸­å¿ƒç»„ç»‡å¯¹æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å¼€å±•å…¨è¿‡ç¨‹è¯„ä¼°ï¼Œç‰µå¤´è®¾ç«‹ä¸“å®¶å’¨è¯¢å§”å‘˜ä¼šï¼Œä¸ºæµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾å»ºè¨€çŒ®ç­–ã€‚ ï¼ˆä¸‰ï¼‰ç¨³æ­¥æ¨è¿›æ”¿ç­–è½åœ°ã€‚åŠ å¤§ç£ä¿ƒè½å®åŠ›åº¦ï¼Œå°†å„é¡¹æ”¿ç­–ä¸¾æªæŠ“å®æŠ“ç»†æŠ“å‡ºæˆæ•ˆã€‚è®¤çœŸç ”ç©¶å’Œå¦¥å–„è§£å†³æµ·å—è‡ªç”±è´¸æ˜“æ¸¯å»ºè®¾ä¸­é‡åˆ°çš„æ–°æƒ…å†µæ–°é—®é¢˜ï¼Œå¯¹ä¸€äº›é‡å¤§æ”¿ç­–æªæ–½åšå¥½è¯•ç‚¹å·¥ä½œï¼Œç§¯æç¨³å¦¥æ¨è¿›æ–¹æ¡ˆå®æ–½ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:4:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ç®€å•æ€»ç»“ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:0","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ä¸‰å¤§äº§ä¸š æ—…æ¸¸ä¸š ç°ä»£æœåŠ¡ä¸š é«˜æ–°æŠ€æœ¯äº§ä¸š æ—…æ¸¸ä¾ç„¶æ’åœ¨é¦–ä½ï¼Œå†åŠ ä¸Šå…ç¨è´­ç‰©ï¼Œé‚£ä¹ˆåŸºæœ¬ç‰©ä»·åº”è¯¥ä¼šæŒç»­ä¸Šæ¶¨ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:1","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å…³äºå…ç¨ å…ç¨æ”¿ç­–æ˜¯â€œä¸€çº¿â€çš„ï¼Œæ„å‘³ç€æµ·å—ä¸å†…åœ°ä¹‹é—´è´¸æ˜“ç®—ä½œè¿›å‡ºå£ï¼› ä½†æ˜¯å¦‚æœæ˜¯é¼“åŠ±ç±»ä¼ä¸šå¹¶ä¸”åœ¨æµ·å—åŠ å·¥å¢å€¼è¶…è¿‡30%å¯ä»¥äº«å—å…ç¨ï¼› å¹¶ä¸æ˜¯æ‰€æœ‰å•†å“éƒ½å…ç¨ï¼Œå­˜åœ¨ã€Šä¸å…ç¨å•†å“æ¸…å•ã€‹å’Œã€Šç¦ã€é™åˆ¶è¿›å‡ºå£æ¸…å•ã€‹ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:2","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å…³äºæµ·å…³ è´§ç‰©è¿›å‡ºå£æ‰‹ç»­ç²¾ç®€ï¼Œè¿›å‡ºæ–¹ä¾¿ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:3","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å…³äºæ”¯ä»˜ æ–°çš„æ”¯ä»˜æµç¨‹ï¼Œæé«˜ä¾¿åˆ©æ€§ï¼Œä½†æ˜¯æ˜¯å¦èƒ½æ¯”è‚©é¦™æ¸¯ï¼Œè¿˜æ˜¯ä¸ªæœªçŸ¥æ•°ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:4","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å…³äºé‡‘è å…¶å®å‘å±•é‡‘èä¸šï¼Œè¿˜æ˜¯ä¸ºäº†ä¿ƒè¿›èµ„é‡‘æµåŠ¨ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:5","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"å…³äºäººæ‰ åˆ©å¥½æ”¿ç­–ï¼Œå¸å¼•å¤–ç±äººå‘˜ã€‚ ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:6","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"äº§ä¸š æ¸¯å£ èˆªè¿ ä»“å‚¨ ç‰©æµ è½¬å£è´¸æ˜“ å¤§å®—å•†å“äº¤æ˜“ å•†å“å±•é”€ æµé€šåŠ å·¥ é›†è£…ç®±æ‹†æ‹¼ç®± ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:7","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":["policy"],"content":"ç¨æ”¶ä¼˜æƒ  ä¼ä¸šæ‰€å¾—ç¨ ç¬¦åˆæ¡ä»¶çš„ä¸ªäººå¯äº«å—ä¸ªç¨ä¼˜æƒ  ","date":"2021-03-24","objectID":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/:5:8","series":null,"tags":["æµ·å£æ”¿ç­–"],"title":"ç ”è¯»è‡ªè´¸æ¸¯æ”¿ç­–","uri":"/%E7%A0%94%E8%AF%BB%E8%87%AA%E8%B4%B8%E6%B8%AF%E6%94%BF%E7%AD%96/"},{"categories":null,"content":"setContentView @Override public void setContentView(View v) { ensureSubDecor(); ViewGroup contentParent = mSubDecor.findViewById(android.R.id.content); contentParent.removeAllViews(); contentParent.addView(v); mAppCompatWindowCallback.getWrapped().onContentChanged(); } @Override public void setContentView(int resId) { ensureSubDecor(); ViewGroup contentParent = mSubDecor.findViewById(android.R.id.content); contentParent.removeAllViews(); LayoutInflater.from(mContext).inflate(resId, contentParent); mAppCompatWindowCallback.getWrapped().onContentChanged(); } @Override public void setContentView(View v, ViewGroup.LayoutParams lp) { ensureSubDecor(); ViewGroup contentParent = mSubDecor.findViewById(android.R.id.content); contentParent.removeAllViews(); contentParent.addView(v, lp); mAppCompatWindowCallback.getWrapped().onContentChanged(); } ","date":"2021-03-24","objectID":"/view%E7%9A%84%E5%89%8D%E5%89%8D%E5%90%8E%E5%90%8E/:1:0","series":null,"tags":null,"title":"Viewçš„å‰å‰åå","uri":"/view%E7%9A%84%E5%89%8D%E5%89%8D%E5%90%8E%E5%90%8E/"},{"categories":null,"content":"ä¸‰å¤§æµç¨‹ measure ç”¨æ¥æµ‹é‡Viewçš„å®½é«˜ï¼› layout ç”¨æ¥ç¡®å®šViewåœ¨çˆ¶å®¹å™¨ä¸­çš„æ”¾ç½®ä½ç½®ï¼› draw è´Ÿè´£ç»˜åˆ¶ã€‚ åœ¨ActivityThreadä¸­ï¼Œå½“Activityåˆ›å»ºå®Œæ¯•åï¼Œä¼šå°†DecorViewé™„åŠ åˆ°Windowä¸­ï¼ŒåŒæ—¶ä¼šåˆ›å»ºViewRootImplå¯¹è±¡ï¼Œå¹¶å°†ViewRootImplä¸DecorViewå»ºç«‹å…³è”ã€‚ ViewRootImlå…¶å®æ˜¯DecorViewçš„ç®¡ç†ç±»ã€‚ Viewçš„ç»˜åˆ¶æµç¨‹æ˜¯ä»ViewRootçš„performTraversals()æ–¹æ³•å¼€å§‹çš„ï¼Œç»è¿‡measureã€layoutã€drawä¸‰ä¸ªè¿‡ç¨‹æ‰èƒ½æœ€ç»ˆå°†ä¸€ä¸ªViewç»˜åˆ¶å‡ºæ¥ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:1:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"measure é€šè¿‡è°ƒç”¨setMeasuredDimensionå†³å®šViewçš„å®½é«˜ã€‚ è®¡ç®—ä¹‹åå¯ä»¥é€šè¿‡getMeasureWidthå’ŒgetMeasureHeightè·å–æµ‹é‡åçš„ç»“æ„ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:1:1","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"measureChildren é€šè¿‡éå†è°ƒç”¨measureChild(child,widthMeasureSpec,heightMeasureSpec)æ–¹æ³•å®Œæˆæ‰€æœ‰å­Viewçš„æµ‹é‡ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:1:2","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"layout ç”¨æ¥ç¡®å®šå­å…ƒç´ çš„ä½ç½®ã€‚éœ€è¦éå†å­å…ƒç´ ï¼Œè°ƒç”¨å…¶layoutæ–¹æ³•ã€‚ å†³å®šäº†Viewçš„å››ä¸ªé¡¶ç‚¹çš„åæ ‡å’Œå®é™…çš„Viewçš„å®½å’Œé«˜ã€‚ getTop getLeft getRight getBottom getWidth getHeight getWidthå’ŒgetHeightæ‰æ˜¯Viewçš„æœ€ç»ˆå®½é«˜ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:1:3","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"onDraw ç»˜åˆ¶èƒŒæ™¯background.draw(canvas)ã€‚ ç»˜åˆ¶è‡ªå·±ï¼ˆonDrawï¼‰ã€‚ ç»˜åˆ¶childrenï¼ˆdispatchDrawï¼‰ã€‚ ç»˜åˆ¶è£…é¥°ï¼ˆonDrawScrollBarsï¼‰ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:2:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"DecorView DecorViewä½œä¸ºé¡¶çº§çš„Viewï¼ŒåŒ…å«ä¸€ä¸ªç«–ç›´çš„LinnerLayoutï¼Œå†…éƒ¨å«æœ‰æ ‡é¢˜æ å’Œå†…å®¹æ .setContentViewå°±æ˜¯æŠŠViewé™„åŠ åˆ°å†…å®¹æ ã€‚å†…å®¹æ æ˜¯ä¸ªFrameLayoutï¼Œä»–çš„çš„idæ˜¯contentï¼Œæ‰€ä»¥æ˜¯setContentViewã€‚ //è·å–contentå†…å®¹æ  ViewGroup content= findViewById (R.android.id.content)ï¼› //è·å–æˆ‘ä»¬è‡ªå·±çš„é¡¶çº§View View rootView = content.getChildAt(0); ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:3:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"MeasureSpec è¿™æ˜¯ä¸€ä¸ª32ä½çš„intï¼Œé«˜2ä½ä»£è¡¨SpecModeï¼Œä½30ä½ä»£è¡¨SpecSizeã€‚ é€šè¿‡å°†SpecModeå’ŒSpecSizeæ‰“åŒ…æˆä¸€ä¸ªintï¼Œé¿å…è¿‡å¤šçš„å†…å­˜åˆ†é…ã€‚ UNSPECIFIED çˆ¶å®¹å™¨ä¸åšä»»ä½•é—²ç½®ï¼Œå­Viewå¯ä»¥ä»»æ„å¤§ï¼› EXACTLY çˆ¶å®¹å™¨æµ‹å‡ºViewæ‰€éœ€å¤§å°ï¼Œå¯¹åº”match_parentå’Œç²¾ç¡®çš„å€¼ï¼› AT_MOST çˆ¶å®¹å™¨åˆ¶å®šäº†ä¸€ä¸ªå¯ç”¨å¤§å°SpecSizeï¼ŒViewçš„å¤§å°ä¸èƒ½å¤§äºè¿™ä¸ªå€¼ï¼Œç”¨äºwrap_contentã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:4:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"è·å–Viewçš„å®½é«˜ viewçš„measureè¿‡ç¨‹å’ŒActivituç”Ÿå‘½å‘¨æœŸä¸åŒæ­¥ï¼Œæ‰€æœ‰åœ¨onCreateã€onStartã€onResumeä¸­éƒ½ä¸èƒ½è·å–åˆ°Viewçš„å®½é«˜ã€‚ Activity/View#onWindowFocusChangedï¼› view.post(runnable)ï¼› ViewtreeObserver view.measure(int widthMeasureSpec,int heightMeasureSpec)(æ‰‹åŠ¨æµ‹é‡); ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:5:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"ç”Ÿå‘½å‘¨æœŸ Constructorsæ„é€ å‡½æ•°ï¼› onFinishInflateå½“è¯¥ViewåŠå…¶å­Viewä»XMLæ–‡ä»¶ä¸­å¡«å……å®Œæˆåä¼šè¢«è°ƒç”¨ï¼› onAttachedToWindowé™„åŠ åˆ°çª—å£; onMeasureè®¡ç®—å°ºå¯¸æ—¶è°ƒç”¨ï¼› onSizeChangedå½“å‰viewå°ºå¯¸å˜åŒ–æ—¶è°ƒç”¨; onLayoutè°ƒç”¨æ‰€æœ‰å­viewçš„layoutæ–¹æ³•ä¸ºæ¯ä¸€ä¸ªå­viewç¡®å®šä½ç½®ï¼› onDrawç»˜å›¾æ—¶è°ƒç”¨ï¼› onDetackedFromWindowè„±ç¦»çª—å£æ—¶è°ƒç”¨ã€‚ ","date":"2021-03-22","objectID":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/:6:0","series":null,"tags":["Android","View"],"title":"Viewçš„å·¥ä½œåŸç†","uri":"/view%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"},{"categories":null,"content":"ä½ç½®å‚æ•° ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:1:0","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"ä¸»è¦ä½ç½®å‚æ•° Viewçš„ä½ç½®ä¸»è¦ç”±å®ƒçš„å››ä¸ªé¡¶ç‚¹(ç›¸å¯¹çˆ¶å®¹å™¨)æ¥å†³å®šï¼š getLeft() getTop() getRight() getBottom() ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:1:1","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"ç”¨äºç§»åŠ¨çš„å‚æ•° x/y Viewå·¦ä¸Šè§’ç›¸å¯¹çˆ¶å®¹å™¨çš„åæ ‡ï¼› translationX/translationY Viewå·¦ä¸Šè§’ç›¸å¯¹çˆ¶å®¹å™¨çš„åç§»é‡ã€‚ x = left + translationX; y = top + translationY; åœ¨Viewç§»åŠ¨ä¸­ï¼Œtopå’Œleftä¸ä¼šå˜ï¼Œxy,translationç³»åˆ—ä¼šå˜ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:1:2","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"ç”¨æˆ·äº¤äº’ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:0","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"MotionEvent äº‹ä»¶ï¼š ACTION_DOWN ACTION_MOVE ACTION_UP è§¦å‘ç‚¹ï¼š getX/getY ç›¸å¯¹å½“å‰Viewå·¦ä¸Šè§’çš„xå’Œyåæ ‡ï¼› getRawX/getRawY ç›¸å¯¹äºæ‰‹æœºå±å¹•å·¦ä¸Šè§’çš„xå’Œyåæ ‡ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:1","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"TouchSlop ç³»ç»Ÿèƒ½è¯†åˆ«å‡ºçš„æ»‘åŠ¨æœ€å°è·ç¦»ã€‚æ˜¯ä¸ªå¸¸é‡ã€‚ ViewConfiguration. get(getContext()).getScaledTouchSlop() å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¸¸é‡æ¥åšè¿‡æ»¤ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:2","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"VelocityTracker é€Ÿåº¦è¿½è¸ªï¼Œç”¨äºè¿½è¸ªæ‰‹æŒ‡åœ¨ä¸€å®šæ—¶é—´å†…æ»‘åŠ¨è¿‡çš„åƒç´ æ•°ã€‚ VelocityTracker velocityTracker = VelocityTracker.obtain(); velocityTracker.addMovement(event); //äº‹ä»¶å®šä½1000æ¯«ç§’ï¼Œä¹Ÿå°±æ˜¯1ç§’ velocityTracker.computeCurrentVelocity(1000); int xVelocity = (int) velocityTracker.getXVelocity(); int yVelocity = (int) velocityTracker.getYVelocity(); //å›æ”¶ velocityTracker.clear(); velocityTracker.recycle(); ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:3","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"GestureDetector æ‰‹åŠ¿æ£€æµ‹ï¼Œç”¨äºè¾…åŠ©æ£€æµ‹ç”¨æˆ·çš„å•å‡»ã€æ»‘åŠ¨ã€é•¿æŒ‰ã€åŒå‡»ç­‰è¡Œä¸ºã€‚ GestureDetector mGestureDetector = new GestureDetector(this); //è§£å†³é•¿æŒ‰å±å¹•åæ— æ³•æ‹–åŠ¨çš„ç°è±¡ mGestureDetector.setIsLongpressEnabled(false) ç„¶ååœ¨Viewçš„onTouchEvent(event)æ–¹æ³•ä¸­æ¥ç®¡äº‹ä»¶ï¼š boolean consume = mGestureDetector.onTouchEvent(event); return consume; ç„¶åå®ç°OnGestureListenerå’ŒOnDoubleTapListeneræ–¹æ³•ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:4","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"Scroller åœ¨Viewæ»‘åŠ¨æ—¶ï¼Œå¯ä»¥è°ƒç”¨scrollTo/scrollByæ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šç¬é—´å®Œæˆï¼Œæ²¡æœ‰è¿‡åº¦åŠ¨ç”»ï¼ŒScrollerå¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ Scroller scroller = new Scroller(mContext); // ç¼“æ…¢æ»šåŠ¨åˆ°æŒ‡å®šä½ç½® private void smoothScrollTo(int destX,int destY) { int scrollX = getScrollX(); int delta = destX -scrollX; // 1000mså†…æ»‘å‘destXï¼Œæ•ˆæœå°±æ˜¯æ…¢æ…¢æ»‘åŠ¨ mScroller.startScroll(scrollX,0,delta,0,1000); invalidate(); } @Override public void computeScroll() { if (mScroller.computeScrollOffset()) { scrollTo(mScroller.getCurrX(),mScroller.getCurrY()); postInvalidate(); } } ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:5","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"Viewçš„æ»‘åŠ¨ scrollTo/scrollBy ä½¿å†…å®¹æ»‘åŠ¨ åŠ¨ç”»å®ç°å¹³ç§»æ•ˆæœ æ”¹å˜Viewçš„LayoutParamsä½¿Viewé‡æ–°å¸ƒå±€ã€‚ scrollTo/scrollBy scrollTo ç»å¯¹æ»‘åŠ¨ã€‚ scrollBy åŸºäºå½“å‰ä½ç½®ç›¸å¯¹æ»‘åŠ¨ã€‚ scrollByå®é™…ä¸Šä¹Ÿæ˜¯è°ƒç”¨scrollToæ–¹æ³•å®ç°çš„ã€‚ è·å–å½“å‰æ»‘åŠ¨ä½ç½®ï¼š getScrollX getScrollY åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼ŒmScrollXçš„å€¼æ€»æ˜¯ç­‰äºViewå·¦è¾¹å…ƒå’ŒViewå†…å®¹å·¦è¾¹å…ƒåœ¨æ°´å¹³æ–¹å‘çš„è·ç¦»ã€‚è€ŒmScrollYçš„å€¼æ€»æ˜¯ç­‰äºViewä¸Šè¾¹ç¼˜å’Œå†…å®¹ä¸Šè¾¹ç¼˜åœ¨ç«–ç›´æ–¹å‘çš„è·ç¦»ã€‚ scrollToå’ŒscrollByåªæ”¹å˜Viewå†…å®¹çš„ä½ç½®ã€‚ åŠ¨ç”»æ“ä½œtranslationX/translationY ViewåŠ¨ç”»æ˜¯å¯¹viewçš„å½±åƒåšæ“ä½œï¼Œå¹¶ä¸èƒ½çœŸæ­£æ”¹å˜Viewçš„ä½ç½®å‚æ•°ã€‚æ‰€ä»¥åœ¨æ–°çš„ä½ç½®å•å‡»ç­‰æ“ä½œä¼šæ— æ•ˆã€‚è§£å†³æ–¹å¼æ˜¯ä½¿ç”¨å±æ€§åŠ¨ç”»ã€‚ æ”¹å¸ƒå±€å‚æ•° MarginLayoutParams params = (MarginLayoutParams)mButton1.getLayoutParams(); params.width += 100; params.leftMargin += 100; mButton1.requestLayout(); //æˆ–è€…mButton1.setLayoutParams(params); ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:2:6","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"äº‹ä»¶åˆ†å‘æœºåˆ¶ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:3:0","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"ç‚¹å‡»äº‹ä»¶çš„ä¼ é€’è§„åˆ™ dispatchTouchEvent onInterceptTouchEvent onTouchEvent dispatchTouchEventç”¨æ¥ç”¨æ¥åšäº‹ä»¶çš„åˆ†å‘ï¼Œè¿”å›ç»“æœå—å½“å‰Viewçš„onTouchEventå’Œä¸‹çº§Viewçš„dispatchTouchEventå½±åƒã€‚è¿”å›å€¼è¡¨ç¤ºæ˜¯å¦å°å·æ‰å½“å‰çš„äº‹ä»¶ã€‚ onInterceptTouchEventç”¨æ¥åˆ¤æ–­æ˜¯å¦æ‹¦æˆªæŸä¸ªäº‹ä»¶ï¼Œå¦‚æœå½“å‰Viewæ‹¦æˆªäº†æŸä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨åŒä¸€ä¸ªäº‹ä»¶åºåˆ—ä¸­ï¼Œæ­¤æ–¹æ³•ä¸ä¼šè¢«å†æ¬¡è°ƒç”¨ï¼Œè¿”å›ç»“æœè¡¨ç¤ºæ˜¯å¦æ‹¦æˆªå½“å‰äº‹ä»¶ã€‚ onTouchEventåœ¨dispatchTouchEventæ–¹æ³•ä¸­è°ƒç”¨ï¼Œç”¨æ¥å¤„ç†ç‚¹å‡»äº‹ä»¶ï¼Œè¿”å›ç»“æœè¡¨ç¤ºæ˜¯å¦æ¶ˆè€—å½“å‰äº‹ä»¶ï¼Œå¦‚æœä¸æ¶ˆè€—ï¼Œåˆ™åœ¨åŒä¸€ä¸ªäº‹ä»¶åºåˆ—ä¸­ï¼Œå½“å‰Viewæ— æ³•å†æ¬¡æ¥æ”¶åˆ°äº‹ä»¶ã€‚ public boolean dispatchTouchEvent(MotionEvent ev) { boolean consume = false; if (onInterceptTouchEvent(ev)) { //å¦‚æœæ‹¦æˆªåˆ°ï¼Œè°ƒç”¨onTouchEvent consume = onTouchEvent(ev); } else { // å¦‚æœä¸æ‹¦æˆªï¼Œé€ä¼ åˆ°å­Viewçš„dispatchTouchEvent consume = child.dispatchTouchEvent(ev); } return consume; } åœ¨è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œå­Viewæ˜¯äº‹ä»¶çš„æœ€ç»ˆå¤„ç†è€…ï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨å­Viewå†…è¿›è¡Œæ‹¦æˆªäº†ï¼Œå› è€Œåœ¨è‡ªå®šä¹‰Viewä¸­ä¸éœ€è¦é‡å†™onInterceptTouchEventã€‚ å½“ä¸€ä¸ªViewè®¾ç½®äº†onTouchListenerï¼Œäº‹ä»¶å…ˆè¢«onTouchListenerå¤„ç†ï¼Œå…¶ä¸­çš„onTouch()æ–¹æ³•å…ˆè¢«å›è°ƒï¼Œå¦‚æœè¿”å›falseï¼Œåˆ™å½“å‰Viewçš„onTouchEventæ–¹æ³•æ‰ä¼šè¢«è°ƒç”¨ï¼›å¦‚æœè¿”å›trueï¼ŒonTouchEvent()æ–¹æ³•å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚åœ¨onTouchEvent()æ–¹æ³•ä¸­ï¼Œå¦‚æœå½“å‰Viewè®¾ç½®äº†onClickListenerï¼Œé‚£ä¹ˆæœ€åæ‰ä¼šè°ƒç”¨onClick()æ–¹æ³•ã€‚onClickListenerçš„ä¼˜å…ˆçº§æœ€ä½ï¼Œå¤„äºäº‹ä»¶ä¼ é€’çš„å°¾ç«¯ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:3:1","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"äº‹ä»¶ä¼ é€’çš„å±‚çº§é¡ºåº Activity Window ViewGroup View äº‹ä»¶ä»ä¸Šå€’ä¸‹ä¼ é€’ï¼Œå¦‚æœå…¶ä¸­ä¸€ç¯çš„onTouchEventè¿”å›falseï¼Œåˆ™å›ä¼ åˆ°çˆ¶å®¹å™¨çš„onTouchEventæ–¹æ³•ã€‚å¦‚æœæ‰€æœ‰çš„Viewéƒ½ä¸å¤„ç†äº‹ä»¶ï¼Œæœ€ç»ˆå°†ä¼šå›ä¼ ç»™Activityçš„onTouchEvent()æ–¹æ³•å¤„ç†ã€‚ MotionEventä»£è¡¨ä¸€ç³»åˆ—äº‹ä»¶ï¼ŒåŸºæœ¬ä¸Šä¼šè¢«ä¸€ä¸ªViewç»Ÿä¸€å¤„ç†ï¼Œä¹Ÿå¯ä»¥åœ¨é€šè¿‡è°ƒç”¨å…¶ä»–Viewçš„onTouchEventå¤„ç†ã€‚ å¦‚æœViewä¸€æ—¦å¼€å§‹å¤„ç†äº‹ä»¶ï¼Œå¦‚æœå®ƒä¸æ¶ˆè€—æ‰å½“å‰äº‹ä»¶ï¼Œé‚£ä¹ˆåŒä¸€äº‹ä»¶åºåˆ—ä¸­çš„å…¶ä»–äº‹ä»¶éƒ½ä¸ä¼šå†äº¤ç»™ä»–å¤„ç†ï¼Œeg:Viewæ”¶åˆ°äº†ACTION_DOWNï¼Œå¦‚æœä¸æ¶ˆè€—æ‰ï¼Œé‚£ä¹ˆåé¢çš„ACTION_MOVEå’ŒACTION_UPéƒ½ä¸ä¼šå†äº¤ç»™ä»–å¤„ç†ã€‚ å¦‚æœViewä¸æ¶ˆè€—æ‰é™¤äº†ACTION_DOWNä»¥å¤–çš„å…¶ä»–äº‹ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å‡»äº‹ä»¶å°±ä¼šæ¶ˆå¤±ï¼Œçˆ¶çº§å®¹å™¨çš„onTouchEvent()å¹¶ä¸ä¼šè°ƒç”¨ã€‚å¹¶ä¸”å½“å‰Viewå¯ä»¥æŒç»­æ”¶åˆ°åç»­çš„äº‹ä»¶ï¼Œæœ€ç»ˆè¿™äº›æ¶ˆå¤±çš„ç‚¹å‡»äº‹ä»¶ä¼šä¼ é€’ç»™Activityå¤„ç†ã€‚ ViewGroupé»˜è®¤ä¸æ‹¦æˆªä»»ä½•äº‹ä»¶ã€‚onInterceptTouchEvent()æ–¹æ³•é»˜è®¤è¿”å›falseã€‚ Viewçš„onTouchEventé»˜è®¤è¿”å›trueï¼Œå³é»˜è®¤æ¶ˆè€—äº‹ä»¶ï¼ˆé™¤éä¸å¯ç‚¹å‡»ï¼‰ã€‚ Viewçš„enableå±æ€§ä¸å½±åƒonTouchEventçš„é»˜è®¤è¿”å›å€¼ã€‚ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:3:2","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"æ»‘åŠ¨å†²çª å†…å¤–æ»‘åŠ¨æ–¹å‘ä¸ä¸€è‡´ åœ¨å¤–å±‚æ ¹æ®æ»‘åŠ¨æ–¹å‘åˆ¤æ–­ï¼Œå¦‚æœä¸è‡ªå·±æ–¹å‘ä¸€è‡´ï¼Œå°±æ‹¦æˆªï¼Œå¦åˆ™ä¼ é€’ç»™å­Viewå¤„ç†å¹¶æ¶ˆè€—æ‰ã€‚ åˆ¤æ–­æ–¹æ³•ï¼š æ°´å¹³æ–¹å‘ä¸ç«–ç›´æ–¹å‘çš„å¤¹è§’ï¼› æ°´å¹³æ–¹å‘ä¸ç«–ç›´æ–¹å‘çš„è·ç¦»å·® å†…å¤–æ»‘åŠ¨æ–¹å‘ä¸€è‡´ æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥åšåˆ¤æ–­ æ ¹æ®ACTION_DOWNçš„è½ç‚¹åæ ‡æ¥åˆ¤æ–­ ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:3:3","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"requestDisallowInterceptTouchEvent ","date":"2021-03-22","objectID":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/:4:0","series":null,"tags":["Android","View"],"title":"Viewäº‹ä»¶ä½“ç³»","uri":"/view%E4%BA%8B%E4%BB%B6%E4%BD%93%E7%B3%BB/"},{"categories":null,"content":"å¹¶å‘ä¸‰å¤§ç‰¹æ€§ åŸå­æ€§ æ“ä½œè¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ï¼Œä¸­é€”ä¸å¯è¢«ä¸­æ–­ã€‚ å¯è§æ€§ å…±äº«å˜é‡çš„å˜æ›´ç«‹å³å¯è§ã€‚ æœ‰åºæ€§ ç¨‹åºæ‰§è¡Œä¾ç…§ä»£ç çš„å…ˆåé¡ºåºæ¥æ‰§è¡Œã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:1:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"JMMæ¨¡å‹ JMMçš„åŸåˆ™æ˜¯æ•°æ®æ‹·è´ï¼Œä¼šä»ä¸»å­˜æ‹·è´åˆ°CPUç¼“å­˜ï¼Œå†æ‹·è´åˆ°CPUå¯„å­˜å™¨ã€‚CPUå¯„å­˜å™¨çš„é€Ÿåº¦è¿œé«˜äºç¼“å­˜ï¼Œç¼“å­˜çš„è¯»å†™é€Ÿåº¦è¿œé«˜äºä¸»å­˜ã€‚å½“ä¸€ä¸ªçº¿ç¨‹åœ¨å¯„å­˜å™¨ä¸­ä¿®æ”¹äº†æ•°æ®ï¼Œè€Œæ²¡æœ‰åŒæ­¥åˆ°ä¸»å­˜æ—¶ï¼Œå¦ä¸€çº¿ç¨‹ä»ä¸»å­˜è¯»å–äº†è¿‡æœŸçš„æ•°æ®ï¼Œé€ æˆæ•°æ®ä¸åŒæ­¥é—®é¢˜ã€‚è§£å†³æ–¹å¼æ˜¯åŒæ­¥è®¿é—®ï¼ˆåŠ é”ï¼‰æˆ–è€…é€šè¿‡volatileå¼ºåˆ¶åˆ·å†™åˆ°ä¸»å­˜ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:2:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"æŒ‡ä»¤é‡æ’åº å¦‚æœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œcpuä¼šåœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹å¯¹æŒ‡ä»¤é‡æ–°æ’åºã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:3:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"JMMå†…å­˜å±éšœ LoadLoad å¯ä¿éšœï¼šåœ¨æ‰§è¡Œå±éšœåé¢çš„æ‰€æœ‰è¯»å–æ“ä½œä¹‹å‰ï¼Œå±éšœå‰é¢çš„è¯»å–æ“ä½œå…¨éƒ¨å®Œæˆã€‚ StoreStore å¯ä¿éšœï¼šåœ¨æ‰§è¡Œå±éšœåé¢çš„æ‰€æœ‰å†™å…¥æ“ä½œä¹‹å‰ï¼Œå±éšœå‰é¢çš„å†™å…¥æ“ä½œå…¨éƒ¨å®Œæˆã€‚ LoadStore å¯ä¿éšœï¼šåœ¨æ‰§è¡Œå±éšœåé¢çš„æ‰€æœ‰å†™å…¥æ“ä½œä¹‹å‰ï¼Œå±éšœå‰é¢çš„è¯»å–æ“ä½œå…¨éƒ¨å®Œæˆã€‚ StoreLoad å¯ä¿éšœï¼šåœ¨æ‰§è¡Œå±éšœåé¢çš„æ‰€æœ‰è¯»å–æ“ä½œä¹‹å‰ï¼Œå±éšœå‰é¢çš„å†™å…¥æ“ä½œå…¨éƒ¨å®Œæˆã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:4:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"volatile ç¬¦åˆå¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸ä¿è¯åŸå­æ€§ã€‚ é€šè¿‡åœ¨ç¼–è¯‘å™¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œåœ¨æŒ‡ä»¤åºåˆ—ä¸­æ·»åŠ å†…å­˜è¯»å†™å±éšœæ¥ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼Œä¿éšœäº†å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ JVMä¼šåœ¨volatileä¿®é¥°çš„å˜é‡å‰åéƒ½åŠ ä¸Šå†…å­˜å±éšœï¼Œä¿è¯æœ‰åºæ€§ï¼š LoadLoadBarrier volatileè¯»æ“ä½œ LoadStoreBarrier StoreStoreBarrier volatileå†™æ“ä½œ StoreLoadBarrier ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:5:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"synchronized ç¬¦åˆå¹¶å‘ç¼–ç¨‹çš„ä¸‰å¤§ç‰¹å¾ã€‚ ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å®ä¾‹çš„é”; ä¿®é¥°é™æ€æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰ç±»å¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰ç±»å¯¹è±¡çš„é”; ä¿®é¥°ä»£ç å—ï¼ŒæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚ åŸç†æ˜¯å¯¹è±¡å¤´ä¸­å­˜åœ¨è®¿é—®è®¡æ•°ã€åå‘é”ã€è½»é‡é”ã€‚ ä»jvmå±‚é¢é”å°±æ˜¯ç›‘è§†å™¨monitorã€‚æŒæœ‰æˆ–è€…é‡å…¥monitorä¼šä½¿è®¡æ•°å™¨è‡ªåŠ 1ã€‚é‡Šæ”¾æ—¶è®¡æ•°å™¨å½’0ï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½æŒæœ‰monitorã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:6:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"å¯¹è±¡é”æ“ä½œ void wait() å¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å®ƒå¾—åˆ°é€šçŸ¥ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨ä¸€ä¸ªåŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­è°ƒç”¨ã€‚å¦‚æœå½“å‰çº¿ç¨‹ä¸æ˜¯å¯¹è±¡é”çš„æŒæœ‰è€…ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ void notify() éšæœºé€‰æ‹©ä¸€ä¸ªåœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•çš„çº¿ç¨‹ï¼Œæ¥è§¦å…¶é˜»å¡çŠ¶æ€ã€‚ void notifyAll() è§£é™¤æ‰€æœ‰è¢«waité˜»å¡çš„çº¿ç¨‹ã€‚ ç”¨æ³•ï¼š public class MainActivity extends AppCompatActivity { private final Data data = new Data(); Runnable runnable1 = new Runnable() { @Override public void run() { synchronized (data) { try { if(!Thread.currentThread().isInterrupted() \u0026\u0026 data.getNum() \u003c 1){ data.wait(); } Log.d(\"å­çº¿ç¨‹\", \"run: æ”¶åˆ°äº†é€šçŸ¥ï¼Œæ­¤æ—¶numå€¼ä¸º\" + data.getNum()); } catch (InterruptedException e) { e.printStackTrace(); } } } }; Runnable runnable2 = new Runnable() { @Override public void run() { synchronized (data) { data.setNum(1); data.notifyAll(); } } }; private Thread t1, t2; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); t1 = new Thread(this.runnable1); t1.start(); } public void start(View v) { t2 = new Thread(this.runnable2); t2.start(); } private static class Data { private int num; public int getNum() { return num; } public void setNum(int num) { this.num = num; } } } ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:7:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"åŸå­ç±»å‹ AtomicInteger AtomicIntegerArray AtomicIntegerFieldUpdater AtomicLong AtomicBoolean AtomicReference åŸç†ï¼š private volatile int value; å†…éƒ¨å€¼å¸¦æœ‰ volatileä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œé€šè¿‡Unsafeçš„åº•å±‚èƒ½åŠ›ä¿è¯åŸå­æ€§ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:8:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"é‡å…¥é”ReentrantLocak é‡å…¥é”ï¼šçº¿ç¨‹å¯ä»¥åå¤è·å¾—å·²æ‹¥æœ‰çš„é”ã€‚ //æ„é€ ä¸€ä¸ªé‡å…¥é” new reentrantLocak(); //æ„é€ ä¸€ä¸ªå…¬å¹³é” new reentrantLocak(boolean fair); å…¬å¹³é”å€¾å‘äºç­‰å¾…æ—¶é—´æœ€é•¿çš„å“æˆï¼Œå¯èƒ½ä¸¥é‡å½±å“æ€§èƒ½ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:9:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"è¯»å†™é”ReadWriteLockã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:10:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"é”åˆ†ç±» å…¬å¹³é”ã€éå…¬å¹³é”ï¼šå…¬å¹³é”æŒ‡å¤šä¸ªçº¿ç¨‹æŒ‰ç…§ç”³è¯·é”çš„é¡ºåºæ¥è·å–é”ï¼Œéå…¬å¹³é”å°±æ˜¯æ²¡æœ‰é¡ºåºå®Œå…¨éšæœºï¼Œæ‰€ä»¥èƒ½ä¼šé€ æˆä¼˜å…ˆçº§åè½¬æˆ–è€…é¥¥é¥¿ç°è±¡ï¼›synchronized å°±æ˜¯éå…¬å¹³é”ï¼ŒReentrantLockï¼ˆä½¿ç”¨ CAS å’Œ AQS å®ç°ï¼‰ é€šè¿‡æ„é€ å‚æ•°å¯ä»¥å†³å®šæ˜¯éå…¬å¹³é”è¿˜æ˜¯å…¬å¹³é”ï¼Œé»˜è®¤æ„é€ æ˜¯éå…¬å¹³é”ï¼›éå…¬å¹³é”çš„ååé‡æ€§èƒ½æ¯”å…¬å¹³é”å¤§å¥½ã€‚ å¯é‡å…¥é”ï¼šåˆåé€’å½’é”ï¼ŒæŒ‡åœ¨åŒä¸€ä¸ªçº¿ç¨‹åœ¨å¤–å±‚æ–¹æ³•è·å–é”çš„æ—¶å€™åœ¨è¿›å…¥å†…å±‚æ–¹æ³•ä¼šè‡ªåŠ¨è·å–é”ï¼Œsynchronized å’Œ ReentrantLock éƒ½æ˜¯å¯é‡å…¥é”ï¼Œå¯é‡å…¥é”å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦é¿å…æ­»é”ã€‚ ç‹¬å é”ã€å…±äº«é”ï¼šç‹¬äº«é”æ˜¯æŒ‡è¯¥é”ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œå…±äº«é”æŒ‡è¯¥é”å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹æŒæœ‰ï¼›synchronized å’Œ ReentrantLock éƒ½æ˜¯ç‹¬äº«é”ï¼ŒReadWriteLock çš„è¯»é”æ˜¯å…±äº«é”ï¼Œå†™é”æ˜¯ç‹¬å é”ï¼›ReentrantLock çš„ç‹¬äº«é”å’Œå…±äº«é”ä¹Ÿæ˜¯é€šè¿‡ AQS æ¥å®ç°çš„ã€‚ äº’æ–¥é”ã€è¯»å†™é”ï¼šå…¶å®å°±æ˜¯ç‹¬äº«é”ã€å…±äº«é”çš„å…·ä½“è¯´æ³•ï¼›äº’æ–¥é”å®è´¨å°±æ˜¯ ReentrantLockï¼Œè¯»å†™é”å®è´¨å°±æ˜¯ ReadWriteLockã€‚ ä¹è§‚é”ã€æ‚²è§‚é”ï¼šè¿™ä¸ªåˆ†ç±»ä¸æ˜¯å…·ä½“é”çš„åˆ†ç±»ï¼Œè€Œæ˜¯çœ‹å¾…å¹¶å‘åŒæ­¥çš„è§’åº¦ï¼›æ‚²è§‚é”è®¤ä¸ºå¯¹äºåŒä¸€ä¸ªæ•°æ®çš„å¹¶å‘æ“ä½œä¸€å®šæ˜¯ä¼šå‘ç”Ÿä¿®æ”¹çš„ï¼ˆå“ªæ€•å®è´¨æ²¡ä¿®æ”¹ä¹Ÿè®¤ä¸ºä¼šä¿®æ”¹ï¼‰ï¼Œå› æ­¤å¯¹äºåŒä¸€ä¸ªæ•°æ®çš„å¹¶å‘æ“ä½œï¼Œæ‚²è§‚é”é‡‡å–åŠ é”çš„å½¢å¼ï¼Œå› ä¸ºæ‚²è§‚é”è®¤ä¸ºä¸åŠ é”çš„æ“ä½œä¸€å®šæœ‰é—®é¢˜ï¼›ä¹è§‚é”åˆ™è®¤ä¸ºå¯¹äºåŒä¸€ä¸ªæ•°æ®çš„å¹¶å‘æ“ä½œæ˜¯ä¸ä¼šå‘ç”Ÿä¿®æ”¹çš„ï¼Œåœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™ä¼šé‡‡ç”¨ä¸æ–­çš„å°è¯•æ›´æ–°ï¼Œä¹è§‚é”è®¤ä¸ºä¸åŠ é”çš„å¹¶å‘æ“ä½œæ˜¯æ²¡äº‹çš„ï¼›ç”±æ­¤å¯ä»¥çœ‹å‡ºæ‚²è§‚é”é€‚åˆå†™æ“ä½œéå¸¸å¤šçš„åœºæ™¯ï¼Œä¹è§‚é”é€‚åˆè¯»æ“ä½œéå¸¸å¤šçš„åœºæ™¯ï¼Œä¸åŠ é”ä¼šå¸¦æ¥å¤§é‡çš„æ€§èƒ½æå‡ï¼Œæ‚²è§‚é”åœ¨ java ä¸­å¾ˆå¸¸è§ï¼Œä¹è§‚é”å…¶å®å°±æ˜¯åŸºäº CAS çš„æ— é”ç¼–ç¨‹ï¼Œè­¬å¦‚ java çš„åŸå­ç±»å°±æ˜¯é€šè¿‡ CAS è‡ªæ—‹å®ç°çš„ã€‚ åˆ†æ®µé”ï¼šå®è´¨æ˜¯ä¸€ç§é”çš„è®¾è®¡ç­–ç•¥ï¼Œä¸æ˜¯å…·ä½“çš„é”ï¼Œå¯¹äº ConcurrentHashMap è€Œè¨€å…¶å¹¶å‘çš„å®ç°å°±æ˜¯é€šè¿‡åˆ†æ®µé”çš„å½¢å¼æ¥å®ç°é«˜æ•ˆå¹¶å‘æ“ä½œï¼›å½“è¦ put å…ƒç´ æ—¶å¹¶ä¸æ˜¯å¯¹æ•´ä¸ª hashmap åŠ é”ï¼Œè€Œæ˜¯å…ˆé€šè¿‡ hashcode çŸ¥é“å®ƒè¦æ”¾åœ¨å“ªä¸ªåˆ†æ®µï¼Œç„¶åå¯¹åˆ†æ®µè¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥å¤šçº¿ç¨‹ put å…ƒç´ æ—¶åªè¦æ”¾åœ¨çš„ä¸æ˜¯åŒä¸€ä¸ªåˆ†æ®µå°±åšåˆ°äº†çœŸæ­£çš„å¹¶è¡Œæ’å…¥ï¼Œä½†æ˜¯ç»Ÿè®¡ size æ—¶å°±éœ€è¦è·å–æ‰€æœ‰çš„åˆ†æ®µé”æ‰èƒ½ç»Ÿè®¡ï¼›åˆ†æ®µé”çš„è®¾è®¡æ˜¯ä¸ºäº†ç»†åŒ–é”çš„ç²’åº¦ã€‚ åå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ï¼šè¿™ç§åˆ†ç±»æ˜¯æŒ‰ç…§é”çŠ¶æ€æ¥å½’çº³çš„ï¼Œå¹¶ä¸”æ˜¯é’ˆå¯¹ synchronized çš„ï¼Œjava 1.6 ä¸ºäº†å‡å°‘è·å–é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½é—®é¢˜è€Œå¼•å…¥çš„ä¸€ç§çŠ¶æ€ï¼Œå…¶çŠ¶æ€ä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ï¼Œé”å¯ä»¥å‡çº§ä½†ä¸èƒ½é™çº§ï¼Œæ„å‘³ç€åå‘é”å‡çº§æˆè½»é‡çº§é”åæ— æ³•é™ä¸ºåå‘é”ï¼Œè¿™ç§å‡çº§æ— æ³•é™çº§çš„ç­–ç•¥ç›®çš„å°±æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡ã€‚ è‡ªæ—‹é”ï¼šå…¶å®æ˜¯ç›¸å¯¹äºäº’æ–¥é”çš„æ¦‚å¿µï¼Œäº’æ–¥é”çº¿ç¨‹ä¼šè¿›å…¥ WAITING çŠ¶æ€å’Œ RUNNABLE çŠ¶æ€çš„åˆ‡æ¢ï¼Œæ¶‰åŠä¸Šä¸‹æ–‡åˆ‡æ¢ã€cpu æŠ¢å ç­‰å¼€é”€ï¼Œè‡ªæ—‹é”çš„çº¿ç¨‹ä¸€ç›´æ˜¯ RUNNABLE çŠ¶æ€çš„ï¼Œä¸€ç›´åœ¨é‚£å¾ªç¯æ£€æµ‹é”æ ‡å¿—ä½ï¼Œæœºåˆ¶ä¸é‡å¤ï¼Œä½†æ˜¯è‡ªæ—‹é”åŠ é”å…¨ç¨‹æ¶ˆè€— cpuï¼Œèµ·å§‹å¼€é”€è™½ç„¶ä½äºäº’æ–¥é”ï¼Œä½†éšç€æŒé”æ—¶é—´åŠ é”å¼€é”€æ˜¯çº¿æ€§å¢é•¿ã€‚ å¯ä¸­æ–­é”ï¼šsynchronized æ˜¯ä¸å¯ä¸­æ–­çš„ï¼ŒLock æ˜¯å¯ä¸­æ–­çš„ï¼Œè¿™é‡Œçš„å¯ä¸­æ–­å»ºç«‹åœ¨é˜»å¡ç­‰å¾…ä¸­æ–­ï¼Œè¿è¡Œä¸­æ˜¯æ— æ³•ä¸­æ–­çš„ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/:11:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹å®‰å…¨","uri":"/java%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/"},{"categories":null,"content":"çŠ¶æ€ new æ–°å»º Runnable å¯è¿è¡Œ Blocaked é˜»å¡ Waiting ç­‰å¾… Timed waiting è®¡æ—¶ç­‰å¾… Terminated ç»ˆæ­¢ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:1:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"æ ¸å¿ƒæ–¹æ³• void start()å¯åŠ¨ void run()è°ƒç”¨å†…éƒ¨Runnableçš„run()ã€‚ public static void sleep(long millis)ä¼‘çœ æŒ‡å®šçš„æ¯«ç§’æ•°ã€‚ static void yield()ä½¿å½“å‰è¿è¡Œçš„çº¿ç¨‹å‘å¦ä¸€ä¸ªçº¿ç¨‹äº¤å‡ºè¿è¡Œæƒã€‚ getState()è·å–å½“å‰çº¿ç¨‹çŠ¶æ€ã€‚ void stop() ç»ˆæ­¢çº¿ç¨‹ï¼Œå·²åºŸå¼ƒã€‚ void suspend() æš‚åœçº¿ç¨‹ï¼Œå·²åºŸå¼ƒã€‚ void resume() æ¢å¤å·²æš‚åœçš„çº¿ç¨‹ï¼Œå·²åºŸå¼ƒã€‚ void interrupt() è¯·æ±‚ç»ˆæ­¢çº¿ç¨‹ï¼Œå˜æ›´æ ‡è®°ä¸ºï¼Œéœ€è¦ç”¨isInterrupted()åˆ¤æ–­ã€‚è¿˜ä¼šæŠ›å‡ºInterruptedExceptionã€‚ public static boolean interrupted() æ£€æŸ¥æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¼šé‡ç½®ä¸­æ–­çŠ¶æ€ä¸ºfalseã€‚ boolean isInterrupted() ä½œç”¨åŒä¸Šï¼Œä½†æ˜¯ä¸ä¼šé‡ç½®çŠ¶æ€ã€‚ static Thread currentThread()è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ã€‚ void setName(String name) ç»™çº¿ç¨‹èµ·ä¸ªåã€‚ void setDaemon(boolean isDaemon) è½¬ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:2:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"é˜»å¡ å½“ä¸€ä¸ªçº¿ç¨‹è¦è®¿é—®å¯¹è±¡æ—¶ï¼ˆå‚ä¸ç«äº‰å¯¹è±¡é”ï¼‰ï¼Œè€Œè¯¥å¯¹è±¡é”è¢«æ­£åœ¨è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œæ­¤çº¿ç¨‹å°±ä¼šé˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾å¯¹è±¡é”ï¼Œå¹¶ä¸”çº¿ç¨‹è°ƒåº¦å™¨å…è®¸æ­¤çº¿ç¨‹æŒæœ‰å¯¹è±¡é”ã€‚ å½“çº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹é€šçŸ¥è°ƒåº¦å™¨å‡ºç°ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚æ¯”å¦‚è°ƒç”¨äº†Object.wait()æˆ–Thread.join()æ–¹æ³•ï¼Œæˆ–è€…æ˜¯java.util.concurrentåº“ä¸­çš„Lock.tryLock()ã€Condition.awaitã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:3:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"ç»ˆæ­¢ ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œrunæ–¹æ³•æ­£å¸¸é€€å‡ºï¼Œçº¿ç¨‹æ­£å¸¸ç»ˆæ­¢ã€‚ æŠ›å‡ºå¼‚å¸¸ç»ˆæ­¢ã€‚ è°ƒç”¨stop()æ–¹æ³•ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:4:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"ä¸­æ–­ mThread.interrupt()å¯ä¸­æ–­çº¿ç¨‹ï¼Œä½†å¹¶ä¸ä¼šç»ˆæ­¢ï¼Œè€Œåªæ˜¯å˜æ›´äº†ä¸­æ–­çŠ¶æ€ã€‚ Thread.currentThread().isInterrupted()å¯ä»¥æ£€æŸ¥ä¸­æ–­çŠ¶æ€ã€‚ å¦‚æœçº¿ç¨‹æ­£åœ¨é˜»å¡ä¸­ï¼Œè°ƒç”¨interrupt()æ–¹æ³•ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚æ•è·è¿™ä¸ªå¼‚å¸¸åï¼Œå¯ä»¥åœ¨çº¿ç¨‹å†…éƒ¨çš„catché‡Œé¢åœ¨æ­¤è°ƒç”¨interrupt()æ–¹æ³•å˜æ›´çŠ¶æ€ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:5:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"å®ˆæŠ¤çº¿ç¨‹ å®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹æä¾›æœåŠ¡çš„çº¿ç¨‹ã€‚JVMé€€å‡ºæ—¶ä¼šè‡ªåŠ¨å›æ”¶å®ˆæŠ¤çº¿ç¨‹ã€‚ mThread.setDaemon(true); å…¸å‹çš„å°±æ˜¯GCçº¿ç¨‹ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:6:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"æœªæ•è·å¼‚å¸¸å¤„ç†å™¨ çº¿ç¨‹çš„runæ–¹æ³•ä¸èƒ½åŒ…æŠ›å‡ºä»»ä½•æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä½†æ˜¯éæ£€æŸ¥å‹å¼‚å¸¸ä¼šå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢ã€‚ å¯ä»¥é€šè¿‡å®ç°Thread.UncaughtExceptionHandleræ¥å£ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªæœªæ•è·å¼‚å¸¸å¤„ç†å™¨ï¼š //åˆ›å»ºçº¿ç¨‹ Thread t = new Thread(); //åˆ›å»ºå¤„ç†å™¨ UncaughtExceptionHandler handler = new UncaughtExceptionHandler(); //è®¾ç½®å¤„ç†å™¨ t.setUncaughtExceptionHandler(handler); //è®¾ç½®å…¨å±€é»˜è®¤å¤„ç†å™¨ Thread.setDefaultUncaughtExceptionHandler(handler); static class UncaughtExceptionHandler implements Thread.UncaughtExceptionHandler{ @Override public void uncaughtException(@NonNull Thread t, @NonNull Throwable e) { //å¯ä»¥åšå¼‚å¸¸é‡‡é›†ã€æ‰“å°æ—¥å¿— } } ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:7:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"çº¿ç¨‹ä¼˜å…ˆçº§ å¯ä»¥ä½¿ç”¨void setPriority(int newPriority)è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œå€¼åœ¨1~10ï¼Œé»˜è®¤ä¸º5ã€‚ç³»ç»Ÿè‡ªå¸¦çš„å¸¸é‡å¦‚ä¸‹ï¼š MIN_PRIORITY = 1 æœ€å°ä¼˜å…ˆçº§ NORM_PRIORITY = 5 é»˜è®¤ä¼˜å…ˆçº§ MAX_PRIORITY = 10 æœ€å¤§ä¼˜å…ˆçº§ é»˜è®¤æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¼šç»§æ‰¿åˆ›å»ºä»–è‡ªèº«çš„çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚ å½“çº¿ç¨‹è°ƒåº¦å™¨æœ‰æœºä¼šé€‰æ‹©æ–°çº¿ç¨‹æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©é«˜ä¼˜å…ˆçº§ã€‚ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:8:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"çº¿ç¨‹é—´é€šä¿¡ wait()ã€notifyAll() Handler+Message å…±äº«å˜é‡ ä¿¡å·é‡ ","date":"2021-03-19","objectID":"/java%E7%BA%BF%E7%A8%8B/:9:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹","uri":"/java%E7%BA%BF%E7%A8%8B/"},{"categories":null,"content":"é˜»å¡é˜Ÿåˆ— BlockingQueue ç”Ÿäº§è€…\u0026æ¶ˆè´¹è€…æ¨¡å‹ é˜Ÿåˆ—çš„æ„ä¹‰ï¼š ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…è§£è€¦ å¹³è¡¡ç”Ÿäº§ä¸æ¶ˆè´¹é€Ÿåº¦ å¯åº”ç”¨äºæ¶ˆæ¯ä¸­å¿ƒ é»˜è®¤å®ç°ï¼š é˜Ÿåˆ— ç•Œé™ ç‰¹ç‚¹ ArrayBlockingQueue æœ‰ ä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œ LinkedBlockingQueue æœ‰ é“¾è¡¨ç»“æ„ PriorityBlockingQueue æ—  æ”¯æŒä¼˜å…ˆçº§æ’åºï¼Œå¯ä»¥ä¼ å…¥æ¯”è¾ƒå™¨ DelayQueue æ—  æ”¯æŒä¼˜å…ˆçº§ï¼Œæ”¯æŒå…ƒç´ çš„å»¶è¿Ÿè·å– SynchronousQueue ä¸å‚¨å­˜å…ƒç´ ï¼Œç”¨æ¥è§£è€¦ LinkedTransferQueue æ—  é“¾è¡¨ç»“æ„ LinkedBlockingQueue åŒå‘é“¾è¡¨ æœ‰ç•Œ\u0026æ— ç•Œ æœ‰ç•Œï¼šé•¿åº¦æœ‰é™ï¼Œæ»¡äº†ä¼šé˜»å¡ï¼› æ— ç•Œï¼šå¯ä»¥éšæ„æ”¾ä¸œè¥¿ï¼Œä¸ä¼šé˜»å¡ï¼› ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:1:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"æ ¸å¿ƒæ–¹æ³• 1.æ”¾å…¥æ•°æ® offer(anObject):è¡¨ç¤ºå¦‚æœå¯èƒ½çš„è¯,å°†anObjectåŠ åˆ°BlockingQueueé‡Œ,å³å¦‚æœBlockingQueueå¯ä»¥å®¹çº³,åˆ™è¿”å›true,å¦åˆ™è¿”å›false.ï¼ˆæœ¬æ–¹æ³•ä¸é˜»å¡å½“å‰æ‰§è¡Œæ–¹æ³•çš„çº¿ç¨‹ï¼‰ï¼›ã€€offer(E o, long timeout, TimeUnit unit)ï¼šå¯ä»¥è®¾å®šç­‰å¾…çš„æ—¶é—´ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…ï¼Œè¿˜ä¸èƒ½å¾€é˜Ÿåˆ—ä¸­åŠ å…¥BlockingQueueï¼Œåˆ™è¿”å›å¤±è´¥ã€‚ put(anObject):æŠŠanObjectåŠ åˆ°BlockingQueueé‡Œ,å¦‚æœBlockQueueæ²¡æœ‰ç©ºé—´,åˆ™è°ƒç”¨æ­¤æ–¹æ³•çš„çº¿ç¨‹è¢«é˜»æ–­ç›´åˆ°BlockingQueueé‡Œé¢æœ‰ç©ºé—´å†ç»§ç»­. poll(time):å–èµ°BlockingQueueé‡Œæ’åœ¨é¦–ä½çš„å¯¹è±¡,è‹¥ä¸èƒ½ç«‹å³å–å‡º,åˆ™å¯ä»¥ç­‰timeå‚æ•°è§„å®šçš„æ—¶é—´,å–ä¸åˆ°æ—¶è¿”å›null; poll(long timeout, TimeUnit unit)ï¼šä»BlockingQueueå–å‡ºä¸€ä¸ªé˜Ÿé¦–çš„å¯¹è±¡ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œé˜Ÿåˆ—ä¸€æ—¦æœ‰æ•°æ®å¯å–ï¼Œåˆ™ç«‹å³è¿”å›é˜Ÿåˆ—ä¸­çš„æ•°æ®ã€‚å¦åˆ™çŸ¥é“æ—¶é—´è¶…æ—¶è¿˜æ²¡æœ‰æ•°æ®å¯å–ï¼Œè¿”å›å¤±è´¥ã€‚ take():å–èµ°BlockingQueueé‡Œæ’åœ¨é¦–ä½çš„å¯¹è±¡,è‹¥BlockingQueueä¸ºç©º,é˜»æ–­è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°BlockingQueueæœ‰æ–°çš„æ•°æ®è¢«åŠ å…¥; drainTo():ä¸€æ¬¡æ€§ä»BlockingQueueè·å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®å¯¹è±¡ï¼ˆè¿˜å¯ä»¥æŒ‡å®šè·å–æ•°æ®çš„ä¸ªæ•°ï¼‰ï¼Œé€šè¿‡è¯¥æ–¹æ³•ï¼Œå¯ä»¥æå‡è·å–æ•°æ®æ•ˆç‡ï¼›ä¸éœ€è¦å¤šæ¬¡åˆ†æ‰¹åŠ é”æˆ–é‡Šæ”¾é”ã€‚ ä¸‹é¢å‡ ä¸ªæ–¹æ³•è¦è®°ä½ æ–¹æ³• é˜»å¡ ä½œç”¨ offer no æ·»åŠ å…ƒç´ æˆåŠŸè¿”å›trueï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡è¿”å›falseï¼Œé‡è½½æ–¹æ³•å¯ä»¥è®¾ç½®ç­‰å¾…æ—¶é—´ã€‚ put yes æ·»åŠ å…ƒç´ ï¼Œå¦‚æœç©ºé—´å·²æ»¡ï¼Œä¼šé˜»å¡çº¿ç¨‹ç›´åˆ°æ·»åŠ æˆåŠŸ poll no å–èµ°é˜Ÿåˆ—é¦–ä½å…ƒç´ ï¼Œå¯ä»¥è®¾å®šç­‰å¾…æ—¶é—´ï¼Œå¤±è´¥è¿”å›false take yes å–èµ°é˜Ÿåˆ—é¦–ä½å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šé˜»å¡çº¿ç¨‹ç›´åˆ°æœ‰äº†ä¸ºæ­¢ drainTo ä¸€æ¬¡æ€§è·å–å¤šä¸ªæˆ–å…¨éƒ¨å…ƒç´  ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:1:1","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"Javaé»˜è®¤çº¿ç¨‹æ±  Executors.newCachedThreadPool()ï¼Œåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„æ— ç•Œçº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºçº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚å½“çº¿ç¨‹ç©ºé—²è¶…è¿‡60ç§’è‡ªåŠ¨å›æ”¶ï¼Œå½“ä»»åŠ¡è¶…è¿‡çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°ï¼Œå¯æ— é™åˆ›å»ºæ–°çº¿ç¨‹ï¼› Executors.newFixedThreadPool(int nThreads)ï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹çš„æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨LinkedBlockingQueueé˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼› Executors.newScheduledThreadPoolï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥æŒ‡å®šçº¿ç¨‹æ± æ ¸å®šçº¿ç¨‹æ•°ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡çš„æ‰§è¡Œï¼› Executors.newSingleThreadExecutorï¼Œåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ Executors.newWorkStealingPoolï¼ˆjava8å¼•å…¥ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªæ›´åŠ é«˜æ•ˆçš„çº¿ç¨‹æ± ï¼Œä¸åŒäºä»¥ä¸Šå››ç§çº¿ç¨‹æ± ï¼Œè¿™ä¸ªçº¿ç¨‹æ± æ‹“å±•äºForkJoinPoolï¼Œé€‚åˆç”¨äºéå¸¸è€—æ—¶æˆ–è‡ªä»»åŠ¡ä¼—å¤šçš„åœºæ™¯ã€‚ å‰å››ç§æ˜¯æˆ‘ä»¬ä¸€èˆ¬ç”¨åˆ°çš„çº¿ç¨‹æ± ï¼Œéƒ½æ˜¯æ‹“å±•è‡ªThreadPoolExecutorç±»ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:2:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"è‡ªå®šä¹‰çº¿ç¨‹æ± ä¸ThreadPoolExecutor æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ThreadPoolExecutorç±»å®ç°è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚ public ThreadPoolExecutor( int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue\u003cRunnable\u003e workQueue, ThreadFactory threadFactory ) å‚æ•°è§£æï¼š corePoolSize çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒçº¿ç¨‹ä¼šåœ¨çº¿ç¨‹æ± ä¸­ä¸€ç›´å­˜æ´»ï¼Œå³ä½¿å®ƒä»¬å¤„äºé—²ç½®çŠ¶æ€ã€‚å¦‚æœé€šè¿‡allowCoreThreadTimeOut(boolean value)æ–¹æ³•è®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆé—²ç½®çš„æ ¸å¿ƒçº¿ç¨‹åœ¨ç­‰å¾…æ–°ä»»åŠ¡åˆ°æ¥æ—¶ä¼šæœ‰è¶…æ—¶ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”ç”±keepAliveTimeæ‰€æŒ‡å®šï¼Œå½“ç­‰å¾…æ—¶é—´è¶…è¿‡keepAliveTimeåï¼Œæ ¸å¿ƒçº¿ç¨‹å°±ä¼šè¢«ç»ˆæ­¢ã€‚ maximumPoolSize çº¿ç¨‹æ± æ‰€èƒ½å®¹çº³çš„æœ€å¤§çº¿ç¨‹æ•°ï¼Œå½“æ´»åŠ¨çº¿ç¨‹æ•°è¾¾åˆ°è¿™ä¸ªæ•°å€¼åï¼Œåç»­çš„æ–°ä»»åŠ¡å°†ä¼šè¢«é˜»å¡ã€‚ keepAliveTime éæ ¸å¿ƒçº¿ç¨‹é—²ç½®æ—¶çš„è¶…æ—¶æ—¶é•¿ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é•¿ï¼Œéæ ¸å¿ƒçº¿ç¨‹å°±ä¼šè¢«å›æ”¶ã€‚å½“ThreadPool-Executorçš„allowCoreThreadTimeOutå±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼ŒkeepAliveTimeåŒæ ·ä¼šä½œç”¨äºæ ¸å¿ƒçº¿ç¨‹ã€‚ unit ç”¨äºæŒ‡å®škeepAliveTimeå‚æ•°çš„æ—¶é—´å•ä½ï¼Œè¿™æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå¸¸ç”¨çš„æœ‰TimeUnit. MILLISECONDSï¼ˆæ¯«ç§’ï¼‰ã€TimeUnit.SECONDSï¼ˆç§’ï¼‰ä»¥åŠTimeUnit.MINUTESï¼ˆåˆ†é’Ÿï¼‰ç­‰ã€‚ workQueue çº¿ç¨‹æ± ä¸­çš„é˜»å¡é˜Ÿåˆ—ï¼Œç”¨æ¥å®¹çº³è¶…å‡ºcoreçº¿ç¨‹æ•°çš„runnableã€‚ threadFactory çº¿ç¨‹å·¥å‚ï¼Œä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„åŠŸèƒ½ã€‚ThreadFactoryæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼šThread newThread(Runnable r)ï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤çš„ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç”¨æ¥è®¾ç½®thread-nameã€‚ Rejected-ExecutionHandler handler å½“çº¿ç¨‹æ± æ— æ³•æ‰§è¡Œæ–°ä»»åŠ¡æ—¶ï¼Œæ¯”å¦‚çº¿ç¨‹å…¨å¿™å¹¶ä¸”é˜Ÿåˆ—å·²æ»¡ï¼Œè¿™ä¸ªæ—¶å€™ThreadPoolExecutorä¼šè°ƒç”¨handlerçš„rejectedExecutionæ–¹æ³•æ¥é€šçŸ¥è°ƒç”¨è€…ï¼Œé»˜è®¤æƒ…å†µä¸‹rejectedExecutionæ–¹æ³•ä¼šç›´æ¥æŠ›å‡ºä¸€ä¸ªRejectedExecution-Exceptionã€‚ThreadPoolExecutorä¸ºRejectedExecutionHandleræä¾›äº†å‡ ä¸ªå¯é€‰å€¼ï¼šCallerRunsPolicyã€AbortPolicyã€DiscardPolicyå’ŒDiscardOldestPolicyï¼Œå…¶ä¸­AbortPolicyæ˜¯é»˜è®¤å€¼ã€‚ ThreadPoolExecutoræ‰§è¡Œä»»åŠ¡æ—¶å¤§è‡´éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š å¦‚æœå½“å‰çº¿ç¨‹æ•°å°äºcoreï¼Œé‚£å°±åˆ›å»ºçº¿ç¨‹ç›´æ¥æ‰§è¡Œï¼› å¦‚æœcoreæ»¡äº†ï¼Œå°±ä¼šæŠŠtaskæ”¾å…¥BlockingQueueä¸­æ’é˜Ÿï¼› å¦‚æœBlockingQueueä¹Ÿæ»¡äº†ï¼Œå°±æ–°å»ºçº¿ç¨‹ç›´æ¥æ‰§è¡Œï¼› å¦‚æœå½“å‰çº¿ç¨‹æ•°é‡è¶…è¿‡maxPoolSizieï¼Œå°±æ‹’ç»ã€‚ é»˜è®¤å®ç°çš„æ‹’ç»ç­–ç•¥ï¼š AbortPolicy ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼ˆæŠ›å¼‚å¸¸ï¼‰ï¼› DiscardPolicy æŠŠæ–°çš„ä»»åŠ¡ç›´æ¥æ‰”æ‰ï¼ˆåè¿›å…ˆå‡ºï¼‰ã€‚ DiscardOldestPolicy ç›´æ¥ä¸¢å¼ƒæœ€æ—§çš„è¿˜æ²¡æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼› CallerRunsPolicy è®©è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œæ¯”å¦‚è°ƒç”¨è€…æ˜¯ä¸»çº¿ç¨‹ï¼Œå°±ä¼šåˆ‡å›ä¸»çº¿ç¨‹ï¼ˆæ‰¯çš®ï¼‰ï¼› ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:3:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"å‚æ•°é…ç½® AsyncTaskæ”¯æŒå¹¶å‘æ—¶çš„é…ç½®ï¼š é€šè¿‡ä»¥ä¸‹ä»£ç è·å–CPUæ ¸å¿ƒæ•°ï¼š Runtime.getRuntime().availableProcessors() é…ç½®åŸåˆ™ï¼š CPUå¯†é›†å‹ï¼šå¤§è§„æ¨¡è¿ç®—ï¼Œæ²¡æœ‰é˜»å¡ï¼Œä¸ºå‡å°‘cpuè½®è½¬æ¬¡æ•°ï¼Œå°½é‡å‡å°‘çº¿ç¨‹æ•°é‡ï¼Œå…¬å¼ï¼šCPUæ ¸å¿ƒæ•°+1; IOå¯†é›†å‹ï¼šé˜»å¡å¤šï¼Œå°½é‡å¤šç»™çº¿ç¨‹æé«˜é€Ÿåº¦ï¼Œå…¬å¼ï¼šCPUæ ¸å¿ƒæ•°*2ï¼› æ··åˆå‹ï¼šå¦‚æœå¯†é›†è®¡ç®—è€—æ—¶ä¸IOè€—æ—¶å·®ä¸å¤šï¼Œå°±æ‹†åˆ†æˆä¸¤ä¸ªçº¿ç¨‹æ± æ¥ç©ã€‚ AsyncTaskçš„é…ç½®ï¼š æ ¸å¿ƒçº¿ç¨‹æ•°ç­‰äºCPUæ ¸å¿ƒæ•°+1ï¼› çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ä¸ºCPUæ ¸å¿ƒæ•°çš„2å€+1ï¼› æ ¸å¿ƒçº¿ç¨‹æ— è¶…æ—¶æœºåˆ¶ï¼Œéæ ¸å¿ƒçº¿ç¨‹åœ¨é—²ç½®æ—¶çš„è¶…æ—¶æ—¶é—´ä¸º1ç§’ï¼› ä»»åŠ¡é˜Ÿåˆ—çš„å®¹é‡ä¸º128ã€‚ ä¸ºä»€ä¹ˆè¦åŠ 1ï¼Ÿå› ä¸ºåœ¨ç¡¬ç›˜ä¸Šæœ‰è™šæ‹Ÿå†…å­˜ï¼Œä¸ºäº†åœ¨å‘ç”Ÿâ€œé¡µç¼ºå¤±â€ç°è±¡æ—¶ï¼Œä¸è®©CPUæ ¸å¿ƒé—²ç½®ï¼Œæ‰€ä»¥è¦åŠ 1ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:3:1","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"çº¿ç¨‹æ± çš„å…³é—­ shutDown å…³é—­çº¿ç¨‹æ± ï¼Œç„¶åå°è¯•ä¸­æ–­å½“å‰æ²¡æœ‰æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼› shutDownNow å°è¯•ä¸­æ–­æ‰€æœ‰çš„çº¿ç¨‹ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:3:2","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"åŸç† ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"executeä»»åŠ¡è°ƒåº¦ï¼š //å½“å‰çº¿ç¨‹æ•° private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0)); public void execute(Runnable command) { //å½“å‰è¿è¡Œçš„ä»»åŠ¡æ•° int c = ctl.get(); //å¦‚æœå°äºæ ¸å¿ƒæ•°ï¼Œå°±addWork if (workerCountOf(c) \u003c corePoolSize) { //å¦‚æœå½“å‰æ´»è·ƒçº¿ç¨‹æ•°å°äºè®¾ç½®çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œç›´æ¥æ‰§è¡Œä»»åŠ¡ if (addWorker(command, true)) return; c = ctl.get(); } //å¦‚æœå¤§äºæ ¸å¿ƒæ•°ï¼Œå¹¶ä¸”çº¿ç¨‹æ± è¿˜åœ¨è¿è¡Œï¼Œå°±æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ if (isRunning(c) \u0026\u0026 workQueue.offer(command)) { int recheck = ctl.get(); //å¦‚æœçº¿ç¨‹æ± å·²ç»åœæ­¢è¿è¡Œï¼Œå°±ç§»é™¤ä»»åŠ¡ if (! isRunning(recheck) \u0026\u0026 remove(command)) //ç§»é™¤æˆåŠŸå°±æ‰§è¡Œæ‹’ç»ç­–ç•¥ reject(command); else if (workerCountOf(recheck) == 0) //çº¿ç¨‹æ± ä¸åœ¨è¿è¡ŒçŠ¶æ€ï¼Œæˆ–è€…ç§»é™¤å¤±è´¥ï¼Œå¹¶ä¸”å½“å‰æ²¡æœ‰ä»»åŠ¡ï¼Œå°±å¼€å¯ä¸€ä¸ªç©ºä»»åŠ¡ addWorker(null, false); } //å¦‚æœæ·»åŠ ä»»åŠ¡å¤±è´¥ï¼Œå°±æ‰§è¡Œæ‹’ç»ç­–ç•¥ else if (!addWorker(command, false)) reject(command); } executeæ–¹æ³•ä¸»è¦ç”¨æ¥è°ƒåº¦ä»»åŠ¡ï¼Œæ®å½“å‰åŸå­è®¡æ•°å™¨cçš„çŠ¶æ€å’Œä»»åŠ¡æ•°ï¼Œ å¦‚æœå½“å‰ä»»åŠ¡æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå°±ç›´æ¥addWorkerï¼› å¦‚æœå¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå°±æŠŠä»»åŠ¡æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—ï¼› å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œå°è¯•addworker; å¦‚æœé˜Ÿåˆ—æ»¡ï¼ŒaddWorkerå¤±è´¥ï¼Œåˆ™æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:1","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"addWorkerçº¿ç¨‹è°ƒåº¦ //æˆ‘æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹æ± å­ private final HashSet\u003cWorker\u003e workers = new HashSet\u003c\u003e(); private boolean addWorker(Runnable firstTask, boolean core) { //ä½¿ç”¨caså¤±è´¥è‡ªæ—‹æ¥ä¿è¯çº¿ç¨‹ç«äº‰é—®é¢˜ retry: for (;;) { int c = ctl.get(); int rs = runStateOf(c); // Check if queue empty only if necessary. if (rs \u003e= SHUTDOWN \u0026\u0026 ! (rs == SHUTDOWN \u0026\u0026 firstTask == null \u0026\u0026 !workQueue.isEmpty()) ) return false; for (;;) { int wc = workerCountOf(c); if (wc \u003e= CAPACITY || wc \u003e= (core ? corePoolSize : maximumPoolSize)) return false; //CASæ“ä½œ if (compareAndIncrementWorkerCount(c)) break retry; c = ctl.get(); // Re-read ctl if (runStateOf(c) != rs) continue retry; } } boolean workerStarted = false; boolean workerAdded = false; Worker w = null; try { //Workeræ˜¯å¯¹runnableå’ŒThreadçš„è£…ç®±ï¼Œæ„é€ æ–¹æ³•ä¼šè°ƒç”¨ThreadFactoryç”Ÿæˆä¸€ä¸ªThread w = new Worker(firstTask); final Thread t = w.thread; if (t != null) { final ReentrantLock mainLock = this.mainLock; mainLock.lock();//ä¸Šé”ï¼Œ try { int rs = runStateOf(ctl.get()); if (rs \u003c SHUTDOWN || (rs == SHUTDOWN \u0026\u0026 firstTask == null)) { if (t.isAlive()) // precheck that t is startable throw new IllegalThreadStateException(); //æ·»åŠ è¿›çº¿ç¨‹æ ˆ workers.add(w); int s = workers.size(); if (s \u003e largestPoolSize) largestPoolSize = s; workerAdded = true; } } finally { mainLock.unlock(); } if (workerAdded) { //coreçº¿ç¨‹ç›´æ¥è¿è¡Œ t.start(); workerStarted = true; } } } finally { if (! workerStarted) addWorkerFailed(w); } return workerStarted; } addWorkerä¸»è¦ç”¨æ¥è°ƒåº¦çº¿ç¨‹ã€‚é¦–å…ˆåˆ›å»ºworkï¼Œç„¶åæŠŠworkæ·»åŠ è¿›çº¿ç¨‹æ± workersï¼Œå¹¶é€šè¿‡ä¸»é”mainLockä¿è¯çº¿ç¨‹æ± workersçš„å®‰å…¨ã€‚æœ€åå¯åŠ¨workerçš„çº¿ç¨‹ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:2","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"work //ThreadPoolExecutorçš„åŒ¿åå†…éƒ¨ç±»ï¼Œæ»¡è¶³AQSå®ç°ä¸å¯é‡å…¥çš„é”ï¼Œæ»¡è¶³Runnableï¼Œå†…éƒ¨åŒ…å«Thread private final class Worker extends AbstractQueuedSynchronizer implements Runnable { //å¯ä»¥åºåˆ—åŒ– private static final long serialVersionUID = 6138294804551838833L; //çº¿ç¨‹ final Thread thread; //ä»»åŠ¡ Runnable firstTask; volatile long completedTasks; //æ„é€ æ–¹æ³•ï¼Œè°ƒç”¨æ—¶ä»ThreadFactoryåˆ›å»ºæ–°çš„çº¿ç¨‹ Worker(Runnable firstTask) { setState(-1); this.firstTask = firstTask; //æ³¨æ„è¿™é‡Œï¼Œç»™çº¿ç¨‹ä¼ å…¥çš„æ˜¯å½“å‰Worker this.thread = getThreadFactory().newThread(this); } //çº¿ç¨‹è¿è¡Œæ—¶ä¼šæ‰§è¡Œè¿™ä¸ª public void run() { runWorker(this); } //å°è¯•Acquire protected boolean tryAcquire(int unused) { if (compareAndSetState(0, 1)) { setExclusiveOwnerThread(Thread.currentThread()); return true; } return false; } //å°è¯•é‡Šæ”¾ protected boolean tryRelease(int unused) { setExclusiveOwnerThread(null); setState(0); return true; } public void lock() { acquire(1); } public boolean tryLock() { return tryAcquire(1); } public void unlock() { release(1); } public boolean isLocked() { return isHeldExclusively(); } //å°è¯•ä¸­æ–­ void interruptIfStarted() { Thread t; if (getState() \u003e= 0 \u0026\u0026 (t = thread) != null \u0026\u0026 !t.isInterrupted()) { try { t.interrupt(); } catch (SecurityException ignore) { } } } } workæ˜¯ThreadPoolExecutorçš„å†…éƒ¨ç±»ï¼Œæ˜¯ä¸€ä¸ªæ»¡è¶³AQSçš„Runnableï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­é€šè¿‡factoryåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶ä¼ å…¥ä»–è‡ªèº«ï¼Œé‚£ä¹ˆå½“addWorkæ—¶ä¼šå¯åŠ¨è¿™ä¸ªçº¿ç¨‹ï¼Œè€Œçº¿ç¨‹ä¼šæ‰§è¡Œä»–è‡ªå·±çš„runæ–¹æ³•ï¼Œrunæ–¹æ³•åˆè°ƒç”¨äº†å¤–å±‚ç±»ThreadPoolExecutorçš„runWorkeræ–¹æ³•ã€‚ workè¿˜æä¾›äº†AQSæ“ä½œå’Œä¸­æ–­çº¿ç¨‹çš„æ–¹æ³•ï¼Œç”±æ­¤å¯è§ï¼Œworkæ˜¯Threadçš„è£…é¥°è€…ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:3","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"runWorkerï¼šå¤ç”¨çº¿ç¨‹ final void runWorker(Worker w) { //æ‹¿åˆ°çº¿ç¨‹ Thread wt = Thread.currentThread(); //æ‹¿åˆ°workæ„é€ æ–¹æ³•ä¼ å…¥çš„runnable Runnable task = w.firstTask; w.firstTask = null; w.unlock(); // allow interrupts boolean completedAbruptly = true; try { //å¾ªç¯æ‰§è¡Œä»»åŠ¡ //å¦‚æœfirstTaskæœ‰å€¼,å°±ç›´æ¥æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ //å¦‚æœæ²¡æœ‰å…·ä½“çš„ä»»åŠ¡,å°±æ‰§è¡ŒgetTask()æ–¹æ³•ä»é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ï¼Œå½“ç„¶è¿™ä¸ªæ“ä½œæ˜¯é˜»å¡çš„ while (task != null || (task = getTask()) != null) { w.lock(); //æ£€æŸ¥çº¿ç¨‹æ± æ˜¯å¦shutDownäº†ï¼Œç¡®ä¿çº¿ç¨‹ä¸­æ–­ if ((runStateAtLeast(ctl.get(), STOP) || (Thread.interrupted() \u0026\u0026 runStateAtLeast(ctl.get(), STOP))) \u0026\u0026 !wt.isInterrupted()) wt.interrupt(); try { beforeExecute(wt, task); Throwable thrown = null; try { //æ‰§è¡Œä»»åŠ¡ task.run(); } catch (RuntimeException x) { thrown = x; throw x; } catch (Error x) { thrown = x; throw x; } catch (Throwable x) { thrown = x; throw new Error(x); } finally { afterExecute(task, thrown); } } finally { task = null; w.completedTasks++; w.unlock(); } } completedAbruptly = false; } finally { processWorkerExit(w, completedAbruptly); } } runWorkeræ–¹æ³•ä¸»è¦æ˜¯å¯¹çº¿ç¨‹çš„æ§åˆ¶ï¼Œä¼šå¾ªç¯è°ƒç”¨getTaskæ–¹æ³•ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡äº¤ç»™çº¿ç¨‹æ‰§è¡Œï¼Œè¾¾åˆ°çº¿ç¨‹å¤ç”¨çš„ç›®çš„ã€‚å½“çº¿ç¨‹æ± shutDownæ—¶ä¼šä¸­æ–­çº¿ç¨‹ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:4","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"getTaské˜»å¡é˜Ÿåˆ—å–å€¼ private Runnable getTask() { boolean timedOut = false; // Did the last poll() time out? //æ­»å¾ªç¯ for (;;) { int c = ctl.get(); int rs = runStateOf(c); // Check if queue empty only if necessary. if (rs \u003e= SHUTDOWN \u0026\u0026 (rs \u003e= STOP || workQueue.isEmpty())) { decrementWorkerCount(); return null; } //å½“å‰ä»»åŠ¡æ•° int wc = workerCountOf(c); // å¦‚æœå½“å‰ä»»åŠ¡æ•°å¤§äºcoreï¼Œæˆ–è€…coreçº¿ç¨‹ä¹Ÿå…è®¸è¶…æ—¶å›æ”¶ boolean timed = allowCoreThreadTimeOut || wc \u003e corePoolSize; if ((wc \u003e maximumPoolSize || (timed \u0026\u0026 timedOut)) \u0026\u0026 (wc \u003e 1 || workQueue.isEmpty())) { if (compareAndDecrementWorkerCount(c)) return null; continue; } try { //å¦‚æœå½“å‰ä»»åŠ¡æ•°å¤§äºcoreå°±ç­‰ç€æ‹¿ï¼Œè¶…æ—¶å°±è¿”å›nullï¼›å¦åˆ™å°±é˜»å¡ç­‰ï¼Œä¸€ç›´ç­‰åˆ°æœ‰äº†ä¸ºæ­¢ Runnable r = timed ? workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) : workQueue.take(); if (r != null) return r; timedOut = true; } catch (InterruptedException retry) { timedOut = false; } } } getTaskä¸»è¦ç”¨äºä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å€¼ï¼Œå¦‚æœå½“å‰ä»»åŠ¡æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°å°±ç›´æ¥æ‹¿ï¼Œå¦åˆ™ä¼šé˜»å¡ç­‰ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:5","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"æ€»ç»“çº¿ç¨‹æ± çš„åŸç† çº¿ç¨‹æ± æˆ‘ä»¬ä»executeæ–¹æ³•å…¥æ‰‹ï¼Œexecuteæ–¹æ³•ä¸»è¦ç”¨æ¥è°ƒåº¦ä»»åŠ¡ï¼Œæ®å½“å‰åŸå­è®¡æ•°å™¨cçš„çŠ¶æ€å’Œä»»åŠ¡æ•°ï¼Œ å¦‚æœå½“å‰ä»»åŠ¡æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå°±ç›´æ¥addWorkerï¼› å¦‚æœå¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå°±æŠŠä»»åŠ¡æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—ï¼› å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œè¿˜æ˜¯addworker; å¦‚æœé˜Ÿåˆ—æ»¡ï¼ŒaddWorkerå¤±è´¥ï¼Œåˆ™æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚ addWorkerä¸»è¦ç”¨æ¥è°ƒåº¦çº¿ç¨‹ã€‚é¦–å…ˆåˆ›å»ºworkerï¼Œç„¶åæŠŠworkæ·»åŠ è¿›çº¿ç¨‹æ± workersï¼Œå¹¶é€šè¿‡ä¸»é”mainLockä¿è¯çº¿ç¨‹æ± workersçš„å®‰å…¨ã€‚æœ€åå¯åŠ¨workerçš„çº¿ç¨‹ã€‚ workæ˜¯runnableçš„è£…é¥°è€…,é™¤äº†å…·å¤‡runnableåŠŸèƒ½ç‰¹æ€§ä¹‹å¤–è¿˜æä¾›AQSæ“ä½œå’Œä¸­æ–­çº¿ç¨‹çš„åŠŸèƒ½ã€‚å®ƒå†…éƒ¨æŒæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œç”±äºä»–è‡ªå·±æ˜¯runnableï¼Œæ‰€ä»¥çº¿ç¨‹ä¼šæ‰§è¡Œä»–è‡ªå·±ï¼Œå¹¶å†å®ƒè‡ªå·±çš„runæ–¹æ³•å†…è°ƒç”¨çº¿ç¨‹æ± çš„runWorkeræ–¹æ³•ã€‚ runWorkeré€šè¿‡å¾ªç¯è°ƒç”¨getTask()æ–¹æ³•å–å‡ºé˜»å¡é˜Ÿåˆ—ä¸­çš„runnableæ¥æ‰§è¡Œï¼Œå½“çº¿ç¨‹æ± shutdownçš„æ—¶å€™ä¼šå°½é‡ä¸­æ–­çº¿ç¨‹ã€‚ è€ŒgetTask()æ–¹æ³•ä¼šä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºé¦–ä½ä»»åŠ¡ã€‚å¦‚æœé˜Ÿåˆ—ä¸­æœ‰ä»»åŠ¡ä¼špollç­‰å¾…å–å‡ºï¼Œç­‰å¾…çš„æ—¶é—´ä¸ºçº¿ç¨‹æ± å‚æ•°keepAliveTimeï¼Œå¦åˆ™å°±ä¼šè°ƒç”¨takeä¸€ç›´é˜»å¡ç­‰å¾…ä»»åŠ¡ã€‚ ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:4:6","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"retryæ ‡è®° ä¸Šé¢çš„addWorkæ–¹æ³•ä¸­å‡ºç°äº†retry:æ ‡è®°ï¼Œè¿™ä¸ªæ ‡è®°ä¸»è¦æ˜¯ç”¨äºåœ¨å¤šé‡å¾ªç¯ä¸­æ ‡è®°éœ€è¦ä¸­æ–­çš„å¾ªç¯å±‚ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶ä»–å­—æ¯+ï¼šçš„æ–¹å¼ï¼š //å£°æ˜ä¸­æ–­æ ‡è®° aaa: //ç¬¬ä¸€å±‚å¾ªç¯f1 for (int i = 0; i \u003c 100; i++) { //ç¬¬äºŒå±‚å¾ªç¯f2 for (int j = 0; j \u003c 200; j++) { ifï¼ˆj == 100) //å°†ä½¿f1è·³è¿‡å¹¶ç»§ç»­ continue aaa; } } ","date":"2021-03-18","objectID":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/:5:0","series":null,"tags":null,"title":"Javaçº¿ç¨‹æ± ","uri":"/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"},{"categories":null,"content":"ç”¨æ³• // æ­¥éª¤1ï¼šåˆ›å»ºHandlerThreadå®ä¾‹å¯¹è±¡ // ä¼ å…¥å‚æ•° = çº¿ç¨‹åå­—ï¼Œä½œç”¨ = æ ‡è®°è¯¥çº¿ç¨‹ HandlerThread mHandlerThread = new HandlerThread(\"handlerThread\"); // æ­¥éª¤2ï¼šå¯åŠ¨çº¿ç¨‹ mHandlerThread.start(); // æ­¥éª¤3ï¼šåˆ›å»ºå·¥ä½œçº¿ç¨‹Handler \u0026 å¤å†™handleMessageï¼ˆï¼‰ // ä½œç”¨ï¼šå…³è”HandlerThreadçš„Looperå¯¹è±¡ã€å®ç°æ¶ˆæ¯å¤„ç†æ“ä½œ \u0026 ä¸å…¶ä»–çº¿ç¨‹è¿›è¡Œé€šä¿¡ // æ³¨ï¼šæ¶ˆæ¯å¤„ç†æ“ä½œï¼ˆHandlerMessageï¼ˆï¼‰ï¼‰çš„æ‰§è¡Œçº¿ç¨‹ = mHandlerThreadæ‰€åˆ›å»ºçš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡Œ Handler workHandler = new Handler(mHandlerThread.getLooper()) { @Override public void handleMessage(@NonNull Message msg) { super.handleMessage(msg); Log.d(\"handler\", \"æ”¶åˆ°æ¶ˆæ¯: \" + msg.obj); // æ³¨æ„ï¼Œä¸èƒ½åœ¨æ­¤å¤„ä¿®æ”¹UI,å› ä¸ºworkHandlerè¿˜æ˜¯ä½äºå·¥ä½œçº¿ç¨‹ï¼Œéœ€è¦åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å»ä¿®æ”¹UI } }; Message msg = Message.obtain(workHandler); msg.obj = \"æˆ‘å‘äº†ä¸€æ¡æ¶ˆæ¯\"; // æ¶ˆæ¯çš„å­˜æ”¾ msg.sendToTarget(); // æ­¥éª¤5ï¼šç»“æŸçº¿ç¨‹ï¼Œå³åœæ­¢çº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯ mHandlerThread.quit(); ","date":"2021-03-18","objectID":"/handlerthread%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":null,"title":"HandlerThreadè§£è¯»","uri":"/handlerthread%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åŸç† //ç»§æ‰¿Threadï¼Œæœ¬èº«å°±æ˜¯çº¿ç¨‹ public class HandlerThread extends Thread { int mPriority; int mTid = -1; //å†…éƒ¨æŒæœ‰looper Looper mLooper; //å†…éƒ¨æŒæœ‰handler private @Nullable Handler mHandler; public HandlerThread(String name) { super(name); mPriority = Process.THREAD_PRIORITY_DEFAULT; } public HandlerThread(String name, int priority) { super(name); mPriority = priority; } /** * Call back method that can be explicitly overridden if needed to execute some * setup before Looper loops. */ protected void onLooperPrepared() { } @Override public void run() { //Processæ˜¯è¿›ç¨‹çš„å¸®åŠ©ç±»ï¼Œå¯æä¾›è¿›ç¨‹ä¿¡æ¯ mTid = Process.myTid(); //åˆå§‹åŒ–loop Looper.prepare(); synchronized (this) { mLooper = Looper.myLooper(); //å®Œæˆä¹‹åå”¤é†’éœ€è¦ä½¿ç”¨looperçš„çº¿ç¨‹ï¼Œä¸»è¦æ˜¯é’ˆå¯¹getLooper()æ–¹æ³• notifyAll(); } Process.setThreadPriority(mPriority); onLooperPrepared(); //å¼€å¯å¾ªç¯ Looper.loop(); mTid = -1; } public Looper getLooper() { if (!isAlive()) { return null; } // ç¡®ä¿Looperä¸€å®šèƒ½å®ä¾‹åŒ– synchronized (this) { // è‡ªæ—‹ while (isAlive() \u0026\u0026 mLooper == null) { try { // é˜»å¡è°ƒç”¨çš„çº¿ç¨‹ï¼Œç›´åˆ°runæ–¹æ³•ä¸­looperåˆå§‹åŒ–å®Œæˆ wait(); } catch (InterruptedException e) { } } } return mLooper; } //åˆå§‹åŒ–å†…éƒ¨Handlerï¼Œä½†æ˜¯å¤–éƒ¨ä¸èƒ½è°ƒç”¨æ­¤æ–¹æ³• @NonNull public Handler getThreadHandler() { if (mHandler == null) { mHandler = new Handler(getLooper()); } return mHandler; } //å…³é—­ public boolean quit() { Looper looper = getLooper(); if (looper != null) { looper.quit(); return true; } return false; } //å®‰å…¨å…³é—­ public boolean quitSafely() { Looper looper = getLooper(); if (looper != null) { looper.quitSafely(); return true; } return false; } //è¿”å›çº¿ç¨‹id public int getThreadId() { return mTid; } } ","date":"2021-03-18","objectID":"/handlerthread%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":null,"title":"HandlerThreadè§£è¯»","uri":"/handlerthread%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ€»ç»“ HandlerThreadæœ¬èº«å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œåªä¸è¿‡å®ƒæŒæœ‰Looper,åœ¨run()æ–¹æ³•å†…éƒ¨å®ç°äº†Looper.prepary()å’ŒLooper.loop()ã€‚æ‰€ä»¥ä»»åŠ¡ä¹Ÿåªèƒ½ä¸²è¡Œã€‚ ç”±äºLooperæ˜¯å¼‚æ­¥åˆ›å»ºçš„ï¼Œé€šè¿‡é”æœºåˆ¶é…åˆwait/notifyAllå®ç°äº†ä¸€ä¸ªé˜»å¡å”¤é†’æœºåˆ¶ï¼Œä¿è¯Looperåœ¨å¼‚æ­¥çŠ¶æ€ä¸‹å¿…å®šèƒ½åˆ›å»ºæˆåŠŸã€‚ ä½¿ç”¨å®Œè¦æ‰‹åŠ¨é€€å‡ºï¼Œå¦åˆ™çº¿ç¨‹ä¸€ç›´å­˜åœ¨ã€‚ ","date":"2021-03-18","objectID":"/handlerthread%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":null,"title":"HandlerThreadè§£è¯»","uri":"/handlerthread%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä½¿ç”¨ public class MainActivity extends AppCompatActivity { TextView tv; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); tv = findViewById(R.id.tv); } public void start(View v) { MyTask task = new MyTask(this.tv); task.execute(\"æˆ‘æ˜¯\"); } @SuppressWarnings(\"deprecation\") private static class MyTask extends AsyncTask\u003cString, Float, String\u003e { WeakReference\u003cTextView\u003e tv; MyTask(TextView tv) { this.tv = new WeakReference\u003cTextView\u003e(tv); } @Override protected void onPreExecute() { super.onPreExecute(); // ä»»åŠ¡æ‰§è¡Œå‰å›è°ƒ tv.get().setText(\"å³å°†å¼€å§‹ä»»åŠ¡\"); } @Override protected String doInBackground(String... strings) { //åå°ä»»åŠ¡é€»è¾‘ if (strings.length \u003e 0) { try { for (int i = 0; i \u003c 5; i++) { Thread.sleep(2000L); //æŠ¥å‘Šè¿›åº¦ publishProgress(0.2f * (i+1)); } } catch (InterruptedException e) { e.printStackTrace(); } return strings[0] + \"ç»“æœ\"; } return null; } @Override protected void onProgressUpdate(Float... values) { super.onProgressUpdate(values); tv.get().setText(\"ä»»åŠ¡å·²æ‰§è¡Œ\"+values[0]); } @Override protected void onPostExecute(String s) { super.onPostExecute(s); //åˆ·æ–°UI tv.get().setText(s); } } } å‡ ä¸ªé‡è¦æ–¹æ³•ï¼š æ–¹æ³• çº¿ç¨‹ æ‰§è¡Œ onPreExecute ä¸»çº¿ç¨‹ ä»»åŠ¡å¼€å§‹å‰æ‰§è¡Œ doInBackground å­çº¿ç¨‹ åå°ä»»åŠ¡æ‰§è¡Œæ—¶è°ƒç”¨ onProgressUpdate ä¸»çº¿ç¨‹ publishProgressè°ƒç”¨æ—¶å›è°ƒ onPostExecute ä¸»çº¿ç¨‹ ä»»åŠ¡å®Œæˆåè°ƒç”¨ onCancelled ä¸»çº¿ç¨‹ cancellè°ƒç”¨æ—¶å›è°ƒ æ ¸å¿ƒå°±è¿™å‡ ä¸ªæ–¹æ³•ï¼Œåªæœ‰doInBackgroundåœ¨å­çº¿ç¨‹ä¸­è°ƒç”¨ã€‚ç„¶ååˆ›å»ºä¸€ä¸ªAsyncTaskçš„å®ä¾‹ï¼Œæ‰§è¡Œexecuteæ–¹æ³•ï¼Œå¹¶ä¼ å…¥ç›¸åº”å‚æ•°å°±å¼€å§‹æ‰§è¡Œäº†ã€‚ åŒæ—¶ä¸ºé¿å…å†…å­˜æ³„éœ²ï¼Œéœ€è¦ç”¨å¼±å¼•ç”¨å…³è”UIã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åŸç† ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ„é€ æ–¹æ³• public AsyncTask() { this((Looper) null); } public AsyncTask(@Nullable Handler handler) { this(handler != null ? handler.getLooper() : null); } /** * æœ€ç»ˆæ„é€ æ–¹æ³• **/ public AsyncTask(@Nullable Looper callbackLooper) { //æ‹¿åˆ°Handlerï¼Œé»˜è®¤æ‹¿åˆ°ä¸»çº¿ç¨‹Handler mHandler = callbackLooper == null || callbackLooper == Looper.getMainLooper() ? getMainHandler() : new Handler(callbackLooper); //å®šä¹‰Callableï¼Œå…¶ä¸­è°ƒç”¨äº†doInBackgroundæ–¹æ³• mWorker = new WorkerRunnable\u003cParams, Result\u003e() { public Result call() throws Exception { mTaskInvoked.set(true); Result result = null; try { Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //è°ƒç”¨doInBackground result = doInBackground(mParams); Binder.flushPendingCommands(); } catch (Throwable tr) { mCancelled.set(true); throw tr; } finally { //å‘é€Message postResult(result); } return result; } }; //ç”¨FutureTaskåŒ…è£…Callableï¼Œæä¾›å¯åŠ¨ã€å–æ¶ˆã€ç›‘å¬åŠŸèƒ½ mFuture = new FutureTask\u003cResult\u003e(mWorker) { @Override protected void done() { try { postResultIfNotInvoked(get()); } catch (InterruptedException e) { android.util.Log.w(LOG_TAG, e); } catch (ExecutionException e) { throw new RuntimeException(\"An error occurred while executing doInBackground()\", e.getCause()); } catch (CancellationException e) { postResultIfNotInvoked(null); } } }; } ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒAsyncçš„ä¸»è¦æµç¨‹åœ¨æ„é€ æ–¹æ³•ä¸­å°±å·²ç»å®šä¹‰å¥½äº†ã€‚ å…¶ä¸­æœ‰ä¸ªmWorkeræ˜¯WorkerRunnableç±»å‹ï¼š private static abstract class WorkerRunnable\u003cParams, Result\u003e implements Callable\u003cResult\u003e { Params[] mParams; } æŸ¥çœ‹æºç æ‰å‘ç°ï¼Œè¿™ç©æ„å¹¶ä¸æ˜¯ä¸€ä¸ªRunnableï¼Œè€Œæ˜¯ä¸ªCallableï¼Œgoogleè·Ÿæˆ‘å¼€äº†ä¸ªç©ç¬‘ã€‚ æ¥ä¸‹æ¥å°±æ˜¯ç”¨FutureTaskåŒ…è£…Callableï¼Œè¿™æ ·å°±å¯ä»¥å…·å¤‡å¯åŠ¨ã€å–æ¶ˆã€å®Œæˆç›‘å¬åŠŸèƒ½ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å»çœ‹executeæ–¹æ³•ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:1","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"execute //é™æ€finalç±»å‹çš„çº¿ç¨‹æ±  public static final Executor SERIAL_EXECUTOR = new SerialExecutor(); //é»˜è®¤çš„çº¿ç¨‹æ±  private static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR; @MainThread public final AsyncTask\u003cParams, Progress, Result\u003e execute(Params... params) { return executeOnExecutor(sDefaultExecutor, params); } //æ–¹æ³•é‡è½½ @MainThread public static void execute(Runnable runnable) { sDefaultExecutor.execute(runnable); } è¿™é‡Œå¯ä»¥çœ‹å‡ºexecuteæ–¹æ³•åªèƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ã€‚è¿™å°±æ˜¯AsyncTaskçš„å±€é™æ€§äº†ï¼šåªèƒ½ç”¨äºä¸»çº¿ç¨‹ã€‚ executeOnExecutoræ–¹æ³•ä¼ å…¥äº†é»˜è®¤çš„çº¿ç¨‹æ± ã€‚è¿™ä¸ªçº¿ç¨‹æ± æ˜¯åœ¨AsyncTaskç±»é¦–æ¬¡åŠ è½½æ—¶åˆå§‹åŒ–çš„ã€‚å®ƒæ˜¯ä¸ªstatic finalç±»å‹ã€‚ @MainThread public final AsyncTask\u003cParams, Progress, Result\u003e executeOnExecutor(Executor exec, Params... params) { if (mStatus != Status.PENDING) { switch (mStatus) { case RUNNING: throw new IllegalStateException(\"Cannot execute task:\" + \" the task is already running.\"); case FINISHED: throw new IllegalStateException(\"Cannot execute task:\" + \" the task has already been executed \" + \"(a task can be executed only once)\"); } } //æ”¹çŠ¶æ€ mStatus = Status.RUNNING; //åœ¨MainThreadå›è°ƒonPreExecute onPreExecute(); mWorker.mParams = params; //çœŸæ­£çš„æ‰§è¡Œä»»åŠ¡ exec.execute(mFuture); return this; } ä»switchåˆ¤æ–­å¯ä»¥çŸ¥é“ï¼ŒAsyncTaskæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸èƒ½å¤ç”¨ï¼Œåªæœ‰PENDINGçŠ¶æ€çš„AsyncTaskæ‰èƒ½è¿è¡Œã€‚è€ŒçŠ¶æ€æ˜¯åœ¨ç±»åŠ è½½æ—¶å®šä¹‰çš„ï¼Œè€Œä¸”ä¸æ”¯æŒä¿®æ”¹ï¼š @UnsupportedAppUsage private volatile Status mStatus = Status.PENDING; åœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œé¦–å…ˆæ”¹å˜äº†å…¨å±€çš„çŠ¶æ€ä¸ºã€Œæ‰§è¡Œä¸­ã€ï¼Œç„¶åé€šè¿‡exec.execute(mFuture)çœŸæ­£å¼€å§‹æ‰§è¡Œçº¿ç¨‹ã€‚åœ¨è¿™é‡ŒæŸ¥çœ‹æºç ï¼Œå‘ç°FutureTaskè¿™ä¸ªç±»åŒæ—¶éµå¾ªRunnableå’ŒFutureæ¥å£ï¼Œæ‰€ä»¥ä»–å¯ä»¥è¢«çº¿ç¨‹æ± executeï¼Œä¹Ÿèƒ½æ¥æ”¶åˆ°callableçš„è¿”å›å€¼ã€‚è¿™ä¹Ÿæ˜¯Callableè½¬Runnableçš„ä¸€ç§æ–¹å¼ã€‚ ç„¶åæ¥çœ‹AsyncTaskçš„ä¸‰ç§çŠ¶æ€ï¼š public enum Status { //æœªæ‰§è¡Œ PENDING, //æ‰§è¡Œä¸­ RUNNING, //æ‰§è¡Œå®Œ FINISHED, } ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:2","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"publishProgress @WorkerThread protected final void publishProgress(Progress... values) { if (!isCancelled()) { getHandler().obtainMessage(MESSAGE_POST_PROGRESS, new AsyncTaskResult\u003cProgress\u003e(this, values)).sendToTarget(); } } æŠ¥å‘Šæ¶ˆæ¯æ˜¯åŸºäºHandler+messageçš„å½¢å¼å®ç°çš„ã€‚ è¿™ä¸ªæ¶ˆæ¯çš„whatæ˜¯MESSAGE_POST_PROGRESSè¿™ä¸ªå¸¸é‡ã€‚objæ˜¯newäº†ä¸€ä¸ªAsyncTaskResult\u003cProgress\u003e(this, values)ï¼š private static class AsyncTaskResult\u003cData\u003e { final AsyncTask mTask; final Data[] mData; AsyncTaskResult(AsyncTask task, Data... data) { mTask = task; mData = data; } } æ¥æ”¶æ¶ˆæ¯çš„Handlerï¼Œä¾é è¿™ä¸ªHandleråˆ‡æ¢å›ä¸»çº¿ç¨‹: private static class InternalHandler extends Handler { public InternalHandler(Looper looper) { super(looper); } @SuppressWarnings({\"unchecked\", \"RawUseOfParameterizedType\"}) @Override public void handleMessage(Message msg) { AsyncTaskResult\u003c?\u003e result = (AsyncTaskResult\u003c?\u003e) msg.obj; switch (msg.what) { case MESSAGE_POST_RESULT: // There is only one result result.mTask.finish(result.mData[0]); break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); break; } } } ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:3","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"onPostExecute è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æ„é€ æ–¹æ³•çš„WorkerRunnableä¸­çš„é€»è¾‘æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åfinallyé‡Œé¢è°ƒç”¨çš„ã€‚ mWorker = new WorkerRunnable\u003cParams, Result\u003e() { public Result call() throws Exception { mTaskInvoked.set(true); Result result = null; try { Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //noinspection unchecked result = doInBackground(mParams); Binder.flushPendingCommands(); } catch (Throwable tr) { mCancelled.set(true); throw tr; } finally { postResult(result); } return result; } }; åœ¨è¿™ä¸ªæ–¹æ³•å½“ç„¶ä¹Ÿæ˜¯é€šè¿‡å‘é€æ¶ˆæ¯çš„æ–¹å¼è¾¾åˆ°çº¿ç¨‹é—´é€šä¿¡çš„ç›®çš„ï¼š private Result postResult(Result result) { @SuppressWarnings(\"unchecked\") Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult\u003cResult\u003e(this, result)); message.sendToTarget(); return result; } æœ€ååœ¨Handlerçš„handleMessageä¸­é€šè¿‡whatåšåˆ¤æ–­ï¼Œå¦‚æœæ˜¯postResultï¼Œå°±è°ƒç”¨finish()æ–¹æ³•ï¼š private void finish(Result result) { if (isCancelled()) { onCancelled(result); } else { onPostExecute(result); } mStatus = Status.FINISHED; } AsyncTaskçš„æµç¨‹å·²ç»é€šäº†ï¼Œæœ€åå†æ¥çœ‹ä¸€ä¸‹å®ƒæ˜¯æ€ä¹ˆç©çº¿ç¨‹æ± çš„ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:4","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"AsyncTaskå·¥ä½œçº¿ç¨‹æ± çš„å®ç° å®ƒè¿™é‡Œæ˜¯è‡ªå®šä¹‰äº†ä¸€ä¸ªçº¿ç¨‹æ± ä»£ç†ï¼š private static class SerialExecutor implements Executor { //å¯ä½œä¸ºæ ˆæˆ–é˜Ÿåˆ—ä½¿ç”¨ï¼Œæ€§èƒ½è¾ƒé«˜ final ArrayDeque\u003cRunnable\u003e mTasks = new ArrayDeque\u003cRunnable\u003e(); Runnable mActive; public synchronized void execute(final Runnable r) { //åœ¨é˜Ÿå°¾æ·»åŠ å…ƒç´  mTasks.offer(new Runnable() { public void run() { try { r.run(); } finally { scheduleNext(); } } }); if (mActive == null) { scheduleNext(); } } protected synchronized void scheduleNext() { //poll()æ‹¿å‡ºé˜Ÿé¦–å…ƒç´  if ((mActive = mTasks.poll()) != null) { THREAD_POOL_EXECUTOR.execute(mActive); } } } è¿™è´§å®é™…ä¸Šæ˜¯THREAD_POOL_EXECUTORè¿™ä¸ªçº¿ç¨‹æ± çš„ä»£ç†ï¼Œä½œç”¨å°±æ˜¯ç»´æŠ¤ä»»åŠ¡é˜Ÿåˆ—ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:5","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"çº¿ç¨‹æ± å‚æ•° //æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œä¸€ç›´å¤„äºæ´»åŠ¨çŠ¶æ€ private static final int CORE_POOL_SIZE = 1; //æœ€å¤§çº¿ç¨‹æ•°ï¼Œå½“ä¸€ä¸ªä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ä¸­æ—¶ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¾¾åˆ°äº†æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¹¶ä¸”ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ï¼Œä¸èƒ½å†å‘ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä»»åŠ¡æ—¶ï¼Œè¿™æ—¶ä¼šæ£€æŸ¥ä»»åŠ¡æ˜¯å¦è¾¾åˆ°äº†æœ€å¤§çº¿ç¨‹æ•°ï¼Œå¦‚æœæœªè¾¾åˆ°ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œå¦åˆ™ï¼Œæ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚ private static final int MAXIMUM_POOL_SIZE = 20; //æ´»è·ƒæ—¶é—´ï¼Œçº¿ç¨‹æ± ä¸­å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°çš„é‚£éƒ¨åˆ†çº¿ç¨‹ï¼Œåœ¨æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œåœ¨çº¿ç¨‹æ± ä¸­å­˜æ´»çš„æ—¶é—´ private static final int KEEP_ALIVE_SECONDS = 3; //çº¿ç¨‹å·¥å‚ private static final ThreadFactory sThreadFactory = new ThreadFactory() { private final AtomicInteger mCount = new AtomicInteger(1); public Thread newThread(Runnable r) { return new Thread(r, \"AsyncTask #\" + mCount.getAndIncrement()); } }; public static final Executor THREAD_POOL_EXECUTOR; static { ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE_SECONDS, TimeUnit.SECONDS, new SynchronousQueue\u003cRunnable\u003e(), sThreadFactory); threadPoolExecutor.setRejectedExecutionHandler(sRunOnSerialPolicy); THREAD_POOL_EXECUTOR = threadPoolExecutor; } é¦–å…ˆæ‰§è¡Œè¿™ä¸ªé™æ€ä»£ç å—ï¼Œåˆå§‹åŒ–çº¿ç¨‹æ± ã€‚ æˆ‘ä»¬çœ‹è¿™é‡Œçš„çº¿ç¨‹æ± æœ€å¤§æ ¸å¿ƒæ•°åªæœ‰1ï¼Œé‚£å°±æ˜¯åªèƒ½ä¸²è¡Œï¼Œæœ€å¤§çº¿ç¨‹æ•°20ï¼Œæœ€å¤šèƒ½æœ‰19ä¸ªçº¿ç¨‹æ’é˜Ÿç­‰å¾…ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:6","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥ //æ ¸å¿ƒçº¿ç¨‹æ•°\u0026æœ€å¤§çº¿ç¨‹æ•° private static final int BACKUP_POOL_SIZE = 5; private static final RejectedExecutionHandler sRunOnSerialPolicy = new RejectedExecutionHandler() { public void rejectedExecution(Runnable r, ThreadPoolExecutor e) { android.util.Log.w(LOG_TAG, \"Exceeded ThreadPoolExecutor pool size\"); synchronized (this) { if (sBackupExecutor == null) { sBackupExecutorQueue = new LinkedBlockingQueue\u003cRunnable\u003e(); sBackupExecutor = new ThreadPoolExecutor( BACKUP_POOL_SIZE, BACKUP_POOL_SIZE, KEEP_ALIVE_SECONDS, TimeUnit.SECONDS, sBackupExecutorQueue, sThreadFactory); sBackupExecutor.allowCoreThreadTimeOut(true); } } sBackupExecutor.execute(r); } }; å¦‚æœè¢«æ‹’ç»ï¼Œå°±æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± å»æ‰§è¡Œï¼Œè¿™éƒ½å¯ä»¥ï¼Ÿ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:2:7","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ€»ç»“ AsyncTaskç±»é¦–æ¬¡åŠ è½½çš„æ—¶å€™åˆå§‹åŒ–ä¸¤ä¸ªé™æ€çš„çº¿ç¨‹æ± ï¼ŒSerialExecutoræ˜¯ä¸ªä»£ç†ï¼Œå†…éƒ¨ç»´æŠ¤ç€Runnableé˜Ÿåˆ—ï¼Œå®é™…é€šè¿‡è°ƒç”¨threadPoolExecutoræ¥æ‰§è¡Œä»»åŠ¡ã€‚ç”±äºçº¿ç¨‹æ± ä¸èƒ½ä¿è¯çº¿ç¨‹æ‰§è¡Œçš„å…ˆåï¼Œæ‰€ä»¥AsyncTaské€šè¿‡åŠ å…¥å¤–éƒ¨é˜Ÿåˆ—çš„æ–¹å¼ä¿éšœäº†ä»»åŠ¡æ‰§è¡Œçš„é¡ºåºã€‚ AsyncTaskçš„æ„é€ æ–¹æ³•å†…éƒ¨åˆå§‹åŒ–äº†Callableï¼ŒAsyncTaskçš„ä¸»è¦æµç¨‹éƒ½å®šä¹‰åœ¨Callableçš„call()æ–¹æ³•å†…éƒ¨ï¼Œç„¶åé€šè¿‡FutureTaskåŒ…è£…Callableè½¬æ¢ä¸ºRunnableä¼ ç»™çº¿ç¨‹æ± æ‰§è¡Œï¼ŒåŒæ—¶å¯ä»¥å–æ¶ˆä»»åŠ¡æˆ–è€…è·å–è¿”å›å€¼ï¼Œæœ€åé€šè¿‡å†…éƒ¨çš„Handlerå‘é€æ¶ˆæ¯åˆ‡æ¢å›ä¸»çº¿ç¨‹ã€‚ ç”±äºå†…éƒ¨çš„Handleråœ¨åˆ›å»ºæ—¶ä¼ å…¥Looper.getMainLooper()ï¼Œæ‰€ä»¥é»˜è®¤çº¿ç¨‹å°±æ˜¯ä¸»çº¿ç¨‹ï¼Œå¹¶ä¸”execute()æ–¹æ³•å¸¦æœ‰@MainThreadæ³¨è§£ï¼Œå¯¼è‡´AsyncTaskåªèƒ½åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ã€‚ AsyncTaskåˆå§‹åŒ–æ—¶çŠ¶æ€ä¸ºpendingï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å˜æ¢ä¸ºRunningæˆ–finishedï¼Œä¸å¯æ‰‹åŠ¨æ›´æ”¹çŠ¶æ€ï¼Œå¯¼è‡´AsyncTaskä¸èƒ½å¤ç”¨ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å¦‚ä½•æ­£ç¡®é…ç½®çº¿ç¨‹æ± çš„å‚æ•° å‰é¢æˆ‘ä»¬è®²åˆ°äº†æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æ± æ¶‰åŠåˆ°çš„å‡ ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦å¦‚ä½•è®¾ç½®è¿™äº›å‚æ•°æ‰ç®—æ˜¯æ­£ç¡®çš„åº”ç”¨å‘¢ï¼Ÿå®é™…ä¸Šï¼Œéœ€è¦æ ¹æ®ä»»åŠ¡çš„ç‰¹æ€§æ¥åˆ†æã€‚ ä»»åŠ¡çš„æ€§è´¨ï¼šCPUå¯†é›†å‹ã€IOå¯†é›†å‹å’Œæ··æ‚å‹ ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼šé«˜ä¸­ä½ ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´ï¼šé•¿ä¸­çŸ­ ä»»åŠ¡çš„ä¾èµ–æ€§ï¼šæ˜¯å¦ä¾èµ–æ•°æ®åº“æˆ–è€…å…¶ä»–ç³»ç»Ÿèµ„æº ä¸åŒçš„æ€§è´¨çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬é‡‡å–çš„é…ç½®å°†æœ‰æ‰€ä¸åŒã€‚åœ¨ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®è·µã€‹ä¸­æœ‰ç›¸åº”çš„è®¡ç®—å…¬å¼ã€‚ é€šå¸¸æ¥è¯´ï¼Œå¦‚æœä»»åŠ¡å±äºCPUå¯†é›†å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†çº¿ç¨‹æ± æ•°é‡è®¾ç½®æˆCPUçš„ä¸ªæ•°ï¼Œä»¥å‡å°‘çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœä»»åŠ¡å±äºIOå¯†é›†å‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†çº¿ç¨‹æ± æ•°é‡è®¾ç½®å¾—æ›´å¤šä¸€äº›ï¼Œæ¯”å¦‚CPUä¸ªæ•°*2ã€‚ PSï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡Runtime.getRuntime().availableProcessors()æ¥è·å–CPUçš„ä¸ªæ•°ã€‚ ä½œè€…ï¼šjuconcurrent é“¾æ¥ï¼šhttps://www.jianshu.com/p/7ab4ae9443b9 æ¥æºï¼šç®€ä¹¦ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ ","date":"2021-03-17","objectID":"/asynctask%E8%A7%A3%E8%AF%BB/:3:1","series":null,"tags":["Android","AsyncTask"],"title":"AsyncTaskè§£è¯»","uri":"/asynctask%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä»Setæ–¹æ³•å…¥æ‰‹ public void set(T value) { Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) map.set(this, value); else createMap(t, value); } void createMap(Thread t, T firstValue) { t.threadLocals = new ThreadLocalMap(this, firstValue); } ThreadLocalMap getMap(Thread t) { return t.threadLocals; } ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒthreadLocalçš„æ ¸å¿ƒå…¶å®æ˜¯ThreadLocalMapå¯¹è±¡ã€‚ setæ–¹æ³•çš„ä½œç”¨æ˜¯åˆå§‹åŒ–å†…éƒ¨çš„ThreadLocalMapï¼Œå¹¶å°†å…ƒç´ æ”¾å…¥ThreadLocalMapä¸­æš‚å­˜ï¼Œå½“å‰çš„ThreadLocalå¯¹è±¡ä¸ºkeyã€‚ ç„¶åå…³æ³¨createMap()æ–¹æ³•ï¼š void createMap(Thread t, T firstValue) { t.threadLocals = new ThreadLocalMap(this, firstValue); } ThreadLocalMap(ThreadLocal\u003c?\u003e firstKey, Object firstValue) { table = new Entry[INITIAL_CAPACITY]; int i = firstKey.threadLocalHashCode \u0026 (INITIAL_CAPACITY - 1); table[i] = new Entry(firstKey, firstValue); size = 1; setThreshold(INITIAL_CAPACITY); } æ¯ä¸ªçº¿ç¨‹ä¸­éƒ½æœ‰ä¸€ä¸ªthreadLocalså¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨createMap()æ–¹æ³•æ—¶éƒ½ä¼šç»™çº¿ç¨‹çš„threadLocalsåˆ›å»ºä¸€ä¸ªæ–°çš„ThreadLocalMapï¼Œé‚£ä¹ˆæ¯æ¬¡è°ƒç”¨set()æ–¹æ³•ï¼Œå…¶å®æ˜¯setç»™å½“å‰çº¿ç¨‹çš„ThreadLocalMapã€‚ ç»“è®ºï¼šThreadLocalçš„setæ–¹æ³•å…¶å®æ˜¯æŠŠå€¼å­˜åˆ°äº†å½“å‰çº¿ç¨‹å†…éƒ¨çš„threadLocalsï¼Œè€ŒthreadLocalsæ˜¯ä¸€ä¸ªThreadLocalMapç±»å‹çš„mapï¼ˆmapåµŒå¥—ï¼‰ï¼Œkeyå°±æ˜¯å½“å‰çš„ThreadLocalã€‚ ","date":"2021-03-17","objectID":"/threadlocal%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":null,"title":"ThreadLocalè§£è¯»","uri":"/threadlocal%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Get public T get() { Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) { ThreadLocalMap.Entry e = map.getEntry(this); if (e != null) { @SuppressWarnings(\"unchecked\") T result = (T)e.value; return result; } } return setInitialValue(); } //ThreadLocalå†…éƒ¨æ–¹æ³• private Entry getEntry(ThreadLocal\u003c?\u003e key) { int i = key.threadLocalHashCode \u0026 (table.length - 1); Entry e = table[i]; if (e != null \u0026\u0026 e.get() == key) return e; else return getEntryAfterMiss(key, i, e); } private T setInitialValue() { T value = initialValue(); Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) map.set(this, value); else createMap(t, value); return value; } ","date":"2021-03-17","objectID":"/threadlocal%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":null,"title":"ThreadLocalè§£è¯»","uri":"/threadlocal%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ThreadLocalMap ThreadLocalMapå…¶å®æ˜¯ä¸ªç®€åŒ–çš„HashMapï¼Œå†…éƒ¨æ˜¯ä¸ªEntryç±»å‹çš„æ•°ç»„ã€‚ static class Entry extends WeakReference\u003cThreadLocal\u003c?\u003e\u003e { /** The value associated with this ThreadLocal. */ Object value; Entry(ThreadLocal\u003c?\u003e k, Object v) { super(k); value = v; } } ","date":"2021-03-17","objectID":"/threadlocal%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":null,"title":"ThreadLocalè§£è¯»","uri":"/threadlocal%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"çœŸçš„çº¿ç¨‹å®‰å…¨ï¼Ÿ å¤§éƒ¨åˆ†åšå®¢éƒ½è¯´ThreadLocalæ˜¯æŠŠå˜é‡åœ¨æ¯ä¸ªçº¿ç¨‹ç”Ÿæˆå˜é‡å‰¯æœ¬ï¼Œçº¿ç¨‹åªèƒ½æ“ä½œå±äºè‡ªå·±çš„å‰¯æœ¬ï¼Œä»è€Œä¸ä¼šç›¸äº’å½±å“ï¼Œå¹¶ä¸”çº¿ç¨‹å®‰å…¨ã€‚ ä½†æ˜¯æˆ‘ç¿»æ¥è¦†å»çš„çœ‹ä»£ç ï¼Œä¹Ÿæ²¡æœ‰çœ‹åˆ°æ‰“ç ´å¼•ç”¨çš„ä»£ç å•Šï¼Œæ²¡æœ‰cloneï¼Œæ²¡æœ‰newï¼Œé‚£æ€ä¹ˆèƒ½å«å‰¯æœ¬å‘¢ï¼Ÿé‚£åº”è¯¥ä¸ç®¡æ€ä¹ˆèµ‹å€¼ï¼Œéƒ½æ˜¯å…±äº«å˜é‡çš„å¼•ç”¨æ‰å¯¹å•Šã€‚é‚£ä¹ˆåœ¨ä¸åŒçº¿ç¨‹ä¸­æ“ä½œåŒä¸€å…±äº«å˜é‡ï¼Œåˆæ²¡åŠ é”ï¼Œè¿˜è°ˆä»€ä¹ˆçº¿ç¨‹å®‰å…¨ï¼Ÿ é‚£å°±å†™ä¸ªä¾‹å­æ¥å°è¯ä¸€ä¸‹ï¼š public class MainActivity extends AppCompatActivity { //éšä¾¿åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ±  private final ThreadPoolExecutor tpe = new ThreadPoolExecutor(8, 8, 1, TimeUnit.SECONDS, new LinkedBlockingDeque\u003cRunnable\u003e()); @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); } //ç‚¹å‡»æŒ‰é’®åè®©çº¿ç¨‹æ± æ‰§è¡Œä¸¤ä¸ªä»»åŠ¡ Data data; public void start(View v) { data = new Data(); tpe.execute(new MyRunnable1(data)); tpe.execute(new MyRunnable2(data)); } //ç­‰10ç§’ä¹‹åç‚¹ç¬¬äºŒä¸ªæŒ‰é’®å±•ç¤ºç»“æœ public void toastResult(View v) { Log.d(\"æˆ‘è¯•è¯•\", \"toastResult: \" + data); Toast.makeText(this, \"toastResult: \" + data, Toast.LENGTH_SHORT).show(); } //ä»»åŠ¡1 static class MyRunnable1 implements Runnable { private final ThreadLocal\u003cData\u003e mThreadLocal = new ThreadLocal\u003c\u003e(); Data data; MyRunnable1(Data data) { this.data = data; } @Override public void run() { mThreadLocal.set(data); mThreadLocal.get().name = \"æå››\"; mThreadLocal.get().age = 10; try { Thread.sleep(10*1000); Log.d(\"æˆ‘è¯•è¯•\", \"çº¿ç¨‹1ï¼š \" + data); } catch (InterruptedException e) { e.printStackTrace(); } } } // ä»»åŠ¡2 static class MyRunnable2 implements Runnable { private ThreadLocal\u003cData\u003e mThreadLocal = new ThreadLocal\u003c\u003e(); Data data; MyRunnable2(Data data) { this.data = data; } @Override public void run() { try { Thread.sleep(3000); Log.d(\"æˆ‘è¯•è¯•\", \"çº¿ç¨‹2ï¼š\" + data); mThreadLocal.set(data); mThreadLocal.get().name = \"ç‹äº”\"; mThreadLocal.get().age = 20; } catch (InterruptedException e) { e.printStackTrace(); } } } static class Data { int age = 1; String name = \"å¼ ä¸‰\"; Data(int age, String name) { this.age = age; this.name = name; } Data() { } @NonNull @Override public String toString() { return this.name + this.age; } } } ä¸Šé¢ä»£ç çš„é€»è¾‘ï¼šåˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œç„¶ååˆ†åˆ«åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸­ç”¨setè¿›å„è‡ªçš„ThreadLocalï¼Œç„¶ågetå„è‡ªçš„å˜é‡å‰¯æœ¬ï¼Œä¿®æ”¹å€¼ï¼Œæ‰“å°å½“å‰å€¼ã€‚æœ€åç­‰ä¸ª20ç§’ä»¥åç‚¹ä¸€ä¸‹è·å–ç»“æœæŒ‰é’®ã€‚ ä½†æ˜¯å½“æˆ‘æœ€åè·å–ç»“æœçš„æ—¶å€™ï¼Œå‘ç°åŸå§‹çš„Dataæ•°æ®å˜äº†ï¼Œå˜æˆäº†ä»»åŠ¡2ä¸­çš„èµ‹å€¼ç»“æœï¼è€Œä¸”åœ¨ä¸¤ä¸ªä»»åŠ¡æ‰§è¡ŒæœŸé—´ï¼ŒthreadLocal.get()ä¹Ÿèƒ½çœ‹åˆ°å…¶ä»–å˜é‡å¯¹dataçš„ä¿®æ”¹ç»“æœï¼Œæœç„¶è·Ÿæˆ‘çš„çŒœæµ‹ä¸é”™ï¼ é€šè¿‡å°è¯ï¼Œæˆ‘å‘ç°ThreadLocalå¹¶ä¸èƒ½è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¹Ÿå¹¶ä¸æ˜¯ä»€ä¹ˆå…±äº«å˜é‡çš„å‰¯æœ¬ã€‚ä»–çš„ä½œç”¨åªæ˜¯æŠŠæ•°æ®ä¸çº¿ç¨‹ç»‘å®šï¼Œè€Œä¸”é€šè¿‡å¼±å¼•ç”¨çš„æ–¹å¼é¿å…çº¿ç¨‹ä½œç”¨åŸŸå†…çš„å¯¹è±¡å†…å­˜æ³„éœ²ã€‚ ","date":"2021-03-17","objectID":"/threadlocal%E8%A7%A3%E8%AF%BB/:4:0","series":null,"tags":null,"title":"ThreadLocalè§£è¯»","uri":"/threadlocal%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸ºä»€ä¹ˆLooperé‡‡ç”¨ThreadLocalï¼Ÿ å› ä¸ºä¸€èˆ¬æˆ‘ä»¬æ“ä½œçº¿ç¨‹çš„å˜é‡ï¼Œéƒ½è¦åœ¨çº¿ç¨‹é‡Œé¢å»æ”¹å®ƒã€‚æˆ‘ä»¬å¯èƒ½newä¸€ä¸ªThreadæˆ–è€…newä¸€ä¸ªRunnableï¼Œé€šè¿‡æ„é€ æ–¹æ³•æˆ–è€…åœ¨runæ–¹æ³•é‡Œé¢å»å†™å˜é‡èµ‹å€¼ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœä½ æ‹¿ä¸åˆ°çº¿ç¨‹ï¼Œä¸èƒ½ä¿®æ”¹çº¿ç¨‹å‘¢ï¼Ÿæ¯”å¦‚ActivityThreadã€‚ è€ŒLooperçš„æºç é‡Œé¢æ²¡æœ‰ä¸€å¥æ“ä½œçº¿ç¨‹çš„ä»£ç ï¼Œè€Œæ˜¯å·§ç”¨äº†ThreadLocalå®Œæˆäº†Looperè‡ªå·±ä¸çº¿ç¨‹çš„ç»‘å®šï¼ï¼ï¼ æ‰€ä»¥ThreadLocalçš„åº”ç”¨åœºæ™¯æ˜¯ï¼šä¸éœ€è¦åœ¨çº¿ç¨‹ä¸­åšæ“ä½œï¼Œåªéœ€è¦æŠŠå˜é‡ä¸çº¿ç¨‹ç»‘å®šæ—¶å°±ç”¨ThreadLocal!ThreadLocalå°±æ˜¯ä¸ªä¸­ä»‹è€…æ¨¡å¼ï¼ ","date":"2021-03-17","objectID":"/threadlocal%E8%A7%A3%E8%AF%BB/:5:0","series":null,"tags":null,"title":"ThreadLocalè§£è¯»","uri":"/threadlocal%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":" class Data implements Parcelable { /** * å­—æ®µ */ private String name; /** * æ„é€ æ–¹æ³•å†…è¯»å– * @param in */ protected Data(Parcel in) { name = in.readString(); } /** * å†™å…¥ */ @Override public void writeToParcel(Parcel dest, int flags) { dest.writeString(name); } /** * ç”Ÿæˆå™¨å¸¸é‡ */ public static final Creator\u003cData\u003e CREATOR = new Creator\u003cData\u003e() { /** * è°ƒç”¨æ„é€ æ–¹æ³•ç”Ÿæˆä¸€ä¸ªå®ä¾‹ * @param in * @return */ @Override public Data createFromParcel(Parcel in) { return new Data(in); } /** * ç”Ÿæˆå¯¹åº”ç±»å‹çš„æ•°ç»„ * @param size * @return */ @Override public Data[] newArray(int size) { return new Data[size]; } }; @Override public int describeContents() { return 0; } //===========ä»¥ä¸‹æ˜¯getterå’Œsetterè®¿é—®å™¨ public String getName() { return name; } public void setName(String name) { this.name = name; } } Parcelableä½¿ç”¨ï¼š ç»§æ‰¿Parcelableæ¥å£ï¼› å£°æ˜æ„é€ æ–¹æ³•ï¼Œä»Parcelä¸­åºåˆ—åŒ–æ•°æ®ï¼› é‡å†™writeToParcel(Parcel dest, int flags)æ–¹æ³•ï¼Œç”¨æ¥ååºåˆ—åŒ–ï¼› åˆ›å»ºCreator\u003cData\u003eç±»å‹çš„CREATORï¼Œå…¶å†…éƒ¨å®ç°äº†ååºåˆ—åŒ–å¯¹è±¡å’Œæ•°ç»„çš„æ–¹æ³•ï¼› é‡å†™describeContents()æ–¹æ³•ã€‚ ","date":"2021-03-12","objectID":"/parcelable%E8%A7%A3%E8%AF%BB/:0:0","series":null,"tags":["Android"],"title":"Parcelableè§£è¯»","uri":"/parcelable%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Parcel æˆ‘ä»¬çŸ¥é“ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½ç¦»ä¸å¼€Parcelå¯¹è±¡ï¼Œé‚£ä»–æ˜¯ä¸ªå•¥ï¼Ÿ åºåˆ—åŒ–çš„è°ƒç”¨é¡ºåºï¼š //åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»ä¸­ï¼š @Override public void writeToParcel(Parcel dest, int flags) { dest.writeString(name); } //æœ€ç»ˆè°ƒç”¨Parcelç±»ä¸­ï¼š public void writeString16NoHelper(@Nullable String val) { nativeWriteString16(mNativePtr, val); } //æœ¬åœ°JNIæ–¹æ³• @FastNative private static native void nativeWriteString16(long nativePtr, String val); Parcelç”¨æ¥åŒ…è£…æ•°æ®ï¼Œå¹¶ä¸”æä¾›äº†å¤§é‡çš„read/writeæ–¹æ³•ï¼Œæœ€ç»ˆä¼šè°ƒç”¨æœ¬åœ°æ–¹æ³•é€šè¿‡Binderè¯»å†™æ•°æ®åˆ°ä¸€å—å…±äº«å†…å­˜ã€‚ è¿™é‡Œå°±ä¸Serializableæœ‰å¾ˆå¤§çš„ä¸åŒã€‚Serializableçš„åŸç†æ˜¯é€šè¿‡IOå°†æ•°æ®å†™åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ é‚£ä¹ˆè€Œè¿™å¯¹æ¯”ï¼Œè‚¯å®šå†…å­˜çš„è¯»å†™æ€§èƒ½è¦é«˜äºç¡¬ç›˜æ–‡ä»¶ç³»ç»Ÿå•Šï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆParcelableæ¯”Serializableå¿«å¾ˆå¤šçš„åŸå› ã€‚ ","date":"2021-03-12","objectID":"/parcelable%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":["Android"],"title":"Parcelableè§£è¯»","uri":"/parcelable%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Parcelçš„åˆ›å»º //æ± å­å†…æœ€å¤§6ä¸ª private static final int POOL_SIZE = 6; private static final Parcel[] sOwnedPool = new Parcel[POOL_SIZE]; private static final Parcel[] sHolderPool = new Parce[POOL_SIZE]; @NonNull public static Parcel obtain() { final Parcel[] pool = sOwnedPool; synchronized (pool) { Parcel p; for (int i=0; i\u003cPOOL_SIZE; i++) { p = pool[i]; if (p != null) { //æ± å­ä¸­å–å‡ºä¸€ä¸ª pool[i] = null; //é‡ç½®å±æ€§ p.mReadWriteHelper = ReadWriteHelper.DEFAULT; //è¿”å› return p; } } } //å¦‚æœæ± å­æ˜¯ç©ºçš„åˆ™newä¸€ä¸ª return new Parcel(0); } ","date":"2021-03-12","objectID":"/parcelable%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":["Android"],"title":"Parcelableè§£è¯»","uri":"/parcelable%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Parcelçš„å›æ”¶ public final void recycle() { if (DEBUG_RECYCLE) mStack = null; freeBuffer(); final Parcel[] pool; if (mOwnsNativeParcelObject) { pool = sOwnedPool; } else { mNativePtr = 0; pool = sHolderPool; } synchronized (pool) { for (int i=0; i\u003cPOOL_SIZE; i++) { if (pool[i] == null) { pool[i] = this; return; } } } } å•¥æ„æ€å‘¢ï¼Ÿæœ¬æ¥è¿™ä¸ªParcelæ˜¯è‡ªç”±çš„ï¼Œæœ‰ä¸ªæ°‘è­¦åŒå¿—å¸¦ç€è¿™ä¸ªparcelå»çœ‹å®ˆæ‰€è½¬äº†ä¸€åœˆï¼Œä¸€æ—¦å‘ç°æœ‰ç©ºç‰¢æˆ¿ï¼Œå°±æŠŠParcelæ‰”è¿›å»ï¼Œå°±ç®—å›æ”¶äº†ã€‚ç­‰åˆ‘æ»¡ç¤¾ä¼šéœ€è¦Parcelçš„æ—¶å€™å†æ”¾å‡ºæ¥ç»™ç¤¾ä¼šåšè´¡çŒ®ã€‚ ","date":"2021-03-12","objectID":"/parcelable%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":["Android"],"title":"Parcelableè§£è¯»","uri":"/parcelable%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Parcelçš„é”€æ¯ @Override protected void finalize() throws Throwable { if (DEBUG_RECYCLE) { if (mStack != null) { Log.w(TAG, \"Client did not call Parcel.recycle()\", mStack); } } destroy(); } private void destroy() { resetSqaushingState(); if (mNativePtr != 0) { if (mOwnsNativeParcelObject) { nativeDestroy(mNativePtr); updateNativeSize(0); } mNativePtr = 0; } } ç«Ÿç„¶æ˜¯é‡å†™finalize()æ–¹æ³•æ‰‹åŠ¨é”€æ¯çš„ï¼ finalize()æ–¹æ³•ä¼šåœ¨GCæ—¶å›è°ƒï¼Œç”¨æ¥é‡Šæ”¾éJavaå¯¹è±¡ï¼Œæ¯”å¦‚JNIä¸­çš„C/C++å¯¹è±¡ã€‚æ­¤å¤„æ˜¯ä¸ºäº†è°ƒç”¨nativeDestroy(mNativePtr)æ–¹æ³•é‡Šæ”¾æœ¬åœ°C++å¯¹è±¡ã€‚ ","date":"2021-03-12","objectID":"/parcelable%E8%A7%A3%E8%AF%BB/:4:0","series":null,"tags":["Android"],"title":"Parcelableè§£è¯»","uri":"/parcelable%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Binderæ˜¯ä»€ä¹ˆ è¿›ç¨‹é—´é€šè®¯æœºåˆ¶ ç³»ç»Ÿé©±åŠ¨ Binder.javaè·¨è¿›ç¨‹èƒ½åŠ› ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:1:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"ä¸ºä½•è¦å¤šè¿›ç¨‹ ç”³è¯·æ›´å¤šå†…å­˜ å®‰å…¨æ€§éš”ç¦» ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:2:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"Binderçš„ä¼˜åŠ¿ æœºåˆ¶ æ€§èƒ½ ç‰¹ç‚¹ å®‰å…¨æ€§ Binder ä¸€æ¬¡æ‹·è´ CSæ¶æ„æ˜“ç”¨ ä¸ºæ¯ä¸ªAppåˆ†é…UIDï¼Œæ”¯æŒå®åå’ŒåŒ¿å å…±äº«å†…å­˜ é›¶æ‹·è´ æ§åˆ¶å¤æ‚ å·® socket åŒæ‹·è´ CSæ¶æ„ï¼Œä¼ è¾“ç‡ä½å¼€é”€å¤§ å·® ä¿¡å·é‡ åŒæ‹·è´ ç¼“å­˜-è½¬å‘ å·® ç®¡é“ åŒæ‹·è´ ç¼“å­˜-è½¬å‘ å·® ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:3:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"è¿›ç¨‹ä¹‹é—´å¦‚ä½•é€šè®¯ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:4:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ æ“ä½œç³»ç»Ÿå†…éƒ¨åˆ†ä¸ºç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ã€‚ ä»å›¾ä¸­çœ‹ï¼Œåº”ç”¨çš„è¿›ç¨‹å¤„äºç”¨æˆ·ç©ºé—´ï¼Œç³»ç»Ÿä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªåº”ç”¨ç›¸å½“äºåŒæ—¶å­˜åœ¨å¤šä¸ªç”¨æˆ·ç©ºé—´ã€‚è€Œæ‰€æœ‰çš„ç”¨æˆ·ç©ºé—´éƒ½å¯¹åº”åŒä¸€ä¸ªå†…æ ¸ç©ºé—´ã€‚ç”¨æˆ·ç©ºé—´ç›¸äº’ä¹‹é—´ä¸å…±äº«ï¼Œä½†æ˜¯å†…æ ¸ç©ºé—´æ˜¯å…±äº«çš„ã€‚ æ‰€æœ‰ç³»ç»Ÿèµ„æºçš„ç®¡ç†éƒ½æ˜¯åœ¨å†…æ ¸ç©ºé—´è¿›è¡Œçš„ï¼Œé‚£æˆ‘ä»¬åº”ç”¨ç¨‹åºéœ€è¦è®¿é—®ç£ç›˜ï¼Œè¯»å–ç½‘å¡çš„æ•°æ®ï¼Œæ–°å»ºä¸€ä¸ªçº¿ç¨‹éƒ½éœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œå®Œæˆä»ç”¨æˆ·æ€åˆ°å†…å­˜æ€çš„åˆ‡æ¢ã€‚ å½“ä¸€ä¸ªä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è€Œé™·å…¥å†…æ ¸ä»£ç ä¸­æ‰§è¡Œæ—¶ï¼Œç§°è¿›ç¨‹å¤„äºå†…æ ¸è¿è¡Œæ€ï¼ˆå†…æ ¸æ€ï¼‰ã€‚ æ¯”å¦‚æˆ‘ä»¬ Java ä¸­éœ€è¦æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œnew Thread( Runnable â€¦) ä¹‹åè°ƒç”¨ start() æ–¹æ³•æ—¶, çœ‹Hotspot Linux çš„JVM æºç å®ç°ï¼Œæœ€ç»ˆæ˜¯è°ƒpthread_create ç³»ç»Ÿæ–¹æ³•æ¥åˆ›å»ºçš„çº¿ç¨‹ï¼Œè¿™é‡Œä¼šä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€å®Œæˆç³»ç»Ÿèµ„æºçš„åˆ†é…ï¼Œçº¿ç¨‹çš„åˆ›å»ºã€‚ é‚£ä¹ˆä¸å…±äº«çš„ç”¨æˆ·ç©ºé—´ä¹‹é—´æ€ä¹ˆè¿›è¡Œé€šä¿¡å‘¢ï¼Ÿä¼ ç»Ÿçš„linuxçš„IPCæ˜¯ä½¿ç”¨åŒæ‹·è´è¿›è¡Œçš„ï¼Œå³ä¸åŒç”¨æˆ·ç©ºé—´ä¸­ï¼Œä¸èƒ½ç®€å•çš„é€šè¿‡å¼•ç”¨æŒ‡é’ˆä¼ é€’æ•°æ®ï¼Œè€Œæ˜¯å¿…é¡»åœ¨å†…æ ¸ç©ºé—´ä¸­è°ƒç”¨copy_from_userå…ˆæŠŠæ•°æ®æ‹·è´åˆ°å†…æ ¸ç©ºé—´ï¼Œå†è°ƒç”¨copy_to_useræŠŠæ•°æ®æ‹·è´åˆ°clientæ‰€åœ¨çš„ç”¨æˆ·ç©ºé—´Bã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:4:1","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"Binderé€šè®¯æœºåˆ¶ è¿™å°±å¾ˆåƒæˆ‘ä»¬åœ¨å®¶é‡Œè®¿é—®ç™¾åº¦ï¼Œæˆ‘ä»¬å…ˆä»æµè§ˆå™¨è¾“å…¥ç™¾åº¦çš„åŸŸåå›è½¦ï¼Œç„¶åè¯·æ±‚ä¼šå…ˆåˆ°è¾¾é™„è¿‘çš„DNSï¼ŒDNSè´Ÿè´£æŠŠåŸŸåè§£ææˆå¯¹åº”çš„IPåœ°å€ï¼Œç„¶åè½¬å‘è¯·æ±‚åˆ°è¿™ä¸ªIPçš„æœåŠ¡å™¨ä¸Šã€‚ serverï¼Œè´Ÿè´£åˆ›å»ºBinderå®ä½“ï¼Œå¹¶ä¸”æŠŠBinderå®ä½“ä»¥åç§°çš„å½¢å¼å­—æ³¨å†Œåˆ°ServiceManagerï¼› ServiceManagerï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œæä¾›Binderçš„æ³¨å†Œå’ŒæŸ¥è¯¢åŠŸèƒ½ï¼›ServiceManagerè‡ªå·±å…¶å®ä¹Ÿæ˜¯ä¸ªserverï¼Œè‡ªå·±å¸¦æœ‰ä¸€ä¸ªç‰¹æ®Šçš„Binderå®ä½“ï¼ˆ0å·ï¼‰ï¼Œè€Œå…¶ä»–è¿›ç¨‹éƒ½å¯ä»¥çœ‹ä½œæ˜¯clientã€‚å½“æˆ‘ä»¬çš„serveråˆ›å»ºBinderå®ä½“åï¼Œé€šè¿‡è¿™ä¸ªç‰¹æ®Šçš„binderé€šä¿¡å®ç°æ³¨å†Œã€‚è€Œclientä¹Ÿé€šè¿‡è¿™ä¸ªç‰¹æ®Šçš„Binderï¼Œå»æŸ¥è¯¢ç›®æ ‡Binderçš„åå­—ï¼ŒæŸ¥åˆ°å°±è¿”å›Binderçš„å¼•ç”¨ã€‚ Binderé©±åŠ¨ï¼ŒçœŸæ­£çš„é€šä¿¡æ˜¯ç”±Binderé©±åŠ¨æ¥å®Œæˆçš„ï¼Œæä¾›äº†ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´åˆ‡æ¢ï¼ˆæ•°æ®æ‹·è´ï¼‰çº¿ç¨‹ç®¡ç†ï¼ŒPIDã€UIDç®¡ç†ç­‰åŠŸèƒ½ã€‚ è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒSMä½äºç”¨æˆ·ç©ºé—´ï¼Œè€ŒBinderDriverä½äºå†…æ ¸ç©ºé—´ã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:5:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"BinderDriverçš„ä½œç”¨ ä¸»è¦æ˜¯ç”¨æ¥åˆ›å»ºBinderå®ä½“ï¼Œå¹¶ä¸”æ§åˆ¶å®ä½“çš„è®¿é—®ï¼ŒåŒ…æ‹¬å¤šçº¿ç¨‹å¯¹å®ä½“çš„è®¿é—®å®‰å…¨ï¼ŒClientçš„è®¿é—®æƒé™ï¼Œè¿›ç¨‹çš„ä¸­æ–­ç­‰å¾…ç­‰ã€‚ å½“æœ‰è¿›ç¨‹é€šè¿‡BINDERSETCONTEXT_MGR å‘½ä»¤æŠŠè‡ªå·±æ³¨å†Œæˆä¸ºServiceManageræ—¶ï¼Œä¼šé€šè¿‡BinderDriveråˆ›å»ºä¸€ä¸ªé»˜è®¤çš„Binderå®ä½“ï¼Œå¹¶ç½®äº0å·ä½ï¼Œå¹¶ä¸”åé¢çš„æ–°åˆ›å»ºçš„Clientéƒ½é»˜è®¤æŒæœ‰è¿™ä¸ª0å·ä½çš„Binderå®ä½“ï¼ˆzygoteä¸æ–­forkè‡ªå·±ï¼Œæ‰€ä»¥éƒ½å¸¦æœ‰0å·ä½ï¼‰ã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:5:1","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"ServiceManagerçš„å®è§‚ä½œç”¨ SMæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œæ˜¯Androidç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡çš„ç®¡ç†è€…ã€‚ç³»ç»Ÿä¸­çš„æ‰€æœ‰serveréƒ½é€šè¿‡åç§°-å¼•ç”¨çš„æ–¹å¼åœ¨SMä¸­æ³¨å†Œï¼Œè€Œclientå…¨éƒ½è¦é€šè¿‡SMæŸ¥è¯¢æœåŠ¡åæ‰¾åˆ°ç›®æ ‡serverä¹‹åå†ä½¿ç”¨serveræä¾›çš„åŠŸèƒ½ã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:5:2","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"Binderæœºåˆ¶çš„å®è§‚ä½œç”¨ ä»ä¸Šé¢æˆ‘ä»¬çœ‹SMçš„ä½œç”¨ï¼Œå°±çŸ¥é“æ•´ä¸ªBinderæœºåˆ¶çš„å®è§‚ä½œç”¨ï¼Œä»–å°±æ˜¯Androidç³»ç»Ÿçš„å¿ƒè„ï¼Œè´Ÿè´£é©±åŠ¨Androidç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½ã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:5:3","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"Binderçš„é€šä¿¡è¿‡ç¨‹ ioctlå‡½æ•°æ˜¯linuxç³»ç»Ÿä¸­é©±åŠ¨ç¨‹åºå¯¹å¤–æä¾›çš„è°ƒç”¨æ¥å£ã€‚ æ³¨å†Œè¿‡ç¨‹ Serverè¿›ç¨‹å¯åŠ¨ä¹‹åï¼Œé€šè¿‡ioctlå‡½æ•°å‘Driverå‘èµ·è¯·æ±‚ï¼Œå¹¶æŒ‡æ˜éœ€è¦0å·ä½binderå¼•ç”¨å¯¹åº”çš„è¿›ç¨‹æ¥å¤„ç†ï¼› é©±åŠ¨æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡SMå†…éƒ¨çš„çº¢é»‘æ ‘æŸ¥è¯¢æ˜¯å¦æ³¨å†Œè¿‡binderå®ä½“ï¼Œç”±äº0å·ä½å·²æ³¨å†Œè¿‡äº†ï¼Œå°±ä¸éœ€è¦å†åˆ›å»ºå®ä½“å’Œæ·»åŠ å¼•ç”¨äº†ï¼Œç›´æ¥æŠŠBinderå®ä½“è½¬å‘ç»™å¯¹åº”çš„è¿›ç¨‹ï¼Œåœ¨è¿™é‡Œå°±æ˜¯SMè¿›ç¨‹ï¼› SMæ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œå°†Serverçš„binderå¼•ç”¨æ·»åŠ åˆ°å†…éƒ¨çš„å•é“¾è¡¨ä¸­ï¼Œå®Œæˆæ³¨å†Œï¼› é€šä¿¡è¿‡ç¨‹ clienté€šè¿‡ioctlå‡½æ•°å‘Driverå‘èµ·è¯·æ±‚ï¼ˆåŒ…å«binderåç§°ï¼‰ï¼› Driverå°†è¯·æ±‚è½¬å‘ç»™SMï¼› SMåœ¨å¼•ç”¨å•é“¾è¡¨ä¸­æ ¹æ®åç§°æŸ¥è¯¢Serverçš„å¼•ç”¨ï¼› é€šè¿‡Driverè¿”å›Binderçš„å¼•ç”¨ï¼› Clientæ”¶åˆ°å¼•ç”¨ä¹‹åï¼Œåˆ›å»ºä¸€ä¸ªServerçš„ä»£ç†ï¼› Clientè°ƒç”¨ä»£ç†çš„æ¥å£ï¼Œé€šè¿‡Driverä¸çœŸæ­£çš„Serverè¿›è¡Œäº¤äº’ã€‚ æ€»ç»“ æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯åˆ›å»ºè¿œç¨‹ä»£ç†ä¸è°ƒç”¨è¿œç¨‹ä»£ç†çš„è¿‡ç¨‹ã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:5:4","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"AIDL ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:6:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"å®šä¹‰ AIDLçš„å…¨ç§°æ˜¯ï¼šAndroidæ¥å£å®šä¹‰è¯­è¨€(å³ Android Interface Definition Language)ï¼Œä»–å®šä¹‰çš„åªä¸è¿‡æ˜¯ä¸€å¥—æ¨¡æ¿ï¼Œå®é™…èµ·ä½œç”¨çš„æ˜¯ASé€šè¿‡è§£é‡Šè¿™ä¸ªæ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆçš„android.os.IInterfaceçš„å­ç±»æ¥å£ã€‚ä½œç”¨æ˜¯ä¾é Serviceä¸­è½¬ï¼Œé€šè¿‡Binderæœºåˆ¶æ¥åšIPCã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:6:1","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"æ•°æ®ç±»å‹ AIDLæ”¯æŒçš„æ•°æ®ç±»å‹ï¼š byte char short int long float double boolean Parcelable List Map ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:6:2","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"å®šå‘Tag interface BookController { List\u003cBook\u003e getBookList(); void addBookInOut(inout Book book); void addBookIn(in Book book); void addBookOut(out Book book); } in æ•°æ®åªèƒ½ç”±å®¢æˆ·ç«¯æµå‘æœåŠ¡ç«¯ out æ•°æ®åªèƒ½ç”±æœåŠ¡ç«¯æµå‘å®¢æˆ·ç«¯ inout æ•°æ®å¯åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´åŒå‘æµé€š å¦‚æœAIDLæ–¹æ³•æ¥å£çš„å‚æ•°å€¼ç±»å‹æ˜¯ï¼šåŸºæœ¬æ•°æ®ç±»å‹ã€Stringã€CharSequenceæˆ–è€…å…¶ä»–AIDLæ–‡ä»¶å®šä¹‰çš„æ–¹æ³•æ¥å£ï¼Œé‚£ä¹ˆè¿™äº›å‚æ•°å€¼çš„å®šå‘ Tag é»˜è®¤æ˜¯ä¸”åªèƒ½æ˜¯ inï¼Œæ‰€ä»¥é™¤äº†è¿™äº›ç±»å‹å¤–ï¼Œå…¶ä»–å‚æ•°å€¼éƒ½éœ€è¦æ˜ç¡®æ ‡æ³¨ä½¿ç”¨å“ªç§å®šå‘Tagã€‚ å¼•è‡ªhttps://www.jianshu.com/p/29999c1a93cd ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:6:3","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"æºç  //åŒ…åä¸é¡¹ç›®åŒ…åä¸€è‡´ package com.vee.aidltest; /** * è‡ªåŠ¨ç”Ÿæˆçš„æ¥å£ **/ public interface IMyAidlInterface extends android.os.IInterface{ /** * æˆ‘ä»¬è‡ªå·±å£°æ˜çš„ä¸šåŠ¡å‡½æ•° **/ public java.lang.String getName() throws android.os.RemoteException; /** * æœ¬æ¥å£çš„é»˜è®¤å®ç°ï¼Œå…¶ä¸­ä¸šåŠ¡æ–¹æ³•`getName`è¿”å›null; **/ public static class Default implements com.vee.aidltest.IMyAidlInterface{ ... } /** * é™æ€å†…éƒ¨ç±»ï¼Œç»§æ‰¿è‡ª`android.os.Binder.Stub`ç±»å‹ï¼Œä¹Ÿéµå¾ªAIDLæ¥å£ **/ public static abstract class Stub extends android.os.Binder implements com.vee.aidltest.IMyAidlInterface{ /** * ç”¨æ¥æ ‡è®°å½“å‰Binderï¼Œæ‰€ä»¥é‡‡ç”¨å…¨ç±»åè¡¨ç¤º **/ private static final java.lang.String DESCRIPTOR = \"com.vee.aidltest.IMyAidlInterface\"; /** * æ„é€ æ–¹æ³•ä¸­è°ƒç”¨å¯¹è±¡æ–¹æ³•ã€‚ **/ public Stub(){ this.attachInterface(this, DESCRIPTOR); } /** * ç”¨äºå°†æœåŠ¡ç«¯çš„Binderå¯¹è±¡è½¬æ¢æˆå®¢æˆ·ç«¯æ‰€éœ€çš„AIDLæ¥å£ç±»å‹çš„å¯¹è±¡ï¼Œè¿™ç§è½¬æ¢è¿‡* ç¨‹æ˜¯åŒºåˆ†è¿›ç¨‹çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½äºåŒä¸€è¿›ç¨‹ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•è¿”å›çš„å°±æ˜¯æœåŠ¡ç«¯*çš„Stubå¯¹è±¡æœ¬èº«ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç³»ç»Ÿå°è£…åçš„Stub.proxyå¯¹è±¡ */ public static com.vee.aidltest.IMyAidlInterface asInterface(android.os.IBinder obj){ if ((obj==null)) { return null; } android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR); if (((iin!=null)\u0026\u0026(iin instanceof com.vee.aidltest.IMyAidlInterface))) { return ((com.vee.aidltest.IMyAidlInterface)iin); } return new com.vee.aidltest.IMyAidlInterface.Stub.Proxy(obj); } /** * è¿”å›å½“å‰Binderå¯¹è±¡ **/ @Override public android.os.IBinder asBinder(){ return this; } @Override public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException{ java.lang.String descriptor = DESCRIPTOR; switch (code){ case INTERFACE_TRANSACTION: { reply.writeString(descriptor); return true; } case TRANSACTION_getName: { data.enforceInterface(descriptor); java.lang.String _arg0; _arg0 = data.readString(); java.lang.String _result = this.getName(_arg0); reply.writeNoException(); reply.writeString(_result); return true; } default: { return super.onTransact(code, data, reply, flags); } } } /** * è‡ªåŠ¨ç”Ÿæˆçš„é™æ€ä»£ç†ï¼Œåœ¨å®¢æˆ·ç«¯å›è°ƒ **/ private static class Proxy implements com.vee.aidltest.IMyAidlInterface{ private android.os.IBinder mRemote; Proxy(android.os.IBinder remote){ mRemote = remote; } @Override public android.os.IBinder asBinder(){ return mRemote; } public java.lang.String getInterfaceDescriptor(){ return DESCRIPTOR; } @Override public java.lang.String getName() throws android.os.RemoteException { android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); java.lang.String _result; try { _data.writeInterfaceToken(DESCRIPTOR); boolean _status = mRemote.transact(Stub.TRANSACTION_getName, _data, _reply, 0); if (!_status \u0026\u0026 getDefaultImpl() != null) { return getDefaultImpl().getName(); } _reply.readException(); _result = _reply.readString(); } finally { _reply.recycle(); _data.recycle(); } return _result; } public static com.vee.aidltest.IMyAidlInterface sDefaultImpl; } /** * ç”¨æ¥æ ‡è®°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ–¹æ³•ï¼Œå‰ç¼€ç¡®å®š **/ static final int TRANSACTION_getName = (android.os.IBinderFIRST_CALL_TRANSACTION + 0); /** * å½“å¤„äºå®¢æˆ·ç«¯æ—¶è°ƒç”¨ï¼Œè¿™é‡Œå°±æ˜¯ç”Ÿæˆä»£ç† **/ public static boolean setDefaultImpl(com.vee.aidltest.IMyAidlInterface impl) { if (Stub.Proxy.sDefaultImpl != null) { throw new IllegalStateException(\"setDefaultImpl() called twice\"); } if (impl != null) { Stub.Proxy.sDefaultImpl = impl; return true; } return false; } /** * å½“å¤„äºå®¢æˆ·ç«¯æ—¶ç”¨æ¥è·å–ä»£ç†å¯¹è±¡ **/ public static com.vee.aidltest.IMyAidlInterface getDefaultImpl() { return Stub.Proxy.sDefaultImpl; } } DESCRIPTOR Binderçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€èˆ¬ç”¨å½“å‰Binderçš„ç±»åè¡¨ç¤ºï¼Œæ¯”å¦‚æœ¬ä¾‹ä¸­çš„com.ryg.chapter_2.aidl.IBookManagerã€‚ asInterface(android.os.IBinder obj) ç”¨äºå°†æœåŠ¡ç«¯çš„Binderå¯¹è±¡è½¬æ¢æˆå®¢æˆ·ç«¯æ‰€éœ€çš„AIDLæ¥å£ç±»å‹çš„å¯¹è±¡ï¼Œè¿™ç§è½¬æ¢è¿‡ç¨‹æ˜¯åŒºåˆ†è¿›ç¨‹çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½äºåŒä¸€è¿›ç¨‹ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•è¿”å›çš„å°±æ˜¯æœåŠ¡ç«¯çš„Stubå¯¹è±¡æœ¬èº«ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç³»ç»Ÿå°è£…åçš„Stub.proxyå¯¹è±¡ã€‚ asBinder æ­¤æ–¹æ³•ç”¨äºè¿”å›å½“å‰Binderå¯¹è±¡ã€‚ onTransact:é‡è¦ è¿™ä¸ªæ–¹æ³•è¿è¡Œåœ¨æœåŠ¡ç«¯ä¸­çš„Binderçº¿ç¨‹æ± ä¸­ï¼Œå½“å®¢æˆ·ç«¯å‘èµ·è·¨è¿›ç¨‹è¯·æ±‚æ—¶ï¼Œè¿œç¨‹è¯·æ±‚ä¼šé€šè¿‡ç³»ç»Ÿåº•å±‚å°è£…åäº¤ç”±æ­¤æ–¹æ³•æ¥å¤„ç†ã€‚è¯¥æ–¹æ³•çš„åŸå‹ä¸ºpublic Boolean onTransact(int code,android.os.Parcel data,android.os.Parcel reply,int flags)ã€‚æœåŠ¡ç«¯å…ˆé€šè¿‡switch(code)å¯ä»¥åˆ¤æ–­å‡ºå®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„æ˜¯å…·ä½“å“ªä¸ªæ–¹æ³•ã€‚è¿˜è®°å¾—è¿™ä¸ªæ–¹æ³•æ ‡è®°å—ï¼š /** * ç”¨æ¥æ ‡è®°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ–¹æ³•ï¼Œå‰ç¼€ç¡®å®š **/ static final int TRANSACTION_getName = (android.os.IBinderFIRST_CALL_TRANSACTION + 0); æ¥ç€ä»dataä¸­å–å‡ºç›®æ ‡æ–¹æ³•æ‰€éœ€çš„å‚æ•°ï¼ˆå¦‚æœç›®æ ‡æ–¹æ³•æœ‰å‚æ•°çš„è¯ï¼‰ï¼Œdataæ˜¯ä¸ªParcelï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ä»äºŒè¿›åˆ¶æµä¸­å»è¯»ã€‚ ç„¶åæ‰§è¡Œç›®æ ‡","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:6:4","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"æå–ä¸€ä¸‹é‡ç‚¹ ä¸¤ä¸ªç«¯ï¼š server client ä¸¤ä¸ªæ ‡è®°ï¼š DESCRIPTORï¼šå½“å‰Binderçš„å”¯ä¸€æ ‡å¿— TRANSACTION_getNameï¼šæ–¹æ³•çš„å”¯ä¸€æ ‡å¿— ä¸¤ä¸ªç±»å‹ï¼š abstract class Stub extends android.os.Binder implements IMyAidlInterface static class Proxy implements IMyAidlInterface 5ä¸ªæ–¹æ³•ï¼š asInterface asBinder ä¸šåŠ¡æ–¹æ³• transact onTransact ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:7:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"æ¢³ç†æµç¨‹ æœåŠ¡ç«¯å‘ServiceManageræ³¨å†ŒBinderã€‚ å®¢æˆ·ç«¯(é€šè¿‡bindService()å›è°ƒ)æ‹¿åˆ°Binderï¼Œè°ƒç”¨Stub.asInterface(binderObj)ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­é€šè¿‡DESCRIPTORæ ‡å¿—åœ¨ServiceManagerä¸­å»æ‰¾Binderï¼Œå¦‚æœæ‰¾åˆ°ç›´æ¥è¿”å›ï¼Œæ‰¾ä¸åˆ°å°±åˆ›å»ºè¿™ä¸ªbinderçš„Proxyå¯¹è±¡ã€‚Proxyå¯¹è±¡ä¸­åŒ…å«è¢«ä»£ç†çš„ä¸šåŠ¡æ–¹æ³•ã€‚ å®¢æˆ·ç«¯è°ƒç”¨Proxyä¸­ä»£ç†çš„ä¸šåŠ¡æ–¹æ³•ï¼Œæ­¤æ—¶åˆ›å»ºä¸¤ä¸ªParcelï¼š_dataå’Œ_replyã€‚ç„¶åè°ƒç”¨ä»£ç†ä¸­çš„binderçš„transact()æ–¹æ³•ï¼Œä¼ å…¥TRANSACTION_getNameæ–¹æ³•æ ‡è®°ã€_dataã€_replyï¼Œè¿™æ ·å°±æ‰§è¡Œäº†æœåŠ¡ç«¯binderä¸­çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œæ­¤æ—¶çº¿ç¨‹æŒ‚èµ·ã€‚ å®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡ç«¯çš„transact()æ–¹æ³•ä¼šå›è°ƒæœåŠ¡ç«¯çš„onTransact()æ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šæ ¹æ®TRANSACTION_getNameåˆ¤æ–­åº”è¯¥è°ƒç”¨å“ªä¸ªä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œç„¶åæŒ‚èµ·çº¿ç¨‹ï¼Œæ‰§è¡Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œæœ€ååœ¨replyä¸­å†™å…¥å¼‚å¸¸æˆ–ç»“æœã€‚ å®¢æˆ·ç«¯ç»§ç»­æ‰§è¡Œtransact()æ–¹æ³•ï¼Œä»_replyä¸­è¯»å–å¼‚å¸¸æˆ–è¿”å›å€¼ï¼Œå†ç»§ç»­çº¿ç¨‹ï¼Œæœ€åå›æ”¶_dataå’Œ_replyå¹¶è¿”å›_replyä¸­è¯»åˆ°çš„ç»“æœã€‚ ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:8:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"Binderè¿æ¥æ±  ","date":"2021-03-12","objectID":"/binder%E8%A7%A3%E6%9E%90/:9:0","series":null,"tags":["Android","binder"],"title":"Binderè§£æ","uri":"/binder%E8%A7%A3%E6%9E%90/"},{"categories":null,"content":"åˆå§‹åŒ– Looper.prepare(); Handler mHandler = new Handler(Looper.myLooper()); Looper.loop(); Looper.prepare()æºç ï¼š private static void prepare(boolean quitAllowed) { if (sThreadLocal.get() != null) { throw new RuntimeException(\"Only one Looper may be created per thread\"); } sThreadLocal.set(new Looper(quitAllowed)); } Looperçš„æ„é€ æ–¹æ³•ï¼š private Looper(boolean quitAllowed) { mQueue = new MessageQueue(quitAllowed); mThread = Thread.currentThread(); } åˆå§‹åŒ–é˜¶æ®µä¸»è¦åšäº†å››ä»¶äº‹ï¼š ä¾èµ–ThreadLocalç»™å½“å‰çº¿ç¨‹åˆ›å»ºLooperçš„ç‹¬ç«‹å¯¹è±¡ï¼› åœ¨Looperæ„é€ æ–¹æ³•ä¸­åˆ›å»ºMessageQueueï¼› åˆ›å»ºHandlerå¯¹è±¡; å¯åŠ¨å¾ªç¯è·å–æ¶ˆæ¯ã€‚ ","date":"2021-03-09","objectID":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/:1:0","series":null,"tags":["Android","handler","Message","Looper"],"title":"Androidä¸­Messageçš„ä¸€è¾ˆå­","uri":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/"},{"categories":null,"content":"åˆ›å»ºæ¶ˆæ¯ //æ–¹å¼1: Message.obtain(); //æ–¹å¼2ï¼š mHandler.obtainMessage(); ","date":"2021-03-09","objectID":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/:2:0","series":null,"tags":["Android","handler","Message","Looper"],"title":"Androidä¸­Messageçš„ä¸€è¾ˆå­","uri":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/"},{"categories":null,"content":"å‘é€ //æ–¹å¼1: mHandler.sendMessage(msg); //æ–¹å¼2: msg.sendToTarget(); æœ€ç»ˆè°ƒç”¨MessageQueue.enqueueMessage(Message msg, long when)ã€‚ æ‰€è°“çš„å‘é€æ¶ˆæ¯ï¼Œå…¶å®æ˜¯å¹²äº†3ä»¶äº‹ï¼š æŠŠæ¶ˆæ¯çš„çŠ¶æ€æ”¹ä¸ºinUseï¼› é‡ç»„MessageQueueä¸­çš„mMessagesé“¾æ¡ï¼ŒæŠŠæ–°æ¶ˆæ¯æ”¾åœ¨é˜Ÿé¦–ï¼› å”¤é†’Looperæ‰€åœ¨çº¿ç¨‹ï¼Œå¼€å§‹å¾ªç¯å¤„ç†æ¶ˆæ¯ã€‚ ","date":"2021-03-09","objectID":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/:3:0","series":null,"tags":["Android","handler","Message","Looper"],"title":"Androidä¸­Messageçš„ä¸€è¾ˆå­","uri":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/"},{"categories":null,"content":"æ¥æ”¶ Looperçš„looperæ–¹æ³•ä¸­å¾ªç¯è°ƒç”¨MessageQueueçš„nextæ–¹æ³•è¯»å–æ–°çš„messageï¼Œå¦‚æœæœ‰æ–°æ¶ˆæ¯ï¼Œå°±è°ƒç”¨handlerçš„dispatchMessage(msg)ï¼Œè¿›è€Œè°ƒç”¨handleCallback()æˆ–è€…è°ƒç”¨handleMessageæ–¹æ³•ã€‚æœ€åé€šè¿‡msgçš„msg.recycleUnchecked();å®Œæˆæ¶ˆæ¯çš„å›æ”¶å¤ç”¨ã€‚ è€Œæ­¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ªæ¶ˆæ¯æ˜¯å»¶è¿Ÿæ¶ˆæ¯ä¸”è¿˜æ²¡åˆ°æ—¶é—´ï¼Œlooperä¼šå›è°ƒæ‰€æœ‰çš„idleHandlerï¼Œç„¶åé€šè¿‡linuxçš„epollæœºåˆ¶è¿›å…¥ä¼‘çœ ï¼Œé™ä½cpuè´Ÿè½½ï¼Œç›´åˆ°è°ƒç”¨Looperå¯¹è±¡çš„quitSafely()ï¼Œè¿›ä¸€æ­¥è°ƒMessageQueueçš„quit()æ–¹æ³•ï¼Œæ›´æ”¹mQuittingæ ‡è®°ï¼Œä½¿MessageQueueçš„nextæ–¹æ³•è¿”å›nullï¼Œè·³å‡ºLopperçš„loopå¾ªç¯ï¼Œé‡Šæ”¾äº†çº¿ç¨‹ã€‚ æ˜å¤©è¡¥ä¸€å¼ ç”Ÿå‘½å‘¨æœŸæ—¶åºå›¾å§ï¼Œä»Šå¤©å…ˆåˆ°è¿™äº† ","date":"2021-03-09","objectID":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/:4:0","series":null,"tags":["Android","handler","Message","Looper"],"title":"Androidä¸­Messageçš„ä¸€è¾ˆå­","uri":"/android%E4%B8%ADmessage%E7%9A%84%E4%B8%80%E8%BE%88%E5%AD%90/"},{"categories":null,"content":"å›é¡¾ handlerå‘é€æ¶ˆæ¯ï¼š private boolean enqueueMessage(@NonNull MessageQueue queue, @NonNull Message msg, long uptimeMillis) { msg.target = this; msg.workSourceUid = ThreadLocalWorkSource.getUid(); if (mAsynchronous) { msg.setAsynchronous(true); } return queue.enqueueMessage(msg, uptimeMillis);//æœ€åè°ƒç”¨çš„æ˜¯queue.enqueueMessage } Looperå¾ªç¯è¯»å–æ¶ˆæ¯å¹¶å‘é€ç»™Handler: for (;;) { Message msg = queue.next(); // ä»MessageQueueä¸­å–å‡ºMessage try { msg.target.dispatchMessage(msg);//è°ƒç”¨Handlerçš„dispatchMessage } catch (Exception exception) { //... } finally { //... } //å›æ”¶æ¶ˆæ¯ msg.recycleUnchecked(); } ","date":"2021-03-04","objectID":"/messagequeue%E8%A7%A3%E8%AF%BB/:0:1","series":null,"tags":["Android","Handler","Looper","Message","MessageQueue"],"title":"MessageQueueè§£è¯»","uri":"/messagequeue%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"enqueueMessage Message mMessages; boolean enqueueMessage(Message msg, long when) { synchronized (this) { if (msg.isInUse()) {//å‘é€çš„æ¶ˆæ¯å¿…é¡»æ˜¯é—²ç½®çŠ¶æ€çš„ throw new IllegalStateException(msg + \" This message is already in use.\"); } if (mQuitting) { //mQuittingæ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œåªæœ‰MessageQueueçš„quitæ–¹æ³•è°ƒç”¨æ—¶æ‰è¿™ä¸ªçŠ¶æ€æ‰ä¼šä¸ºtrue msg.recycle();//å›æ”¶ return false; } msg.markInUse(); //æ”¹çŠ¶æ€ä¸ºä½¿ç”¨ä¸­ msg.when = when;//æ³¨æ„è¿™é‡Œèµ‹å€¼ Message p = mMessages; boolean needWake; //é‡ç‚¹æ˜¯æ—¶é—´çš„æ¯”è¾ƒï¼Œå¦‚æœæ–°çš„msgçš„æ—¶é—´æ—©äºå½“å‰çš„messageï¼Œé‚£ä¹ˆå°±æŠŠæ–°çš„msgæ”¾åœ¨å¤´éƒ¨ã€‚ if (p == null || when == 0 || when \u003c p.when) { // New head, wake up the event queue if blocked. msg.next = p; mMessages = msg; needWake = mBlocked; } else { needWake = mBlocked \u0026\u0026 p.target == null \u0026\u0026 msg.isAsynchronous();//å¦‚æœæ˜¯å¼‚æ­¥æ¶ˆæ¯ Message prev; for (;;) {//åˆä¸€ä¸ªæ­»å¾ªç¯ï¼Œç”¨æ¥å‘ä¸‹éå†é˜Ÿåˆ—ï¼Œ prev = p;//æŠŠå½“å‰çš„msgè®¾ä¸ºå‰ä¸€ä¸ªmsg p = p.next;//å½“å‰çš„msgæŒ‡å‘ä¸‹ä¸€ä¸ªmsg if (p == null || when \u003c p.when) {//å¦‚æœæˆ‘ä»¬è®¾ç½®æ—¶é—´çš„æ—©äºmsgçš„æ—¶é—´ï¼Œé‚£ä¹ˆå°±åœæ­¢éå† break; } if (needWake \u0026\u0026 p.isAsynchronous()) { needWake = false; } } msg.next = p; // invariant: p == prev.next prev.next = msg; } if (needWake) { nativeWake(mPtr);//å”¤é†’çº¿ç¨‹å¤„ç†æ¶ˆæ¯ } } return true; } ç®€è€Œè¨€ä¹‹ï¼ŒenqueueMessageçš„ä½œç”¨æ˜¯é‡‡ç”¨synchronizedåŒæ­¥é˜»å¡çš„æ–¹å¼æ“ä½œMessageé“¾æ¡ï¼Œä¾æ®Messageçš„å»¶è¿Ÿæ—¶é—´ï¼Œæ‰“æ–­é“¾æ¡é‡æ–°æ’åºï¼ŒåŒæ—¶ä¿®æ”¹msgçš„çŠ¶æ€ï¼Œåˆ©ç”¨å…±äº«å†…å­˜ï¼ˆmMessagesï¼‰è¾¾åˆ°çº¿ç¨‹é—´é€šä¿¡çš„ç›®çš„ã€‚ é‚£ä¹ˆæ‰€è°“çš„Handler.sendMessage(msg)æ˜¯çœŸçš„å‘é€æ¶ˆæ¯å—ï¼Ÿå¹¶ä¸æ˜¯ï¼å®ƒåªæ˜¯ä¿®æ”¹äº†Looperä¸­æŒæœ‰çš„MessageQueueä¸­çš„mMessagesçš„é“¾æ¡é¡ºåºï¼Œç„¶åç­‰å¾…Looperä¸æ–­å¾ªç¯è·å–ï¼Œå†ä¼ é€’å›mHandler.dispatchMessage(msg)è€Œå·²ã€‚ä½†è¿™ä¸€æ”¹åŠ ä¸€å–ï¼Œå°±èƒ½è¾¾åˆ°çº¿ç¨‹é—´é€šä¿¡çš„æ•ˆæœï¼Œå¹¶è®©æˆ‘ä¸€ç›´è¯¯ä»¥ä¸ºæ˜¯çœŸçš„é€šè¿‡åºåˆ—åŒ–ä¹‹åå‘é€å‡ºå»ï¼Œè€Œè¿™ç§æ–¹å¼å«åšå…±äº«å†…å­˜ã€‚ ä¸çœ‹ä¸çŸ¥é“ï¼Œä¸€çœ‹å¥½é¸¡è´¼ï¼ ","date":"2021-03-04","objectID":"/messagequeue%E8%A7%A3%E8%AF%BB/:0:2","series":null,"tags":["Android","Handler","Looper","Message","MessageQueue"],"title":"MessageQueueè§£è¯»","uri":"/messagequeue%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"nextæ–¹æ³• @UnsupportedAppUsage Message next() { //å½“loopæ‰§è¡Œäº†quitåï¼Œç¨‹åºå¯èƒ½ä¼šé‡å¯looperï¼Œå°±ä¼šè¿”å›åˆ°è¿™é‡Œã€‚ final long ptr = mPtr; if (ptr == 0) { return null; } int pendingIdleHandlerCount = -1; //åªæœ‰åœ¨ç¬¬ä¸€æ¬¡éå†æ—¶æ˜¯-1 int nextPollTimeoutMillis = 0; for (;;) { if (nextPollTimeoutMillis != 0) { //ç”¨æ¥åœ¨çº¿ç¨‹è¦è¿›å…¥é˜»å¡ä¹‹å‰è·Ÿå†…æ ¸çº¿ç¨‹å‘é€æ¶ˆæ¯ï¼Œé˜²æ­¢ç”¨æˆ·çº¿ç¨‹é•¿æ—¶é—´çš„æŒæœ‰æŸä¸ªå¯¹è±¡ Binder.flushPendingCommands(); } nativePollOnce(ptr, nextPollTimeoutMillis);//å‘Šè¯‰linuxçš„epollï¼šä½ ä¸«å¯ä»¥ç¡nextPollTimeoutMillisè¿™ä¹ˆé•¿æ—¶é—´äº†ï¼ç›´åˆ°handlerå‘é€æ¶ˆæ¯è°ƒç”¨`mQueue.enqueueMessage()`æ–¹æ³•æ—¶ä¼šè¢«å”¤é†’ï¼Œæˆ–è€…å½“å‰æ¶ˆæ¯åˆ°æ—¶é—´æ—¶ä¹Ÿä¼šè¢«å”¤é†’ã€‚ synchronized (this) { // å°è¯•æ£€ç´¢ä¸‹ä¸€ä¸ªmsgï¼Œæ‰¾åˆ°å°±è¿”å› final long now = SystemClock.uptimeMillis(); Message prevMsg = null; Message msg = mMessages; if (msg != null \u0026\u0026 msg.target == null) { //é æ …æ åœæ»ï¼Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªéå¼‚æ­¥msg do { prevMsg = msg; msg = msg.next; } while (msg != null \u0026\u0026 !msg.isAsynchronous()); } if (msg != null) { if (now \u003c msg.when) { //ä¸‹ä¸€ä¸ªæ¶ˆæ¯è¿˜æ²¡åˆ°æ—¶é—´ã€‚è®¾ç½®ä¸€ä¸ªå”¤é†’æ—¶æ®µ nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE); } else { // è·å–ä¸€æ¡æ¶ˆæ¯ mBlocked = false; if (prevMsg != null) { prevMsg.next = msg.next; } else {//å¦‚æœä¸æ˜¯å¼‚æ­¥æ¶ˆæ¯ï¼ŒprevMsgå°±æ˜¯null mMessages = msg.next;//å¾€ä¸Šæä¸€ä½ } msg.next = null;//æ‰“æ–­é“¾æ¡å•ç‹¬å–å‡º if (DEBUG) Log.v(TAG, \"Returning message: \" + msg); msg.markInUse();//æ”¹å˜çŠ¶æ€ä¸ºä½¿ç”¨ä¸­ return msg;//è¿”å› } } else { //å¦‚æœå½“å‰æ²¡æœ‰æ¶ˆæ¯ï¼ŒæŠŠå”¤é†’æ—¶é’Ÿè®¾ä¸º-1ï¼Œé‚£ä¹ˆæ„å‘³ç€çº¿ç¨‹ä¼šæ²‰ç¡Integer.MaxValue nextPollTimeoutMillis = -1; } // Process the quit message now that all pending messages have been handled. if (mQuitting) { dispose(); return null; } ///æ¥ä¸‹æ¥å°±æ˜¯å–œé—»ä¹è§çš„idleHandleräº† if (pendingIdleHandlerCount \u003c 0 \u0026\u0026 (mMessages == null || now \u003c mMessages.when)) { pendingIdleHandlerCount = mIdleHandlers.size();//å¦‚æœæ²¡æœ‰æ·»åŠ è¿‡idleHandlerï¼Œé‚£ä¹ˆå°±æ˜¯0 } if (pendingIdleHandlerCount \u003c= 0) { //å¦‚æœæ²¡æœ‰idleHandleréœ€è¦æ‰§è¡Œï¼Œé‚£å°±ç»§ç»­loop mBlocked = true; continue; } //åˆå§‹åŒ–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ•°ç»„ if (mPendingIdleHandlers == null) { mPendingIdleHandlers = new IdleHandler[Math.max(pendingIdleHandlerCount, 4)]; } mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers); } // éå†æ‰§è¡Œæ‰€æœ‰çš„idleHandler. //åªæœ‰åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶æ‰ä¼šæ‰§è¡Œåˆ°è¿™ä¸ªä»£ç å— for (int i = 0; i \u003c pendingIdleHandlerCount; i++) { final IdleHandler idler = mPendingIdleHandlers[i]; mPendingIdleHandlers[i] = null; // å¼ºè¡Œé‡Šæ”¾æ•°ç»„ä¸­çš„idleHandlerï¼Œä¸ä¼šå½±å“ArrayListä¸­çš„idleHandlerå’Œå½“å‰æ­£åœ¨ä½¿ç”¨çš„idleHandlerã€‚ boolean keep = false; try { keep = idler.queueIdle();//å›è°ƒqueueIdleæ–¹æ³• } catch (Throwable t) { Log.wtf(TAG, \"IdleHandler threw exception\", t); } if (!keep) { synchronized (this) { mIdleHandlers.remove(idler); } } } //é‡ç½®è®¡æ•° pendingIdleHandlerCount = 0; nextPollTimeoutMillis = 0; } } ","date":"2021-03-04","objectID":"/messagequeue%E8%A7%A3%E8%AF%BB/:0:3","series":null,"tags":["Android","Handler","Looper","Message","MessageQueue"],"title":"MessageQueueè§£è¯»","uri":"/messagequeue%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"IdleHandler /** * Callback interface for discovering when a thread is going to block * waiting for more messages. * å½“çº¿ç¨‹å°†è¦é”å®šï¼ˆç­‰å¾…æ›´å¤šæ¶ˆæ¯ï¼‰æ—¶å°±ä¼šå›è°ƒqueueIdleæ–¹æ³• */ public static interface IdleHandler { /** * å½“MessqgeQueueå·²ç»å¤„ç†å®Œæ‰€æœ‰çš„messageï¼Œå¹¶ä¸”å°†è¦è¿›å…¥ç¡çœ å’Œç­‰å¾…æ—¶è¿™ä¸ªæ–¹æ³•æ‰ä¼šè¢«è°ƒç”¨ã€‚ * è¿”å›trueå¯ä»¥ä½¿IdleHandlerä¿æŒæ¿€æ´»çŠ¶æ€ï¼Œé‚£ä¹ˆå½“ä¸‹æ¬¡çº¿ç¨‹ç©ºé—²äº†è¿˜ä¼šè°ƒç”¨ï¼Œè¿”å›falseå°±ä¼šç§»é™¤IdleHandlerã€‚ */ boolean queueIdle(); } åŸæ¥è¿™ç©æ„æ ¹æœ¬ä¸æ˜¯ä»€ä¹ˆHandlerçš„å­ç±»ï¼Œè€Œæ˜¯MessageQueueçš„ä¸€ä¸ªå†…éƒ¨é™æ€ç±»è€Œå·²ï¼ ç„¶åæˆ‘å°±ä¸å¤ªæ˜ç™½è¿™ä¸ªç©æ„äº†ï¼Œå»ç™¾äº†ä¸ªåº¦ï¼Œæ‹¿åˆ°ç­”æ¡ˆå¦‚ä¸‹ï¼š ä¹‹å‰åšè¿‡å†·å¯åŠ¨ä¼˜åŒ–ï¼Œåœ¨å†·å¯åŠ¨çš„åœºæ™¯æœ‰å¾ˆå¤šçš„ä»»åŠ¡å…¶å®å¹¶ä¸éœ€è¦é©¬ä¸Šå¯åŠ¨ï¼Œé€šå¸¸çš„åšæ³•å°±æ˜¯åšä¸€ä¸ªå»¶è¿Ÿå¯åŠ¨ï¼Œå¦‚ä¸‹æ‰€ç¤º Handler mHandler = new Handler(); mHandler.postDelayed(() -\u003e { //do something }, 1000); å°†ä»»åŠ¡å»¶è¿Ÿå¯åŠ¨1000msï¼Œä½†æ˜¯è¿™ä¸ªå»¶è¿Ÿå¯åŠ¨çš„æ—¶é—´ä¸å¥½ç¡®å®šï¼Œåªèƒ½æ˜¯è‡ªå·±é¢„ä¼°çš„ï¼Œå¯¹äºä¸€äº›é«˜ç«¯æ‰‹æœº1000mså¯èƒ½å¤šäº†ï¼Œä¸€äº›ä½ç«¯æ‰‹æœºå¯èƒ½1000msè¿˜ä¸å¤Ÿã€‚è¿™ä¸ªæ—¶å€™IdelHandlerå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒèƒ½å¤Ÿåœ¨CPUç©ºé—²çš„æ—¶å€™å†æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚ ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè°ƒç”¨addIdleHandleræ–¹æ³•å°±å¯ä»¥äº†: MessageQueue.IdleHandler idleHandler = new MessageQueue.IdleHandler() { @Override public boolean queueIdle() { //do something return false; } }; Looper.getMainLooper().getQueue().addIdleHandler(idleHandler); å¼•è‡ªè¿™é‡Œ æˆ‘æƒŠå¹å•Šï¼Œè¿˜èƒ½è¿™ä¹ˆç©å•Šï½ï½æƒ³åˆ°ä»¥å‰é¢è¯•å®˜é—®è¿‡æˆ‘æ€ä¹ˆåšå»¶è¿Ÿå¯åŠ¨ï¼Œæˆ‘å›ç­”ContentProviderå’ŒStartUpï¼Œæˆ‘è§‰å¾—æ˜¯æ²¡é”™çš„ï¼Œä½†æ˜¯å¥¹æƒ³è¦çš„åº”è¯¥å°±æ˜¯è¿™ä¸ªIdleHandlerã€‚ public void addIdleHandler(@NonNull IdleHandler handler) { if (handler == null) { throw new NullPointerException(\"Can't add a null IdleHandler\"); } synchronized (this) { mIdleHandlers.add(handler); } } æ·»åŠ æ—¶æœ‰éç©ºåˆ¤æ–­å’Œçº¿ç¨‹å®‰å…¨ã€‚ ç„¶åå…·ä½“çš„æ“ä½œä¹Ÿæ˜¯åœ¨MessqgeQueueçš„nextæ–¹æ³•ä¸­è¿›è¡Œçš„ã€‚é‚£ä¹ˆIdleHandleræ€ä¹ˆåˆ¤æ–­çº¿ç¨‹æ˜¯å¦ç©ºé—²å‘¢ï¼Ÿçœ‹nextæ–¹æ³•ä¸­è¿™ä¸€éƒ¨åˆ†ï¼š //æ¡ä»¶1:æ²¡æœ‰msgæˆ–msgè¿˜æ²¡åˆ°æ‰§è¡Œçš„æ—¶å€™ if (msg != null) { if (now \u003c msg.when) { //msgæ—¶é—´æ™šäºå½“å‰æ—¶é—´ nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE); } else { // Got a message. mBlocked = false; if (prevMsg != null) { prevMsg.next = msg.next; } else { mMessages = msg.next; } msg.next = null; if (DEBUG) Log.v(TAG, \"Returning message: \" + msg); msg.markInUse(); return msg; } } else { // No more messages. nextPollTimeoutMillis = -1; } //æ¡ä»¶2:looperæ²¡æœ‰åœæ­¢ if (mQuitting) { dispose(); return null; } //æ¡ä»¶3:ä¸å­˜åœ¨IdleHandlerçš„è¯å°±é‡æ–°éå† if (pendingIdleHandlerCount \u003c= 0) { // No idle handlers to run. Loop and wait some more. mBlocked = true; continue; } æ‰€ä»¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å°†è¿›å…¥ç©ºé—²ï¼Œä¹Ÿå°±æ˜¯IdleHandlerçš„æ‰§è¡Œæ—¶æœºï¼Œæ˜¯ä¾æ®ï¼š MessageQueueä¸­æ²¡æœ‰æ¶ˆæ¯æˆ–å½“å‰æ¶ˆæ¯ä¸å¿…é©¬ä¸Šæ‰§è¡Œï¼› Looperæ²¡æœ‰é‡Šæ”¾ï¼› é˜Ÿåˆ—ä¸­å­˜åœ¨IdleHandlerã€‚ ","date":"2021-03-04","objectID":"/messagequeue%E8%A7%A3%E8%AF%BB/:0:4","series":null,"tags":["Android","Handler","Looper","Message","MessageQueue"],"title":"MessageQueueè§£è¯»","uri":"/messagequeue%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åŒæ­¥å±éšœä¸å¼‚æ­¥æ¶ˆæ¯ å‰é¢ç»å¸¸æåˆ°å¼‚æ­¥æ¶ˆæ¯ï¼Œå¯¹äºå¼‚æ­¥æ¶ˆæ¯çš„å¤„ç†å¦‚ä¸‹ï¼š åœ¨enqueueMessageæ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¼‚æ­¥æ¶ˆæ¯çš„è¯ï¼Œä¼šè®©cpuä¿æŒå”¤é†’çŠ¶æ€ï¼› åœ¨nextæ–¹æ³•ä¸­ï¼Œä¾é åŒæ­¥å±éšœæ¥ä¼˜å…ˆæŸ¥æ‰¾å¼‚æ­¥æ¶ˆæ¯è¿”å›å¤„ç†ã€‚ æ£€ç´¢å¹¶ä½¿ç”¨åŒæ­¥å±éšœ MessageQueueçš„next()æ–¹æ³•ï¼š if (msg != null \u0026\u0026 msg.target == null) { // å¦‚æœtargetä¸ºç©ºï¼Œåˆ™åˆ¤å®šä¸ºé‡åˆ°äº†æ …æ ï¼Œæ­¤æ—¶ä¾¿åˆ©åé¢çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œæ‰¾åˆ°å¼‚æ­¥æ¶ˆæ¯ä¼˜å…ˆå¤„ç† do { prevMsg = msg; msg = msg.next; } while (msg != null \u0026\u0026 !msg.isAsynchronous()); } æ’å…¥åŒæ­¥å±éšœ @UnsupportedAppUsage @TestApi public int postSyncBarrier() { return postSyncBarrier(SystemClock.uptimeMillis()); } private int postSyncBarrier(long when) { synchronized (this) { // ç¼“å­˜token final int token = mNextBarrierToken++; // åˆ›å»ºä¸€ä¸ªæ— targetçš„æ¶ˆæ¯ final Message msg = Message.obtain(); msg.markInUse(); msg.when = when; msg.arg1 = token; Message prev = null; Message p = mMessages; æ’å…¥åˆ°æŒ‡å®šæ—¶é—´ if (when != 0) { while (p != null \u0026\u0026 p.when \u003c= when) { prev = p; p = p.next; } } if (prev != null) { // invariant: p == prev.next msg.next = p; prev.next = msg; } else { msg.next = p; mMessages = msg; } return token; } } æ€»ç»“ MessageQueueæ˜¯ä¸€ä¸ªç”±å•é“¾è¡¨å®ç°çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼› å±éšœæ¶ˆæ¯å’Œæ™®é€šæ¶ˆæ¯åŒºåˆ«åœ¨äºå±å¹•æ²¡æœ‰targetï¼Œæ™®é€šæ¶ˆæ¯æœ‰targetæ˜¯å› ä¸ºå®ƒéœ€è¦å°†æ¶ˆæ¯åˆ†å‘ç»™å¯¹åº”çš„targetï¼Œè€Œå±éšœä¸éœ€è¦è¢«åˆ†å‘ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æŒ¡ä½æ™®é€šæ¶ˆæ¯æ¥ä¿è¯å¼‚æ­¥æ¶ˆæ¯ä¼˜å…ˆå¤„ç†çš„ï¼› å±éšœå’Œæ™®é€šæ¶ˆæ¯ä¸€æ ·å¯ä»¥æ ¹æ®æ—¶é—´æ¥æ’å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„é€‚å½“ä½ç½®ï¼Œå¹¶ä¸”åªä¼šæŒ¡ä½å®ƒåé¢çš„åŒæ­¥æ¶ˆæ¯çš„åˆ†å‘ï¼› postSyncBarrierä¼šè¿”å›ä¸€ä¸ªtokenï¼Œåˆ©ç”¨è¿™ä¸ªtokenå¯ä»¥æ’¤é”€å±éšœï¼› postSyncBarrieræ˜¯hideçš„ï¼Œä½¿ç”¨å®ƒå¾—ç”¨åå°„ï¼› æ’å…¥æ™®é€šæ¶ˆæ¯ä¼šå”¤é†’æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æ’å…¥å±éšœä¸ä¼šã€‚ ","date":"2021-03-04","objectID":"/messagequeue%E8%A7%A3%E8%AF%BB/:0:5","series":null,"tags":["Android","Handler","Looper","Message","MessageQueue"],"title":"MessageQueueè§£è¯»","uri":"/messagequeue%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"Handlerçš„åŸç† å†…å­˜å…±äº«æ–¹æ¡ˆï¼Œå¹¶ä¸”é€šè¿‡åŠ é”é¿å…çº¿ç¨‹ä¹‹é—´çš„ç›¸äº’å¹²æ‰°ã€‚ ä¸ºä½•ä¸ç”¨wait/notify ç­”æ¡ˆï¼š é€šè¿‡é˜…è¯»main()å‡½æ•°ï¼Œä¼šå‘ç°ä¸»çº¿ç¨‹å®Œå…¨å°±æ˜¯åŸºäºloopæ¥è¿è¡Œçš„ï¼Œæ‰€ä»¥çš„Androidå®Œå…¨å°±æ˜¯åœ¨handler+loop+messageä¸Šé¢ç©çš„ã€‚é‚£ä¹ˆHandleræœºåˆ¶æœ€æ ¸å¿ƒçš„ç”¨é€”æ˜¯ï¼šç»´æŒç¨‹åºçš„è¿è¡Œï¼ï¼Œè€Œæ¶ˆæ¯æœºåˆ¶åè€Œæ˜¯æ¬¡è¦ç”¨é€”ã€‚ ","date":"2021-03-04","objectID":"/handler%E9%AB%98%E7%BA%A7/:1:0","series":null,"tags":null,"title":"Handlerçš„åŸç†","uri":"/handler%E9%AB%98%E7%BA%A7/"},{"categories":null,"content":"MessageQueueçš„æ•°æ®ç»“æ„ ç”±å•é“¾è¡¨å®ç°çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚ ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ ¹æ®æ—¶é—´ä¼˜å…ˆçº§çš„æ’å…¥æ’åºç®—æ³•çš„å•é“¾è¡¨ã€‚ ","date":"2021-03-04","objectID":"/handler%E9%AB%98%E7%BA%A7/:2:0","series":null,"tags":null,"title":"Handlerçš„åŸç†","uri":"/handler%E9%AB%98%E7%BA%A7/"},{"categories":null,"content":"ThreadLocal ThreadLocalæ˜¯çº¿ç¨‹ä¸Šä¸‹æ–‡çš„å­˜å‚¨ä¾¿å˜é‡ï¼Œ [] éœ€è¦çœ‹ä¸€ä¸‹ThreadLocalæºç  ","date":"2021-03-04","objectID":"/handler%E9%AB%98%E7%BA%A7/:3:0","series":null,"tags":null,"title":"Handlerçš„åŸç†","uri":"/handler%E9%AB%98%E7%BA%A7/"},{"categories":null,"content":"é¢è¯•é¢˜ ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandler? æ— æ•°ä¸ªã€‚ ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªLooper?å¦‚ä½•ä¿è¯ï¼Ÿ 1ä¸ªï¼ŒThreadLocal. Handlerå†…å­˜æ³„éœ²çš„åŸå› ï¼Ÿ åŒ¿ååˆ›å»ºæ—¶ï¼ŒæŒæœ‰å¤–éƒ¨Activityçš„å¼ºå¼•ç”¨ï¼Œå¯¼è‡´Activityä¸èƒ½GCã€‚ åœ¨å­çº¿ç¨‹new Handler(); éœ€è¦è‡ªå·±è°ƒç”¨Looper.prepary()å’ŒLooper.loop()ã€‚ å­çº¿ç¨‹ä¸­ç»´æŠ¤çš„Looperå½“æ— æ¶ˆæ¯çš„æ—¶å€™å¦‚ä½•å¤„ç†ï¼Ÿ éœ€è¦è‡ªå·±Looper.quit()ï¼Œå¦åˆ™çº¿ç¨‹ä¸€ç›´è¿è¡Œã€‚ ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ä¸­çš„é˜»å¡æœºåˆ¶ ä½¿ç”¨epollæœºåˆ¶ï¼Œå½“msgæ²¡åˆ°æ—¶é—´æ—¶ï¼Œä¼šepollç¡çœ ä¸€æ®µæ—¶é—´ï¼›å½“æ²¡æœ‰msgæ—¶ï¼Œç¡çœ é»˜è®¤æ—¶é—´ï¼ˆå¾ˆé•¿ï¼‰ã€‚å½“è°ƒç”¨åˆ°enqueueMessageæ—¶ï¼Œä¼šè°ƒç”¨nativeWakeæ¥å”¤é†’ã€‚ æ¶ˆæ¯é˜Ÿåˆ—æ— æ¶ˆæ¯å¦‚ä½•å¤„ç†ï¼Ÿ epollæœºåˆ¶ç¡çœ ï¼Œå½“enqueueMessage()æ—¶é€šè¿‡nativeWake()å”¤é†’ã€‚æ•´ä¸ªè¿‡ç¨‹æ˜¯é˜»å¡è¿›è¡Œçš„ã€‚åœ¨å­çº¿ç¨‹ä¸­ï¼Œéœ€è¦è‡ªå·±è°ƒç”¨quité€€å‡ºã€‚ å¤šä¸ªHandlerå‘MessageQueueä¸­æ·»åŠ æ•°æ®ï¼Œä½†æ˜¯ä»–ä»¬å¤„äºä¸åŒçš„çº¿ç¨‹ä¸­ï¼Œæ€ä¹ˆç¡®ä¿æ•°æ®å®‰å…¨ï¼Ÿ sysnchronizedé”äº†thisï¼Œé”çš„æ˜¯å½“å‰çš„MessageQueueå¯¹è±¡ï¼Œä»–çš„æ‰€æœ‰çš„å‡½æ•°å’Œä»£ç å—éƒ½ä¼šå—é™ã€‚ ä¸»çº¿ç¨‹æ˜¯å¦å…è®¸quitï¼Ÿ ä¸»çº¿ç¨‹ä¸å…è®¸ï¼Œä¸€æ—¦è°ƒç”¨å°±ä¼šæŠ›å¼‚å¸¸ã€‚Zygoteä¼šforkè‡ªèº«ï¼Œç»™æ¯ä¸€ä¸ªåº”ç”¨åˆ›å»ºJVMï¼Œç„¶åå¯åŠ¨AcitivityThreadï¼Œåœ¨åè€…æ‰§è¡Œçš„mainæ–¹æ³•ä¸­ä¼šè°ƒç”¨Looper.preparyMainLooper()å’ŒLooper.loop()ï¼Œåº”ç”¨çš„æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯åœ¨è¿™ä¸ªloopæ–¹æ³•ä¸­è¿è¡Œçš„ã€‚ å¤¸çº¿ç¨‹é€šä¿¡çš„åŸç†ï¼Ÿ é€šè¿‡å…±äº«å†…å­˜å®ç°ã€‚ ä¸ºä»€ä¹ˆçº¿ç¨‹é—´ä¸ä¼šå¹²æ‰°ï¼Ÿ é€šè¿‡é”ã€‚ ä¸ºä»€ä¹ˆä¸ç”¨wait/notify? å› ä¸ºJavaçš„wait/notifyåº•å±‚è°ƒç”¨c++å®ç°ï¼ŒAndroidè‡ªå·±å®ç°äº†ä¸€ä¸ªåŸºäºlinuxçš„epollæœºåˆ¶ï¼Œæ•ˆç‡æ›´é«˜ï¼Ÿ ","date":"2021-03-04","objectID":"/handler%E9%AB%98%E7%BA%A7/:4:0","series":null,"tags":null,"title":"Handlerçš„åŸç†","uri":"/handler%E9%AB%98%E7%BA%A7/"},{"categories":null,"content":"TODO ThreadLocalåŸç†è¿›ä¸€æ­¥äº†è§£ ","date":"2021-03-04","objectID":"/handler%E9%AB%98%E7%BA%A7/:5:0","series":null,"tags":null,"title":"Handlerçš„åŸç†","uri":"/handler%E9%AB%98%E7%BA%A7/"},{"categories":null,"content":"æ„é€ æ–¹æ³• public Handler(@NonNull Looper looper, @Nullable Callback callback, boolean async) { mLooper = looper; mQueue = looper.mQueue; mCallback = callback; mAsynchronous = async; } æ„é€ æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒhandleræŒæœ‰Looperçš„MessageQueueã€‚ ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"obtainMessage public final Message obtainMessage(){ return Message.obtain(this); } Handlerçš„obtainMessage()å…¶å®è¿˜æ˜¯è°ƒç”¨Message.obtain()æ–¹æ³•ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨åè€…åè€Œæ•ˆç‡æ›´é«˜ã€‚é‚£ä¹ˆæ¥çœ‹ä¸€ä¸‹Message.obtain()å¹²äº†ä»€ä¹ˆï¼š public static Message obtain(Handler h) { Message m = obtain(); m.target = h; return m; } æ²¡é”™ï¼Œå°±æ˜¯è®¾ç½®äº†ä¸€ä¸ªtargetã€‚ ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"sendMessage public final boolean sendMessage(@NonNull Message msg) { return sendMessageDelayed(msg, 0); } public final boolean sendMessageDelayed(@NonNull Message msg, long delayMillis) { if (delayMillis \u003c 0) { delayMillis = 0; } return sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis); } public boolean sendMessageAtTime(@NonNull Message msg, long uptimeMillis) { MessageQueue queue = mQueue; if (queue == null) { RuntimeException e = new RuntimeException( this + \" sendMessageAtTime() called with no mQueue\"); Log.w(\"Looper\", e.getMessage(), e); return false; } return enqueueMessage(queue, msg, uptimeMillis); } /** * æ ¸å¿ƒåœ¨è¿™é‡Œ */ private boolean enqueueMessage(@NonNull MessageQueue queue, @NonNull Message msg, long uptimeMillis) { msg.target = this; msg.workSourceUid = ThreadLocalWorkSource.getUid(); if (mAsynchronous) { msg.setAsynchronous(true); } return queue.enqueueMessage(msg, uptimeMillis);//æœ€åè°ƒç”¨çš„æ˜¯queue.enqueueMessage } sendMessageæœ€åæ˜¯é€šè¿‡MessageQueueçš„enqueueMessageå®ç°æ¶ˆæ¯çš„å‘é€ã€‚é‚£ä¹ˆæˆ‘çŸ¥é“messageæœ‰ä¸ªsendToTargetæ–¹æ³•ï¼Œå…¶å®ä¹Ÿæ˜¯é€šè¿‡handlerå»å‘æ¶ˆæ¯çš„ã€‚ public void sendToTarget() { target.sendMessage(this); } å½“æ¶ˆæ¯å‘å‡ºåï¼Œå°±è¿›å…¥äº†ç”Ÿäº§è€…æ¨¡å‹ä¸­ã€‚ ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"post postå…¶å®ä¹Ÿæ˜¯åŸºäºæ¶ˆæ¯å®ç°çš„ï¼Œä½†ä¸å‘é€æ¶ˆæ¯ä¸åŒçš„æ˜¯ï¼Œpostæ˜¯å…ˆåˆ›å»ºä¸ªæ¶ˆæ¯ï¼Œç„¶åæŠŠRunnableç±»å‹çš„å‚æ•°èµ‹å€¼ç»™msgçš„callbackã€‚å‰é¢è§£è¯»Messageçš„æ—¶å€™äº†è§£åˆ°ï¼Œcallbackæ˜¯åœ¨handleræ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™æ‰æ‰§è¡Œï¼Œå®ƒä¸handleråœ¨åŒä¸€çº¿ç¨‹ã€‚ /** * æŠŠRunnableæ·»åŠ åˆ°messageä¸­ï¼Œå¹¶ä¸”åœ¨handleræ‰€åœ¨çº¿ç¨‹è¿è¡Œ */ public final boolean post(@NonNull Runnable r) { return sendMessageDelayed(getPostMessage(r), 0); } private static Message getPostMessage(Runnable r) { Message m = Message.obtain();//ä»messageå›æ”¶æ± ä¸­å–ä¸€ä¸ªé—²ç½®msg m.callback = r;//èµ‹å€¼callback return m; } ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:4:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"postDelayed public final boolean postDelayed(@NonNull Runnable r, long delayMillis) { return sendMessageDelayed(getPostMessage(r), delayMillis); } public final boolean sendMessageDelayed(@NonNull Message msg, long delayMillis) { if (delayMillis \u003c 0) { delayMillis = 0; } return sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis); } ä¸€èˆ¬é¢è¯•çš„ä¼šè€ƒè¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘æ„Ÿè§‰ä¹Ÿæ²¡å•¥å•Šï¼Œæ— éå°±æ˜¯ä¸ªSystemClock.uptimeMillis()åŠ ä¸Šè®¾å®šçš„å»¶è¿Ÿæ—¶é—´ã€‚ SystemClock.uptimeMillis()æ˜¯ä»ç³»ç»Ÿå¯åŠ¨åå¼€å§‹ç´¯è®¡çš„æ—¶é—´ï¼Œå¹¶ä¸”åœ¨ç³»ç»Ÿè¿›å…¥æ·±åº¦ç¡çœ çš„æ—¶å€™æš‚åœç´¯è®¡ã€‚ ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:5:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ¥æ”¶æ¶ˆæ¯ å‰é¢åœ¨Looperè§£è¯»é‡Œäº†è§£åˆ°ï¼ŒLooperåœ¨loopæ–¹æ³•ä¸­æ­»å¾ªç¯è¯»å–messageï¼Œç„¶åé€šè¿‡msg.target.dispatchMessage(msg);æ–¹æ³•å‘é€æ¶ˆæ¯ï¼š /** * Handle system messages here. */ public void dispatchMessage(@NonNull Message msg) { if (msg.callback != null) { handleCallback(msg); } else { if (mCallback != null) { if (mCallback.handleMessage(msg)) { return; } } handleMessage(msg); } } è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœmsgçš„callbackä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å¤„ç†callback,åä¹‹åˆ™å¤„ç†msgã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç»™msgæ·»åŠ äº†callbackä¹‹åï¼ŒHandlerçš„handleMessageä¸ä¼šå†å›è°ƒçš„åŸå› ã€‚ handleCallback: private static void handleCallback(Message message) { message.callback.run(); } ç›´æ¥åœ¨å½“å‰çº¿ç¨‹å»è·‘Runnableç±»å‹çš„callbackã€‚ ","date":"2021-03-04","objectID":"/handler%E8%A7%A3%E8%AF%BB/:6:0","series":null,"tags":null,"title":"Handlerè§£è¯»","uri":"/handler%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"åˆ›å»º æˆ‘ä»¬éƒ½çŸ¥é“åˆ›å»ºMessageçš„æ—¶å€™æœ‰ä¸¤ç§æ–¹å¼ï¼š æ„é€ æ–¹æ³•åˆ›å»ºï¼ˆä¸æ¨èï¼‰ã€‚ Message.obtain();ï¼ˆæ¨èï¼‰. ä¸ºäº†é˜²æ­¢OOMï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ç›´æ¥ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œç›´æ¥ä»å›æ”¶æ± é‡Œé¢æ‹¿é—²ç½®ã€‚é‚£ä¹ˆè¿™ä¸ªé—²ç½®çš„Messageæ˜¯ä»å“ªåˆ›å»ºçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç”¨å…ˆnewä¸€ä¸ªMessageï¼Œå›æ”¶æ± é‡Œé¢å°±æœ‰å‘¢ï¼Ÿ public static final Object sPoolSync = new Object(); /** * æ± å­ * / private static Message sPool; private static int sPoolSize = 0; private static final int MAX_POOL_SIZE = 50; @UnsupportedAppUsage /*package*/ Message next; public static Message obtain() { synchronized (sPoolSync) { if (sPool != null) { Message m = sPool; sPool = m.next; m.next = null;//æ‰“æ–­äº†é“¾æ¡ m.flags = 0; // clear in-use flag sPoolSize--; return m; } } return new Message(); } ç”±ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œobtain()æ–¹æ³•æ£€æŸ¥æ± å­ä¸ºnull,å°±ä¼šè‡ªåŠ¨newä¸€ä¸ªmessageå‡ºæ¥ã€‚è€Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™æŠ½å–å‡ºæ¥æ¸…ä¸€ä¸‹çŠ¶æ€è¿”å›ï¼Œå¹¶æŠŠåŸæ¥çš„nextå‰ç½®ç»™sPoolï¼Œæœ€åæŠŠsizeè‡ªå‡1ã€‚ è¿™é‡Œçš„sPollæ¯”è¾ƒæœ‰æ„æ€ï¼Œå«æ± å­ï¼Œä½†å…¶å®æ˜¯ä¸ªå•å‘é“¾ï¼Œæˆ‘è§‰å¾—å«é˜Ÿåˆ—æ›´åˆé€‚ã€‚ä½†æ˜¯çœ‹åˆ°åé¢ä¼šå‘ç°è¿˜æ˜¯åº”è¯¥å«æ± å­ã€‚ æ‰€ä»¥ï¼ŒMessageçš„å®è´¨æ˜¯å•å‘é“¾+Sizeæ•´æ•°ï¼Œæœ€å¤šä¸èƒ½è¶…è¿‡50ä¸ªï¼ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:1","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å›æ”¶å¤ç”¨æŒ‡å®šçš„Message /** * Same as {@link #obtain()}, but copies the values of an existing * message (including its target) into the new one. * @param orig Original message to copy. * @return A Message object from the global pool. */ public static Message obtain(Message orig) { Message m = obtain(); m.what = orig.what; m.arg1 = orig.arg1; m.arg2 = orig.arg2; m.obj = orig.obj; m.replyTo = orig.replyTo; m.sendingUid = orig.sendingUid; m.workSourceUid = orig.workSourceUid; if (orig.data != null) { m.data = new Bundle(orig.data); } m.target = orig.target; m.callback = orig.callback; return m; } å¦‚æœéœ€è¦å›æ”¶å¹¶ä¸”å¤ç”¨æŒ‡å®šçš„Messageï¼Œé‚£ä¹ˆå°±æŠŠè¯¥messageä¼ é€’åˆ°obtainæ–¹æ³•ä¸­ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå…¶å®æ˜¯é€šè¿‡copyå€¼ç»™å›æ”¶çš„messageæ¥å®Œæˆã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:2","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"target obtainæ–¹æ³•å¯ä»¥ä¼ é€’ä¸€ä¸ªHandlerå¯¹è±¡ã€‚ /** * Same as {@link #obtain()}, but sets the value for the \u003cem\u003etarget\u003c/em\u003e member on the Message returned. * @param h Handler to assign to the returned Message object's \u003cem\u003etarget\u003c/em\u003e member. * @return A Message object from the global pool. */ public static Message obtain(Handler h) { Message m = obtain(); m.target = h; return m; } å¦‚æœæŒ‡å®šäº†å¯¹è±¡ï¼Œå°±å¯ä»¥é€šè¿‡sendToTarget()æ–¹æ³•ç›´æ¥å‘é€Messageäº†ã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:3","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"callback /** * Same as {@link #obtain(Handler)}, but assigns a callback Runnable on * the Message that is returned. * @param h Handler to assign to the returned Message object's \u003cem\u003etarget\u003c/em\u003e member. * @param callback Runnable that will execute when the message is handled. * @return A Message object from the global pool. */ public static Message obtain(Handler h, Runnable callback) { Message m = obtain(); m.target = h; m.callback = callback; return m; } obtainæ–¹æ³•è¿˜å¯ä»¥ä¼ é€’ä¸€ä¸ªRunnableï¼Œä½œç”¨æ˜¯å½“messageå‘é€åˆ°Handleræ—¶å°±ä¼šæ‰§è¡Œè¿™ä¸ªrunnableã€‚è€Œä¸”è¿™ä¸ªcallbackç«Ÿç„¶ä¸Handleråœ¨åŒä¸€çº¿ç¨‹ä¸­ï¼ï¼ï¼ ä½†æ˜¯ä¸€æ—¦ç»™æ¶ˆæ¯è®¾ç½®äº†callbackï¼Œå®æµ‹Handlerçš„handleMessageä¼šå¤±æ•ˆï¼Œè¿™æ˜¯ä¸ºå•¥ï¼Œè¦æƒ³ä¸€æƒ³äº†ã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:4","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¼ é€’ mHandler.send(msg); msg.sendToTarget(); Parcelable ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:5","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å¼‚æ­¥ è®¾ç½®æ¶ˆæ¯æ˜¯å¦å¼‚æ­¥ï¼Œè¿™æ„å‘³ç€å®ƒä¸å—{@link Looper}åŒæ­¥éšœç¢çš„çº¦æŸã€‚ public void setAsynchronous(boolean async) { if (async) { flags |= FLAG_ASYNCHRONOUS; } else { flags \u0026= ~FLAG_ASYNCHRONOUS; } } å¼‚æ­¥æ–¹å¼æˆ‘å¹³æ—¶å¾ˆå°‘ä½¿ç”¨ï¼Œå¬è¯´æ˜¯å¯ä»¥æå‡æ¶ˆæ¯çš„é‡è¦æ€§ï¼Œå¦‚æœæ ‡æ˜å¼‚æ­¥ï¼Œé‚£ä¹ˆMessageQueueå°†ä¼šç”±è¿‘åŠè¿œä¼˜å…ˆå¤„ç†å¼‚æ­¥æ¶ˆæ¯ï¼Œç„¶åå†å¤„ç†åŒæ­¥æ¶ˆæ¯ã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:6","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"å›æ”¶ public void recycle() { if (isInUse()) { if (gCheckRecycle) { throw new IllegalStateException(\"This message cannot be recycled because it is still in use.\"); } return; } recycleUnchecked(); } å…ˆæ£€æµ‹æ˜¯å¦åœ¨ä½¿ç”¨ä¸­ï¼Œæ£€æµ‹é€šè¿‡æ‰çœŸæ­£çš„å›æ”¶ï¼š /** * å›æ”¶ä¸€ä¸ªå¯èƒ½æ­£åœ¨ä½¿ç”¨ä¸­çš„Messageã€‚ * å½“é˜Ÿåˆ—ä¸­çš„Messageè¢«é‡Šæ”¾æ—¶ï¼Œç”±MessageQueue å’Œ Looperåœ¨å†…éƒ¨è°ƒç”¨æ­¤æ–¹æ³•ã€‚ */ @UnsupportedAppUsage void recycleUnchecked() { // Mark the message as in use while it remains in the recycled object pool. // Clear out all other details. flags = FLAG_IN_USE; what = 0; arg1 = 0; arg2 = 0; obj = null; replyTo = null; sendingUid = UID_NONE; workSourceUid = UID_NONE; when = 0; target = null; callback = null; data = null; synchronized (sPoolSync) { if (sPoolSize \u003c MAX_POOL_SIZE) { next = sPool; // æ·»åŠ å…¥é“¾æ¡ sPool = this; sPoolSize++; } } } è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯æŠŠå½“å‰çš„Messageå¯¹è±¡å›æ»šåˆ°åˆå§‹çŠ¶æ€ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºã€Œæ­£åœ¨ä½¿ç”¨ã€ã€‚æŠŠå½“å‰çš„Messageèµ‹å€¼ç»™äº†nextï¼Œå¹¶ä¸”sPoolSize++,è¡¨ç¤ºå¤šäº†ä¸ªé—²ç½®ã€‚ MAX_POOL_SIZEå¸¸é‡çš„å€¼ä¸º50ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªAppæœ€å¤šèƒ½æœ‰50ä¸ªé—²ç½®çš„messageã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:7","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ€»ç»“ Messageçš„åŸç†æ˜¯æ•´æ•°sPoolSize+é™æ€å•å‘é“¾sPollï¼Œå¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„messageéƒ½æ˜¯ä»sPollä¸­å–é˜Ÿé¦–ï¼ŒçŠ¶æ€æ”¹ä¸ºé—²ç½®ï¼Œå›æ”¶åæŠŠçŠ¶æ€æ”¹æˆã€Œä½¿ç”¨ä¸­ã€ï¼Œå¹¶æ’å›åˆ°é˜Ÿé¦–ï¼Œéµå¾ªã€Œåè¿›å…ˆå‡ºã€åŸåˆ™ï¼Œå¹¶åœ¨å¡«å……å’Œå›æ”¶æ—¶é€šè¿‡synchronizedä¿éšœçº¿ç¨‹å®‰å…¨ã€‚ ","date":"2021-03-03","objectID":"/message%E8%A7%A3%E8%AF%BB/:0:8","series":null,"tags":["Android","message"],"title":"Messageè§£è¯»","uri":"/message%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ç±»å›¾ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:1:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"prepare public static void prepare() { prepare(true); } private static void prepare(boolean quitAllowed) { // å¦‚æœçº¿ç¨‹å·²ç»æœ‰äº†Looperå°±ä¼šæŠ¥é”™ if (sThreadLocal.get() != null) { throw new RuntimeException(\"Only one Looper may be created per thread\"); } sThreadLocal.set(new Looper(quitAllowed)); } /** * æ„é€ æ–¹æ³•ä¸­åˆ›å»ºMessageQueueï¼Œå¹¶å¼•ç”¨å½“å‰çº¿ç¨‹ã€‚ */ private Looper(boolean quitAllowed) { mQueue = new MessageQueue(quitAllowed); mThread = Thread.currentThread(); } Looper.prepare()æ–¹æ³•åªæ˜¯ä¸ºäº†åˆ›å»ºMessageQueueå’Œåˆå§‹åŒ–ThreadLocalã€‚ ä¹‹å‰äº†è§£è¿‡ï¼ŒThreadLocalå¯ä»¥ä¿è¯å¤šçº¿ç¨‹è®¿é—®å…±äº«å˜é‡çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä»–ä¸åƒsynchronizedé é˜»å¡å®ç°çº¿ç¨‹å®‰å…¨ï¼Œè€Œæ˜¯é€šè¿‡å¯¹å˜é‡æ‹·è´çš„æ–¹å¼ï¼Œä½¿æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ“ä½œè‡ªå·±çš„æ‹·è´ï¼Œå®ç°çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥æ•ˆç‡è¦ä¼˜äºsynchronizedã€‚è¯¦æƒ…çœ‹è¿™é‡Œå’Œè¿™é‡Œ ThreadLocalåœ¨æ­¤å¤„çš„ä½¿ç”¨æ˜¯ä¸ºäº†ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½åˆ†é…åˆ°ä¸€ä¸ªLooperå¯¹è±¡ï¼Œå¤šæ¬¡è°ƒç”¨Looper.prepary()æ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è€Œä¸”åœ¨å…¶ä»–çº¿ç¨‹å»æ“ä½œè¿™ä¸ªLooperå¯¹è±¡å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ¯”å¦‚åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨mHandler.getLooper().quitSafely()æ¥ç»ˆæ­¢å­çº¿ç¨‹çš„Looperå¯¹è±¡çš„loop()å¾ªç¯ã€‚ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:2:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"loop åªçœ‹æ ¸å¿ƒï¼š public static void loop() { final Looper me = myLooper();//å…¶å®å°±æ˜¯ä»threadLocalä¸­å–å‡ºlooper //çœç•¥åˆ¤ç©º me.mInLoop = true; //æ”¹å˜çŠ¶æ€ final MessageQueue queue = me.mQueue;//æ‹¿åˆ°MessageQueue ... //æ¥ä¸‹æ¥å°±æ˜¯å¯åŠ¨ä¸ªæ­»å¾ªç¯ï¼Œä¸ºä»€ä¹ˆä¸ç”¨whileè€Œç”¨forå‘¢ï¼Ÿ for (;;) { Message msg = queue.next(); // ä»MessageQueueä¸­å–å‡ºMessage if (msg == null) { //å¦‚æœæ± å­é‡Œé¢æ²¡æœ‰msgäº†åˆ™ç»ˆæ­¢å¾ªç¯ï¼Œæ‰€ä»¥è¿™é‡Œå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ­»å¾ªç¯ return; } try { msg.target.dispatchMessage(msg);//è°ƒç”¨Handlerçš„dispatchMessage } catch (Exception exception) { //... } finally { //... } //å›æ”¶æ¶ˆæ¯ msg.recycleUnchecked(); } è¿™é‡Œæ­»å¾ªç¯çš„å†™æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œä¸ºä»€ä¹ˆä¸ç”¨while(true)æˆ–è€…do-while(true)å‘¢ï¼Ÿä¸€å¼€å§‹æ€»æ˜¯æƒ³ä¸æ˜ç™½ã€‚åæ¥å‘ç°ï¼Œç”¨whileç³»åˆ—å¾ªç¯ï¼Œæ— è®ºå¦‚ä½•éƒ½è¦ä¼ é€’ä¸ªè¡¨è¾¾å¼è¿›å»ï¼Œé‚£ä¹ˆå°±æ¶‰åŠåˆ°äº†å†…å­˜å ç”¨å’ŒCPUè¿ç®—ã€‚è€Œç”¨ç©ºforå¾ªç¯ï¼Œåˆ™ä¸å¿…åˆ›å»ºä»»ä½•å˜é‡æˆ–ç»“æ„ä½“ï¼Œèƒ½å¤Ÿæœ€å¤§é™åº¦çš„é™ä½å†…å­˜å’ŒCPUå ç”¨ï¼ŒçœŸæ˜¯å­¦åˆ°äº†ã€‚ ä»Šå¤©åˆçªç„¶æƒ³åˆ°ï¼Œæ—¢ç„¶æ¶‰åŠåˆ°è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆæ¯æ¬¡å¾ªç¯çš„æ—¶å€™éƒ½éœ€è¦åˆ¤æ–­è¡¨è¾¾å¼æ˜¯å¦æˆç«‹ï¼Œæ— å¯é¿å…æµªè´¹äº†cpuï¼ŒåŒæ—¶å¸¦æ¥äº†cpuè®¡ç®—å•å…ƒåšæ— æ•ˆè®¡ç®—å¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚ ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“æ²¡æœ‰msgæ—¶ï¼Œloopå°±ä¼šé€€å‡ºï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä»€ä¹ˆæ—¶å€™ä¼šæ²¡æœ‰msgå‘¢ï¼Ÿå¹¶ä¸”ä¸€æ—¦loopé€€å‡ºï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹ä¸ä¹Ÿå°±è·Ÿç€é€€å‡ºäº†å—ï¼Ÿç›®å‰æˆ‘çš„çŒœæƒ³æ˜¯ï¼Œå½“æ²¡æœ‰æ¶ˆæ¯æ—¶ï¼ŒAndroidé€šè¿‡epoolæœºåˆ¶è®©cpuä¼‘çœ ï¼Œå½“æœ‰äº†æ–°çš„msgæ—¶åˆä¼šå”¤é†’cpuï¼Œä»è€Œä¿è¯ä¸€ç›´å­˜åœ¨msgã€‚è€Œä¼‘çœ çš„æ—¶æœºæ˜¯åœ¨messageQueueçš„next()æ–¹æ³•ä¸­è¿›è¡Œçš„ï¼š if (msg != null) { ... } else { //å¦‚æœå½“å‰æ²¡æœ‰æ¶ˆæ¯ï¼ŒæŠŠå”¤é†’æ—¶é’Ÿè®¾ä¸º-1ï¼Œé‚£ä¹ˆæ„å‘³ç€çº¿ç¨‹ä¼šæ²‰ç¡Integer.MaxValue nextPollTimeoutMillis = -1; } ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:3:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¸»çº¿ç¨‹ä¸­ä¸ºä½•ä¸ANRä¹Ÿä¸ä¼šå†…å­˜æ³„éœ² æˆ‘ä»¬éƒ½çŸ¥é“çº¿ç¨‹ä¸€æ—¦è¿è¡Œå®Œæ¯•å°±ä¼šå›æ”¶ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹ä¸­æ²¡æœ‰æ‰§è¡Œä»»ä½•åŠ¨ä½œæ—¶ä¸ºä½•ä¸ä¼šå›æ”¶å‘¢ï¼ŸåŸå› å°±æ˜¯å› ä¸ºlooperåœ¨æ­»å¾ªç¯ï¼Œé˜»å¡äº†ä¸»çº¿ç¨‹çš„å›æ”¶ï¼Œé‚£ä¹ˆç›¸åº”çš„ä¸€æ—¦ä¸å†æ­»å¾ªç¯ï¼Œç¨‹åºä¹Ÿå°±é€€å‡ºäº†ã€‚AndroidåŒæ—¶åˆ©ç”¨Looperçš„æ­»å¾ªç¯ï¼Œå‘é€æ¶ˆæ¯ï¼Œæ¯”å¦‚é€šçŸ¥Viewé‡ç»˜ç­‰ç­‰ã€‚ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:4:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ä¼šä¸ä¼šé˜»å¡å­çº¿ç¨‹å‘¢ï¼Ÿ class MyRunnable implements Runnable { @Override public void run() { Looper.prepare(); Handler handler = new Handler(); Message msg = Message.obtain(handler, new Runnable() { @Override public void run() { Log.d(\"\", \"run: \"); } }); msg.sendToTarget(); Looper.loop(); Log.d(\"è¿™é‡Œæ°¸è¿œéƒ½ä¸ä¼šæ‰§è¡Œ\", \"run:\"); int i = 0; } } æˆ‘ç”¨ProfileæŒç»­è§‚å¯Ÿä¹‹åå‘ç°ï¼šç­”æ¡ˆæ˜¯ä¼šï¼CPUä¼šä¸€ç›´è¢«å ç”¨ï¼Œçº¿ç¨‹æ± ä¹Ÿæ— æ³•å›æ”¶è¯¥çº¿ç¨‹ï¼ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:5:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"ç»ˆæ­¢loop æ‰€ä»¥ä¸ºäº†å°½å¯èƒ½å‡å°‘CPUæµªè´¹ï¼Œåº”è¯¥è°ƒç”¨handler.getLooper().quitSafely(); public void quitSafely() { mQueue.quit(true); } å†æ¥çœ‹mQueue.quit(true)ï¼š void quit(boolean safe) { if (!mQuitAllowed) { throw new IllegalStateException(\"Main thread not allowed to quit.\"); } synchronized (this) { if (mQuitting) { return; } mQuitting = true; if (safe) { removeAllFutureMessagesLocked(); } else { removeAllMessagesLocked(); } // We can assume mPtr != 0 because mQuitting was previously false. nativeWake(mPtr); } } ä¸»è¦æ˜¯ä¿®æ”¹äº†mQuitting = true;ï¼Œè¿™å°±æ˜¯ä¸ªæ ‡è®°ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦ç»ˆæ­¢æ­»å¾ªç¯ã€‚é€ æˆçš„æ•ˆæœå‘¢å½“ç„¶æ˜¯åœ¨loopæ–¹æ³•çš„æ­»å¾ªç¯ä¸­è°ƒç”¨mqueue.next()æ—¶ï¼Œä¼šå—åˆ°ä¸‹é¢ä»£ç çš„å½±å“ï¼š if (mQuitting) { dispose(); return null; } private void dispose() { if (mPtr != 0) { nativeDestroy(mPtr); mPtr = 0; } } private native static void nativeDestroy(long ptr); ç›´æ¥è¿”å›nullï¼Œè€Œåœ¨Looperçš„loopæ–¹æ³•çš„æ­»å¾ªç¯ä¸­æœ‰è¿™æ ·çš„åˆ¤æ–­ï¼š ... Message msg = queue.next(); // might block if (msg == null) { // No message indicates that the message queue is quitting. me.mLogging.println(\"æ³¨æ„å•¦ï¼ŒçœŸçš„åœå•¦ï½ï½ï½\"); return; } ... å¦‚æœqueue.nextè¿”å›nullé‚£ä¹ˆå°±ç»ˆæ­¢å¾ªç¯ã€‚ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:6:0","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"æ€»ç»“ Looperå…¶å®æ¯”è¾ƒç®€å•ï¼Œæ ¸å¿ƒå°±ä¸¤ä¸ªæ–¹æ³•ï¼š prepary()æ–¹æ³•ç”¨æ¥åˆ›å»ºMessageQueueå’ŒThreadLocalï¼› loop()æ–¹æ³•å°±æ˜¯æ°¸åŠ¨æœºï¼Œä¸æ–­ä»messageä¸­æ‹¿å‡ºmsgæ¥æ¶ˆè´¹ã€‚ åªæœ‰è°ƒç”¨quitSafely()æˆ–è€…quit()è¿™ä¸¤ä¸ªæ–¹æ³•ä¿®æ”¹mQuittingè¿™ä¸ªæ ‡è®°ä½ï¼Œä½¿MessageQueueçš„next()æ–¹æ³•è¿”å›nullï¼Œæ‰èƒ½é€€å‡ºloop()æ–¹æ³•ã€‚ ä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªLooperï¼Œæ˜¯é€šè¿‡ThreadLocalå®ç°çš„ã€‚ ","date":"2021-03-02","objectID":"/looper%E8%A7%A3%E8%AF%BB/:6:1","series":null,"tags":["Android"],"title":"Looperè§£è¯»","uri":"/looper%E8%A7%A3%E8%AF%BB/"},{"categories":null,"content":"è®°å¿†æ–¹å¼ Fragmentçš„onAttach,onCreate,onCreateView,onViewCreatedåœ¨é™„åŠ åˆ°Activityæ—¶æ‰§è¡Œï¼Œå¦‚setContentViewæˆ–è€…add,replaceæ—¶ã€‚ Fragmentçš„onResumeæ˜¯åœ¨Activityçš„onResumeæ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œï¼Œè€Œå…¶ä»–ç”Ÿå‘½å‘¨æœŸéƒ½åœ¨Activityçš„super.onXXXå†…æ‰§è¡Œã€‚ è·³è½¬æ—¶ï¼Œå‰ä¸€ä¸ªé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸèµ°åˆ°onPauseæ—¶æš‚åœï¼Œç­‰å¾…åä¸€ä¸ªé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸèµ°åˆ°onResumeä¹‹åï¼Œå†ç»§ç»­æ‰§è¡ŒonStopï¼›åŒç†ï¼Œè¿”å›æ—¶åä¸€ä¸ªé¡µé¢èµ°åˆ°onPauseæ—¶æš‚åœï¼Œå‰ä¸€ä¸ªé¡µé¢onRestart,onStart,onResumeä¹‹åï¼Œå†ç»§ç»­æ‰§è¡Œå‰©ä¸‹çš„onStop,onDestoryã€‚ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:1:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"æ‡’åŠ è½½ Fragmentçš„æ‡’åŠ è½½ä¸»è¦æ˜¯ç”¨äºViewPagerä¸­ï¼ŒViewPagerä¼šåœ¨åŠ è½½fragmentä¹‹å‰è°ƒç”¨å…¶setUserVisibleHint()æ–¹æ³•ã€‚æ‰€ä»¥setUserVisibleHint()æ˜¯åœ¨onActtch()æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:2:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"æµç¨‹å›¾ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:3:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"å¯åŠ¨ D: FirstActivity's super.onCreate: å‰ D: FirstActivity's super.onCreate: å D: FirstActivity's setContentView: å‰ D: FirstFragment's onAttach: D: FirstFragment's onCreate: D: FirstFragment's onCreateView: D: FirstFragment's onViewCreated: D: FirstActivity's setContentView: å D: FirstActivity's super.onStart: å‰ D: FirstFragment's onActivityCreated: D: FirstFragment's onStart: D: FirstActivity's super.onStart: å D: FirstActivity's super.onResume: å‰ D: FirstActivity's super.onResume: å D: FirstFragment's onResume: fragmentçš„onAttachï¼ŒonCreateï¼ŒonCreateViewï¼ŒonViewCreatedæ˜¯åœ¨Activityçš„setContentViewä¸­æ‰§è¡Œçš„ã€‚ æƒ³ä¸€ä¸‹å°±çŸ¥é“ï¼ŒActivityçš„setContentViewçš„ç›®çš„æ˜¯ä»xmlä¸­åŠ è½½Viewï¼Œè€Œæˆ‘æŠŠfragmentå†™åœ¨äº†xmlé‡Œé¢ã€‚ è¿™é‡Œæœ‰ä¸ªå°æ’æ›²ï¼Œäº‹å®è¯æ˜ï¼ŒActivityçš„super.onCreateå¯ä»¥å†™åœ¨setContentViewä¹‹åï¼Œä½†æ˜¯xmlä¸­å­˜åœ¨fragmentæ—¶å°±ä¼šæŠ¥é”™ã€‚ fragmentçš„onActivityCreatedã€onStartæ˜¯åœ¨Activityçš„super.onStartæ–¹æ³•ä¸­æ‰§è¡Œã€‚ fragmentçš„onResumeæ˜¯åœ¨activityçš„super.onResumeä¹‹åæ‰§è¡Œã€‚ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:4:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"è·³è½¬ D: FirstActivity's super.onPause: å‰ D: FirstFragment's onPause: D: FirstActivity's super.onPause: å D: SecondActivity's super.onCreate: å‰ D: SecondActivity's super.onCreate: å D: SecondActivity's setContentView: å‰ D: SecondFragment's onAttach: D: SecondFragment's onCreate: D: SecondFragment's onCreateView: D: SecondFragment's onViewCreated: D: SecondActivity's setContentView: å D: SecondActivity's super.onStart: å‰ D: SecondFragment's onActivityCreated: D: SecondFragment's onStart: D: SecondActivity's super.onStart: å D: SecondActivity's super.onResume: å‰ D: SecondActivity's super.onResume: å D: SecondFragment's onResume: D: FirstActivity's super.onStop: å‰ D: FirstFragment's onStop: D: FirstActivity's super.onStop: å fragmentçš„onPauseæ˜¯åœ¨Activityçš„super.onPauseä¸­æ‰§è¡Œã€‚ å½“ç¬¬äºŒä¸ªå«æœ‰fragmentçš„Activityå¯è§åï¼Œä¸Šä¸€ä¸ªActivityçš„ç”Ÿå‘½å‘¨æœŸæ‰ä¼šç»§ç»­ã€‚ ç„¶åä¸Šä¸€ä¸ªfragmentçš„onStopåœ¨Activityçš„onStopä¸­æ‰§è¡Œã€‚ æ³¨æ„ï¼Œå‰ä¸€ä¸ªActivityæ‰§è¡Œåˆ°onPauseï¼Œç„¶åç¬¬äºŒä¸ªActivityç”Ÿå‘½å‘¨æœŸå®Œæˆåï¼Œå‰ä¸€ä¸ªActivityæ‰ä¼šæ‰§è¡ŒonStopã€‚ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:5:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"è¿”å› D: SecondActivity's super.onPause: å‰ D: SecondFragment's onPause: D: SecondActivity's super.onPause: å D: FirstActivity's super.onRestart: å‰ D: FirstActivity's super.onRestart: å D: FirstActivity's super.onStart: å‰ D: FirstFragment's onStart: D: FirstActivity's super.onStart: å D: FirstActivity's super.onResume: å‰ D: FirstActivity's super.onResume: å D: FirstFragment's onResume: D: SecondActivity's super.onStop: å‰ D: SecondFragment's onStop: D: SecondActivity's super.onStop: å D: SecondActivity's super.onDestroy: å‰ D: SecondFragment's onDestroyView: D: SecondFragment's onDestroy: D: SecondFragment's onDetach: D: SecondActivity's super.onDestroy: å å…ˆæ‰§è¡Œç¬¬äºŒä¸ªActivityçš„onPauseã€‚ å†å›è°ƒå‰ä¸€ä¸ªActivityçš„onRestartã€‚ fragmentçš„onStartåœ¨Activityçš„super.onStartä¸­æ‰§è¡Œã€‚ fragmentçš„onResumeåœ¨Activityçš„super.onResumeä¸­æ‰§è¡Œã€‚ fragmentçš„onStopåœ¨Activityçš„super.onStopä¸­æ‰§è¡Œã€‚ fragmentçš„onDestroyViewã€onDestroyã€onDetachåœ¨Activityçš„super.onDestroyä¸­æ‰§è¡Œã€‚ æ³¨æ„fragmentçš„onResumeæ˜¯åœ¨Activityçš„onResumeä¹‹åæ‰§è¡Œçš„ï¼ï¼ï¼ ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:5:1","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"é€€å…¥åå° D: FirstActivity's super.onPause: å‰ D: FirstFragment's onPause: D: FirstActivity's super.onPause: å D: FirstActivity's super.onStop: å‰ D: FirstFragment's onStop: D: FirstActivity's super.onStop: å ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:6:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"å›åˆ°å‰å° D: FirstActivity's super.onRestart: å‰ D: FirstActivity's super.onRestart: å D: FirstActivity's super.onStart: å‰ D: FirstFragment's onStart: D: FirstActivity's super.onStart: å D: FirstActivity's super.onResume: å‰ D: FirstActivity's super.onResume: å D: FirstFragment's onResume: ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:7:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"é€€å‡º D: FirstActivity's super.onPause: å‰ D: FirstFragment's onPause: D: FirstActivity's super.onPause: å D: FirstActivity's super.onStop: å‰ D: FirstFragment's onStop: D: FirstActivity's super.onStop: å D: FirstActivity's super.onDestroy: å‰ D: FirstFragment's onDestroyView: D: FirstFragment's onDestroy: D: FirstFragment's onDetach: D: FirstActivity's super.onDestroy: å ","date":"2021-02-26","objectID":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/:8:0","series":null,"tags":["Android","ç”Ÿå‘½å‘¨æœŸ","fragment","activity"],"title":"Fragmentåœ¨Activityä¸­çš„ç”Ÿå‘½å‘¨æœŸ","uri":"/fragment%E5%9C%A8activity%E4%B8%AD%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"categories":null,"content":"GraphQLå¦‚ä½•è·å–æ•°æ® æ¯ä¸ªfieldéƒ½æœ‰ä¸€ä¸ªgraphql.schema.DataFetcherä¸ä¹‹å¯¹åº”ã€‚ ä¸€äº›Fileä¼šä½¿ç”¨ç‰¹å®šçš„data fetcherï¼Œè¿™ç§DataFetcherçŸ¥é“æ€ä¹ˆå»è®¿é—®æ•°æ®åº“è·å–fieldçš„ä¿¡æ¯ï¼Œç„¶åå¤§å¤šæ•°çš„dataFetcheråˆ™æ˜¯ç®€å•çš„ä»å†…å­˜ä¸­çš„objectè·å–æ•°æ®ã€‚åœ¨è·å–æ•°æ®æ—¶ï¼Œä¼šå‚ç…§fieldçš„åå­—and Plain Old Java Object (POJO) patterns to get the data. æ‰€ä»¥å¯ä»¥åƒè¿™æ ·æ¥å£°æ˜ä¸€ä¸ªtype: type Query { products(match : String) : [Product] # a list of products } type Product { id : ID name : String description : String cost : Float tax : Float launchDate(dateFormat : String = \"dd, MMM, yyyy') : String } Query.productsè¿™ä¸ªfieldæœ‰ä¸€ä¸ªdata fetcherï¼Œç”¨æ¥è·å–ä»æ•°æ®åº“ä¸­è·å–Productç±»å‹çš„fieldsé›†åˆã€‚å®ƒå¸¦æœ‰ä¸€ä¸ªmatchå‚æ•°ï¼Œå¯ä»¥è¿‡æ»¤å‡ºæˆ‘ä»¬æƒ³è¦çš„productï¼š DataFetcher productsDataFetcher = new DataFetcher\u003cList\u003cProductDTO\u003e\u003e() { @Override public List\u003cProductDTO\u003e get(DataFetchingEnvironment environment) { DatabaseSecurityCtx ctx = environment.getContext(); List\u003cProductDTO\u003e products; String match = environment.getArgument(\"match\"); if (match != null) { products = fetchProductsFromDatabaseWithMatching(ctx, match); } else { products = fetchAllProductsFromDatabase(ctx); } return products; } }; æ¯ä¸ªDataFetcherç›¸äº’ä¹‹é—´ä¼ é€’ç€ä¸€ä¸ªgraphql.schema.DataFetchingEnvironmentå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«æ­£åœ¨è·å–çš„fieldã€ä¼ é€’ç»™fieldçš„å‚æ•°argumentsã€å’Œå…¶ä»–ä¿¡æ¯è¯¸å¦‚fieldçš„ç±»å‹ï¼Œå®ƒçˆ¶çº§çš„ç±»å‹query root objectæˆ–è€…query context objectã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œdata fetcherçš„ç¼–ç æ˜¯åŸºäºcontext objectä½œä¸ºä¸€ä¸ªå®‰å…¨ç¨‹åºæ¥å¤„ç†æ•°æ®åº“çš„è®¿é—®ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬æŠ€æœ¯æ¥æä¾›ä¸€ä¸ªåº•å±‚è°ƒç”¨ä¸Šä¸‹æ–‡ã€‚ å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªProductDTOçš„åˆ—è¡¨ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªfieldéƒ½æä¸€ä¸ªdata fetcherã€‚graphql-java æœ‰ä¸€ä¸ªèªæ˜çš„graphql.schema.PropertyDataFetcherçŸ¥é“æ€ä¹ˆå»æ ¹æ®åç§°è¿½è¸ªPOJOçš„ç»“æ„ã€‚åœ¨æœ¬ä¾‹ä¸­å°±æ˜¯æœ‰ä¸ªå¸¦æœ‰nameçš„fieldï¼Œç„¶ågraphql.schema.PropertyDataFetcherå°†å°è¯•é€šè¿‡POJOçš„public String getName()æ–¹æ³•æ¥è·å–æ•°æ®ã€‚ graphql.schema.PropertyDataFetcheræ˜¯é»˜è®¤çš„DataFetcherã€‚ ä½ ä»ç„¶å¯ä»¥åœ¨DTOçš„æ–¹æ³•ä¸­ä½¿ç”¨graphql.schema.PropertyDataFetcheræ¥è®¿é—®ã€‚è¿™å…è®¸ä½ åœ¨æ•°æ®å‘é€å‡ºå»ä¹‹å‰å…ˆåšä¿®æ”¹ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸ªlaunchDateå­—æ®µæºå¸¦è€…ä¸€ä¸ªå¯é€‰çš„dateFormatå‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ProductDTOä¸­å†™ä¸ªé€»è¾‘åšæ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ–ã€‚ class ProductDTO { private ID id; private String name; private String description; private Double cost; private Double tax; private LocalDateTime launchDate; // ... public String getName() { return name; } // ... public String getLaunchDate(DataFetchingEnvironment environment) { String dateFormat = environment.getArgument(\"dateFormat\"); return yodaTimeFormatter(launchDate,dateFormat); } } ","date":"2021-01-23","objectID":"/graphql-java%E4%BA%8Cdatafetcher/:1:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(äºŒ)DataFetching","uri":"/graphql-java%E4%BA%8Cdatafetcher/"},{"categories":null,"content":"å®šåˆ¶PropertyDataFetcher åƒä¹‹å‰è®²çš„ä¸€æ ·ï¼Œgraphql.schema.PropertyDataFetcheræ˜¯é»˜è®¤çš„data fetcherï¼Œå¹¶ä¸”å®ƒåœ¨è·å–æ•°æ®æ—¶ä½¿ç”¨æ ‡å‡†ç»“æ„ã€‚ å®ƒæ”¯æŒPOJOå’Œmapã€‚å‡è®¾æœ‰ä¸ªfieldå«fieldXï¼Œå®ƒå°†ä¼šå¯»æ‰¾ä¸€ä¸ªPOJOä¹Ÿå«åšfieldXï¼Œæˆ–è€…åœ¨Mapä¸­å»æ‰¾ä¸€ä¸ªkeyä¹Ÿå«åšfieldXã€‚ ç„¶è€Œï¼Œä½ åœ¨å®šä¹‰çš„schemaä¸POJOæœ‰ä¸€ç‚¹ä¸é€šï¼Œæ¯”å¦‚Product.descriptionå¯¹åº”ç€POJOä¸­çš„getDesc(). ä½ å¯ä»¥åœ¨SDLä¸­ä½¿ç”¨@fetchæ³¨è§£æ¥åšåŒ¹é…ï¼š directive @fetch(from : String!) on FIELD_DEFINITION type Product { id : ID name : String description : String @fetch(from:\"desc\") cost : Float tax : Float } è¿™å°†å‘Šè¯‰graphql.schema.PropertyDataFetcheråœ¨è·å–æ•°æ®æ—¶åº”è¯¥ä½¿ç”¨åä¸ºdescçš„å±æ€§æ¥å¯¹åº”SDLä¸­çš„descriptionå­—æ®µã€‚ å¦‚æœä½ ä¸ç”¨SDL,è€Œæ˜¯å–œæ¬¢æ‰‹å†™ä»£ç ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥æŒ‡å®šData Fetcher: GraphQLFieldDefinition descriptionField = GraphQLFieldDefinition.newFieldDefinition() .name(\"description\") .type(Scalars.GraphQLString) .build(); GraphQLCodeRegistry codeRegistry = GraphQLCodeRegistry.newCodeRegistry() .dataFetcher( coordinates(\"ObjectType\", \"description\"), PropertyDataFetcher.fetching(\"desc\")) .build(); ","date":"2021-01-23","objectID":"/graphql-java%E4%BA%8Cdatafetcher/:2:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(äºŒ)DataFetching","uri":"/graphql-java%E4%BA%8Cdatafetcher/"},{"categories":null,"content":"DataFetchingEnvironmentä¸­æœ‰æ„æ€çš„éƒ¨åˆ† æ¯ä¸€ä¸ªdata fetcheréƒ½ä¼ é€’äº†ä¸€ä¸ªgraphql.schema.DataFetchingEnvironmentå¯¹è±¡ã€‚å®ƒçŸ¥é“æˆ‘ä»¬æ­£åœ¨è·å–ä»€ä¹ˆä¸œè¥¿ï¼Œå¹¶ä¸”çŸ¥é“æä¾›äº†å“ªäº›å‚æ•°ã€‚ \u003cT\u003e T getSource()-è·å–fieldçš„ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡å°±æ˜¯çˆ¶çº§è·å–åˆ°çš„ç»“æœï¼Œä»–ä¸€ä¸ªå†…å­˜ä¸­çš„DTOå¯¹è±¡ï¼Œå¹¶ä¸”é€šè¿‡POJOçš„gettersè·å–åˆ°å€¼ã€‚åœ¨å¤æ‚çš„åœºæ™¯ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æ£€æŸ¥å®ƒæ¥è·å–fieldçš„ç‰¹å®šä¿¡æ¯ã€‚å½“graphqlçš„field treeæ‰§è¡Œåè¿”å›çš„æ¯ä¸€ä¸ªfieldçš„å€¼ï¼Œéƒ½ä¼šæˆä¸ºå­çº§çš„sourceã€‚ \u003cT\u003e T getRoot()-ç”¨æ¥æŸ¥çœ‹graphqlçš„æŸ¥è¯¢queryã€‚åœ¨é¡¶å±‚çº§ä¸­ï¼Œrootå’Œsourceæ˜¯ä¸€æ ·çš„ã€‚root objectåœ¨æŸ¥è¯¢æœŸé—´æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œå®ƒå¯èƒ½ä¸ºnullï¼Œæ‰€ä»¥å°½é‡ä¸è¦ç”¨è¿™ç©æ„ã€‚ Map\u003cString, Object\u003e getArguments()-ç”¨æ¥è·å–fieldæä¾›çš„å‚æ•°ã€‚ \u003cT\u003e T getContext()-å½“queryç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œæ‰ä¼šè®¾ç½®å¥½contextï¼Œå¹¶è®©å…¶åœç•™åœ¨queryçš„ç”Ÿå‘½å‘¨æœŸä¸Šã€‚æ‰€ä»¥contextçš„ç”Ÿå‘½å‘¨æœŸä¸queryä¸€è‡´ã€‚contextå¯ä»¥æ˜¯ä»»ä½•å€¼ï¼Œä¸»è¦æ˜¯data fetcheråœ¨è·å–æ•°æ®æ—¶éœ€è¦è¿™ç©æ„ã€‚æ‰€ä»¥åªéœ€è¦æŠŠå®ƒæ³¨å…¥ç»™data fetcherå°±è¡Œäº†ï¼Œå…¶ä»–åœºæ™¯éƒ½ç”¨ä¸åˆ°ã€‚ï¼ˆæ—¥äº†ç‹—äº†ï¼Œè®²äº†è¿™ä¹ˆé•¿ä¸€ä¸²ï¼Œæœ€åç‰¹ä¹ˆæ²¡ç‚¹é¸Ÿç”¨ï¼‰ ExecutionStepInfo getExecutionStepInfo()-ç”¨æ¥è·å–ExecutionStepInfoã€‚å½“queryæ‰§è¡Œåï¼ŒExecutionStepInfoå­˜æ”¾äº†æ‰€æœ‰fieldçš„ç±»å‹ä¿¡æ¯ã€‚ DataFetchingFieldSelectionSet getSelectionSet()-ç”¨æ¥è·å–é€‰é¡¹é›†ã€‚æ‰€è°“ã€Œé€‰é¡¹é›†ã€å°±æ˜¯å½“å‰æ‰§è¡Œä¸­çš„fieldä¹‹åçš„å“ªäº›è¢«ã€Œé€‰ä¸­ã€çš„å­filedä»¬ã€‚è¿™å¯¹äºå±•æœ›æ¥ä¸‹æ¥å°†è¦æ‰§è¡Œçš„fieldçš„ä¿¡æ¯ã€‚ï¼ˆæˆ‘æ„Ÿè§‰å°±åƒæ˜¯éŸ³ä¹æ’­æ”¾å™¨åœ¨æ’­æ”¾æ”¶è—çš„ä¸“è¾‘ä¸€æ ·ï¼Œæ¯”å¦‚å½“å‰æ’­æ”¾åˆ°äº†è´¹ç‰æ¸…çš„ã€Šå¤©ä¹‹å¤§ã€‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•å»æŸ¥çœ‹ã€Šå¤©ä¹‹å¤§ã€‹ä¸‹é¢æœ‰å“ªäº›æ­Œå°†è¦è¢«æ’­æ”¾äº†ï¼‰ã€‚ ExecutionId getExecutionId()-æ‰€æœ‰çš„æŸ¥è¯¢éƒ½æœ‰ä¸€ä¸ªunique idã€‚å¯ä»¥æŠŠidä½œä¸ºlogæ—¥å¿—çš„tagï¼Œç”¨æ¥æ‰“å°ç‰¹å®šçš„queryã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E4%BA%8Cdatafetcher/:3:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(äºŒ)DataFetching","uri":"/graphql-java%E4%BA%8Cdatafetcher/"},{"categories":null,"content":"ExecutionStepInfoå¥½ç©çš„åœ°æ–¹ ä¸€ä¸ªgraphql queryåœ¨æ‰§è¡Œæ—¶ä¼šç”Ÿæˆä¸€ä¸ªcall treeï¼Œå°±æ˜¯ã€Œè°ƒç”¨æ ‘ã€ã€‚graphql.execution.ExecutionStepInfo.getParentTypeInfoå…è®¸ä½ å‘ä¸Šå¯¼èˆªï¼Œçœ‹åˆ°æ˜¯ä»€ä¹ˆç±»å‹çš„fieldè¢«å¸¦åˆ°äº†å½“å‰çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ åœ¨æ•´ä¸ªæ‰§è¡ŒæœŸé—´ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ ‘å½¢pathï¼Œgraphql.execution.ExecutionStepInfo.getPathæ–¹æ³•å¯ä»¥è¿”å›è¿™ä¸ªæ ‘å½¢pathçš„æè¿°ã€‚è¿™åœ¨æ—¥å¿—æ‰“å°å’Œè°ƒè¯•queryæ—¶æ¯”è¾ƒæœ‰ç”¨ã€‚è€Œä¸”å¯ä»¥æŸ¥çœ‹åˆ°éç©ºç±»å‹çš„åç§°å’ŒæŠ˜å åçš„åˆ—è¡¨ã€‚ ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼Œä¸»è¦ç”¨äºè°ƒè¯•å’Œæ’é”™ã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E4%BA%8Cdatafetcher/:3:1","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(äºŒ)DataFetching","uri":"/graphql-java%E4%BA%8Cdatafetcher/"},{"categories":null,"content":"DataFetchingFieldSelectionSetæœ‰è¶£çš„åœ°æ–¹ æƒ³è±¡ä¸€ä¸‹æœ‰ä¸ªqueryå°±åƒè¿™æ ·ï¼š query { products { # the fields below represent the selection set name description sellingLocations { state } } } Productçš„æ‰€æœ‰å­fieldï¼Œå¯¹äºProductæ¥è®²å°±æ˜¯selection fieldsã€‚å½“æˆ‘ä»¬æƒ³è¦çŸ¥é“å“ªäº›å­çº§fieldæ­£åœ¨è¢«è¯·æ±‚æ—¶éå¸¸æœ‰ç”¨ã€‚ä¸¾ä¾‹æ¥è®²ï¼Œæˆ‘ä»¬çš„POJOä¸­å¯èƒ½æœ‰å¾ˆå¤šå±æ€§ï¼Œæ•°æ®åº“è¡¨ä¸­çš„å­—æ®µä¹Ÿä¸ä¹‹ä¸€ä¸€å¯¹åº”ã€‚ä½†æ˜¯æˆ‘ä»¬è·‘ä¸ªgraphqlæŸ¥è¯¢æ—¶å¯èƒ½ä¸éœ€è¦è¿”å›å…¨éƒ¨çš„å­—æ®µï¼Œæˆ‘ä»¬åªè¦æˆ‘ä»¬éœ€è¦çš„å­—æ®µå°±è¡Œäº†ï¼Œæ­¤æ—¶data fetcherå»æŸ¥æ•°æ®åº“æ—¶ä¹Ÿä¸éœ€è¦æŸ¥å‡ºæ‰€æœ‰çš„åˆ—ï¼Œä¹Ÿæ˜¯æŒ‰éœ€è·å–å°±è¡Œäº†ã€‚é‚£æ€ä¹ˆåœ¨ä»£ç é‡Œæ„ŸçŸ¥åˆ°æˆ‘ä»¬å…·ä½“è¯·æ±‚çš„å“ªäº›å­—æ®µå‘¢ï¼Ÿå°±æ˜¯é è¿™ä¸ªDataFetchingFieldSelectionSetã€‚ æ¯”å¦‚ä¸Šä¾‹ä¸­æˆ‘ä»¬è¯·æ±‚äº†sellingLocationså­—æ®µï¼Œæˆ–è€…æˆ‘ä»¬ä½¿ç”¨æ›´é«˜æ•ˆçš„æŸ¥è¯¢ï¼šåŒæ—¶æŸ¥å‡ºproductså’ŒsellingLocationsã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E4%BA%8Cdatafetcher/:3:2","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(äºŒ)DataFetching","uri":"/graphql-java%E4%BA%8Cdatafetcher/"},{"categories":null,"content":"å¼•å…¥ä¾èµ– dependencies { implementation 'com.graphql-java:graphql-java:14.1' // NEW implementation 'com.graphql-java:graphql-java-spring-boot-starter-webmvc:1.0' // NEW implementation 'com.google.guava:guava:26.0-jre' // NEW implementation 'org.springframework.boot:spring-boot-starter-web' testImplementation 'org.springframework.boot:spring-boot-starter-test' } ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:1:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"å®šä¹‰Schema åœ¨src/main/resourcesä¸­åˆ›å»ºschema.graphqlså¦‚ä¸‹ï¼š type Query { bookById(id: ID): Book } type Book { id: ID name: String pageCount: Int author: Author } type Author { id: ID firstName: String lastName: String } è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªé¡¶çº§å­—æ®µï¼šbookByIdï¼Œå®ƒç”¨æ¥è¿”å›ç‰¹å®šIDçš„bookï¼› å¹¶ä¸”å®šä¹‰äº†ä¸€ä¸ªBooç±»ï¼Œå…¶ä¸­åŒ…å«id,name,pageCount,authorã€‚authoræ˜¯å¦ä¸€ä¸ªç±»å‹ã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:2:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"è§£æSchema åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªGraphQLProviderç±»å‹çš„javaæ–‡ä»¶ï¼Œç”¨æ¥åˆ›å»ºGraphQLå®ä¾‹ï¼š @Component public class GraphQLProvider { private GraphQL graphQL; @Bean public GraphQL graphQL() { return graphQL; } /** * ç”¨Guava Resourcesè¯»å–èµ„æºæ–‡ä»¶ * * @throws IOException */ @PostConstruct public void init() throws IOException { URL url = Resources.getResource(\"schema.graphqls\"); String sdl = Resources.toString(url, Charsets.UTF_8); GraphQLSchema graphQLSchema = buildSchema(sdl); this.graphQL = GraphQL.newGraphQL(graphQLSchema).build(); } private GraphQLSchema buildSchema(String sdl) { // TODO: we will create the schema here later } } æˆ‘ä»¬é€šè¿‡googleçš„Guava Resourcesæ¥è¯»å–Schema.graphqlæ–‡ä»¶ï¼Œå¹¶ä¸”é€šè¿‡@Beanæ³¨è§£æŠŠGraphQLå®ä¾‹æš´éœ²å‡ºå»ï¼ŒGraphQL Java Spring adapterä¼šä½¿ç”¨è¿™ä¸ªGraphQLå®ä¾‹æ¥æŠŠschemaåŒ¹é…åˆ°`/graphqlâ€™è·¯å¾„ï¼Œä»¥åé€šè¿‡è¿™ä¸ªè·¯å¾„è°ƒç”¨æ‰€æœ‰æ¥å£ã€‚ æ¥ä¸‹æ¥å®ç°buildSchemaæ–¹æ³•ï¼š @Autowired GraphQLDataFetchers graphQLDataFetchers; /** * æ„å»ºè°ƒç”¨æ¨¡å‹ * @param sdl ä»èµ„æºæ–‡ä»¶è·å–åˆ°çš„sdlè¯­è¨€å†…å®¹ * @return */ private GraphQLSchema buildSchema(String sdl) { TypeDefinitionRegistry typeRegistry = new SchemaParser().parse(sdl); RuntimeWiring runtimeWiring = buildWiring(); SchemaGenerator schemaGenerator = new SchemaGenerator(); return schemaGenerator.makeExecutableSchema(typeRegistry, runtimeWiring); } private RuntimeWiring buildWiring() { return RuntimeWiring.newRuntimeWiring() .type(newTypeWiring(\"Query\") .dataFetcher(\"bookById\", graphQLDataFetchers.getBookByIdDataFetcher())) .type(newTypeWiring(\"Book\") .dataFetcher(\"author\", graphQLDataFetchers.getAuthorDataFetcher())) .build(); } TypeDefinitionRegistry æ˜¯SDLè½¬æ¢æˆçš„javaå¯¹è±¡ã€‚RuntimeWiringæ‰æ˜¯çœŸæ­£çš„é‡ç‚¹ï¼Œä¸»è¦ä½œç”¨æ˜¯æ³¨å†Œäº†ä¸¤ä¸ªDataFetchersï¼š ä¸€ä¸ªç”¨æ¥æ ¹æ®IDæŸ¥bookï¼› ä¸€ä¸ªç”¨æ¥è·å–ç‰¹å®šbookçš„ä½œè€…ã€‚ ä»”ç»†çœ‹ä»£ç ä¼šå‘ç°ï¼Œåœ¨æ„å»ºRuntimeWiringæ—¶ç”¨åˆ°çš„å­—ç¬¦ä¸²å‚æ•°ï¼Œå…¨éƒ½æ˜¯æˆ‘ä»¬åœ¨SDLä¸­å®šä¹‰å¥½çš„typeï¼Œæ‰€ä»¥è¿™é‡Œçš„ä½œç”¨æ˜¯å‘Šè¯‰GraphQL Adapteræ€ä¹ˆå»æ ¹æ®SDLæ‹¿å¯¹åº”çš„æ•°æ®ã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:3:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"DataFetchers DataFetcheræ˜¯ä¸€ä¸ªæ¥å£ï¼Œç”¨æ¥æ ¹æ®SDLä¸­çš„fieldæ¥è·å–å¯¹åº”çš„æ•°æ®ï¼Œæ‰€ä»¥å®ƒå†…éƒ¨åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼š public interface DataFetcher\u003cT\u003e { T get(DataFetchingEnvironment dataFetchingEnvironment) throws Exception; } è¿™é‡Œè¦æ³¨æ„ï¼ŒSDLä¸­æ¯ä¸€ä¸ªfieldéƒ½å¯¹åº”ä¸€ä¸ªDataFetcherï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šä¸€ä¸ªDataFetcherï¼Œé»˜è®¤ä¼šé‡‡ç”¨PropertyDataFetcherã€‚æ‰€ä»¥åœ¨ä¸Šé¢ç”ŸæˆRuntimeWiringçš„ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹authoræ³¨å†ŒdataFetcherï¼Œè€Œæ˜¯è®©ä»–ç›´æ¥é‡‡ç”¨äº†é»˜è®¤çš„PropertyDataFetcherã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å®ç°DataFetcheräº†ï¼Œåˆ›å»ºä¸€ä¸ªGraphQLDataFetchersç±»ï¼š @Component public class GraphQLDataFetchers { private static List\u003cMap\u003cString, String\u003e\u003e books = Arrays.asList( ImmutableMap.of(\"id\", \"book-1\", \"name\", \"Harry Potter and the Philosopher's Stone\", \"pageCount\", \"223\", \"authorId\", \"author-1\"), ImmutableMap.of(\"id\", \"book-2\", \"name\", \"Moby Dick\", \"pageCount\", \"635\", \"authorId\", \"author-2\"), ImmutableMap.of(\"id\", \"book-3\", \"name\", \"Interview with the vampire\", \"pageCount\", \"371\", \"authorId\", \"author-3\") ); private static List\u003cMap\u003cString, String\u003e\u003e authors = Arrays.asList( ImmutableMap.of(\"id\", \"author-1\", \"firstName\", \"Joanne\", \"lastName\", \"Rowling\"), ImmutableMap.of(\"id\", \"author-2\", \"firstName\", \"Herman\", \"lastName\", \"Melville\"), ImmutableMap.of(\"id\", \"author-3\", \"firstName\", \"Anne\", \"lastName\", \"Rice\") ); public DataFetcher getBookByIdDataFetcher() { return dataFetchingEnvironment -\u003e { String bookId = dataFetchingEnvironment.getArgument(\"id\"); return books .stream() .filter(book -\u003e book.get(\"id\").equals(bookId)) .findFirst() .orElse(null); }; } public DataFetcher getAuthorDataFetcher() { return dataFetchingEnvironment -\u003e { Map\u003cString,String\u003e book = dataFetchingEnvironment.getSource(); String authorId = book.get(\"authorId\"); return authors .stream() .filter(author -\u003e author.get(\"id\").equals(authorId)) .findFirst() .orElse(null); }; } } å…¨éƒ½æ˜¯mockæ•°æ®ï¼Œäº®ç‚¹æ˜¯é‡‡ç”¨äº†javaçš„æ–°ç‰¹æ€§ï¼Œé€šè¿‡æµå¼è°ƒç”¨æ¥å¤„ç†é›†åˆï¼Œå¹¶ä¸”è¿˜æœ‰lamdaè¡¨è¾¾å¼çš„ä¹¦å†™ã€‚ ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒDataFetcheræ˜¯DataFetchingEnvironmentï¼Œä¸‰ä¸ªæŸ¥è¯¢æ–¹æ³•ä¹Ÿéƒ½æ˜¯è¿”å›DataFetchingEnvironmentçš„å®ä¾‹ï¼Œå…¶ä¸­éœ€è¦å…³æ³¨çš„æ˜¯ï¼š getArgument(\"id\")ç”¨æ¥è·å–å‚æ•°ã€‚ getSource()ç”¨æ¥è·å–å¯¹è±¡ã€‚ æ ¹æ®æˆ‘ä»¬åœ¨SDLä¸­çš„å®šä¹‰ï¼š type Query { bookById(id: ID): Book } æŸ¥è¯¢bookæ—¶éœ€è¦ä¼ é€’ä¸€ä¸ªidï¼Œæ‰€ä»¥è¿™ä¸ªidæ€ä¹ˆè·å–å‘¢ï¼Ÿé€šè¿‡dataFetchingEnvironment.getArgument(\"id\")å°±èƒ½è·å–åˆ°ã€‚ ç„¶åæ ¹æ®SDLä¸­å®šä¹‰ï¼š type Book { id: ID! name: String pageCount: Int author: Author } æŸ¥è¯¢ç‰¹å®šbookçš„ä½œè€…ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªç‰¹å®šçš„bookå®ä¾‹ï¼Œé€šè¿‡getSource()å¯ä»¥è·å–åˆ°çˆ¶çº§çš„bookå®ä¾‹ã€‚ åœ¨GraphQLä¸­ï¼Œæ¯ä¸€ä¸ªfieldçš„DataFetcheræ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œä»çˆ¶åˆ°å­è¢«è°ƒç”¨çš„ï¼Œå¹¶ä¸”çˆ¶çº§çš„ç»“æœå¯ä»¥ä»å­çº§çš„DataFetcherEnvironmentçš„getSource()æ–¹æ³•ä¸­å–åˆ°ã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:4:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"Default DataFetchers å‰é¢è¯´è¿‡ï¼Œå¦‚æœä¸ç»™fieldæŒ‡å®šä¸€ä¸ªDataFetcherï¼Œé‚£ä¹ˆå°†é»˜è®¤ä½¿ç”¨PropertyDataFetcherã€‚åœ¨è¿™ä¸ªdemoé‡Œï¼Œæ„å‘³ç€Book.id, Book.name, Book.pageCount, Author.id, Author.firstName, Author.lastNameéƒ½å¯¹åº”ç€ä¸€ä¸ªPropertyDataFetcherã€‚ PropertyDataFetcherä¼šé€šè¿‡å¤šç§æ–¹å¼ä»Javaå¯¹è±¡ä¸­æ‰¾åˆ°å¯¹åº”çš„å±æ€§ï¼Œå¦‚æœæ˜¯java.util.Mapï¼Œå°±é€šè¿‡Keyå»æ‰¾ã€‚è¿™é‡Œè¦æ±‚fieldçš„åå­—ä¸keyä¸€è‡´ã€‚å¦‚æœä¸ä¸€è‡´å°±ä¼šè¿”å›nullã€‚ï¼ˆè¿™é‡Œæˆ‘ç¿»è¯‘çš„ä¸å¤ªå¯¹å‘³ï¼Œä½†æ˜¯æ„æ€è¿˜æ˜¯å¾ˆæ˜ç¡®çš„ï¼‰ã€‚ ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:4:1","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"Try API ç›´æ¥rest_clientäº†ï¼š POST http://localhost:9000/graphql Content-Type: application/json X-REQUEST-TYPE: GraphQL { bookById(id:\"book-1\"){ id name pageCount author { firstName lastName } } } è¿”å›ç»“æœï¼š HTTP/1.1 200 Content-Type: application/json;charset=UTF-8 Transfer-Encoding: chunked Date: Sat, 23 Jan 2021 13:35:24 GMT Connection: close { \"data\": { \"bookById\": { \"id\": \"book-1\", \"name\": \"Harry Potter and the Philosopher's Stone\", \"pageCount\": 223, \"author\": { \"firstName\": \"Joanne\", \"lastName\": \"Rowling\" } } } } ","date":"2021-01-23","objectID":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/:5:0","series":null,"tags":["GraphQL"],"title":"GraphQL-Java(é›¶)ä»SpringBootæœåŠ¡ç«¯å¼€å§‹","uri":"/graphql-java%E9%9B%B6%E5%85%A5%E9%97%A8/"},{"categories":null,"content":"æœ¬æ–‡åŸºäºGraphQl-java:v1.6ç‰ˆæœ¬å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ã€‚","date":"2021-01-19","objectID":"/graphql-java%E4%B8%89execution/","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸‰)Execution","uri":"/graphql-java%E4%B8%89execution/"},{"categories":null,"content":"Queries å¦‚æœæƒ³è¦åœ¨schemaé‡Œè·‘ä¸ªæŸ¥è¯¢ï¼Œéœ€è¦ç”¨å¯¹åº”çš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„GraphQL objectï¼Œç„¶åæ‰§è¡Œexecute()ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªExecutionResultï¼Œå®ƒåŒ…å«æŸ¥è¯¢ç»“æœï¼Œæˆ–è€…ä¸€ä¸ªé”™è¯¯åˆ—è¡¨ã€‚ GraphQLSchema schema = GraphQLSchema.newSchema() .query(queryType) .build(); GraphQL graphQL = GraphQL.newGraphQL(schema) .build(); ExecutionInput executionInput = ExecutionInput.newExecutionInput().query(\"query { hero { name } }\") .build(); ExecutionResult executionResult = graphQL.execute(executionInput); Object data = executionResult.getData(); List\u003cGraphQLError\u003e errors = executionResult.getErrors(); æ›´å¤šçš„åˆ—å­åœ¨è¿™é‡Œ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%89execution/:1:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸‰)Execution","uri":"/graphql-java%E4%B8%89execution/"},{"categories":null,"content":"Data Fetchers æ¯ä¸€ä¸ªfieldéƒ½å¯¹åº”ç€ä¸€ä¸ªgraphql.schema.DataFetcherï¼Œä¹Ÿè¢«ç§°ä½œresolversã€‚ ä½ å¯ä»¥ç”¨åŸºäºgraphql.schema.PropertyDataFetcherå»æµ‹è¯•Java POJOå¯¹è±¡æä¾›çš„fieldã€‚å¦‚æœä½ æ²¡æœ‰ä¸ºfieldæŒ‡å®šä¸€ä¸ªdata fetcherï¼Œé‚£ä¹ˆé»˜è®¤ä¼šä½¿ç”¨graphql.schema.PropertyDataFetcherã€‚ ç„¶è€Œï¼Œä½ éœ€è¦é€šè¿‡è‡ªå®šä¹‰çš„data fetcherå»è·å–åŸŸçš„é¡¶å±‚å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œæˆ–è€…é€šè¿‡httpè°ƒç”¨å…¶ä»–æœåŠ¡è·å–ã€‚ graphql-javaå¹¶ä¸å…³æ³¨å¦‚ä½•è·å–å¯¹è±¡ï¼Œè¿™äº›é€»è¾‘éœ€è¦ä½ è‡ªå·±å»å¤„ç†ã€‚ ä¸€ä¸ªdata fetcherå¯èƒ½åƒè¿™æ ·ï¼š DataFetcher userDataFetcher = new DataFetcher() { @Override public Object get(DataFetchingEnvironment environment) { return fetchUserFromDatabase(environment.getArgument(\"userId\")); } }; æ¯ä¸€ä¸ªDataFetcherå®é™…ä¸Šéƒ½åŒ…å«åœ¨graphql.schema.DataFetchingEnvironmentå¯¹è±¡ä¸­ï¼Œè€Œgraphql.schema.DataFetchingEnvironmentå¯¹è±¡åŒæ—¶åŒ…å«äº†æ­£åœ¨è·å–çš„å­—æ®µã€å·²æä¾›ç»™å­—æ®µçš„å‚æ•°ã€å­—æ®µçš„çˆ¶çº§å¯¹è±¡ã€æŸ¥è¯¢æ ¹å¯¹è±¡æˆ–è€…æŸ¥è¯¢ä¸Šä¸‹æ–‡ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‰§è¡Œå°†ç­‰å¾…æ•°æ®æå–ç¨‹åºè¿”å›åå†ç»§ç»­ã€‚æ‚¨å¯ä»¥é€šè¿‡å‘æ•°æ®è¿”å› CompletionStage æ¥å¼‚æ­¥æ‰§è¡Œ DataFetcherï¼Œæœ¬é¡µé¢å°†å¯¹æ­¤è¿›è¡Œæ›´è¯¦ç»†çš„è§£é‡Šã€‚ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%89execution/:2:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸‰)Execution","uri":"/graphql-java%E4%B8%89execution/"},{"categories":null,"content":"Exceptions while fetching data å¦‚æœåœ¨æ•°æ®è¯»å–å™¨è°ƒç”¨æœŸé—´å‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œç­–ç•¥å°†ç”Ÿæˆ graphqlã€‚ç„¶åå°†å…¶æ·»åŠ åˆ°ç»“æœçš„é”™è¯¯åˆ—è¡¨ä¸­ã€‚è®°ä½ï¼Œgraphql å…è®¸å¸¦æœ‰é”™è¯¯çš„éƒ¨åˆ†ç»“æœã€‚ public class SimpleDataFetcherExceptionHandler implements DataFetcherExceptionHandler { private static final Logger log = LoggerFactory.getLogger(SimpleDataFetcherExceptionHandler.class); @Override public void accept(DataFetcherExceptionHandlerParameters handlerParameters) { Throwable exception = handlerParameters.getException(); SourceLocation sourceLocation = handlerParameters.getField().getSourceLocation(); ExecutionPath path = handlerParameters.getPath(); ExceptionWhileDataFetching error = new ExceptionWhileDataFetching(path, exception, sourceLocation); handlerParameters.getExecutionContext().addError(error); log.warn(error.getMessage(), exception); } } å¦‚æœæ‚¨æŠ›å‡ºçš„å¼‚å¸¸æœ¬èº«æ˜¯ä¸€ä¸ª GraphqlErrorï¼Œé‚£ä¹ˆå®ƒå°†æŠŠæ¶ˆæ¯å’Œè‡ªå®šä¹‰æ‰©å±•å±æ€§ä»è¯¥å¼‚å¸¸è½¬ç§»åˆ° exceptionwhiledatatfetching å¯¹è±¡ä¸­ã€‚è¿™å…è®¸æ‚¨å°†è‡ªå·±çš„å®šåˆ¶å±æ€§æ”¾ç½®åˆ°å‘é€å›è°ƒç”¨è€…çš„ graphql é”™è¯¯ä¸­ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„æ•°æ®è¯»å–å™¨æŠ›å‡ºæ­¤å¼‚å¸¸ã€‚Foo å’Œ fizz å±æ€§å°†åŒ…å«åœ¨ç»“æœ graphql é”™è¯¯ä¸­ã€‚ class CustomRuntimeException extends RuntimeException implements GraphQLError { @Override public Map\u003cString, Object\u003e getExtensions() { Map\u003cString, Object\u003e customAttributes = new LinkedHashMap\u003c\u003e(); customAttributes.put(\"foo\", \"bar\"); customAttributes.put(\"fizz\", \"whizz\"); return customAttributes; } @Override public List\u003cSourceLocation\u003e getLocations() { return null; } @Override public ErrorType getErrorType() { return ErrorType.DataFetchingException; } } ç¿»è¯‘åˆ°è¿™é‡Œå…ˆåœä¸€ä¸‹å§ï¼Œå•çº¯çš„ç¿»è¯‘åªæ˜¯æµªè´¹æ—¶é—´ã€‚å‰æ®µæ—¶é—´é¡¹ç›®ç´§ï¼Œæ²¡æ—¶é—´åƒé€è¿™ä¸ªgraphqlï¼Œæ‰€ä»¥ç°åœ¨æƒ³ç›´æ¥ä»ä¸ªäººç½‘ç›˜é¡¹ç›®é‡Œé¢å°è¯•ä¸€ä¸‹ã€‚ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%89execution/:3:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸‰)Execution","uri":"/graphql-java%E4%B8%89execution/"},{"categories":null,"content":"æœ¬æ–‡åŸºäºGraphQl-java:v1.6ç‰ˆæœ¬å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ã€‚","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"å¼•å…¥ä¾èµ– ç‰ˆæœ¬åˆ—è¡¨ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:1:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Gradle repositories { mavenCentral() } dependencies { compile 'com.graphql-java:graphql-java:15.0' } ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:1:1","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Maven \u003cdependency\u003e \u003cgroupId\u003ecom.graphql-java\u003c/groupId\u003e \u003cartifactId\u003egraphql-java\u003c/artifactId\u003e \u003cversion\u003e15.0\u003c/version\u003e \u003c/dependency\u003e ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:1:2","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Schemaâ€”â€”å¤§çº² åˆ›å»ºä¸€ä¸ªSchemaæœ‰ä¸¤ç§æ–¹å¼ï¼š æ¨èSDL(special graphql dsl): type Foo { bar: String } java code: GraphQLObjectType fooType = newObject() .name(\"Foo\") .field(newFieldDefinition() .name(\"bar\") .type(GraphQLString)) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:2:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"DataFetcher and TypeResolver DataFetcherç”¨æ¥å‘fieldæä¾›æ•°æ®ï¼Œæ¯ä¸€ä¸ªfieldéƒ½åŒ…å«ä¸€ä¸ªDataFetcher,é»˜è®¤é‡‡ç”¨PropertyDataFetcherã€‚ PropertyDataFetcher ä»Mapæˆ–è€…Java Beanä¸­è·å–æ•°æ®ï¼Œæ‰€ä»¥å½“field nameä¸mapçš„keyï¼Œæˆ–è€…ç±»çš„å…ƒç´ åç§°çš„ç›¸åŒ¹é…ï¼Œå°±ä¸éœ€è¦å®šä¹‰DataFetcheräº†ã€‚ TypeResolverå¸®åŠ©graphql-javaåˆ¤æ–­å€¼çš„ç±»å‹ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ¥å£MagicUserTypeï¼Œç”¨æ¥è§£æä¸€ç³»åˆ—javaç±»Wizard,Witchå’ŒNecromancerã€‚ç±»å‹æ£€æŸ¥å™¨è´Ÿè´£æ£€æŸ¥ä¸€ä¸ªè¿è¡Œæ—¶å¯¹è±¡ï¼Œå¹¶ä¸”åˆ¤æ–­ç”¨å“ªä¸ªGraphqlObjectTypeå»å“åº”è¿™ä¸ªå¯¹è±¡ï¼Œå¯¹åº”çš„åº”è¯¥ç”¨å“ªä¸ªdata fetcherså’Œfieldå»è¿è¡Œã€‚ new TypeResolver() { @Override public GraphQLObjectType getType(TypeResolutionEnvironment env) { Object javaObject = env.getObject(); if (javaObject instanceof Wizard) { return env.getSchema().getObjectType(\"WizardType\"); } else if (javaObject instanceof Witch) { return env.getSchema().getObjectType(\"WitchType\"); } else { return env.getSchema().getObjectType(\"NecromancerType\"); } } }; ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:3:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"ç”¨SDLåˆ›å»ºä¸€ä¸ªSchema å½“é€šè¿‡schemaåˆ›å»ºä¸€ä¸ªSDLï¼Œä½ åº”è¯¥å®šä¹‰å¥½DataFetcherå’ŒTypeResolverã€‚ æ¯”å¦‚åˆ›å»ºä¸€ä¸ªstarWarsSchema.graphqls: è¿™è´§æ˜¯æ˜Ÿæˆ˜è¿·ï¼Œæ—¥äº†ï¼Œå¥½å¤šç”µå½±é‡Œè‡ªåˆ›çš„åè¯ã€‚å¹¸äºå‰é˜µå­çœ‹äº†ã€Šæ›¼è¾¾æ´›äººã€‹ï¼Œè¦ä¸ç„¶éƒ½ç¿»è¯‘ä¸äº†è¿™ç ´å®˜æ–‡ã€‚ schema { query: QueryType } type QueryType { hero(episode: Episode): Character //è‹±é›„ human(id : String) : Human //äººç±» droid(id: ID!): Droid //å¾·é²ä¼Š } //BGMæšä¸¾ enum Episode { NEWHOPE //æ–°å¸Œæœ›å†› EMPIRE //å¸å›½å†› JEDI //ç»åœ°æ­¦å£« } //è§’è‰²æ¥å£ interface Character { id: ID! name: String! friends: [Character] appearsIn: [Episode]! //å‡ºç°çš„æ—¶å€™æ’­æ”¾å¯¹åº”çš„BGM } type Human implements Character { id: ID! name: String! friends: [Character] appearsIn: [Episode]! homePlanet: String //æ¯æ˜Ÿ } type Droid implements Character { id: ID! name: String! friends: [Character] appearsIn: [Episode]! primaryFunction: String //è¶…èƒ½åŠ› } è¿™ä¸ªé™æ€æ–‡ä»¶starWarsSchema.graphqlsåŒ…å«äº†fieldå’Œtypeçš„å®šä¹‰ï¼Œä½†æ˜¯ä½ è¿˜éœ€è¦ä¸€ä¸ªruntimeWiringï¼ˆè¿è¡Œæ—¶æ³¨å…¥ï¼‰æ¥æŠŠè¿™ä¸ªé™æ€æ–‡ä»¶è½¬æ¢ä¸ºä¸€ä¸ªå¯è¿è¡Œçš„schemaã€‚ runtimeWiringå¿…é¡»åŒ…å«DataFetcherã€TypeResolverå’Œè‡ªå®šä¹‰çš„Scalarã€‚ ä½ å¯ä»¥ç”¨ä¸‹é¢çš„å»ºé€ è€…æ¨¡å¼+lambdaè¡¨è¾¾å¼å»åˆ›å»ºæŠ¥æ–‡ï¼š RuntimeWiring buildRuntimeWiring() { return RuntimeWiring.newRuntimeWiring() .scalar(CustomScalar) // this uses builder function lambda syntax .type(\"QueryType\", typeWiring -\u003e typeWiring .dataFetcher(\"hero\", new StaticDataFetcher(StarWarsData.getArtoo())) .dataFetcher(\"human\", StarWarsData.getHumanDataFetcher()) .dataFetcher(\"droid\", StarWarsData.getDroidDataFetcher()) ) .type(\"Human\", typeWiring -\u003e typeWiring .dataFetcher(\"friends\", StarWarsData.getFriendsDataFetcher()) ) // you can use builder syntax if you don't like the lambda syntax .type(\"Droid\", typeWiring -\u003e typeWiring .dataFetcher(\"friends\", StarWarsData.getFriendsDataFetcher()) ) // or full builder syntax if that takes your fancy .type( newTypeWiring(\"Character\") .typeResolver(StarWarsData.getCharacterTypeResolver()) .build() ) .build(); } æœ€ç»ˆï¼Œä½ å¯ä»¥æŠŠé™æ€çš„å¤§çº²å’Œæ³¨å…¥ç»“åˆåˆ°ä¸€èµ·æ¥åˆ›å»ºä¸€ä¸ªå¯è¿è¡Œçš„schemaï¼š SchemaParser schemaParser = new SchemaParser(); SchemaGenerator schemaGenerator = new SchemaGenerator(); File schemaFile = loadSchema(\"starWarsSchema.graphqls\"); TypeDefinitionRegistry typeRegistry = schemaParser.parse(schemaFile); RuntimeWiring wiring = buildRuntimeWiring(); GraphQLSchema graphQLSchema = schemaGenerator.makeExecutableSchema(typeRegistry, wiring); å¦å¤–åœ¨å»ºé€ è€…æ¨¡å¼çš„åŸºç¡€ä¸Šï¼ŒTypeResolverå’ŒDataFetcherå¯ä»¥ä½¿ç”¨WiringFactoryæ¥å£æ¥æ³¨å…¥ã€‚è¿™ä¼šå…è®¸æ›´å¤šçš„åŠ¨æ€è¿è¡Œæ—¶ï¼Œé€šè¿‡schemaçš„å®šä¹‰å»åˆ¤æ–­åº”è¯¥æ³¨å…¥ä»€ä¹ˆä¸œè¥¿ã€‚ä½ å¯ä»¥é€šè¿‡é˜…è¯»SDLæ¥åˆ¤æ–­ç”Ÿæˆå“ªç§runtimeã€‚ RuntimeWiring buildDynamicRuntimeWiring() { WiringFactory dynamicWiringFactory = new WiringFactory() { @Override public boolean providesTypeResolver(TypeDefinitionRegistry registry, InterfaceTypeDefinition definition) { return getDirective(definition,\"specialMarker\") != null; } @Override public boolean providesTypeResolver(TypeDefinitionRegistry registry, UnionTypeDefinition definition) { return getDirective(definition,\"specialMarker\") != null; } @Override public TypeResolver getTypeResolver(TypeDefinitionRegistry registry, InterfaceTypeDefinition definition) { Directive directive = getDirective(definition,\"specialMarker\"); return createTypeResolver(definition,directive); } @Override public TypeResolver getTypeResolver(TypeDefinitionRegistry registry, UnionTypeDefinition definition) { Directive directive = getDirective(definition,\"specialMarker\"); return createTypeResolver(definition,directive); } @Override public boolean providesDataFetcher(TypeDefinitionRegistry registry, FieldDefinition definition) { return getDirective(definition,\"dataFetcher\") != null; } @Override public DataFetcher getDataFetcher(TypeDefinitionRegistry registry, FieldDefinition definition) { Directive directive = getDirective(definition, \"dataFetcher\"); return createDataFetcher(definition,directive); } }; return RuntimeWiring.newRuntimeWiring() .wiringFactory(dynamicWiringFactory).build(); } ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:4:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"åˆ›å»ºä¸€ä¸ªschemaå®šä¹‰ å½“schemaç”Ÿæˆæ—¶ï¼ŒDataFetcherå’ŒTypeResolverå¯ä»¥åœ¨ç±»å‹åˆ›å»ºæ—¶æä¾›ï¼š DataFetcher\u003cFoo\u003e fooDataFetcher = new DataFetcher\u003cFoo\u003e(){ @Override public Foo get(DataFetchingEnvironment environment) { // environment.getSource() is the value of the surrounding // object. In this case described by objectType Foo value = perhapsFromDatabase(); // Perhaps getting from a DB or whatever return value; } }; GraphQLObjectType objectType = newObject() .name(\"ObjectType\") .field(newFieldDefinition() .name(\"foo\") .type(GraphQLString) ) .build(); GraphQLCodeRegistry codeRegistry = newCodeRegistry() .dataFetcher( coordinates(\"ObjectType\", \"foo\"), fooDataFetcher) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:5:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"GraphQlæ”¯æŒçš„ç±»å‹ Scalarâ€”â€”æ ‡é‡ Objectâ€”â€”å¯¹è±¡ Interfaceâ€”â€”æ¥å£ Unionâ€”â€”è”åˆ InputObjectâ€”â€”è¾“å…¥å¯¹è±¡ Enumâ€”â€”æšä¸¾ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Scalar graphql-javaæ”¯æŒä¸‹é¢å‡ ç§æ ‡é‡ï¼š æ ‡å‡†æ ‡é‡ï¼š GraphQLString GraphQLBoolean GraphQLInt GraphQLFloat GraphQLID æ‰©å±•æ ‡é‡ï¼š GraphQLLong GraphQLShort GraphQLByte GraphQLFloat(æ€ä¹ˆé‡å¤äº†ï¼Ÿ) GraphQLBigDecimal GraphQLBigInteger **æ³¨æ„ï¼šä½ çš„å®¢æˆ·ç«¯å¯èƒ½ä¸èƒ½ç†è§£æ‰©å±•æ ‡é‡çš„è¯­æ„ï¼Œæ¯”å¦‚æŠŠJavaä¸­çš„long(æœ€å¤§å€¼26^3-1)åŒ¹é…ç»™JavaScriptçš„Numberç±»å‹(æœ€å¤§å€¼2^53 - 1)å¯èƒ½ä¼šå‡ºé—®é¢˜ã€‚ è¿™é‡Œç”¨äº†ä¸¤ä¸ªmay beï¼Œæˆ‘è§‰å¾—èº«ä¸ºä¸€ä¸ªå®˜æ–‡ï¼Œè¿™æ ·å†™æ˜¯ä¸å¯¹çš„ã€‚ä¼šå°±æ˜¯ä¼šï¼Œmay beä»€ä¹ˆé¬¼ã€‚ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:1","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Object SDL Example: //Simpsonåº”è¯¥æ˜¯å¡é€šç‰‡ã€Šè¾›æ™®æ£®ä¸€å®¶ã€‹ä¸­çš„ä¸€ç±»æ€ªç‰© type SimpsonCharacter { name: String mainCharacter: Boolean //æ˜¯å¦æ˜¯ä¸»è§’ } Java Example: GraphQLObjectType simpsonCharacter = newObject() .name(\"SimpsonCharacter\") .description(\"A Simpson character\") .field(newFieldDefinition() .name(\"name\") .description(\"The name of the character.\") .type(GraphQLString)) .field(newFieldDefinition() .name(\"mainCharacter\") .description(\"One of the main Simpson characters?\") .type(GraphQLBoolean)) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:2","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Interface Interfaces æ˜¯ç±»å‹çš„æŠ½è±¡å®šä¹‰ï¼Œå“‡å¡ï¼ SDL Example: //æ»‘ç¨½è§’è‰² interface ComicCharacter { name: String; } Java Example: GraphQLInterfaceType comicCharacter = newInterface() .name(\"ComicCharacter\") .description(\"An abstract comic character.\") .field(newFieldDefinition() .name(\"name\") .description(\"The name of the character.\") .type(GraphQLString)) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:3","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Union SDL Example: type Cat { name: String; lives: Int; } type Dog { name: String; bonesOwned: int; } union Pet = Cat | Dog æˆ‘æ“¦ï¼Œã€ŠçŒ«ç‹—å¤§æˆ˜ã€‹ Java Example: TypeResolver typeResolver = new TypeResolver() { @Override public GraphQLObjectType getType(TypeResolutionEnvironment env) { if (env.getObject() instanceof Cat) { return CatType; } if (env.getObject() instanceof Dog) { return DogType; } return null; } }; GraphQLUnionType PetType = newUnionType() .name(\"Pet\") .possibleType(CatType) .possibleType(DogType) .build(); GraphQLCodeRegistry codeRegistry = newCodeRegistry() .typeResolver(\"Pet\", typeResolver) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:4","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Enum SDL Example: enum Color { RED GREEN BLUE } Java Example: GraphQLEnumType colorEnum = newEnum() .name(\"Color\") .description(\"Supported colors.\") .value(\"RED\") .value(\"GREEN\") .value(\"BLUE\") .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:5","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"ObjectInputType SDL Example: input Character { name: String } Java Example: GraphQLInputObjectType inputObjectType = newInputObject() .name(\"inputObjectType\") .field(newInputObjectField() .name(\"field\") .type(GraphQLString)) .build(); ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:6:6","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"ç±»å‹å…³ç³»å’Œé€’å½’ GraphQLæ”¯æŒé€’å½’ï¼ˆå“‡å¡ï¼ï¼‰ï¼šæ¯”å¦‚ä¸€ä¸ªPersonç±»å†…éƒ¨å«æœ‰ä¸€ä¸ªList\u003cFriend\u003eï¼Œæˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªç±»graphql-javaå¹¶æŒæœ‰ä¸€ä¸ªGraphQLTypeReferenceç±»å‹çš„å±æ€§ã€‚å½“schemaåˆ›å»ºæ—¶ï¼ŒGraphQLTypeReferenceä¼šè¢«å®é™…çš„ç±»å‹æ›¿æ¢æ‰ã€‚(ç­”ä¸å¯¹é¢˜ï¼Œæ–‡å½©å¤ªå·®äº†)ã€‚ ä¾‹å¦‚ï¼š GraphQLObjectType person = newObject() .name(\"Person\") .field(newFieldDefinition() .name(\"friends\") .type(GraphQLList .list(GraphQLTypeReference.typeRef(\"Person\")) ) ) .build(); å½“schemaé€šè¿‡SDLåˆ›å»ºæ—¶ï¼Œä¸éœ€è¦å¯¹é€’å½’ç±»å‹åšç‰¹æ®Šå¤„ç†ï¼Œé€’å½’å·²ç»è‡ªåŠ¨å®Œæˆäº†ã€‚ æ‰€ä»¥ä½ å°±å¯ä»¥ä¸ç»™å‡ºä¸ªSDLçš„ä¾‹å­å—ï¼Œä½œè€…ï¼Ÿ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:7:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"Schema SDL çš„æ¨¡å—åŒ– ä¸€ä¸ªå·¨å¤§çš„schemaæ–‡ä»¶æ˜¯ä¸æ–¹ä¾¿æµè§ˆçš„ï¼ˆæˆ‘æƒ³èµ·äº†æ“å“¥å†™è¿‡çš„300è¡Œçš„å‡½æ•°å’ŒåµŒå¥—äº†7å±‚çš„ifï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æŠ€æœ¯ä½¿ä¹‹æ¨¡å—åŒ–ã€‚ NO.1 åœ¨é€»è¾‘å•å…ƒ(javaä»£ç )ä¸­åˆå¹¶å¤šä¸ªSchema SDLæ–‡ä»¶ã€‚ SchemaParser schemaParser = new SchemaParser(); SchemaGenerator schemaGenerator = new SchemaGenerator(); File schemaFile1 = loadSchema(\"starWarsSchemaPart1.graphqls\"); File schemaFile2 = loadSchema(\"starWarsSchemaPart2.graphqls\"); File schemaFile3 = loadSchema(\"starWarsSchemaPart3.graphqls\"); TypeDefinitionRegistry typeRegistry = new TypeDefinitionRegistry(); // each registry is merged into the main registry typeRegistry.merge(schemaParser.parse(schemaFile1)); typeRegistry.merge(schemaParser.parse(schemaFile2)); typeRegistry.merge(schemaParser.parse(schemaFile3)); GraphQLSchema graphQLSchema = schemaGenerator.makeExecutableSchema(typeRegistry, buildRuntimeWiring()); NO.2 Graphql SDLçš„ç±»å‹ç³»ç»Ÿé’ˆå¯¹å¤šæ¨¡å—å…·å¤‡äº†å¦ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨type extensionså»æŠŠé¢å¤–çš„fieldå’Œinsterfacesæ·»åŠ åˆ°ç±»å‹ä¸­ã€‚ æƒ³è±¡ä½ å¼€å§‹çš„æ—¶å€™å†™äº†è¿™ä¹ˆä¸ªtypeï¼š type Human { id: ID! name: String! } åœ¨å¦ä¸€éƒ¨åˆ†æ–‡ä»¶ä¸­å¯ä»¥é€šè¿‡extendè¿™ä¸ªtypeæ¥æ·»åŠ æ›´å¤šçš„å›¾å½¢ã€‚ extend type Human implements Character { id: ID! name: String! friends: [Character] appearsIn: [Episode]! } ä½ å¯ä»¥æ·»åŠ æ›´å¤šæ–‡ä»¶ï¼Œå®ƒä»¬æœ€ç»ˆä¼šè¢«æ•´åˆåˆ°ä¸€èµ·ï¼ˆä¸å…è®¸é‡å¤å®šä¹‰å­—æ®µï¼‰ã€‚ extend type Human { homePlanet: String } æœ€ç»ˆå½“æ‰€æœ‰typeçš„ç»§æ‰¿è€…æ±‡é›†åˆ°ä¸€èµ·æ—¶ï¼Œåœ¨è¿è¡Œæ—¶ä¸­typeä¼šå˜æˆè¿™ä¸ªæ ·å­ï¼š type Human implements Character { id: ID! name: String! friends: [Character] appearsIn: [Episode]! homePlanet: String } è¿™åœ¨é¡¶çº§ä¸­å¾ˆæœ‰ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥å‘é¡¶çº§çš„schemaã€Œqueryã€ä¸­æ·»åŠ æ–°çš„å­—æ®µã€‚å›¢é˜Ÿå¼€å‘ä¸­å¯ä»¥é‡‡ç”¨è¿™ç§å½¢å¼æ¥å‘æ‰€æœ‰çš„queryé»˜è®¤æä¾›é¡¶çº§queryã€‚ schema { query: CombinedQueryFromMultipleTeams } type CombinedQueryFromMultipleTeams { createdTimestamp: String } # maybe the invoicing system team puts in this set of attributes extend type CombinedQueryFromMultipleTeams { invoicing: Invoicing } # and the billing system team puts in this set of attributes extend type CombinedQueryFromMultipleTeams { billing: Billing } # and so and so forth extend type CombinedQueryFromMultipleTeams { auditing: Auditing } ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:8:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"è®¢é˜…æ”¯æŒ(å“‡å¡ï¼) è®¢é˜…å…è®¸ä½ è·‘ä¸ªqueryï¼Œå¹¶ä¸”æŒç»­ç›‘å¬è¿™ä¸ªqueryè¿”å›å¯¹è±¡çš„å˜åŒ–ã€‚ï¼ˆè¿™ä¸ªç‰›é€¼äº†ï¼Œä½†æ˜¯æœ‰å¯èƒ½æ˜¯é é•¿é“¾æ¥ç»´æŒçš„ï¼Œå¦‚æœæ˜¯çš„è¯å¼€é”€å°±æœ‰ç‚¹å¤§äº†ï¼‰ subscription foo { # normal graphql query } å…·ä½“è¯·æŸ¥çœ‹Subscriptionsã€‚ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:9:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"åè®° ç»ˆäºç¿»è¯‘å®Œäº†ï¼Œä½œè€…æ–‡å½©æ¯”è¾ƒæ¸£ï¼Œæ‰€ä»¥ç¿»è¯‘çš„æœ‰ç‚¹ç´¯ã€‚ä¸‹ä¸€ç¯‡å‡†å¤‡ç¿»è¯‘è¿™ä¸ªSubscriptionï¼Œçœ‹çœ‹å®ƒçš„è®¢é˜…åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ã€‚å½“ç„¶åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦å¯¹æœ¬ç¯‡ç¿»è¯‘äºŒæ¬¡å›é¡¾ï¼Œæ¶ˆåŒ–å¸æ”¶ã€‚æ‰€ä»¥ä¸‹ä¸€ç¯‡ç¿»è¯‘ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½æå‡ºæ¥äº†ã€‚ ç¿»è¯‘å®Œä¹‹åçš„ç¬¬ä¸€æ¬¡æ ¡ç¨¿ï¼Œå‘ç°å•çº¯é˜…è¯»è¿™ä¸ªSchemaç¯‡æ ¹æœ¬ç†è§£ä¸äº†ã€‚åŸå› æ˜¯æŒ‰ç…§demoè·‘å®Œå…¥é—¨ä»£ç åï¼Œå¹¶æ²¡æœ‰å¥½å¥½é˜…è¯»ç†è§£é€»è¾‘ï¼Œç„¶åä¸­é—´å› ä¸ºæ¥æ´»äº†ï¼Œä¸­æ–­äº†å­¦ä¹ å’Œç¿»è¯‘ï¼Œç‰¹ä¹ˆå°´å°¬äº†ã€‚ä¸‹ä¸€ç¯‡è¿˜æ˜¯ä»quick startå¼€å§‹å§ã€‚ ","date":"2021-01-19","objectID":"/graphql-java%E4%B8%80schema/:10:0","series":null,"tags":["GraphQL"],"title":"GraphQl-Java(ä¸€)Schema","uri":"/graphql-java%E4%B8%80schema/"},{"categories":null,"content":"ç‰ˆæœ¬å·®å¼‚ ç‰ˆæœ¬ ç‰¹ç‚¹ JDK1.7 æ•°ç»„+å•å‘é“¾ JDK1.8 æ•°ç»„+å•å‘é“¾+çº¢é»‘æ ‘ jdk1.7ä¸­ï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œè€Œé“¾è¡¨æ˜¯ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ã€‚å½“é“¾è¡¨è¿‡é•¿ï¼Œå›ä¸¥é‡å½±å“æ€§èƒ½ï¼Œæ‰€ä»¥åœ¨1.8ä¸­ï¼Œå½“é“¾è¡¨è¶…è¿‡8ä¸”æ•°æ®æ€»é‡è¶…è¿‡64ä¼šè½¬æˆçº¢é»‘æ ‘ï¼š é“¾è¡¨è¶…è¿‡8ï¼Œä¸”æ•°æ®æ€»é‡è¶…è¿‡64ä¼šè½¬æˆçº¢é»‘æ ‘ï¼› å¦‚æœæ•°ç»„é•¿åº¦å°äº64ï¼Œä¼šä¼˜å…ˆæ‰©å®¹ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:1:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"é»˜è®¤åŠ è½½å› å­ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:2:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"Javaä¸­çš„äºŒè¿›åˆ¶ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:3:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"intçš„å®¹é‡ æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„intæ˜¯32ä½æ•´å‹ï¼Œå ç”¨4å­—èŠ‚ã€‚åœ¨è®¡ç®—æœºä¸­æ˜¯ä»¥äºŒè¿›åˆ¶æ¥å‚¨å­˜çš„ï¼Œå…±æœ‰32ä½ã€‚ å‡è®¾æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªint i = 10ï¼Œ10çš„äºŒè¿›åˆ¶æ˜¯1010ï¼Œä¸€å…±åªæœ‰4ä½ï¼Œåœ¨è®¡ç®—æœºä¸­ä¼šç”¨0æŠŠå‰é¢è¡¥é½ï¼Œæ»¡è¶³32ä½å­˜å‚¨ï¼Œæ‰€ä»¥å®é™…ä¸Šè®¡ç®—æœºä¸­å‚¨å­˜çš„æ˜¯ï¼š 00000000 00000000 00000000 00001010 ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:3:1","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"æºç ï¼Œåç ï¼Œè¡¥ç  æºç  ä¸€ä¸ªæ­£æ•°ï¼ŒæŒ‰ç…§ç»å¯¹å€¼å¤§å°è½¬æ¢æˆçš„äºŒè¿›åˆ¶æ•°ï¼›ä¸€ä¸ªè´Ÿæ•°æŒ‰ç…§ç»å¯¹å€¼å¤§å°è½¬æ¢æˆçš„äºŒè¿›åˆ¶æ•°ï¼Œç„¶åæœ€é«˜ä½æ”¹ä¸º1ï¼Œç§°ä¸ºåŸç ã€‚ æ¯”å¦‚ 00000000 00000000 00000000 00000101 æ˜¯ 5çš„ åŸç ã€‚ 10000000 00000000 00000000 00000101 æ˜¯ -5çš„ åŸç ã€‚ åç  æ­£æ•°çš„åç ä¸æºç ç›¸åŒï¼Œè´Ÿæ•°çš„åç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åã€‚ ä¹Ÿå°±æ˜¯åŸä¸º1ï¼Œå¾—0ï¼›åŸä¸º0ï¼Œå¾—1ã€‚ï¼ˆ1å˜0; 0å˜1ï¼‰ã€‚ 5çš„åç ï¼š00000000 00000000 00000000 00000101 -5çš„åç ï¼š11111111 11111111 11111111 11111010 è¡¥ç  æ­£æ•°çš„è¡¥ç ä¸åŸç ç›¸åŒï¼Œè´Ÿæ•°çš„è¡¥ç ä¸ºå¯¹è¯¥æ•°çš„åŸç é™¤ç¬¦å·ä½å¤–å„ä½å–åï¼Œç„¶ååœ¨æœ€åä¸€ä½åŠ 1ã€‚ 5çš„è¡¥ç ï¼š00000000 00000000 00000000 00000101 -5çš„è¡¥ç ï¼š11111111 11111111 11111111 11111011 ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:3:2","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"Javaä¸­å¯¹è´Ÿæ•°çš„å¤„ç† åœ¨äºŒè¿›åˆ¶é‡Œï¼Œæ˜¯ç”¨0å’Œ1æ¥è¡¨ç¤ºæ­£è´Ÿçš„ï¼Œæœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œæœ€é«˜ä½ä¸º1ä»£è¡¨è´Ÿæ•°ï¼Œæœ€é«˜ä½ä¸º0ä»£è¡¨æ­£æ•°ã€‚ è®¡ç®—æœºä»¥è¡¥ç çš„å½¢å¼å­˜å‚¨æ•°æ®ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:3:3","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"è®¡ç®—æ–¹å¼ æ­£æ•°ï¼šç»å¯¹å€¼çš„äºŒè¿›åˆ¶ï¼› è´Ÿæ•°ï¼šç»å¯¹å€¼è½¬äºŒè¿›åˆ¶ï¼Œé«˜ä½æ”¹ä¸º1ï¼Œå¾—åˆ°åç ï¼Œå†æŠŠåç +1å¾—åˆ°è¡¥ç ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:3:4","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"Javaç§»ä½æ“ä½œ å¹³æ—¶çœ‹æºç æ€»é‡åˆ°å‡ ä¸ªç¬¦å·ï¼Œå¾ˆæ˜¯é˜»ç¢æˆ‘å­¦ä¹ ï¼Œæ‰€ä»¥è¶è¿™æ¬¡å›é¡¾HashMapçš„æºç çš„æœºä¼šï¼Œé¡ºä¾¿æŠŠç§»ä½ä¹Ÿå¤ä¹ ä¸€ä¸‹å§ã€‚ Â« å·¦ç§»ä½ï¼Œå°†æ“ä½œæ•°å‘å·¦ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ï¼Œå¹¶åœ¨ä½ä½è¡¥0ï¼› \u003e\u003e æœ‰ç¬¦å·å³ç§»ä½ï¼Œå°†æ“ä½œæ•°å‘å³ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ï¼Œè‹¥ç¬¦å·ä¸ºæ­£ï¼Œåˆ™åœ¨é«˜ä½æ’å…¥0ï¼›è‹¥ç¬¦å·ä¸ºè´Ÿï¼Œåˆ™åœ¨é«˜ä½æ’å…¥1ï¼› \u003eÂ» æ— ç¬¦å·å³ç§»ä½ï¼Œæ— è®ºæ­£è´Ÿï¼Œéƒ½åœ¨é«˜ä½æ’å…¥0ã€‚ æˆ‘ä»¬ä»¥ä¸€ä¸ªè´Ÿæ•°ä¸¾ä¾‹ï¼šint i = -10ï¼Œåˆ†åˆ«æ±‚iå·¦ç§»ä½2ã€æœ‰ç¬¦å·å³ç§»ä½2å’Œæ— ç¬¦å·å³ç§»ä½2åçš„å€¼ã€‚ å·¦ç§»ä½ï¼šå…ˆæŠŠi=-10æ¢ç®—æˆäºŒè¿›åˆ¶åçš„å€¼ä¸º-1010ï¼Œç„¶åå·¦ç§»ä¸¤ä½ï¼Œä½ä½ç”¨0è¡¥ä¸Šï¼Œå¾—åˆ°å€¼ä¸º-101000. æœ‰ç¬¦å·å³ç§»ä½ï¼šå…ˆæŠŠi=-10æ¢ç®—æˆäºŒè¿›åˆ¶åçš„å€¼ä¸º111111111111111111111111111 10110ï¼Œç„¶åå¼€å§‹å³ç§»ï¼Œä½†ç”±äºç©ºé—´ä¸å¤Ÿï¼Œæ‰€ä»¥æœ«å°¾çš„10å°±ä¼šè¢«èˆå»ï¼Œæ‰€ä»¥å¾—åˆ°å€¼ä¸º-10ï¼Œå› ä¸ºç¬¦å·ä¸ºè´Ÿï¼Œæ‰€ä»¥é«˜ä½ç”¨1è¡¥ä¸Šã€‚ è®¡ç®—æœºçš„ç§»ä½è®¡ç®—æ¯”ä¹˜é™¤è¿ç®—æ•ˆç‡æ›´é«˜ï¼Œæ‰€ä»¥Javaæºç ä¸­å¾ˆå¸¸è§ç§»ä½æ“ä½œã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:4:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"Javaçš„\u0026æ“ä½œç¬¦ ä½œç”¨ï¼šå¦‚æœç›¸å¯¹åº”ä½éƒ½æ˜¯1ï¼Œåˆ™ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ å®ä¾‹ï¼š public static void main(String[] args) throws Exception { int i = 11; int j = 21; System.out.println(Integer.toBinaryString(i)); System.out.println(Integer.toBinaryString(j)); System.out.println(Integer.toBinaryString(i \u0026 j)); } è¾“å‡ºï¼š 1011 10101 1 å¤§æ¦‚äº†è§£ä¸€ä¸‹å°±è¡Œï¼Œåæ­£è¿˜æ˜¯ä¸ä¼šç®—ã€‚ã€‚ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:5:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"æºç è§£è¯» ä¸€å¼€å§‹çœ‹çš„æ˜¯JDK1.8çš„æºç ï¼Œå¥½å¤æ‚ï¼Œæ‰€ä»¥ç‰¹æ„ä¸‹è½½äº†JDK1.7çš„æºç å¼€å§‹å­¦ä¹ ï¼Œä»¥ä¸‹éƒ½æ˜¯åŸºäº1.7çš„ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"ç±»å®šä¹‰ï¼Œæ”¯æŒå…‹éš†å’Œåºåˆ—åŒ– public class HashMap\u003cK,V\u003e extends AbstractMap\u003cK,V\u003e implements Map\u003cK,V\u003e, Cloneable, Serializable { è¿™é‡Œè¦æä»¥ä¸‹ï¼ŒHashMapéµå¾ªMapã€Cloneableã€Serializableï¼Œæ‰€ä»¥æ”¯æŒå…‹éš†ï¼Œæ”¯æŒåºåˆ—åŒ–ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:1","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"æ ¸å¿ƒé™æ€å†…éƒ¨ç±»â€”â€”å•å‘é“¾ static class Entry\u003cK,V\u003e implements Map.Entry\u003cK,V\u003e { //è‡ªå·±çš„key final K key; //è‡ªå·±çš„å€¼ V value; //ä¸‹ä¸€èŠ‚ç‚¹ Entry\u003cK,V\u003e next; //è‡ªå·±çš„å“ˆå¸Œ int hash; /** * æ„é€ æ–¹æ³• */ Entry(int h, K k, V v, Entry\u003cK,V\u003e n) { ... } public final K getKey() { ... } public final V getValue() { ... } public final V setValue(V newValue) { ... } public final boolean equals(Object o) { ... } public final int hashCode() { ... } public final String toString() { ... } } æºç ä¸­ä¸é‡è¦çš„åœ°æ–¹æˆ‘éƒ½çœç•¥äº†ã€‚ ä»æºç æ¥çœ‹ï¼ŒEntry\u003ckey,v\u003eç±»æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ç»“æ„ã€‚ å†ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªEntryï¼Œä¸ç¦è®©æˆ‘æƒ³èµ·äº†å‰æ®µæ—¶é—´ç ”ç©¶AQSé‡Œé¢çš„Nodeã€‚Nodeæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨å½¢å¼çš„CLHé˜Ÿåˆ—ï¼Œæ‰€ä»¥ç±»åç”¨Nodeè¡¨ç¤ºï¼Œæ„æ€æ˜¯é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼›ä½†æ˜¯åœ¨HashMapä¸­çš„Entryæ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œæ‰€ä»¥ä¸€ä¸ªEntryåªèƒ½å……å½“å…¥å£æ¥ç”¨ã€‚å®åœ¨å¾ˆä½©æœJavaçš„ä½œè€…ï¼Œèƒ½æŠŠç±»åèµ·çš„è¿™ä¹ˆè´´åˆ‡ï¼ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:2","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"æ„é€ æ–¹æ³• JDK1.7ç‰ˆæœ¬ä¸­æ„é€ æ–¹æ³•å…±æœ‰4ä¸ªï¼Œä½†æ˜¯æ ¸å¿ƒçš„åªæœ‰ä¸¤ä¸ªï¼Œæˆ‘ä»¬ä¸»è¦ç ”ç©¶ç¬¬ä¸€ä¸ªï¼š //å¸¸é‡ï¼Œå®é™…æ•°å€¼ä¸º1åé¢30ä¸ª0,æ˜¯ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œç”¨äºè¡¨ç¤ºåˆå§‹å®¹é‡çš„æé™ static final int MAXIMUM_CAPACITY = 1 \u003c\u003c 30; /** *æ ¸å¿ƒæ„é€ æ–¹æ³•ä¸€ * @param initialCapacity åˆå§‹å®¹é‡ * @param loadFactor åŠ è½½å› å­ **/ public HashMap(int initialCapacity, float loadFactor){ //åˆå§‹å®¹é‡ä¸èƒ½å°äº0 if (initialCapacity \u003c 0) throw new IllegalArgumentException(\"Illegal initial capacity: \" + initialCapacity); //åˆå§‹å®¹é‡é™ä¸ºæé™ if (initialCapacity \u003e MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; //åŠ è½½å› å­ä¸å…è®¸å°äº0ï¼Œå¿…é¡»ä¸ºæ•°å­— if (loadFactor \u003c= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException(\"Illegal load factor: \" + loadFactor); this.loadFactor = loadFactor; threshold = initialCapacity; //è°ƒç”¨é’©å­æ–¹æ³•ï¼Œç”¨æ¥hookå­ç±»ï¼Œæœ¬èº«æ²¡ä»€ä¹ˆä½œç”¨ï¼Œéœ€è¦å­ç±»é‡å†™æ‰æœ‰ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¹Ÿä¸é‡å†™ã€‚ init(); } æ„é€ æ–¹æ³•æœ€å¤§çš„ä½œç”¨å°±æ˜¯åˆå§‹åŒ–initialCapacityåˆå§‹å®¹é‡å’ŒloadFactoråŠ è½½å› å­ï¼Œè¿™ä¸¤ä¸ªå­—æ®µæœ‰ä»€ä¹ˆç”¨ï¼Œä¸‹é¢ä¼šä»‹ç»åˆ°ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:3","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"putæ–¹æ³• //èŠ‚ç‚¹æ•°ç»„ transient Entry\u003cK,V\u003e[] table = (Entry\u003cK,V\u003e[]) EMPTY_TABLE; public V put(K key, V value) { //åˆå§‹åŒ–tableæ•°ç»„ if (table == EMPTY_TABLE) { inflateTable(threshold); } //keyä¸ºnullçš„å¤„ç†æ–¹å¼ if (key == null) return putForNullKey(value); //ä¸‹é¢æ˜¯keyä¸ä¸ºnullçš„å¤„ç†æ–¹å¼ //è®¡ç®—keyçš„å“ˆå¸Œç  int hash = hash(key); //æ‰¾åˆ°hashç åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢å®šä½ int i = indexFor(hash, table.length); //éå†è¯¥ä½ç½®çš„å•å‘é“¾ï¼Œæ‰¾åˆ°å¯¹åº”çš„keyï¼Œèµ‹å€¼value for (Entry\u003cK,V\u003e e = table[i]; e != null; e = e.next) { Object k; if (e.hash == hash \u0026\u0026 ((k = e.key) == key || key.equals(k))) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } modCount++; //å¦‚æœä¸€ç›´æ‰¾ä¸åˆ°å¯¹åº”çš„keyï¼Œå°±æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ addEntry(hash, key, value, i); return null; } /** * keyä¸ºnullæ—¶çš„å¤„ç†æ–¹å¼,åªæ˜¯æ²¡æœ‰è®¡ç®—å“ˆå¸Œï¼Œè€Œæ˜¯ç›´æ¥ä» * table[0]ä½ç½®å¼€å§‹éå†é“¾è¡¨ */ private V putForNullKey(V value) { for (Entry\u003cK,V\u003e e = table[0]; e != null; e = e.next) { if (e.key == null) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } modCount++; addEntry(0, null, value, 0); return null; } /** * æ ¹æ®hashæ‰¾åˆ°æ•°ç»„ä¸­çš„å¯¹åº”ä½ç½® */ static int indexFor(int h, int length) { return h \u0026 (length-1); } /** * æ·»åŠ æ–°èŠ‚ç‚¹ */ void addEntry(int hash, K key, V value, int bucketIndex) { if ((size \u003e= threshold) \u0026\u0026 (null != table[bucketIndex])) { //å¦‚æœå½“å‰sizeå¤§äºæ‰©å®¹å› å­ï¼Œåˆ™æ‰©å®¹ä¸¤å€ resize(2 * table.length); hash = (null != key) ? hash(key) : 0; bucketIndex = indexFor(hash, table.length); } createEntry(hash, key, value, bucketIndex); } /** * åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œå¹¶æ’å…¥é˜Ÿé¦– */ void createEntry(int hash, K key, V value, int bucketIndex) { Entry\u003cK,V\u003e e = table[bucketIndex]; table[bucketIndex] = new Entry\u003c\u003e(hash, key, value, e); size++; } /** * é‡æ–°è®¡ç®—å®¹é‡ */ void resize(int newCapacity) { Entry[] oldTable = table; int oldCapacity = oldTable.length; if (oldCapacity == MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return; } Entry[] newTable = new Entry[newCapacity]; transfer(newTable, initHashSeedAsNeeded(newCapacity)); table = newTable; threshold = (int)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + 1); } Putæ–¹æ³•æ€»ç»“ å…ˆçœ‹çœ‹æµç¨‹ ä»Putæ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼ŒHashMapçš„æ ¸å¿ƒæ˜¯tableæ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ æ˜¯Entryè¿™ä¸ªå•å‘é“¾ï¼Œè¿™ç§ç»“æ„è¢«ç§°ä¹‹ä¸ºæ•£åˆ—è¡¨ã€‚ åœ¨å­˜æ”¾æ•°ç»„æ—¶ï¼Œä½¿ç”¨hash \u0026 (length-1)çš„æ–¹å¼ä½¿æ•°ç»„å‡åŒ€åˆ†å¸ƒï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ ä¸ºä½•è¦å‡åŒ€åˆ†å¸ƒï¼Ÿå› ä¸ºæŸ¥è¯¢æ—¶é¦–å…ˆæ‰¾åˆ°æ•°ç»„çš„å¯¹åº”ä¸‹æ ‡ï¼Œç„¶åforå¾ªç¯å¯¹åº”çš„å•å‘é“¾ã€‚å‡åŒ€åˆ†å¸ƒä½¿å¾—é“¾è¡¨é•¿åº¦å°½å¯èƒ½å°ï¼Œå‡å°‘äº†éå†æ¬¡æ•°ï¼Œæé«˜äº†æ•ˆç‡ã€‚ å¦‚æœæŸ¥è¯¢æ²¡æœ‰è·å–ç»“æœï¼Œå¹¶ä¸”å½“å‰çš„sizeå¤§äºæ‰©å®¹å› å­ï¼ŒHashMapä¼šå…ˆè°ƒç”¨resize()æ–¹æ³•è¿›è¡Œæ‰©å®¹ç¿»å€ï¼Œæœ€ååˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œæ’å…¥é˜Ÿé¦–ï¼Œ HashMapå…è®¸keyã€valueä¸ºnullï¼Œå½“keyä¸ºnullæ—¶ï¼Œä¼šé»˜è®¤å­˜åœ¨table[0]ã€‚ å½“keyä¸ä¸ºç©ºæ—¶ï¼Œåœ¨putæ—¶ä¼šä¾æ®keyçš„å“ˆå¸Œå€¼æ‰¾åˆ°æ•°ç»„ä¸­çš„å¯¹åº”ä½ç½®ï¼Œç„¶åforå¾ªç¯éå†è¯¥ä½ç½®çš„é“¾è¡¨æ‰¾åˆ°keyï¼Œå†è¿›è¡Œå‚¨å­˜ã€‚ ç»†è¯´æ‰©å®¹ HashMapä¸­tableæ•°ç»„åˆå§‹é•¿åº¦æ˜¯16ï¼ˆé»˜è®¤çŠ¶å†µä¸‹ï¼‰ï¼Œè€Œé»˜è®¤åŠ è½½å› å­çš„å€¼ä¸º0.75fï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µï¼Œå½“tableçš„é•¿åº¦è¶…è¿‡16 * 0.75 = 12çš„æ—¶å€™ï¼Œå†ç»§ç»­putå°±ä¼šç¿»å€æ‰©å®¹æˆ32ï¼Œç„¶åå†é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè¿™æ˜¯éå¸¸è€—è´¹æ€§èƒ½çš„ã€‚ ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨HashMapçš„æ—¶å€™ï¼Œåº”è¯¥å°½å¯èƒ½é¿å…æ‰©å®¹ï¼Œæ‰€ä»¥åº”è¯¥åœ¨åˆå§‹å®¹é‡ä¸Šé¢åšæ–‡ç« ï¼š æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æœ‰1000ä¸ªå…ƒç´ new HashMap(1000), ä½†æ˜¯ç†è®ºä¸Šæ¥è®²new HashMap(1024)æ›´åˆé€‚ï¼Œä¸è¿‡ä¸Šé¢anneguå·²ç»è¯´è¿‡ï¼Œå³ä½¿æ˜¯1000ï¼Œhashmapä¹Ÿè‡ªåŠ¨ä¼šå°†å…¶è®¾ç½®ä¸º1024ã€‚ ä½†æ˜¯new HashMap(1024)è¿˜ä¸æ˜¯æ›´åˆé€‚çš„ï¼Œå› ä¸º0.75*1000 \u003c 1000, ä¹Ÿå°±æ˜¯è¯´ä¸ºäº†è®©0.75 * size \u003e 1000, æˆ‘ä»¬å¿…é¡»è¿™æ ·new HashMap(2048)æ‰æœ€åˆé€‚ï¼Œæ—¢è€ƒè™‘äº†\u0026çš„é—®é¢˜ï¼Œä¹Ÿé¿å…äº†resizeçš„é—®é¢˜ã€‚ æ‘˜è‡ªhttps://blog.csdn.net/sd_csdn_scy/article/details/55510453 ä½†æ˜¯è¿™æ ·ä¸å¯é¿å…çš„å‡ºç°äº†å†…å­˜æµªè´¹ã€‚ åˆå§‹å®¹é‡è®¾ç½® å¿…é¡»æ˜¯2çš„æ•´æ•°å¹‚ï¼Œå¯å‡å°‘å“ˆå¸Œå†²çªï¼Œä½¿æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶ä¸”å¯ä»¥é¿å…ç©ºé—´æµªè´¹ã€‚ å°½é‡åœ¨ä¹˜ä»¥0.75åå¤§äºé¢„ä¼°å…ƒç´ æ•°é‡ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:4","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"get æ–¹æ³• public V get(Object key) { if (key == null) return getForNullKey(); Entry\u003cK,V\u003e entry = getEntry(key); return null == entry ? null : entry.getValue(); } /** * keyä¸ºnullæ—¶çš„å¤„ç†æ–¹å¼ */ private V getForNullKey() { if (size == 0) { return null; } //è¿˜æ˜¯ç›´æ¥å»èµµtable[0]ï¼Œç„¶åéå† for (Entry\u003cK,V\u003e e = table[0]; e != null; e = e.next) { if (e.key == null) return e.value; } return null; } final Entry\u003cK,V\u003e getEntry(Object key) { if (size == 0) { return null; } //è®¡ç®—å“ˆå¸Œå€¼ int hash = (key == null) ? 0 : hash(key); //æŸ¥æ‰¾å“ˆå¸Œ for (Entry\u003cK,V\u003e e = table[indexFor(hash, table.length)]; e != null; e = e.next) { Object k; if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) return e; } return null; } getæ–¹æ³•åŸºæœ¬å°±æ²¡å•¥å¯è¯´çš„äº†ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:6:5","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"åºåˆ—åŒ– ä¸€å¼€å§‹çœ‹åˆ°ç±»å£°æ˜æ—¶ï¼ŒçŸ¥é“HashMapæ˜¯æ”¯æŒåºåˆ—åŒ–çš„ï¼Œä½†æ˜¯åæ¥çœ‹åˆ°äº†ï¼š transient Entry\u003cK,V\u003e[] table = (Entry\u003cK,V\u003e[]) EMPTY_TABLE; tableæ˜¯transientçš„ï¼Œæ˜¯ä¸å…è®¸åºåˆ—åŒ–çš„ã€‚è€Œä¸”Entryæ˜¯ä¸æ”¯æŒåºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥æˆ‘å°±å¼€å§‹æƒ³HashMapæ˜¯æ€ä¹ˆè¿›è¡Œåºåˆ—åŒ–çš„å‘¢ï¼Ÿ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:7:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"writeObject private void writeObject(java.io.ObjectOutputStream s)throws IOException { // å†™å…¥å®¹é‡ã€åŠ è½½å› å­ç­‰ä¿¡æ¯ s.defaultWriteObject(); // å†™å…¥tableæ•°ç»„å½“å‰çš„é•¿åº¦ if (table==EMPTY_TABLE) { s.writeInt(roundUpToPowerOf2(threshold)); } else { s.writeInt(table.length); } // å†™å…¥å½“å‰å…ƒç´ æ•°é‡ s.writeInt(size); // éå†å†™å…¥æ‰€æœ‰å…ƒç´ çš„KV if (size \u003e 0) { for(Map.Entry\u003cK,V\u003e e : entrySet0()) { s.writeObject(e.getKey()); s.writeObject(e.getValue()); } } } ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:7:1","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"readObject private void readObject(java.io.ObjectInputStream s)throws IOException, ClassNotFoundException{ s.defaultReadObject(); if (loadFactor \u003c= 0 || Float.isNaN(loadFactor)) { throw new InvalidObjectException(\"Illegal load factor: \" +loadFactor); } // set other fields that need values table = (Entry\u003cK,V\u003e[]) EMPTY_TABLE; // Read in number of buckets s.readInt(); // ignored. // Read number of mappings int mappings = s.readInt(); if (mappings \u003c 0) throw new InvalidObjectException(\"Illegal mappings count: \" + mappings); // capacity chosen by number of mappings and desired load (if \u003e= 0.25) int capacity = (int) Math.min( mappings * Math.min(1 / loadFactor, 4.0f), // we have limits... HashMap.MAXIMUM_CAPACITY); // allocate the bucket array; if (mappings \u003e 0) { inflateTable(capacity); } else { threshold = capacity; } init(); // Give subclass a chance to do its thing. // Read the keys and values, and put the mappings in the HashMap for (int i = 0; i \u003c mappings; i++) { K key = (K) s.readObject(); V value = (V) s.readObject(); putForCreate(key, value); } } ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:7:2","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"åºåˆ—åŒ–æ€»ç»“ HashMapçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åŸç†å°±æ˜¯éå†è¯»å†™tableæ•°ç»„ä¸­çš„å„ä¸ªEntryå…ƒç´ çš„keyå’Œvalueï¼Œé‡‡ç”¨äº†ObjectInputStream.readObject()å’ŒObjectInputStream.writeObject()æ–¹æ³•ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:7:3","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":"çŸ¥è¯†ç‚¹é€Ÿè®° å‚¨å­˜ç»“æ„ï¼š JDKç‰ˆæœ¬ ç»“æ„ ç‰¹ç‚¹ 1.7 æ•£åˆ—è¡¨ é“¾è¡¨å¤ªé•¿å½±å“æŸ¥è¯¢æ€§èƒ½ 1.8 æ•£åˆ—è¡¨+çº¢é»‘æ ‘ é“¾è¡¨é•¿åº¦è¶…è¿‡8å¹¶ä¸”æ•°æ®æ€»é‡è¶…è¿‡64è½¬çº¢é»‘æ ‘ æ ¸å¿ƒå­—æ®µï¼š å­—æ®µ ä½œç”¨ transient Entry[] table ä¸»è¦å­˜å‚¨ï¼Œæ•£åˆ—è¡¨ transient int size entryçš„ä¸ªæ•° int threshold é˜ˆå€¼ï¼Œç­‰äºtable.length*loadFactoryï¼Œtableæ•°ç»„é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼å°±ä¼šæ‰©å®¹ã€‚ loadFactory åŠ è½½å› å­ modCount ä¿®æ”¹æ¬¡æ•° åˆå§‹å®¹é‡ï¼š å¿…é¡»æ˜¯2çš„æ•´æ•°å¹‚ï¼Œå¯å‡å°‘å“ˆå¸Œå†²çªï¼Œä½¿æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶ä¸”å¯ä»¥é¿å…ç©ºé—´æµªè´¹ã€‚ å°½é‡åœ¨ä¹˜ä»¥0.75åå¤§äºé¢„ä¼°å…ƒç´ æ•°é‡ã€‚ putè¿‡ç¨‹ï¼š å…ˆè®¡ç®—keyçš„hashå€¼ï¼Œå†æ ¹æ®hash \u0026 (length-1)æ‰¾åˆ°keyå†tableä¸­çš„ä½ç½®ï¼Œéå†è¯¥ä½ç½®ä¸Šçš„é“¾è¡¨æ‰¾åˆ°å¯¹åº”çš„keyï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°keyï¼Œåˆ™resize()æ–¹æ³•æ‰©å®¹ï¼Œç„¶ååˆ›å»ºæ–°çš„entryæ’å…¥é˜Ÿé¦–ã€‚ å…³äºæ‰©å®¹ï¼š æ¡ä»¶ï¼šè°ƒç”¨putæ–¹æ³•æ—¶ï¼Œsize\u003ethreshold*loadFactoryï¼› æ–¹å¼ï¼šåˆ›å»ºä¸¤å€é•¿åº¦çš„æ–°æ•°ç»„ï¼Œç„¶åforåµŒå¥—whileå¾ªç¯ä¸€ä¸ªä¸ªçš„å€’è…¾ã€‚ å…³äºåºåˆ—åŒ–ï¼š è‡ªå·±å®ç°äº†writeObjectå’ŒreadObjectæ–¹æ³•ï¼Œé€šè¿‡åå°„è°ƒç”¨ï¼›ä¼˜å…ˆå¤„ç†é‚£å‡ ä¸ªæ ¸å¿ƒå­—æ®µï¼Œæœ€åéå†entrySetåˆ†åˆ«è¯»å†™keyå’Œvalueã€‚ å…³äºEntrySetï¼š EntrySetæ˜¯HashMapçš„å†…éƒ¨ç±»ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®HashMapçš„æˆå‘˜ï¼Œæä¾›nextEntryæ–¹æ³•ï¼Œéå†çš„è¿˜æ˜¯HashMapçš„æ•£åˆ—è¡¨ã€‚ ","date":"2021-01-12","objectID":"/hashmap%E9%80%9F%E8%AE%B0/:8:0","series":null,"tags":["java"],"title":"HashMapé€Ÿè®°","uri":"/hashmap%E9%80%9F%E8%AE%B0/"},{"categories":null,"content":" ç”±äºæˆ‘å¯¹GCçš„ç†è§£ä¸€ç›´ä¸å¥½ï¼Œæ€»æ˜¯è®°ä¸ä½ï¼Œæ‰€ä»¥æœ¬ç¯‡åšå®¢å®Œå…¨æ’¸äº†ä¸€é¢—è‹¹æœçš„åšå®¢,ååˆ†æ„Ÿè°¢åŸä½œè€…ï¼ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:0:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"ä»€ä¹ˆæ˜¯åƒåœ¾ Javaè¿›ç¨‹è¿è¡Œåï¼Œå¦‚æœæŸä¸ªç±»å‹(æ–¹æ³•åŒºä¸­çš„ç±»ä¿¡æ¯ï¼Œå †ä¸­çš„ç±»å¯¹è±¡)ï¼Œå¸¸é‡ï¼Œå¯¹è±¡ï¼Œå¦‚æœä¸å¯ç”¨ï¼Œå°±æˆäº†åƒåœ¾ã€‚ æç‚¼ä¸€ä¸‹ï¼Œåƒåœ¾çš„åˆ†ç±»ï¼š ç±»å‹ å¸¸é‡ å˜é‡ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:1:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"è°è´Ÿè´£å…·ä½“çš„å›æ”¶ GCçº¿ç¨‹è´Ÿè´£å…·ä½“å›æ”¶å·¥ä½œï¼ŒGCçº¿ç¨‹æ˜¯ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:2:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"å›æ”¶çš„æ—¶æœº åˆ›å»ºå¯¹è±¡æ—¶ï¼Œéœ€è¦å†å¯¹åº”çš„å†…å­˜åŒºåŸŸåˆ†é…å†…å­˜ç©ºé—´ï¼Œå¦‚æœè¯¥åŒºåŸŸçš„ç©ºé—´ä¸è¶³ï¼Œå°±ä¼šè§¦å‘è¯¥åŒºåŸŸçš„GCã€‚ System.gc()æ–¹æ³•å¯å»ºè®®GCï¼Œä½†æ˜¯ä¸èƒ½ç¡®ä¿ä¸€å®šGCã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:3:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"åƒåœ¾åˆ¤å®šç®—æ³• ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:4:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"å¼•ç”¨è®¡æ•°æ³• ç»™å¯¹è±¡å¢åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“å¢åŠ ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œè®¡æ•°å™¨è‡ªåŠ 1ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨è‡ªå‡1ï¼›å½“è®¡æ•°å™¨ä¸º0æ—¶è¢«åˆ¤å®šä¸ºåƒåœ¾ã€‚ é—®é¢˜ï¼šå½“å‡ºç°å¾ªç¯å¼•ç”¨ä¼šæ— æ³•GCã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:4:1","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"å¯è¾¾æ€§åˆ†ææ³• ä»¥GC Rootå¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œå‘ä¸‹æœç´¢ï¼Œæœç´¢çš„è·¯å¾„ä½³ä½œâ€œå¼•ç”¨é“¾â€ã€‚å½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼ˆä¸å¯è¾¾ï¼‰,è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯åƒåœ¾ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:4:2","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"Javaçš„å››ç§å¼•ç”¨ç±»å‹ å¼ºå¼•ç”¨ Object o = new Object(); åªè¦æ˜¯newå‡ºæ¥çš„éƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œåªè¦å¯è¾¾ï¼Œå°±ä¸èƒ½è¢«å›æ”¶ï¼Œå°±ç®—å†…å­˜ä¸è¶³ï¼ŒJVMä¹Ÿåªä¼šæŠ›å‡ºOOMå¼‚å¸¸ã€‚ è½¯å¼•ç”¨ SoftReference\u003cObject\u003e sr = new SoftReference\u003c\u003e(new Object()); å³ä½¿æ˜¯å¯è¾¾çš„,ä½†æ˜¯ä¸€æ—¦è¯¥åŒºåŸŸç©ºé—´ä¸è¶³(OOM)ï¼Œå°±ä¼šè¢«GCã€‚ å¼±å¼•ç”¨ WeakReference\u003cObject\u003e sr = new WeakReference\u003c\u003e(new Object()); å³ä½¿æ˜¯å¯è¾¾çš„ï¼Œä½†æ˜¯ä¸€æ—¦è¯¥åŒºåŸŸå‘ç”ŸGCï¼Œä¹Ÿä¼šè¢«åŒæ—¶GCæ‰ã€‚ è™šå¼•ç”¨ è¿™è´§åŸºæœ¬ä¸ç”¨ï¼Œéšæ—¶éƒ½æœ‰å¯èƒ½è¢«å›æ”¶ï¼Œçœ‹å¿ƒæƒ…ï¼Ÿ å›æ”¶ä¼˜å…ˆçº§ è™šå¼•ç”¨-\u003eå¼±å¼•ç”¨-\u003eè½¯å¼•ç”¨-\u003eå¼ºå¼•ç”¨ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:4:3","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"GCçš„ä½ç½® ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°JVMMåˆ’åˆ†æˆäº†ä¸¤å¤§å—ä¸‰å¤§åŒºå’Œä¸‰å°åŒºï¼š å¹´è½»ä»£GCéå¸¸é¢‘ç¹ï¼Œå›æ”¶æ•ˆç‡ä¹Ÿé«˜ã€‚ è€å¹´ä»£GCé€Ÿåº¦æ¯”å¹´è½»ä»£æ…¢10å€ä»¥ä¸Šã€‚ æ°¸ç”Ÿä»£GCé¢‘ç‡éå¸¸ä½ï¼Œåœ¨jdk1.7å«æ–¹æ³•åŒºï¼Œ1.8å«åŸç©ºé—´ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:5:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"GCç®—æ³• ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:6:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"æ ‡è®°æ¸…é™¤æ³• å…ˆæ ‡è®°ä¸å¯è¾¾å¯¹è±¡ï¼Œå†ä¸€æ¬¡æ€§é‡Šæ”¾æ‰€æœ‰æ ‡è®°è¿‡çš„å¯¹è±¡ã€‚ ç‰¹ç‚¹ï¼š æ ‡è®°æ—¶åªè¦æ‰¾åˆ°ä¸€ä¸ªå¼•ç”¨å°±å¯è¯æ˜å¯¹è±¡å­˜æ´»ç€ï¼› ä¸ç§»åŠ¨å¯¹è±¡ä½ç½®ï¼› ç”±äºä¸¤ä¸ªé˜¶æ®µéƒ½é‡‡ç”¨éå†+é€’å½’çš„å½¢å¼ï¼Œæ‰€ä»¥ä¸¤ä¸ªé˜¶æ®µæ•ˆç‡éƒ½ä¸é«˜ï¼› å›æ”¶åå­˜åœ¨å†…å­˜ç¢ç‰‡ï¼Œé€ æˆç©ºé—´æµªè´¹ã€‚ å†…å­˜ç¢ç‰‡ï¼šå½“åˆ›å»ºéå¸¸å¤§çš„å¯¹è±¡æ—¶ï¼Œä¸€å—åŒºåŸŸä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥JVMä¼šç»™è¯¥å¯¹è±¡åˆ†é…å¦ä¸€å—ç›¸è¿çš„åŒºåŸŸï¼›è€ŒGCæ—¶åªä¼šå›æ”¶å…¶ä¸­ä¸€å—åŒºåŸŸï¼Œå¦ä¸€å—åŒºåŸŸä¸ä¼šè¢«å›æ”¶ï¼Œå°±å½¢æˆäº†ç¢ç‰‡ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:6:1","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"å¤åˆ¶ç®—æ³•ï¼ˆæ–°ç”Ÿä»£é‡‡ç”¨ï¼‰ å°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™å—å†…å­˜éœ€è¦è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šå°†æ­¤åŒºåŸŸè¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ç»ä½¿ç”¨è¿‡çš„å†…å­˜åŒºåŸŸä¸€æ¬¡æ¸…ç†æ‰ã€‚ ç‰¹ç‚¹ï¼š æ•ˆç‡é«˜ æ²¡æœ‰ç¢ç‰‡é—®é¢˜ ä»åŸç†ä¸Šçœ‹æµªè´¹äº†ä¸€åŠç©ºé—´ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:6:2","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"æ ‡è®°æ•´ç†ç®—æ³•ï¼ˆè€å¹´ä»£é‡‡ç”¨ï¼‰ æ ‡è®°å‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œç„¶åç§»åŠ¨åˆ°å¦ä¸€å—åŒºåŸŸï¼Œå†æ¸…ç†å‰©ä½™å†…å­˜ã€‚ ç‰¹ç‚¹ï¼š å¦‚æœå­˜æ´»å¯¹è±¡è¿‡å¤šï¼Œä¼šäº§ç”Ÿè¾ƒå¤šå¤åˆ¶æ“ä½œï¼Œå¯¼è‡´æ•ˆç‡ä½ï¼› æ²¡æœ‰ç¢ç‰‡ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:6:3","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"åˆ†ä»£æ”¶é›†ç®—æ³•ï¼ˆJVMçš„æ•´ä½“ç®—æ³•ï¼‰ å°±æ˜¯åˆ†æˆè‹¥å¹²åŒºåŸŸï¼Œä»€ä¹ˆæ–°ç”Ÿä»£ã€è€å¹´ä»£ã€æ°¸ç”Ÿä»£ï¼Œç„¶åè¿›ä¸€æ­¥ç»†åˆ†åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸé‡‡ç”¨ä¸åŒçš„GCç®—æ³•ï¼š æ–°ç”Ÿä»£ï¼šå¯¹è±¡ç”Ÿå­˜å‘¨æœŸçŸ­ï¼Œæ¯æ¬¡å›æ”¶ä¼šé‡Šæ”¾å¤§é‡å¯¹è±¡ï¼Œæ‰€ä»¥é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼› è€å¹´ä»£ï¼šå¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜ï¼Œæ²¡æœ‰é¢å¤–çš„ç©ºé—´è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œæ‰€ä»¥é‡‡ç”¨æ ‡è®°æ•´ç†ç®—æ³•ã€‚ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:6:4","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"é¸£è°¢ï¼š è€è«8 ä¸€é¢—è‹¹æœ ","date":"2021-01-12","objectID":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/:7:0","series":null,"tags":["java"],"title":"Javaçš„GCæœºåˆ¶","uri":"/java%E7%9A%84gc%E6%9C%BA%E5%88%B6/"},{"categories":null,"content":"javaæ˜¯å¼•ç”¨ä¼ é€’è¿˜æ˜¯å€¼ä¼ é€’ï¼Ÿ ç»“è®ºï¼ŒJavaå°±æ˜¯å€¼ä¼ é€’ï¼Œåªä¸è¿‡åœ¨ä¼ é€’å¼•ç”¨ç±»å‹çš„æ—¶å€™ï¼Œä¼šæŠŠå¯¹è±¡çš„å¼•ç”¨åœ°å€å½“ä½œå€¼æ¥ä¼ é€’ã€‚ é¦–å…ˆå£°æ˜ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼š private static class MyObject { private MyObject subObject; private String content; private int num; public MyObject(String content, int num) { this.content = content; this.num = num; } public MyObject(String content, int num, String subContent, int subnum) { this.content = content; this.num = num; this.subObject = new MyObject(subContent, subnum); } @Override public String toString() { StringBuilder sb = new StringBuilder(\"å½“å‰çš„contentæ˜¯:\" + content + \"\\tå½“å‰çš„numæ˜¯\" + num); if (subObject != null) { sb.append(\"\\nå±æ€§çš„contentæ˜¯:\" + subObject.content + \"\\tå±æ€§çš„numæ˜¯:\" + subObject.num); } return sb.toString(); } } ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:0","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"å½¢å‚ä¸ºä¸€èˆ¬ç±»å‹ï¼Œå¯¹å®å‚æ— å½±å“ public static void main(String[] args) throws Exception { int num = 0; test(num); System.out.println(\"ç»testæ–¹æ³•ä¹‹å,numå€¼ä¸ºï¼š\\n\" + num); } è¾“å‡ºï¼š ç»testæ–¹æ³•ä¹‹å,numå€¼ä¸ºï¼š 0 ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:1","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"å½¢å‚ä¸ºå¼•ç”¨ç±»å‹ï¼Œå¯¹å®å‚æ— å½±å“ public static void main(String[] args) throws Exception { MyObject obj = new MyObject(\"æˆ‘æ˜¯ç¬¬ä¸€å±‚\", 10, \"æˆ‘æ˜¯ç¬¬äºŒå±‚\", 20); test(obj); System.out.println(\"ç»testæ–¹æ³•ä¹‹å,objå¯¹è±¡ä¸ºï¼š\\n\" + String.valueOf(obj)); } /** * æˆ‘æ˜¯æ–¹æ³• * @param myobj */ private static void test(MyObject myobj) { myobj = null; } è¾“å‡ºï¼š ç»testæ–¹æ³•ä¹‹å,objå¯¹è±¡ä¸ºï¼š å½“å‰çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬ä¸€å±‚ å½“å‰çš„numæ˜¯10 å±æ€§çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬äºŒå±‚ å±æ€§çš„numæ˜¯:10 å¯ä»¥çœ‹åˆ°åœ¨æ–¹æ³•ä¸­ç»™å½¢å‚è®¾ç½®ä¸ºnullï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥è¾“å‡ºã€‚ ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:2","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"æ”¹å˜å½¢å‚çš„ä¸€èˆ¬ç±»å‹å­—æ®µï¼Œä¼šæ”¹å˜å®å‚çš„å­—æ®µ private static void test(MyObject myobj) { myobj.num++; } è¾“å‡ºï¼š ç»testæ–¹æ³•ä¹‹å,objå¯¹è±¡ä¸ºï¼š å½“å‰çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬ä¸€å±‚ å½“å‰çš„numæ˜¯11 å±æ€§çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬äºŒå±‚ å±æ€§çš„numæ˜¯:20 ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:3","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"æ”¹å˜å½¢å‚çš„å¼•ç”¨å­—æ®µï¼Œä¹Ÿä¼šæ”¹å˜å®å‚çš„å­—æ®µ private static void test(MyObject myobj) { myobj.content = null; } è¾“å‡ºï¼š ç»testæ–¹æ³•ä¹‹å,objå¯¹è±¡ä¸ºï¼š å½“å‰çš„contentæ˜¯:null å½“å‰çš„numæ˜¯10 å±æ€§çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬äºŒå±‚ å±æ€§çš„numæ˜¯:20 ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:4","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"æ”¹å˜å½¢å‚å¼•ç”¨å­—æ®µå†…éƒ¨çš„ä¸€èˆ¬å­—æ®µï¼Œå®å‚ä¼šå˜ private static void test(MyObject myobj) { myobj.subObject.num++; } è¾“å‡ºï¼š ç»testæ–¹æ³•ä¹‹å,objå¯¹è±¡ä¸ºï¼š å½“å‰çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬ä¸€å±‚ å½“å‰çš„numæ˜¯10 å±æ€§çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬äºŒå±‚ å±æ€§çš„numæ˜¯:21 ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:5","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"æ”¹å˜å½¢å‚å¼•ç”¨å­—æ®µå†…éƒ¨çš„å¼•ç”¨å­—æ®µï¼Œå®å‚ä¼šå˜ private static void test(MyObject myobj) { myobj.subObject.content=null; } è¾“å‡ºï¼š å½“å‰çš„contentæ˜¯:æˆ‘æ˜¯ç¬¬ä¸€å±‚ å½“å‰çš„numæ˜¯10 å±æ€§çš„contentæ˜¯:null å±æ€§çš„numæ˜¯:20 ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:6","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"æ€»ç»“ï¼š javaæ˜¯æ‹·è´ä¼ é€’ï¼Œå¦‚æœå½¢å‚æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™æ”¹å˜å½¢å‚å¯¹å®å‚æ— ä»»ä½•å½±å“ï¼›è€Œæ”¹å˜å½¢å‚å†…éƒ¨çš„å±æ€§ï¼Œåˆ™ä¼šå¯¹å®å‚äº§ç”Ÿå½±å“ã€‚ ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:1:7","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"tryé‡Œé¢returnï¼Œæ˜¯returnå…ˆæ‰§è¡Œè¿˜æ˜¯finallyå…ˆæ‰§è¡Œï¼Ÿ public static void main(String[] args) throws Exception { boolean result = test(); System.out.print(\"æ”¶åˆ°ç»“æœä¸ºï¼š\" + result); } private static boolean test() { try { System.out.println(\"æ‰§è¡Œåˆ°äº†return\"); return true; } finally { System.out.println(\"æ‰§è¡Œåˆ°äº†finally\"); } } è¾“å‡ºï¼š æ‰§è¡Œåˆ°äº†return æ‰§è¡Œåˆ°äº†finally æ”¶åˆ°ç»“æœä¸ºï¼štrue ä»è¾“å‡ºä¸Šçœ‹ï¼Œåº”è¯¥æ˜¯å…ˆreturnå†æ‰§è¡Œfinallyï¼Œä½†æ˜¯â€¦ å½“æˆ‘åœ¨returnå¤„æ‰“ä¸Šæ–­ç‚¹ï¼Œåœ¨finallyå†…éƒ¨è¾“å‡ºé‚£ä¸€è¡Œä¹Ÿæ‰“ä¸Šæ–­ç‚¹ï¼Œè°ƒè¯•æ—¶æƒŠå–œçš„å‘ç°ï¼Œå…ˆæ‰§è¡Œtryå†…çš„è¾“å‡ºï¼Œç„¶åè‡ªåŠ¨è·³è¿‡äº†returnè¯­å¥ç›´æ¥åœ¨finallyå†…éƒ¨çš„æ–­ç‚¹åœäº†ï¼Œå½“æˆ‘ç»§ç»­è¿è¡Œï¼Œå‘ç°å®ƒåˆå›åˆ°äº†returnè¯­å¥ï¼Œæœ€åæ‰ç¦»å¼€æ–¹æ³•ã€‚ ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:2:0","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"tryå’Œfinallyéƒ½return public static void main(String[] args) throws Exception { boolean result = test(); System.out.println(\"æ”¶åˆ°ç»“æœä¸ºï¼š\" + result); } private static boolean test() { try { System.out.println(\"æ‰§è¡Œåˆ°äº†return\"); return true; } finally { System.out.println(\"æ‰§è¡Œåˆ°äº†finally\"); return false; } } å½“ç„¶åˆ°äº†ç°åœ¨ï¼Œå¯ä»¥ä¸ç›¸ä¿¡è¾“å‡ºäº†ï¼Œè¦ä»¥æ–­ç‚¹é¡ºåºä¸ºå‡†ã€‚ å½“tryå’Œfinallyä¸­éƒ½æœ‰returnæ—¶ï¼ŒJavaå†ä¸€æ¬¡ç»™äº†æˆ‘æƒŠå–œï¼š é¦–å…ˆæ‰§è¡Œäº†tryä¸­çš„returnï¼Œç„¶ååˆæ‰§è¡Œäº†finallyä¸­çš„returnï¼Œæœ€åæ‰è¿”å›ç»“æœï¼Œå¹¶ä¸”æ˜¯ä»¥finallyä¸­çš„returnä¸ºå‡†ï¼ ç»“è®ºï¼š finallyä¸­æ²¡æœ‰returnï¼Œå…ˆfinallyå†tryçš„returnï¼› finallyä¸­æœ‰returnï¼Œå…ˆtryçš„returnï¼Œå†finallyä¸­çš„returnï¼Œç»“æ„ä»¥åæ‰§è¡Œçš„returnä¸ºå‡†ã€‚ æ‰€ä»¥Javaæ— è®ºå¦‚ä½•éƒ½æ˜¯å…ˆfinallyå†returnï¼ ","date":"2021-01-12","objectID":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/:2:1","series":null,"tags":["java"],"title":"Javaè¶£å‘³é¢˜","uri":"/java%E8%B6%A3%E5%91%B3%E9%A2%98/"},{"categories":null,"content":"è¶ç€ä¸‹è½½Keycloakçš„æ—¶å€™ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±å¯¹SpringCloudä¸­çš„ç”¨æˆ·é‰´æƒç³»ç»Ÿçš„è®¤è¯†ã€‚ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:0:0","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"OAuth2.0 å››ç§æˆæƒæ¨¡å¼ æ¨¡å¼ refresh_token ç”¨é€” authorization_code true å…è®¸ç”¨æˆ·é€šè¿‡ç¬¬ä¸‰æ–¹åº”ç”¨ç™»å½•è‡ªèº«è·å–èµ„æºï¼Œå‰ææ˜¯ç”¨æˆ·å·²ç™»å½•è‡ªèº«æœåŠ¡ã€‚ implicit false ç®€åŒ–æ¨¡å¼ï¼Œè·³è¿‡äº†è·å–æˆæƒç è¿‡ç¨‹ã€‚ password true è´¦å·å¯†ç æ¨¡å¼ï¼Œç”¨äºé«˜åº¦æˆä¿¡åœºæ™¯ï¼Œæ¯”å¦‚ç™»å½•å¾®ä¿¡ã€QQè‡ªèº«ï½œ client_credentials false å®¢æˆ·ç«¯æ¨¡å¼ï¼Œç”¨äºé«˜åº¦æˆä¿¡çš„å…¶ä»–æœåŠ¡ï¼Œå¦‚ä¼ä¸šè‡ªå·±çš„å…¶ä»–æœåŠ¡ï¼Œæˆ–é«˜åº¦åŠ å¯†çš„ç¡¬ä»¶å®¢æˆ·ç«¯ï¼Œç™»å½•è¿‡ç¨‹å®Œå…¨ä¸éœ€è¦ç”¨æˆ·æ“ä½œã€‚ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:1:0","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"Securityã€ResourceServerã€ClientServerå„è‡ªçš„ä½œç”¨å’Œå…³ç³» SpringSecurity:é‰´æƒæ–¹å¼çš„é…ç½®ï¼Œæ¯”å¦‚å“ªäº›æ¥å£éœ€è¦é‰´æƒï¼Œè¿˜è¦æ’é™¤è°ƒç™»å½•æ³¨å†Œå’Œç™»å‡ºæ¥å£ç­‰ç­‰ã€‚è¿˜æœ‰ç”¨æˆ·ä¿¡æ¯çš„å­˜æ”¾ã€è®¤è¯ï¼ŒToken Provider çš„é…ç½®ç­‰ç­‰ã€‚ ResourceServer:æ˜¯æŒ‡éœ€è¦æ”¶åˆ°ä¿æŠ¤çš„èµ„æºã€‚æ¯”æˆ‘çš„ä¸€ä¸ªæœåŠ¡æœ‰å¤§é‡æ¥å£ï¼Œéœ€è¦é‡‡ç”¨Securityä¿æŠ¤ï¼Œé‚£è¿™ä¸ªæœåŠ¡å°±æ˜¯ä¸ªResourceServerã€‚æ€ä¹ˆä¿æŠ¤å‘¢ï¼Ÿé€šè¿‡é›†æˆSpringSecurityæ¥ä¿æŠ¤ã€‚æ¯å½“æœ‰è¯·æ±‚è¦è®¿é—®æˆ‘ä»¬çš„æ¥å£ï¼ŒResourceServeréƒ½éœ€è¦å‘token_provideréªŒè¯tokençš„æœ‰æ•ˆæ€§ã€‚ ClientServer:æ˜¯ç”¨æ¥åœ¨æœåŠ¡ç«¯è·å–access_tokenå’Œrefresh_tokenç”¨çš„ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨ä½¿ç”¨refresh_tokenå»åˆ·æ–°access_tokenã€‚å‘è°è·å–ï¼Ÿå¯ä»¥æ˜¯å¾®ä¿¡ã€å¾®åšã€githubç­‰ç­‰ã€‚ TokenProvider:ç”¨æ¥æä¾›tokençš„æœåŠ¡ã€‚æ¯”å¦‚å¾®ä¿¡ã€æ”¯ä»˜å®ã€github,ä¹Ÿå¯ä»¥æ˜¯è‡ªå·±æ­å»ºçš„KeycloakæœåŠ¡ã€‚ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:2:0","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"ç½‘å…³ç»Ÿä¸€ç”¨æˆ·è®¤è¯ å¾ˆç®€å•ï¼Œè¯´ç™½äº†å°±æ˜¯åœ¨Gatewayé›†æˆSecurityï¼Œè¿™æ ·ä»¥æ¥Gatewayå°±æˆäº†ä¸€ä¸ªResourceServerï¼Œå¹¶ä¸”å¯ä»¥ä¸ºæ‰€æœ‰è·¯ç”±åšç”¨æˆ·è®¤è¯ã€‚ ä½†æ˜¯ï¼å…·ä½“çš„é‰´æƒè¿˜æ˜¯éœ€è¦å„ä¸ªæœåŠ¡è‡ªå·±å»åšï¼Œæ¯•ç«Ÿç½‘å…³ä¸çŸ¥é“å…·ä½“çš„æœåŠ¡éœ€è¦å…·ä½“å“ªä¸€é¡¹æƒé™ã€‚ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:3:0","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"FAQ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:4:0","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"ç›´æ¥ä½¿ç”¨å¾®ä¿¡ã€æ”¯ä»˜å®çš„tokenæ¥åšè‡ªå·±çš„æœ‰æ•ˆæ€§éªŒè¯å¯ä»¥ç ï¼Ÿ å½“ç„¶å¯ä»¥ï¼åªä¸è¿‡ï¼Œäººå®¶çš„tokenéªŒè¯åªæœ‰åœ¨è°ƒç”¨ä»–ä»¬çš„æœåŠ¡æ—¶æ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœä¸è°ƒç”¨ä»–ä»¬çš„æœåŠ¡ï¼Œæˆ‘ä»¬è‡ªå·±ä¸çŸ¥é“äººå®¶çš„tokenæ˜¯å¦æœ‰æ•ˆï¼ˆè¶…æ—¶è¿‡æœŸï¼‰ã€‚ é‚£ä¹ˆè¯¥æ€ä¹ˆå®ç°ï¼Ÿå½“æˆ‘ä»¬è‡ªå·±çš„æ¥å£è¢«è®¿é—®æ—¶ï¼Œå…ˆå»è°ƒä¸ªäººå®¶çš„æœåŠ¡ï¼Œæœ€å¥½æ˜¯æ— å…³ç—›ç—’çš„æœåŠ¡ï¼Œå•çº¯ä¸ºäº†éªŒè¯äººå®¶çš„tokenæ˜¯å¦æœ‰æ•ˆã€‚ ä½†æ˜¯è¿™æ ·ä»¥æ¥å°±å¤§å¤§é™ä½äº†æ¥å£çš„è¯·æ±‚é€Ÿåº¦ï¼Œè€Œä¸”ä¹Ÿä¸ä¼˜é›…ï¼Œå¹³è¡¡ä¸‹æ¥è¿˜ä¸è®¸è‡ªå·±æ­å»ºå¸å·ä½“ç³»æ¥çš„å®åœ¨ï¼ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:4:1","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"é‡‡ç”¨æˆæƒç æ–¹å¼è®©è‡ªå·±çš„å®¢æˆ·ç«¯è®¿é—®è‡ªå·±æœåŠ¡ï¼Ÿ è¿™å°±å«è„±äº†è£¤å­æ”¾å±ï¼Œä¸ºå®‰å…¨è€Œå®‰å…¨ï¼ ç”¨å¾®ä¿¡çš„ç¬¬ä¸‰æ–¹ç™»å½•ä¸¾ä¾‹ï¼Œå‡å¦‚æˆ‘ä»¬æ²¡æœ‰ç™»å½•å¾®ä¿¡ï¼Œå½“ä½¿ç”¨å¾®ä¿¡æ—¶ï¼Œä¾ç„¶éœ€è¦ç”¨å¸å·å¯†ç æ–¹å¼å…ˆç™»å½•å¾®ä¿¡ã€‚å› ä¸ºä½ åœ¨æ“ä½œæˆæƒç™»å½•æ—¶ï¼Œæ˜¯å…ˆè°ƒèµ·å¾®ä¿¡çš„é¡µé¢æˆ–è€…å®ƒSDKçš„é¡µé¢ï¼Œæ˜¯åœ¨äººå®¶çš„é¡µé¢é‡Œé¢ç©çš„ï¼Œå¯¹äºå¾®ä¿¡æ¥è®²ï¼Œä»–è‡ªå·±çš„é¡µé¢å°±æ˜¯é«˜åº¦æˆä¿¡çš„ï¼Œæ‰€ä»¥è¿½æœ¬æº¯æºï¼Œæˆæƒç ç™»å½•æ–¹å¼è¿˜æ˜¯åŸºäºå¸å·å¯†ç ä¹‹ä¸Šçš„ã€‚ ","date":"2021-01-12","objectID":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/:4:2","series":null,"tags":["spring","cloud","security","oauth2.0"],"title":"å¯¹SpringGateway+Security+OAuth2.0çš„è®¤è¯†","uri":"/%E5%AF%B9springgateway-security-oauth2-0%E7%9A%84%E8%AE%A4%E8%AF%86/"},{"categories":null,"content":"æ­»é” æ­»é”æ˜¯æŒ‡å¤šä¸ªçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºæˆ–è€…ç”±äºæ‰¹æ¬¡é€šä¿¡è€Œé€ æˆçš„ä¸€ç§é˜»å¡ç°è±¡ã€‚è‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œä»–ä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚ ","date":"2021-01-07","objectID":"/cas/:1:0","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":null,"content":"æ‚²è§‚é”ä¸ä¹è§‚é” æ‚²è§‚é”: å‡å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œå³å…±äº«èµ„æºä¼šè¢«æŸä¸ªçº¿ç¨‹æ›´æ”¹ã€‚æ‰€ä»¥å½“æŸä¸ªçº¿ç¨‹è·å–å…±äº«èµ„æºæ—¶ï¼Œä¼šé˜»æ­¢åˆ«çš„çº¿ç¨‹è·å–å…±äº«èµ„æºã€‚ä¹Ÿç§°ç‹¬å é”æˆ–è€…äº’æ–¥é”ï¼Œä¾‹å¦‚javaä¸­çš„synchronizedåŒæ­¥é”ã€‚ ä¹è§‚é”: å‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œåªæœ‰åœ¨æœ€åæ›´æ–°å…±äº«èµ„æºçš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´æœ‰æ²¡æœ‰åˆ«çš„çº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå…±äº«èµ„æºã€‚å¦‚æœå‘ç”Ÿå†²çªå°±é‡è¯•ï¼Œç›´åˆ°æ²¡æœ‰å†²çªï¼Œæ›´æ–°æˆåŠŸã€‚CASå°±æ˜¯ä¸€ç§ä¹è§‚é”å®ç°æ–¹å¼ã€‚ ç”±äºä¹è§‚é”ä¸ä¼šé˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥ç›¸å¯¹ç›¸ç‡æ›´é«˜ã€‚ ","date":"2021-01-07","objectID":"/cas/:2:0","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":null,"content":"CAS ","date":"2021-01-07","objectID":"/cas/:3:0","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":null,"content":"å®šä¹‰ compare and swap æ¯”è¾ƒå¹¶ä¸”äº¤æ¢ JVMçš„CASåŒæ—¶åŒ…å«äº†CPUçš„CASæŒ‡ä»¤å’Œè‡ªé€‰æ“ä½œã€‚ CPUçš„CASæŒ‡ä»¤æ ¸å¿ƒæ˜¯ä¸‰ä¸ªå€¼ä¹‹é—´çš„æ¯”è¾ƒå’Œäº¤æ¢ï¼š å½“å‰å†…å­˜å€¼(O) é¢„æœŸåŸæ¥çš„å€¼(C) æœŸå¾…æ›´æ–°çš„å€¼(U) æ¯”è¾ƒæ–¹å¼ï¼š å¦‚æœå†…å­˜ä½ç½®Oçš„å€¼ä¸é¢„æœŸåŸå€¼Cç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®å€¼æ›´æ–°ä¸ºæ–°å€¼,è¿”å›trueã€‚å¦åˆ™å¤„ç†å™¨ä¸åšä»»ä½•æ“ä½œï¼Œè¿”å›falseã€‚ JVMæ¥æ”¶åˆ°falseåä¼šè‡ªæ—‹æ“ä½œï¼Œç›´åˆ°æ”¶åˆ°trueä¸ºæ­¢ã€‚ eg: å‡è®¾å½“å‰æœ‰ä¸¤ä¸ªçº¿ç¨‹t1å’Œt2å¹¶å‘æ“ä½œOï¼ˆOå¤„äºå†…å­˜ä¸­ï¼‰ï¼Œå½“t1æ‹¿åˆ°é”å‡†å¤‡å¼€å§‹å˜æ›´Oæ—¶ï¼Œt1ä¼šå…ˆæŠŠOæ‹·è´å‡ºä¸€ä¸ªå®ƒè‡ªå·±çš„çº¿ç¨‹å‰¯æœ¬C(å¤„äºCPUç¼“å­˜ä¸­)ï¼Œç„¶åå¯¹å‰¯æœ¬åšå¯¹åº”çš„æ“ä½œäº§ç”ŸUï¼Œä¹‹åå†ç”¨Cå»è·Ÿå†…å­˜ä¸­çš„Oåšæ¯”è¾ƒï¼Œå¦‚æœC=Oï¼Œè¯´æ˜å†…å­˜ä¸­çš„Oæ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å˜æ›´ï¼Œé‚£ä¹ˆå°±æŠŠUåˆ·å†™è¿›å†…å­˜æ›¿æ¢æ‰Oï¼Œå¹¶ä¸”è¿”å›trueï¼›å¦‚æœC!=Oï¼Œå°±ç›´æ¥è¿”å›falseã€‚ JVMæ¥æ”¶åˆ°falseåï¼Œå°±ä¼šä»å¤´å†æ¥ä¸€éï¼Œä¹Ÿå°±æ˜¯è‡ªæ—‹ã€‚ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶å†…å­˜ä¸­çš„Oå·²ç»è¢«t2æ›´æ”¹ä¸ºO+äº†,æ‰€ä»¥t1ä¼šæŠŠO+ä½œä¸ºå½“å‰å€¼åˆ›å»ºå‰¯æœ¬C+,æ‰§è¡Œæ“ä½œåäº§ç”ŸU+,ç„¶åç”¨C+å†å»è·Ÿå†…å­˜ä¸­çš„å€¼å¯¹æ¯”ã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œç›´åˆ°CPUè¿”å›trueä¸ºæ­¢ã€‚ å…¸å‹å°±æ˜¯JUCå¹¶å‘æ¡†æ¶ä¸‹çš„atomicåŸå­ç±»å‹ã€‚ æ³¨æ„ï¼šCASæœ¬èº«ä¸å¾ªç¯ï¼Œå¾ªç¯ä¹Ÿå°±æ˜¯è‡ªæ—‹æ˜¯ç”±JVMå®ç°çš„ã€‚ ","date":"2021-01-07","objectID":"/cas/:3:1","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":null,"content":"CSçš„ä¸‰å¤§é—®é¢˜ ABAé—®é¢˜ å¼€é”€é—®é¢˜ åªèƒ½ä¿è¯ä¸€ä¸ªå†…å­˜å˜é‡çš„åŸå­æ“ä½œ ABAé—®é¢˜ é—®é¢˜æè¿°ï¼šçº¿ç¨‹t1å°†å®ƒçš„å€¼ä»Aå˜ä¸ºBï¼Œå†ä»Bå˜ä¸ºAã€‚åŒæ—¶æœ‰çº¿ç¨‹t2è¦å°†å€¼ä»Aå˜ä¸ºCã€‚ä½†CASæ£€æŸ¥çš„æ—¶å€™ä¼šå‘ç°æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯å®è´¨ä¸Šå®ƒå·²ç»å‘ç”Ÿäº†æ”¹å˜ ã€‚å¯èƒ½ä¼šé€ æˆæ•°æ®çš„ç¼ºå¤±ã€‚ é—®é¢˜æè¿°ï¼š t1å’Œt2åŒæ—¶æ“ä½œAï¼Œt1è¦æŠŠAæ”¹ä¸ºBå†æ”¹å›Aï¼Œå¹¶ä¸”t1æ¯”t2é€Ÿåº¦å¿«çš„å¤šï¼Œå¯¼è‡´t2è¦æŠŠAæ”¹ä¸ºCæ—¶ï¼Œæ¯”è¾ƒçš„ç»“æœä¼šè®¤ä¸ºAæ²¡æœ‰è¢«æ”¹å˜è¿‡ï¼Œä¼šç›´æ¥è¿›è¡Œæ›¿æ¢ï¼Œå¯¼è‡´äº†æ•°æ®ä¸¢å¤±ã€‚ eg æœ‰ä¸€æ¡å•å‘é“¾A-\u003eBï¼Œæˆ‘ä»¬æƒ³é€šè¿‡å¹¶å‘æŠŠå®ƒå˜ä¸ºB-\u003eC-\u003eDã€‚ çº¿ç¨‹t1è´Ÿè´£æŠŠAç§»é™¤ï¼Œè®©æ ˆé¡¶å˜ä¸ºBï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è¿›è¡ŒCASã€‚ æ­¤æ—¶ä¸€ä¸ªéå¸¸å¿«çš„çº¿ç¨‹t2ï¼Œå®ƒæŠŠé“¾æ¡ä¸­çš„å…ƒç´ å…¨éƒ¨å‡ºæ ˆï¼Œç„¶åå†ä¾æ¬¡è£…å…¥Aã€Cã€D æ­¤æ—¶å•å‘é“¾å˜ä¸ºA-\u003eC-\u003eD ç„¶åt1åœ¨è¿›è¡ŒCASæ—¶ï¼Œç”±äºæ ˆé¡¶è¿˜æ˜¯Aï¼Œæ‰€ä»¥compareå°±ä¼šé€šè¿‡ï¼Œå¹¶ä¸”å®Œæˆæ›¿æ¢ã€‚ æ­¤æ—¶å•å‘é“¾å˜ä¸ºï¼šB-\u003enull ä»ç»“æœä¸Šæ¥çœ‹ï¼ŒCå’ŒDä¸¢å¤±æ‰äº†ã€‚ è§£å†³åŠæ³• åŠ æ—¶é—´æˆ³æˆ–è€…ç‰ˆæœ¬æˆ³ AtomicStampedReferenceï¼ˆå†…éƒ¨ä¹Ÿæ˜¯ç‰ˆæœ¬æˆ³ï¼‰ AtomicStampedReferenceæ€ä¹ˆç”¨æš‚æ—¶è¿˜ä¸ä¼šï¼Œä»¥åå†è¯´å§ğŸ˜„ public static void main(String[] args) { AtomicStampedReference\u003cInteger\u003e stampedReference = new AtomicStampedReference\u003c\u003e(100,1); //é£å¿«çš„t2 new Thread(() -\u003e { stampedReference.compareAndSet(100, 101, stampedReference.getStamp(), stampedReference.getStamp() + 1 ); stampedReference.compareAndSet(101, 100, stampedReference.getStamp(), stampedReference.getStamp() + 1 ); },\"t2\").start(); //é¾Ÿé€Ÿçš„t1 new Thread(() -\u003e { int stamp = stampedReference.getStamp(); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } boolean b = stampedReference.compareAndSet(100, 2019, stamp, stamp + 1); },\"t1\").start(); } å¼€é”€é—®é¢˜ è‡ªæ—‹CASå¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥éå¸¸å¤§çš„æ‰§è¡Œå¼€é”€ã€‚è²Œä¼¼ç›®å‰æ— è§£ï¼Œå¥½åƒä¹Ÿå¾ˆéš¾é‡åˆ°ã€‚ åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ ç”¨é” å¤šä¸ªå˜é‡åˆå¹¶æˆä¸€ä¸ªå˜é‡ ","date":"2021-01-07","objectID":"/cas/:3:2","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":null,"content":"AotomicIntegeråŸç† public final int getAndUpdate(IntUnaryOperator updateFunction) { int prev, next; do { prev = get(); next = updateFunction.applyAsInt(prev); } while (!compareAndSet(prev, next)); return prev; } //CASæ“ä½œ private static final sun.misc.Unsafe U = sun.misc.Unsafe.getUnsafe(); public final boolean compareAndSet(int expect, int update) { return U.compareAndSwapInt(this, VALUE, expect, update); } å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä½¿ç”¨do-whileå¯¹CASåšåˆ¤æ–­ï¼Œå¦‚æœCASè¿”å›falseï¼Œé‚£ä¹ˆå°±ç»§ç»­å¾ªç¯ã€‚ ","date":"2021-01-07","objectID":"/cas/:4:0","series":null,"tags":["Java"],"title":"CASåŸç†å’Œé—®é¢˜","uri":"/cas/"},{"categories":["technology"],"content":"åç¼–è¯‘æŒ‡ä»¤ javap -v XXX.class ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:1:0","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"ç›‘è§†å™¨å¯¹è±¡Monitor ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:2:0","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"åŸç† å½“synchronizedåŠ è½½ä»£ç å—ä¸Šï¼ŒJVMä¼šæ‰§è¡Œä¸¤æ¡æŒ‡ä»¤ï¼š åŠ é”ï¼šMonitorEnter è§£é”ï¼šMonitorExit å½“synchornizedå…³é”®å­—åŠ åœ¨æ–¹æ³•ä¸Šï¼Œjvmä¼šç»™è¯¥æ–¹æ³•åŠ ä¸€ä¸ªflagï¼šACC_SYNCHRONIZED ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:3:0","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"Javaå¯¹è±¡å¤´ å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­newä¸€ä¸ªobjectï¼Œæ¯ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­éƒ½ä¼šå­˜æ”¾ç›¸å…³çš„æ•°æ®ï¼Œé™¤äº†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å±æ€§ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ç€ä¸€ä¸ªå¯¹è±¡å¤´ï¼Œå¯¹è±¡å¤´å­˜æ”¾ç€GCå¹´é¾„ï¼ˆMarkWorkï¼‰ï¼Œ ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:4:0","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"Synchornizedä¸­çš„é”åˆ†ç±» ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:5:0","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"è½»é‡é” é€šè¿‡CASæ“ä½œæ¥åŠ é”å’Œè§£é”ï¼Œçº¿ç¨‹å¦‚æœæ‹¿ä¸åˆ°é”ï¼Œä¼šè‡ªæ—‹ï¼Œè€Œä¸éœ€è¦æŒ‚èµ·çº¿ç¨‹ï¼Œå‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç›¸å¯¹æ€§èƒ½è¾ƒé«˜ã€‚ ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:5:1","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":["technology"],"content":"è‡ªæ—‹é” ä¸æŒ‚èµ·çº¿ç¨‹ï¼Œbu ","date":"2021-01-06","objectID":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/:5:2","series":null,"tags":["java"],"title":"synchornizedå…³é”®å­—","uri":"/synchornized%E5%85%B3%E9%94%AE%E5%AD%97/"},{"categories":null,"content":"åºåˆ—åŒ–ï¼šObject =\u003e String ååºåˆ—åŒ–ï¼šString =\u003e Object ","date":"0001-01-01","objectID":"/%E5%BA%8F%E5%88%97%E5%8C%96/:0:0","series":null,"tags":["Android"],"title":"åºåˆ—åŒ–","uri":"/%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"æ ¸å¿ƒåŸç† åºåˆ—åŒ–æ˜¯æŠŠå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆè½¬æ¢ä¹‹åçš„å­—ç¬¦ä¸²ï¼Œå°±ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥Javaçš„åºåˆ—åŒ–æ˜¯åŸºäºæ–‡ä»¶IOçš„ã€‚ ","date":"0001-01-01","objectID":"/%E5%BA%8F%E5%88%97%E5%8C%96/:1:0","series":null,"tags":["Android"],"title":"åºåˆ—åŒ–","uri":"/%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"Serializable public class Main { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); boolean goOn = true; while (goOn) { System.out.println(\"1å†™å…¥ï¼Œ2è¯»å–ï¼Œ0é€€å‡º\"); int answer = scanner.nextInt(); switch (answer) { case 1: writeObject(); break; case 2: readObject(); break; default: goOn = false; } } } catch (Exception e) { e.printStackTrace(); } } /** * å†™å…¥ * @throws IOException */ private static void writeObject() throws IOException { ObjectOutputStream stream = new ObjectOutputStream(new FileOutputStream(\"test.txt\")); Student student = new Student(); stream.writeObject(student); } /** * è¯»å– * @throws IOException * @throws ClassNotFoundException */ private static void readObject() throws IOException, ClassNotFoundException { ObjectInputStream stream = new ObjectInputStream(new FileInputStream(\"test.txt\")); Student student = (Student) stream.readObject(); System.out.println(\"è¯»åˆ°å¯¹è±¡ï¼š\" + student.toString()); } /** * æµ‹è¯•åºåˆ—åŒ–ç±» */ private static class Student implements Serializable { /** * æ³¨æ„ï¼š * 1.å¿…é¡»æ˜¯static final long serialVersionUIDï¼› * 2.åœ¨ååºåˆ—åŒ–æ—¶ï¼ŒJavaæ ¹æ®è¿™ä¸ªæ¥åˆ¤å®šç±»å‹æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœå˜åŒ–ä¼šæŠ›å‡ºInvalidClassExceptionï¼ˆç±»å‹æ— æ•ˆå¼‚å¸¸ï¼‰ï¼› * 3.å¹¶ä¸æ˜¯å¿…é¡»ï¼ŒJavaä¼šé»˜è®¤ç”Ÿæˆï¼› * 4.å¦‚æœä¸¤ä¸ªç«¯åŒæ—¶åŒæ—¶æ“ä½œåºåˆ—åŒ–æ–‡ä»¶ï¼ŒAç«¯çš„serialVersionUIDå˜äº†ï¼Œæ¯”å¦‚å¢åŠ äº†å­—æ®µï¼Œç„¶åè¿›è¡Œäº†åºåˆ—åŒ–ï¼›è€ŒBç«¯çš„serialVersionUIDæ²¡æœ‰å˜ï¼Œæ˜¯å¯ä»¥æˆåŠŸååºåˆ—åŒ–çš„ï¼Œä½†æ˜¯ä¼šå¿½ç•¥Aç«¯æ–°å¢çš„å­—æ®µã€‚ */ private static final long serialVersionUID = 2L; public String name = \"å¼ ä¸‰\"; public int age = 18; private final Teacher teacher = new Teacher(); @Override public String toString() { return \"Student{\" + \"name='\" + name + '\\'' + \", age=\" + age + \", teacher=\" + teacher + '}'; } } /** * åºåˆ—åŒ–ç±»å‹ä¸­çš„å¼•ç”¨ç±»å‹å¿…é¡»ä¹Ÿæ˜¯å¯åºåˆ—åŒ–çš„ */ private static class Teacher implements Serializable { public String name = \"æå››\"; public int age = 22; @Override public String toString() { return \"Teacher{\" + \"name='\" + name + '\\'' + \", age=\" + age + '}'; } } } ","date":"0001-01-01","objectID":"/%E5%BA%8F%E5%88%97%E5%8C%96/:2:0","series":null,"tags":["Android"],"title":"åºåˆ—åŒ–","uri":"/%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"Externalizable æä¾›äº†ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼š writeExternal(ObjectOutPut out) readExternal(ObjectOutPut out) ","date":"0001-01-01","objectID":"/%E5%BA%8F%E5%88%97%E5%8C%96/:3:0","series":null,"tags":["Android"],"title":"åºåˆ—åŒ–","uri":"/%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"Parcelable ","date":"0001-01-01","objectID":"/%E5%BA%8F%E5%88%97%E5%8C%96/:4:0","series":null,"tags":["Android"],"title":"åºåˆ—åŒ–","uri":"/%E5%BA%8F%E5%88%97%E5%8C%96/"}]