---
title: "HTTP协议"
subtitle: ""
date: 2021-08-31T16:55:19+08:00
lastmod: 2021-08-31T16:55:19+08:00
draft: false
authors: []
description: ""

tags: []
categories: []
series: [网络协议]

hiddenFromHomePage: false
hiddenFromSearch: false

featuredImage: ""
featuredImagePreview: ""

toc:
  enable: true
math:
  enable: false
lightgallery: false
license: ""
---

<!--more-->

### 概述

概念：超文本传输协议。依赖传输层中的TCP协议，数据链路层中的IP协议，但自己本身位于应用层。

默认端口号：80。

### URL

统一资源标识符。

```
http://host[":"port][abs_path]
```

### 特点

- **无连接**：每次连接只处理一个请求，服务器处理完请求后立即开始挥手，以最快的速度断开连接以节省资源；
- **媒体独立**：通过指定`MIME-type`，可以传输任何类型的数据；
- **无状态**：对于事务的处理没有记忆功能，不能持久化，所以需要其他技术手段来储存信息，如cookie;
- **明文传输**。

### 请求结构

![](http协议的结构.png)

#### 回车符与换行符

- 回车符`\r`：告诉打字机把打印头定位到左边界；
- 换行符`\n`：告诉打字机把纸下移一行。

### 响应结构

```
HTTP/1.1 200 OK/r/n
Date: Sat, 31 Dec 2005 23:59:59 GMT/r/n
Content-Type: text/html;charset=ISO-8859-1/r/n
Content-Length: 122/r/n
/r/n
<html>
</html>
```

### 请求类型

| 类型    | 作用                                                                                                                                                                                  |
| ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OPTIONS | 返回服务器针对特定资源所支持的HTTP请求方法。也可以利用向Web服务器发送'*'的请求来测试服务器的功能性。                                                                                  |
| HEAD    | 向服务器索要与GET请求相一致的响应，只不过响应体将不会被返回。这一方法可以在不必传输整个响应内容的情况下，就可以获取包含在响应消息头中的元信息。                                       |
| GET     | 向特定的资源发出请求。                                                                                                                                                                |
| POST    | 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的创建和/或已有资源的修改。                                               |
| PUT     | 向指定资源位置上传其最新内容。                                                                                                                                                        |
| DELETE  | 请求服务器删除 Request-URI 所标识的资源。                                                                                                  content/posts/Technology/网络协议/HTTP协议 |
| CONNECT | HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器。                                                                                                                             |

### 状态码

| 系列 | 系列描述                                         |
| ---- | ------------------------------------------------ |
| 1**  | 信息，服务器收到请求，需要请求者继续执行操作。   |
| 2**  | 成功，操作被成功接收并处理。                     |
| 3**  | 重定向，需要进一步的操作以完成请求。             |
| 4**  | 客户端错误，请求包含语法错误或无法完成请求。     |
| 5**  | 服务器错误，服务器在处理请求的过程中发生了错误。 |

### 版本更迭

#### 0.9

仅支持GET请求，仅能访问html资源。

#### 1.0

- 必须在请求行中标明版本号`http/1.0`;
- 增加了POST和HEAD请求方法；
- 增加了Content-Type多媒体类型支持；
- 增加了客户端cache的支持；
- 请求必须包函`头信息`；
- 增加状态码支持；
- 增加用户鉴权；
- 每次Tcontent/posts/Technology/网络协议/HTTP协议会关闭，如果再次请求则需要重新建立TCP连接，开销大效率低。

#### 1.1

- **引入持久连接**；
- 加入NIO机制，允许在同一个TCP连接中同时发送多个请求，增加了并发性，提高效率；
- 分块传输数据；
- 增加`PUT`、`PATCH`、`OPTIONS`、`DELETE`请求；
- 请求头中增加Host字段；
- 支持断点续传（`RANGE:bytes`）。

Http1.1中虽然复用了TCP连接，并且客户端可以同时发送请求，但是服务端还是按队列顺序来处理，假设前面请求的处理时间过长，导致后面有很多的请求排队等待，会造成「头部阻塞」问题。

由于Http是无状态连接，因此每次请求都需要添加重复的字段，降低了带宽的利用率。

多路复用带来一个严重问题，即重要的请求可能一直被阻塞。

#### 2.0

- 增加双工模式，客户端和服务器都可以同时处理多个请求，解决头部问题；
- 增加服务器主动推送能力。

#### 3.0(Quick UDP Internet Connections)

3.0基于UDP实现，原理当然就是通过短报文解决各种疑难杂症：

- TCP建立连接时间长；
- 头部阻塞；
- 弱网环境，断线。。。


